!function(R,H,r){"use strict";var C="ht";if(!R[C]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),R.performance&&R.performance.now||function(){var h=Date.now();R.performance||(R.performance={}),R.performance.now=function(){return Date.now()-h}}();for(var F=Date.now(),m=16,k=["ms","moz","webkit","o"],P=0;P<k.length&&!R.requestAnimationFrame;++P)R.requestAnimationFrame=R[k[P]+"RequestAnimationFrame"],R.cancelAnimationFrame=R[k[P]+"CancelAnimationFrame"]||R[k[P]+"CancelRequestAnimationFrame"];R.requestAnimationFrame||(R.requestAnimationFrame=function(y){var E=Date.now(),B=m+F-E;return 0>B&&(B=0),F=E,R.setTimeout(function(){F=Date.now(),y(performance.now())},B)}),R.cancelAnimationFrame||(R.cancelAnimationFrame=function(s){return R.clearTimeout(s)}),H.assign===r&&(H.assign=function(u){if(u===r||null===u)throw new TypeError("Cannot convert undefined or null to object");for(var E=H(u),M=1;M<arguments.length;M++){var R=arguments[M];if(R!==r&&null!==R)for(var n in R)H.prototype.hasOwnProperty.call(R,n)&&(E[n]=R[n])}return E})}();var k=R.document,s=null,I=R[C]={},A=R[C+"config"],l=I.Default=A&&A.Default||{},g=I.Style=A&&A.Style||{},y=I.Attr=A&&A.Attr||{},h=I.Color=A&&A.Color||{},Q=I.IsGetter=A&&A.IsGetter||{};!function(){var K=!1;try{var g=H.defineProperty({},"passive",{get:function(){K=!0}});R.addEventListener("test",g,g),R.removeEventListener("test",g,g)}catch(z){K=!1}l.passiveSupported=K}();var E,f,G,m,V=l.passiveSupported,i=l.eventListenerOptionsFalse=V?{passive:!1,capture:!1}:!1,e=l.eventListenerOptionsTrue=V?{passive:!1,capture:!0}:!0,j=Math,d=j.round,c=j.floor,v=j.ceil,W=j.sqrt,t=j.max,$=j.min,P=j.abs,b=j.cos,T=j.acos,w=j.sin,F=j.pow,J=j.asin,M=j.PI,p=2*M,S=M/2,x=j.tan,Z=j.atan2,_=j.random,n=j.log,u=!0,Y=!1,o=R.parseInt||global.parseInt,K="2019-03-25",X=R.navigator?R.navigator.platform.indexOf("Win")>-1:!1,z=function(x){return x*x},q=R.setTimeout,U=R.clearTimeout,L=R.location,O=R.navigator?R.navigator.userAgent.toLowerCase():"",D=function(t){return t.test(O)},B=D(/msie/),N=D(/msie/)||D(/trident/),a=D(/msie 10/),tc=D(/edge/),ge=D(/firefox/),yb=D(/mac/),Ch=l.isTouchable===r?X?!1:k?"ontouchend"in k:!1:l.isTouchable,uj="default",Tc="single",Ij="multiple",pg="front",Pm="back",Ih="left",Go="right",ns="top",cj="bottom",Re="center",Wg="eye",Mo="middle",_j="east",nj="west",up="north",zh="none",pp="px",go="absolute",Ke="border",fd="triangle",Dj="rect",Bp="circle",ag="cylinder",jf="shape",qk="items",Ag="normal",fj="remove",Xb="clear",Lg="width",cc="height",ed="ingroup",Ii="check",Fi="uncheck",Zg="radio",aq="radioOn",Yn="radioOff",Gp="points",Fq="values",ih="series",wm="body",Le="label",cf="label2",Hl="note",hc="note2",wp="icons",wo="labelFont",Nb="labelColor",oe="labelSelectColor",Cc="note.expanded",ob="note2.expanded",bb="edge.expanded",mi="edge.points",Cp="edge.type",Nc="rotation",mq="hidden",Gj="visible",aj="tuv",nf="no",br="draw",Kr="select",Yr="currentSubGraph",xm="selectBackground",Sg="autoMakeVisible",kg="autoHideScrollBar",Sb="scrollBarColor",Um="scrollBarSize",Vl="indent",Ar="rowHeight",qn="columnLineColor",om="rowLineColor",mh="columnLineVisible",oi="rowLineVisible",Tn="visibleFunc",Vh="expandIcon",nh="collapseIcon",dn="checkMode",ij="sortFunc",eb="editable",Lp="batchEditable",ho="tristate",lj="asc",mk="desc",Yb="position",Jd="elevation",Mi="children",dj="translateX",_n="translateY",oo="dataModel",od="maxSize",is="shape3d",Ze="shape3d.resolution",Th="shape3d.visible",En="shape3d.from.visible",vo="shape3d.to.visible",pq="shape3d.top.visible",Al="shape3d.bottom.visible",Pb="repeat.uv.length",Ib="serializeValue",kd="deserializeValue",yk="centerUniform",Yc="uniform",yd="rgba(255,255,255,0)",Cg="style",ub="attr",$c="field",uc="string",Fe="boolean",fk="color",qh="int",Zf="number",co="ew-resize",Wi="ns-resize",Ne="pointer",wr="auto",jk="mousedown",Ek="mousemove",sl="mouseup",Jf="mouseout",jm="touchstart",No="touchmove",zf="touchend",Ug="keydown",$j="keyup",se=["DOMMouseScroll","mousewheel"],qr=ge?se[0]:se[1],Yo=Ch?[jm,No,zf,Ug,$j,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Ug,$j,"keypress","input",jk,Ek,sl,Jf,qr,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Bc=s,no=s,wb=s,io=sl.length,hs=function(){wb&&(U(wb.timeout),wb=s)},td=function(){wb&&bi(wb.e,wb.info)};R.addEventListener&&(Ch||(R.addEventListener(Jf,function(){hs()},i),R.addEventListener(qr,function(){Si()},i)),R.addEventListener($j,function(Y){91===Y.keyCode?wd={}:delete wd[Y.keyCode]},e),R.addEventListener(Ug,function(y){wd[y.keyCode]=!0},e),R.addEventListener("blur",function(){wd={}},i));var Ao,Ji,wg,Sp=0,Sm=s,fg=function(u,p){var P=q(function(){delete Sm[P],rb(Sm)&&(Sm=s),u()},p);return P},_d=s,tp=s,wn={},le={},mm={},Vc={},ug={},wd={},$q={},Ho={},$d={},mb={},Pd=/.json$/,Fm=/^data:image\/svg\+xml/,Gc={},sb=[],qs={},Fr=s,kn=s,ve=function(){},ak=function(){throw"Oops!"},wi=[0,0,0],vi={x:0,y:0,width:0,height:0},Kb=s,Tf=s,hb=s,sn=function(a,k){le[a]=k,k&&k.comps&&!k.uuid&&(k.uuid=I.Math.generateUUID()),ee[a]&&(k.cacheRule=ee[a],delete ee[a])},md=function(X){Tf&&!X._72O&&(hb||(hb={}),hb[X._72O=to()]=X),Ao!=s?Xi()<.05&&m&&!Ji&&(ze=hs):ze=Xp},hl=function(G,Y,L,a){Tf||(Tf={});var w=Tf[G];if(w){if(w.url===Y)return;w.image?(w.image.onload=ve,w.image.onerror=ve):w.request&&(w.request.onload=ve,w.request.onerror=ve)}if(Pd.test(Y)){var X=new ib;if(Tf[G]={request:X,url:Y},Y=l.beforeLoadURL(Y),Y.data){var H=l.parse(Y.data);Ak(G,H),l.handleImageLoaded(G,H)}else{X.onload=function(N){if(200===this.status||0===this.status){var S=l.parse(N.target.response||N.target.responseText);Ak(G,S),l.handleImageLoaded(G,S)}else Ak(G,l.handleUnfoundImage(G,Y)||s)},X.onerror=function(){Ak(G,l.handleUnfoundImage(G,Y)||s)};var u={};u.url=encodeURI(Y),u.sync=!1,X.send(u)}}else{var H=new Image;Tf[G]={image:H,url:Y},/^data:image/.test(Y)||(Y=l.beforeLoadURL(Y),Y=l.appendTimeStamp(Y),Y=encodeURI(Y),H.crossOrigin=l.crossOrigin),l.convertImageSrc(Y,function(A){N&&(Y.toLowerCase().indexOf(".svg")>0||Fm.test(Y))?(k.body.appendChild(H),H.style.visibility="hidden",H.onload=function(){q(function(){if(L&&(H.width=L),a&&(H.height=a),!H.width||!H.height){var o=H.width||H.clientWidth,e=H.height||H.clientHeight;H.width=o,H.height=e}l.handleImageLoaded(G,H),Ak(G,H),k.body.removeChild(H),H.style.visibility=""},180)},H.onerror=function(){Ak(G,l.handleUnfoundImage(G,Y)||s),k.body.removeChild(H),H.style.visibility=""}):(H.onload=function(){L&&(H.width=L),a&&(H.height=a),l.handleImageLoaded(G,H),Ak(G,H)},H.onerror=function(){Ak(G,l.handleUnfoundImage(G,Y)||s)}),H.src=A})}},Ak=function(n,v){if(sn(n,v),delete Tf[n],rb(Tf)&&(Tf=s,hb)){for(var w in hb){var p=hb[w];p._2O&&p._2O[n]&&(p.deleteTexture(n),delete p._2O[n]),p.invalidateAll&&p.invalidateAll(r,"imageLoaded",n),p.redraw&&p.redraw(),p.iv(),delete p._72O}hb=s}if(v&&hb)for(var w in hb){var p=hb[w];p.invalidateAll&&p.invalidateAll(r,"imageLoading",n),p.redraw&&p.redraw(),p.iv()}},Ip=function(){return n=j&&Date,function(){return R.performance&&R.performance.now?R.performance.now():Date.now()}}(),Sh=function(P,g){g?U(P):R.cancelAnimationFrame(P)},wf=function(o,$,Y){return{width:o,height:$,comps:xd(Y)?Y:[Y]}},Yi=function(u,z){return{type:Bp,rect:[u,z,1.6,1.6],borderWidth:1,borderColor:$i,gradient:op,gradientColor:tg,background:$i}},Hh=function(r,o){return wf(16,16,{type:fd,rect:[4,4,10,8],background:r,rotation:o?1.57:3.14})},Jl=function(K,Q){return wf(16,16,{type:fd,rect:[4,4,8,7],background:K,rotation:Q?3.14:0})},Or=function(H){var K=H._orientation;return"horizontal"===K||"h"===K},un=function(y){var Q=s||4,C=s||1,o=s||1;0>Q?Q=0:Q>.25&&(Q=.25);var j,q,S,N,k,x,v,_=.5,e=[],L=[],z=[],n=p/o,R=p/C,D=_-Q;for(q=0;C>=q;q++)for(N=-M+q*R,x=b(N),k=w(N),j=0;o>=j;j++)S=j*n,v=D+Q*x,e.push(b(S)*v,k*Q,-w(S)*v),(f=y)&&L.push(j/o,1-q/C);for(q=0;C>q;q++){var I=q*(o+1),l=(q+1)*(o+1);for(j=0;o>j;j++)z.push(I+j,l+j+1,l+j,I+j,I+j+1,l+j+1),Km.z=_f.z=y}},yl=function(t){var L=2,A=0;for(var u in t)u.length===L&&o(u,32)===Cj&&(Fr=kn=t[u]),A++;return A},ne=function(H,C,J,d){return J||(J=Ch?5:3,J/=d||1),{x:H-J,y:C-J,width:2*J,height:2*J}},ar=function(q,r,U,i){var c=this;r||(r=Ch?5:3,U=20,i=20);var l={x:q,y:r,width:U,height:i};if(U)for(var w=0;U>w;w++)if(3===U)i=20;else for(var Y=0;i>Y;Y++)c=R?R:U;var C={x:M,y:2*M};if(Li(l,C)){var V=cc[0]+ns[0]+Xb[1]+(lj.length-1);cq[Wg]=c[V],c[V]=Lb[Wg]}},Xk=function(S){return(/ble$/.test(S)||/ed$/.test(S)||Q[S]?"is":"get")+S.charAt(0).toUpperCase()+S.slice(1)},Lb=function(g){return"set"+g.charAt(0).toUpperCase()+g.slice(1)},Kl=function(w){return typeof w===uc||w instanceof String},il=function(I){return typeof I===Zf},Xp=function(P){return typeof P===Fe},sk=function(P){return P&&"object"==typeof P},Ym=function(v){return"function"==typeof v},xd=function(w){return w instanceof Array},pn=function(j){return j instanceof Ce},Pp=function(i){return xd(i)?new Ce(i):i},lb=function(c){return c instanceof Vb},Hb=function(Q){return Q instanceof Fp},Ig=function(u){return u instanceof Mp},Rm=function(t,p){if(!(t instanceof I.Group))return!1;if(!p)return t.isExpanded();var k=p.getDataUI(t);return k&&k._88I?!0:!1},qm=function(u){return u instanceof Ud},gp=function(v){return v&&"IFRAME"===v.tagName},ud=function(E){return E==s||l.numberDigits==s?E:parseFloat(E.toFixed(l.numberDigits))},ff=function(j,B,w){var H,X=B.length;if(w)for(var b=0;w>b;b++)if(3===X)j.push(B[0]),j.push(B[1]),j.push(B[2]);else for(H=0;X>H;H++)j.push(B[H]);else if(3===X)j.push(B[0]),j.push(B[1]),j.push(B[2]);else for(H=0;X>H;H++)j.push(B[H])},dg=function(K){return K?sk(K)?K:{}:!1},Kk=function(A,t,w){var N,H=sk(A)?A:A.prototype;for(N in t)w&&H[N]!==r||(H[N]=t[N]);return A},Kh=function(w){return String.fromCharCode(w)},fb=function(n){for(var j,q=0,W="";q<n.length;q++)j=n[n.length-1-q],"%"===j?j="'":"a"===j?j='"':"]"===j&&(j="\\"),W+=Kh(j.charCodeAt(0)-1);return W},jj=function(K,o,z){K.superClass.constructor.apply(o,z)},rb=function(i){for(var W in i)return!1;return!0},ys=function(c){return c?0===c.length:!0},Kq=function(){var s="";return[Fi[0],om[0],Le[0]].forEach(function(S){s+=Lb(S).slice(3)}),Yc=k&&k[s]||yk,function(q,L){return q===L?!0:q.x===L.x&&q.y===L.y&&q.width===L.width&&q.height===L.height}}(),bm=function(G,S,O){return S>G?S:G>O?O:G},gr=function(h){return 0>h?-1:h>0?1:0},Xi=function(){var t=1e4*w(io++);return t-c(t)},Dn=function(y,m,w){return me(y.x,y.y,m.x,m.y,w.x,w.y,w.x+w.width,w.y,!0)||me(y.x,y.y,m.x,m.y,w.x+w.width,w.y,w.x+w.width,w.y+w.height,!0)||me(y.x,y.y,m.x,m.y,w.x+w.width,w.y+w.height,w.x,w.y+w.height,!0)||me(y.x,y.y,m.x,m.y,w.x,w.y+w.height,w.x,w.y,!0)},me=function(V,P,w,_,N,D,E,W,S){var n=(E-N)*(P-D)-(W-D)*(V-N),Y=(W-D)*(w-V)-(E-N)*(_-P);if(0!==Y){var F=n/Y,C=V+F*(w-V),L=P+F*(_-P);return S&&(C+Bi<$(V,w)||C-Bi>t(V,w)||C+Bi<$(N,E)||C-Bi>t(N,E)||L+Bi<$(P,_)||L-Bi>t(P,_)||L+Bi<$(D,W)||L-Bi>t(D,W))?s:[C,L]}return s},Tm=function(g,A,Y){if(g&&Y)if(A){if(A===Cg)return g.getStyle(Y);if(A===ub)return g.getAttr(Y);if(A===$c)return g[Y]}else if(Y=Xk(Y),g[Y])return g[Y]();return r},gf=function(k,p,Q,$){if(k&&Q)if(p){if(p===Cg)k.s(Q,$);else if(p===ub)k.a(Q,$);else if(p===$c){var s=k[Q];k[Q]=$,k.fp("f:"+Q,s,$)}}else Q=Lb(Q),k[Q]&&k[Q]($)},Cl=function(L,v,u){return v&&"top"!==v?"bottom"===v?{x:L.x,y:L.y,width:L.width,height:L.height*u}:"right"===v?{x:L.x,y:L.y,width:L.width*u,height:L.height}:"left"===v?{x:L.x+L.width*(1-u),y:L.y,width:L.width*u,height:L.height}:void 0:{x:L.x,y:L.y+L.height*(1-u),width:L.width,height:L.height*u}},oq=function(o,y,l,R,t){y&&Yl(o,l,R,1,t,y)},pd=function(z,w,o,j){var T=1-z;return T*T*w+2*z*T*o+z*z*j},Km=function(w,z,i,k,G){var M=1-w;return M*M*M*z+3*M*M*w*i+3*M*w*w*k+w*w*w*G},Rl=function(i){var t,B,X,O,w=0;return i.forEach(function(l){if(t=l.length,t>0)for(B=l[0],O=1;t>O;O++)X=l[O],w+=Bg(B,X),B=X}),w},Ue=function(T,p,w){var u="__"+T,t=function(j){w.disabled||w["handle_"+T](j)};w[u]||(w[u]=t,p.addEventListener(T,t,i))},Ee=function(w,g,q){var L="__"+w,H=q[L];H&&(g.removeEventListener(w,H,i),delete q[L])},$n=function(g,R){var b="_"+R;g[Xk(R)]=function(){return this[b]},g[Lb(R)]=function(g){var B=this[b];this[b]=g,this.fp(R,B,g)}},gj=function(N){return H.create(N)},us=function(y){if(!y.element){var k,H;(k=y.textField)?H=sh(yc.TextField,k):(k=y.textArea)?H=sh(yc.TextArea,k):(k=y.button)?H=sh(yc.Button,k):(k=y.comboBox)?H=sh(yc.ComboBox,k):(k=y.checkBox)?H=sh(yc.CheckBox,k):(k=y.radioButton)?H=sh(yc.RadioButton,k):(k=y.slider)?H=sh(yc.Slider,k):(k=y.colorPicker)?H=sh(yc.ColorPicker,k):(k=y.image)&&(H=sh(yc.Image,k)),H&&(y.element=H)}},js=function(O,j){var t=$b(O);return t._ht=j,t},$b=function(Q,M){var d=k.createElement("div"),K=d.style;return d.tabIndex=-1,d.onkeydown=bn,K.msTouchAction=zh,ii(d,s,0),Ch&&K.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",s),Q&&(K.overflow=mq),M&&Xd(M,d),d},Ub=function(d,P){var l=k.createElement("canvas"),D=l.style;return D.msTouchAction=zh,P||(D.pointerEvents=zh),ii(l,s,0),d&&Xd(d,l),l},ii=function(M,P,B){var p=M.style;p.border=P?P+" solid 1px":0,p.outline=0,p.padding=B?"0 "+B+pp:0,Ql(M)},Ql=function(L){var E=L.style;E.position=go,E.margin=0,E.setProperty("box-sizing","border-box",s),E.setProperty("-moz-box-sizing","border-box",s)},sf=function(G,b,Q,M){M||(M=Rb),b!=s&&(G.width=b*M,G.style.width=b+pp),Q!=s&&(G.height=Q*M,G.style.height=Q+pp)},Xd=function(Q,g,w){Q.appendChild(g),w&&(g.style.position=go)},Kp=function(B,W){W.split||(W+="");for(var g,p=W.split("\n"),R=0,X=p.length,k=0;X>k;k++){var d=sq(B.font,p[k]);d.width>R&&(R=d.width),g||(g=d.height)}return B.ss=p,{width:R,height:g*X}},dc=function(H,G,O,z,t,X){var f=G.length;if(1===f)Cq(H,G[0],O,z,t);else for(var D=O.height/f,x={x:O.x,y:O.y,width:O.width,height:D},a=0;a<G.length;a++)X?li(H,G[a],z,t,x.x,x.y,x.width,x.height,X):Cq(H,G[a],x,z,t),x.y+=D},Cq=function(w,q,D,o,k){w.font=o?o:bo,w.fillStyle=k?k:Xj,w.textAlign=Re,w.textBaseline=Mo;var Q,E;D?D.width===r?(Q=D.x,E=D.y):(Q=D.x+D.width/2,E=D.y+D.height/2):(Q=0,E=0),w.fillText(q,d(Q),d(E))},kh=function(M){M.getView&&(M=M.getView());var b=M.offsetWidth||M.scrollWidth;return!b&&M.style.width&&(b=o(M.style.width)),b},ec=function(c){c.getView&&(c=c.getView());var Y=c.offsetHeight||c.scrollHeight;return!Y&&c.style.height&&(Y=o(c.style.height)),Y},pe=function(C,X,E){var I=X[0].toUpperCase()+X.substring(1,X.length);C["webkit"+I]=E,C["moz"+I]=E,C["ms"+I]=E,C["o"+I]=E,C[X]=E},yg=function(){var O=function(J){bn(J),J.stopPropagation()},o=function(o){bn(o)},F=Ch?[jm]:[Ug,jk];return function(G,u){var E=$b(),z=E.style;return z.backgroundColor=l.disabledBackground,G&&(z.backgroundImage="url("+G+")",z.backgroundPosition="50% 50%",z.backgroundRepeat="no-repeat no-repeat"),u===!1?F.forEach(function(k){E.addEventListener(k,o,i)}):F.forEach(function(H){E.addEventListener(H,O,i)}),E}}(),An=function(M){var f=M.getContext("2d");return f.save(),f.lineCap=fo,f.lineJoin=cn,f},ze=function(O,x,d,_){Zd(O,x*Rb,d*Rb),_*=Rb,1!==_&&O.scale(_,_)},Zd=function(E,t,Y){E.translate(t,Y)},jc=function($,T){T&&$.rotate(T)},vp=function(o,v,G){v===r&&(v=1),G===r&&(G=1),(1!==v||1!==G)&&o.scale(v,G)},jd=!1,an=function(Q){var G=k.activeElement;if(k.activeElement!==Q){G&&G.forceOnblur&&G.forceOnblur();for(var n=[],g=Q.parentNode;g;)n.push([g,g.scrollLeft,g.scrollTop]),g=g.parentNode;if(!jd){var w=[],m=[];try{for(var V=R.parent,C=R;V!==C;)w.push([V,V.scrollX,V.scrollY]),C=V,V=R.parent;var T=R.frameElement;if(T)for(var J=T.parentNode;J;)m.push([J,J.scrollLeft,J.scrollTop]),J=J.parentNode}catch(o){jd=!0}}if(Ch)Q.focus();else{var W=$h(),M=W.target;Q.focus(),M.scrollLeft=W.left,M.scrollTop=W.top}n.forEach(function(K){K[0].scrollLeft=K[1],K[0].scrollTop=K[2]}),jd||(w.forEach(function(Y){Y[0].scrollTo(Y[1],Y[2])}),m.forEach(function(M){M[0].scrollLeft=M[1],M[0].scrollTop=M[2]}))}},Yf=function(T){return T&&T.getView?T.getView():T},Kj=function(G,X,D,V,d){if(2===arguments.length&&(D=X.y,V=X.width,d=X.height,X=X.x),G.isSelfViewEvent)G.setX(X),G.setY(D),G.setWidth(V),G.setHeight(d);else{var $=Yf(G),O=$.style;if((k.fullscreenElement||k.mozFullScreenElement||k.webkitFullscreenElement||k.msFullscreenElement)!==$)X!==r&&(O.left=X+pp),D!==r&&(O.top=D+pp),V!==r&&(O.width=V+pp),d!==r&&(O.height=d+pp);else{var J=l.getWindowInfo();O.left=(X=J.left)+pp,O.top=(D=J.top)+pp,O.width=(V=J.width)+pp,O.height=(d=J.height)+pp}G.endEditing&&!Ch&&G.endEditing(),G.redraw&&G.redraw(),G.invalidate&&G.invalidate(),G.onLayouted&&G.onLayouted(X,D,V,d),G.fireViewEvent&&G.fireViewEvent("layout")}},Lk=function(Y){if(!Y.touches)return Y;var F=Y.touches[0];return F?F:Y.changedTouches[0]},Ki=function(Q){return Ch?Lk(Q).target:Q.target},ei=function(m){l.popup&&l.popup.close(),l.popup=m},Rn=s,kk=function(D){Rn.handleWindowTouchMove(D)},vd=function(F){Rn.handleWindowTouchEnd(F),R.removeEventListener(No,kk,i),R.removeEventListener(zf,vd,i),Rn=s},zr=function(X){Rn.handleWindowMouseMove(X)},fc=function(U){Rn.handleWindowMouseUp(U),R.removeEventListener(Ek,zr,i),R.removeEventListener(sl,fc,i),Rn=s},xq=function(D){return 1===Xf(D)},lr=function(T,m){return m?m.keyCode===T:wd[T]},Jc=function(A){return Ei(A)&&lr(65,A)},Wl=function(x){return lr(46,x)||lr(8,x)},Eh=function(W){return function($){return $?$.keyCode===W:wd[W]}},Cj=573,pc=[65,83,68,87,37,38,39,40,32,13,27],fh=Eh(pc[0]),vs=Eh(pc[1]),ik=Eh(pc[2]),iq=Eh(pc[3]),Dp=Eh(pc[4]),ri=Eh(pc[5]),Wc=Eh(pc[6]),tr=Eh(pc[7]),Ln=Eh(pc[8]),$k=Eh(pc[9]),vq=Eh(pc[10]),Ec={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},_i=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,5,29,31],xl=s,rn=s,Ac=function(s,D){xl||(xl=Ub()),sf(xl,s,D,1);var Y=An(xl);return Y.clearRect(0,0,s,D),Y},rp=function(){var n,A={};for(var t in R){var k=Ij.length;if(t.length==k&&t[0]===Ij[2]&&t[1]===zh[1]&&t[4]===Ij[3]&&t[5]===Ij[4]&&t.substr(k-2)===zh[1]+zh[2]){var o=R[t];for(var j in o)j.length===k&&j.substr(0,3)===Go[3]+fj[3]+Kr[0]&&j.substr(k-2)===Ij[0]+Hl[3]&&(se=o[j])}}return function(D){var $,w=A[D];return w||(n||(n=Ub(),sf(n,1,1,1)),$=n.getContext("2d"),$.clearRect(0,0,1,1),Yl($,0,0,1,1,D),w=$.getImageData(0,0,1,1).data,w=A[D]=[w[0],w[1],w[2],w[3]]),w}}(),oj=function(H){if(!Kl(H))return H;var x=rp(H);return x.CA||(x.CA=[x[0]/255,x[1]/255,x[2]/255,x[3]/255]),x.CA},Fd=function(S,W,m,B,P){var x=Ub();x.width=m,x.height=B;var t=x.getContext("2d");t.drawImage(S,0,0,m,B);try{for(var V=t.getImageData(0,0,m,B),r=V.data,h=0,R=r.length;R>h;h+=4){var l=r[h+0],k=r[h+1],s=r[h+2],b=r[h+3];"override_a"===P?r[h+3]=255*W[3]:"override_rgb"===P?(r[h+0]=255*W[0],r[h+1]=255*W[1],r[h+2]=255*W[2]):"override"===P?(r[h+0]=255*W[0],r[h+1]=255*W[1],r[h+2]=255*W[2],r[h+3]=255*W[3]):(r[h+0]=W[0]*l,r[h+1]=W[1]*k,r[h+2]=W[2]*s,r[h+3]=W[3]*b)}t.putImageData(V,0,0)}catch(D){return S}return x},cq=function(l,d,O){return d&&(d="miter"===O?8*d+20:d+1,l&&mf(l,d)),d},np=function(e,T){if(T){var m=new Tk(T),X=e.width/2,G=e.height/2,H=Bq([m.tf(-X,-G),m.tf(X,-G),m.tf(X,G),m.tf(-X,G)]);return H.x+=e.x+X,H.y+=e.y+G,H}return e},Nr=function(U,t,f,h,v,K,B,c){h*=Math.PI/180;var E={x:Math.cos(h)*(U.x-B.x)/2+Math.sin(h)*(U.y-B.y)/2,y:-Math.sin(h)*(U.x-B.x)/2+Math.cos(h)*(U.y-B.y)/2},F=Math.pow(E.x,2)/Math.pow(t,2)+Math.pow(E.y,2)/Math.pow(f,2);F>1&&(t*=Math.sqrt(F),f*=Math.sqrt(F));var r=(v==K?-1:1)*Math.sqrt((Math.pow(t,2)*Math.pow(f,2)-Math.pow(t,2)*Math.pow(E.y,2)-Math.pow(f,2)*Math.pow(E.x,2))/(Math.pow(t,2)*Math.pow(E.y,2)+Math.pow(f,2)*Math.pow(E.x,2)));isNaN(r)&&(r=0);var e={x:r*t*E.y/f,y:r*-f*E.x/t},q={x:(U.x+B.x)/2+Math.cos(h)*e.x-Math.sin(h)*e.y,y:(U.y+B.y)/2+Math.sin(h)*e.x+Math.cos(h)*e.y},o=function(B){return Math.sqrt(Math.pow(B[0],2)+Math.pow(B[1],2))},Y=function(T,g){return(T[0]*g[0]+T[1]*g[1])/(o(T)*o(g))},$=function($,c){return($[0]*c[1]<$[1]*c[0]?-1:1)*Math.acos(Y($,c))},S=$([1,0],[(E.x-e.x)/t,(E.y-e.y)/f]),i=[(E.x-e.x)/t,(E.y-e.y)/f],C=[(-E.x-e.x)/t,(-E.y-e.y)/f],M=$(i,C);Y(i,C)<=-1&&(M=Math.PI),Y(i,C)>=1&&(M=0);var Y=t>f?t:f,D=t>f?1:t/f,P=t>f?f/t:1;if(null==c){var z={x:0,y:0,width:0,height:0};mf(z,Y),z.x*=D,z.width*=D,z.y*=P,z.height*=P;var V=new Tk(h);return z=Bq([V.tf(z.x,z.y),V.tf(z.x+z.width,z.y),V.tf(z.x+z.width,z.y+z.height),V.tf(z.x,z.y+z.height)]),z.x+=q.x,z.y+=q.y,[{x:z.x,y:z.y},{x:z.x+z.width,y:z.y},{x:z.x+z.width,y:z.y+z.height},{x:z.x,y:z.y+z.height}]}c.translate(q.x,q.y),c.rotate(h),c.scale(D,P),c.arc(0,0,Y,S,S+M,1-K),c.scale(1/D,1/P),c.rotate(-h),c.translate(-q.x,-q.y)},tq=function(Z,g){Z&&Z.beginPath();for(var R,A,T,K=[],J=function(L){for(var S,l=/(\-{0,1}[\d\.]+)/gi,q=[];S=l.exec(L);)q.push(parseFloat(S[0]));return q},d=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,p={x:0,y:0};R=d.exec(g);){var w=R[0],u=w.substr(0,1);if("M"===u||"m"===u){for(var i=J(w),x=0;x<i.length;x+=2){var o=i[x],s=i[x+1];"m"===u&&(o+=p.x,s+=p.y),Z&&Z.moveTo(o,s),K.push({x:o,y:s}),p.x=o,p.y=s}A=T=null}else if("H"===u||"h"===u){for(var i=J(w),x=0;x<i.length;x+=1){var o=i[x];"h"===u&&(o+=p.x),Z&&Z.lineTo(o,p.y),K.push({x:o,y:p.y}),p.x=o}A=T=null}else if("C"===u||"c"===u){for(var i=J(w),x=0;x<i.length;x+=6){var C=i[x],r=i[x+1],e=i[x+2],c=i[x+3],o=i[x+4],s=i[x+5];"c"===u&&(C+=p.x,r+=p.y,e+=p.x,c+=p.y,o+=p.x,s+=p.y),Z&&Z.bezierCurveTo(C,r,e,c,o,s),K.push({x:C,y:r}),K.push({x:e,y:c}),K.push({x:o,y:s}),p.x=o,p.y=s}A=[C,r,e,c,o,s],T=null}else if("S"===u||"s"===u){for(var i=J(w),x=0;x<i.length;x+=4){var C,r;A?(C=2*A[4]-A[2],r=2*A[5]-A[3]):(C=p.x,r=p.y);var e=i[x],c=i[x+1],o=i[x+2],s=i[x+3];"s"===u&&(e+=p.x,c+=p.y,o+=p.x,s+=p.y),Z&&Z.bezierCurveTo(C,r,e,c,o,s),K.push({x:C,y:r}),K.push({x:e,y:c}),K.push({x:o,y:s}),p.x=o,p.y=s}A=[C,r,e,c,o,s],T=null}else if("Q"===u||"q"===u){for(var i=J(w),x=0;x<i.length;x+=4){var C=i[x],r=i[x+1],o=i[x+2],s=i[x+3];"q"===u&&(C+=p.x,r+=p.y,o+=p.x,s+=p.y),Z&&Z.quadraticCurveTo(C,r,o,s),K.push({x:C,y:r}),K.push({x:o,y:s}),p.x=o,p.y=s}A=null,T=[C,r,o,s]}else if("T"===u||"t"===u){for(var i=J(w),x=0;x<i.length;x+=2){var C,r;T?(C=2*T[2]-T[0],r=2*T[3]-T[1]):(C=p.x,r=p.y);var o=i[x],s=i[x+1];"t"===u&&(o+=p.x,s+=p.y),Z&&Z.quadraticCurveTo(C,r,o,s),K.push({x:C,y:r}),K.push({x:o,y:s}),p.x=o,p.y=s}A=null,T=[C,r,o,s]}else if("V"===u||"v"===u){for(var i=J(w),x=0;x<i.length;x+=1){var s=i[x];"v"===u&&(s+=p.y),Z&&Z.lineTo(p.x,s),K.push({x:p.x,y:s}),p.y=s}A=T=null}else if("L"===u||"l"===u){for(var i=J(w),x=0;x<i.length;x+=2){var o=i[x],s=i[x+1];"l"===u&&(o+=p.x,s+=p.y),Z&&Z.lineTo(o,s),K.push({x:o,y:s}),p.x=o,p.y=s}A=T=null}else if("A"===u||"a"===u){for(var i=J(w),x=0;x<i.length;x+=7){var q=i[x],y=i[x+1],$=i[x+2],U=i[x+3],V=i[x+4],o=i[x+5],s=i[x+6];"a"===u&&(o+=p.x,s+=p.y);var E=Nr(p,q,y,$,U,V,{x:o,y:s},Z);E&&(K=K.concat(E)),p.x=o,p.y=s}A=T=null}var M=w.substr(w.length-1);("z"===M||"Z"===M)&&Z&&Z.closePath()}return K},Np=function(w,p){var u,K,y="L"===p[0],C=p.length;w.save(),y?(w.transform(p[5],p[6],p[7],p[8],p[9],p[10]),u=w.createLinearGradient(p[1],p[2],p[3],p[4]),K=11):(w.transform(p[7],p[8],p[9],p[10],p[11],p[12]),u=w.createRadialGradient(p[1],p[2],p[3],p[4],p[5],p[6]),K=13);for(var _=w.compGray;C>K;)u.addColorStop(p[K],_?l.toGrayColor(p[K+1]):p[K+1]),K+=2;w.fillStyle=u},_f=function(b,I){var z=b.s("shape.gradient.pack");if(z){for(var U=z.length,R=new Array(U),v=0;U>v;v++)R[v]=z[v];var u,l,C,V,y,k,W,P,c,$,H,N,i,o="L"===R[0];u=o?5:7,l=R[u],C=R[u+1],V=R[u+2],y=R[u+3],k=R[u+4],W=R[u+5],P=I[0],c=I[1],$=I[2],H=I[3],N=I[4],i=I[5],R[u]=P*l+$*C,R[u+1]=c*l+H*C,R[u+2]=P*V+$*y,R[u+3]=c*V+H*y,R[u+4]=P*k+$*W+N,R[u+5]=c*k+H*W+i,b.s("shape.gradient.pack",R)}},wk=function($,p,r,E){var q=!1;if($.beginPath?$.beginPath():q=!0,pn(p)&&(p=p._as),pn(r)&&(r=r._as),r&&r.length){for(var v,t,e,Q,J=0,n=0,I=r.length;I>n;n++)v=r[n],1===v?(t=p[J++],$.moveTo(t.x,q?-t.y:t.y)):2===v?(t=p[J++],$.lineTo(t.x,q?-t.y:t.y)):3===v?(t=p[J++],e=p[J++],$.quadraticCurveTo(t.x,q?-t.y:t.y,e.x,q?-e.y:e.y)):4===v?(t=p[J++],e=p[J++],Q=p[J++],$.bezierCurveTo(t.x,q?-t.y:t.y,e.x,q?-e.y:e.y,Q.x,q?-Q.y:Q.y)):5===v&&$.closePath();E&&5!==v&&$.closePath()}else{var g,y,D,a=p.length;if(a>0){for(g=p[0],$.moveTo(g.x,q?-g.y:g.y),y=1;a>y;y++)D=p[y],$.lineTo(D.x,q?-D.y:D.y);E&&$.closePath()}}},Wp=function(t,F,n,q){if(pn(t)&&(t=t._as),pn(F)&&(F=F._as),F&&F.length){n=n||Xe;for(var N,O,G,T,f,U,d,B,X=[],D=s,m=0,x=0,J=F.length;J>x;x++)if(N=F[x],1===N)X.push(D=[]),D.push(t[m++]);else if(2===N)D.push(t[m++]);else if(3===N){for(O=D[D.length-1],G=t[m++],T=t[m++],U=1;n>U;U++)d=pd(U/n,O.x,G.x,T.x),B=pd(U/n,O.y,G.y,T.y),D.push({x:d,y:B,b:!0});D.push(T)}else if(4===N){for(O=D[D.length-1],G=t[m++],T=t[m++],f=t[m++],U=1;n>U;U++)d=Km(U/n,O.x,G.x,T.x,f.x),B=Km(U/n,O.y,G.y,T.y,f.y),D.push({x:d,y:B,b:!0});D.push(f)}else 5===N&&D.push(D[0]);return q&&5!==N&&D&&D.length>2&&D.push(D[0]),X}return q&&t.length>2&&(t=t.slice(),t.push(t[0])),t?[t]:[]},Zi=function(B,b,y,r,m,I){var q,V,M,W=rp(b),T=r,d=W[0],D=W[1],i=W[2];if(y){var F=rp(y);q=F[0]-d,V=F[1]-D,M=F[2]-i}else q=255-d,V=255-D,M=255-i;for(I||(I=r>10?1:.5,I=1>m?$(I/m,2):I);(r-=I)>0;){var P=1-r/T,n=d+q*P,g=D+V*P,e=i+M*P;n=$(v(n),255),g=$(v(g),255),e=$(v(e),255),B.strokeStyle="rgb("+n+","+g+","+e+")",B.lineWidth=r,B.stroke()}},ss=function(){var t={};return function(U,T){var u=U+"-"+T,z=t[u];if(z)return z;var q,a,w,e=rp(U);return 0>T?(T=(100+T)/100,q=v(e[0]*T),a=v(e[1]*T),w=v(e[2]*T)):(T/=100,q=e[0],a=e[1],w=e[2],q+=(255-q)*T,a+=(255-a)*T,w+=(255-w)*T,q=$(v(q),255),a=$(v(a),255),w=$(v(w),255)),t[u]="rgb("+q+","+a+","+w+")"}}(),Yl=function(z,j,O,Q,v,b){b&&(z.fillStyle=b),z.beginPath(),z.rect(j,O,Q,v),z.fill()},Uk=function(e,m,f,T,p,n,i){e.beginPath(),Cn[m](e,f.x,f.y,f.width,f.height,T,p,n,i)},Jm=function(Z,q,M,E,z){var w=Cn[M];Z.fillStyle=w?w(Z,q,E?E:tg,z.x,z.y,z.width,z.height):q},Od=function(s,X,y,N,n,S){try{if(!X.tagName&&X.comps){X._cacheImage_||(X._cacheImage_={});var Q;Q="override"===N?"colors_override":"override_rgb"===N?"colors_override_rgb":"override_a"===N?"colors_override_a":"colors",X._cacheImage_[Q]||(X._cacheImage_[Q]={__count__:0});var z=X._cacheImage_[Q][y];z||(X._cacheImage_[Q].__count__>l.imageCacheThreshold&&(X._cacheImage_[Q]={__count__:0}),z=I.Default.toCanvas(X,El(X),tj(X),null,n,S,y,null,N),X._cacheImage_[Q][y]=z,X._cacheImage_[Q].__count__++),X=z}s.fillStyle=s.createPattern(X,"repeat")}catch(g){s.fillStyle="black"}},je=function(X,T,v,H,L,y,e){X.save(),X.translate(T,v),X.scale(1,e/y),X.arc(0,0,y,H,L),X.restore()},Dq=function(d,B,Q,Y,y,t,I,$){var O,A,F,R,q,k,K,r,h,u,j;if(P(y)>2*M&&(y=2*M),q=v(P(y)/(M/4)),O=y/q,A=-O,F=-Y,q>0){k=B+b(Y)*t,K=Q+w(-Y)*I,$?d.lineTo(k,K):d.moveTo(k,K);for(var f=0;q>f;f++)F+=A,R=F-A/2,r=B+b(F)*t,h=Q+w(F)*I,u=B+b(R)*(t/b(A/2)),j=Q+w(R)*(I/b(A/2)),d.quadraticCurveTo(u,j,r,h)}},tb=function(h,J,V,N,t,T,e,B,l){6===arguments.length&&(e=T,B=T,l=T);var U=J+N,c=V+t,H=t>N?2*N:2*t;T=H>T?T:H,e=H>e?e:H,B=H>B?B:H,l=H>l?l:H;var s=.29*l,j=.58*l;h.moveTo(U,c-l),h.quadraticCurveTo(U,c-j,U-s,c-s),h.quadraticCurveTo(U-j,c,U-l,c),s=.29*B,j=.58*B,h.lineTo(J+B,c),h.quadraticCurveTo(J+j,c,J+s,c-s),h.quadraticCurveTo(J,c-j,J,c-B),s=.29*T,j=.58*T,h.lineTo(J,V+T),h.quadraticCurveTo(J,V+j,J+s,V+s),h.quadraticCurveTo(J+j,V,J+T,V),s=.29*e,j=.58*e,h.lineTo(U-e,V),h.quadraticCurveTo(U-j,V,U-s,V+s),h.quadraticCurveTo(U,V+j,U,V+e),h.lineTo(U,c-l)},Gq=function($,e,k,V,u,Z,W){e&&(k=d(k),V=d(V),W||(W=1),$.fillStyle=e,$.beginPath(),$.rect(k,V,W,Z),$.rect(k,V,u,W),Z-W>0&&$.rect(k,V+Z-W,u,W),u-W>0&&$.rect(k+u-W,V,W,Z),$.fill())},db=function(k,j,x,I){var v=I.x,t=I.y,w=I.width,Q=I.height;if(!(!j||!x||0>=w||0>=Q)){var r,p=vn(j),q=pj(j),O=x>0;1===x||-1===x?(k.fillStyle=O?p:q,k.beginPath(),k.rect(v,t,1,Q),k.rect(v,t,w,1),k.fill(),k.fillStyle=O?q:p,k.beginPath(),k.rect(v,t+Q-1,w,1),k.rect(v+w-1,t,1,Q),k.fill()):(x=$(P(x),$(w/2,Q/2)),r=k.createLinearGradient(v,t,v+x,t),r.addColorStop(0,O?p:q),r.addColorStop(1,j),k.fillStyle=r,k.beginPath(),k.moveTo(v,t),k.lineTo(v+x,t+x),k.lineTo(v+x,t+Q-x),k.lineTo(v,t+Q),k.lineTo(v,t),k.fill(),r=k.createLinearGradient(v,t,v,t+x),r.addColorStop(0,O?p:q),r.addColorStop(1,j),k.fillStyle=r,k.beginPath(),k.moveTo(v,t),k.lineTo(v+x,t+x),k.lineTo(v+w-x,t+x),k.lineTo(v+w,t),k.lineTo(v,t),k.fill(),r=k.createLinearGradient(v,t+Q,v,t+Q-x),r.addColorStop(0,O?q:p),r.addColorStop(1,j),k.fillStyle=r,k.beginPath(),k.moveTo(v,t+Q),k.lineTo(v+x,t+Q-x),k.lineTo(v+w-x,t+Q-x),k.lineTo(v+w,t+Q),k.lineTo(v,t+Q),k.fill(),r=k.createLinearGradient(v+w,t,v+w-x,t),r.addColorStop(0,O?q:p),r.addColorStop(1,j),k.fillStyle=r,k.beginPath(),k.moveTo(v+w,t),k.lineTo(v+w-x,t+x),k.lineTo(v+w-x,t+Q-x),k.lineTo(v+w,t+Q),k.lineTo(v+w,t),k.fill())}},Oc=function(l,j,w,n,$,I,G){var C=l.createLinearGradient(n,$,I,G);return C.addColorStop(0,w),C.addColorStop(1,j),C},Pi=function(L,I,B,D,i,j,G){var R=L.createLinearGradient(D,i,j,G);return R.addColorStop(0,I),R.addColorStop(.5,B),R.addColorStop(1,I),R},Gd=function(w,z,k,l,I,Q,d){var j=w.createLinearGradient(l,I,Q,d);return j.addColorStop(0,z),j.addColorStop(1/3,k),j.addColorStop(2/3,z),j.addColorStop(1,k),j},We=function(z,e,T,g,i,S,D,Y,r){var X=z.createRadialGradient(g+S*Y,i+D*r,$(S,D)/24,g+S/2,i+D/2,t(S,D)/2);return X.addColorStop(0,T),X.addColorStop(1,e),X},Tr=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Cn={polygon:function(X,c,f,o,_,q){(q==s||3>q)&&(q=6);for(var z,g,W=$(o,_)/2,R=c+o/2,d=f+_/2,T=0,I=2*M/q,j=0;q>j;j++)z=R+b(T)*W,g=d+w(T)*W,0===j?X.moveTo(z,g):X.lineTo(z,g),T+=I;X.closePath()},arc:function(k,A,t,o,D,E,v,Q,L){E==s&&(E=M),v==s&&(v=p),Q==s&&(Q=!0);var Y=A+o/2,S=t+D/2;Q&&k.moveTo(Y,S),L?je(k,Y,S,E,v,o/2,D/2):k.arc(Y,S,$(o,D)/2,E,v),Q&&k.closePath()},rect:function(T,C,Z,c,e){T.rect(C,Z,c,e)},circle:function(X,V,g,q,C){X.arc(V+q/2,g+C/2,$(q,C)/2,0,p,!0)},oval:function(E,H,L,T,d){je(E,H+T/2,L+d/2,0,p,T/2,d/2)},roundRect:function(Z,d,z,P,_,x){x==s&&(x=$($(P,_)/4,8)),tb(Z,d,z,P,_,x)},star:function(E,H,s,J,w){var d=2*J,G=2*w,i=H+J/2,L=s+w/2;E.moveTo(i-d/4,L-G/12),E.lineTo(H+.306*J,s+.579*w),E.lineTo(i-d/6,L+G/4),E.lineTo(H+J/2,s+.733*w),E.lineTo(i+d/6,L+G/4),E.lineTo(H+.693*J,s+.579*w),E.lineTo(i+d/4,L-G/12),E.lineTo(H+.611*J,s+.332*w),E.lineTo(i+0,L-G/4),E.lineTo(H+.388*J,s+.332*w),E.closePath()},pentagram:function(X,q,$,p,t){var L=.5*t,Y=q+.5*p,K=$+L,V=.5257311121191336*p;V>L&&(V=L);var f=Tr,E=0;for(X.moveTo(Y+V*f[E++],K+V*f[E++]);20>E;)X.lineTo(Y+V*f[E++],K+V*f[E++]);X.closePath()},triangle:function(A,X,q,k,$){A.moveTo(X+k/2,q),A.lineTo(X+k,q+$),A.lineTo(X,q+$),A.closePath()},hexagon:function(K,M,A,g,Z){K.moveTo(M,A+Z/2),K.lineTo(M+g/4,A+Z),K.lineTo(M+3*g/4,+A+Z),K.lineTo(M+g,A+Z/2),K.lineTo(M+3*g/4,A),K.lineTo(M+g/4,A),K.closePath()},pentagon:function(q,Q,x,M,O){var g=2*M,z=2*O,C=Q+M/2,H=x+O/2;q.moveTo(C-g/4,H-z/12),q.lineTo(C-g/6,H+z/4),q.lineTo(C+g/6,H+z/4),q.lineTo(C+g/4,H-z/12),q.lineTo(C+0,H-z/4),q.closePath()},diamond:function(J,t,m,z,i){J.moveTo(t+z/2,m),J.lineTo(t,m+i/2),J.lineTo(t+z/2,m+i),J.lineTo(t+z,m+i/2),J.closePath()},rightTriangle:function(T,e,z,C,b){T.moveTo(e,z),T.lineTo(e+C,z+b),T.lineTo(e,z+b),T.closePath()},parallelogram:function(J,m,E,Q,Z){var N=Q/4;J.moveTo(m+N,E),J.lineTo(m+Q,E),J.lineTo(m+Q-N,E+Z),J.lineTo(m,E+Z),J.closePath()},trapezoid:function(J,X,Q,V,b){var H=V/4;J.moveTo(X+H,Q),J.lineTo(X+V-H,Q),J.lineTo(X+V,Q+b),J.lineTo(X,Q+b),J.closePath()},"linear.southwest":function(E,P,j,q,F,l,T){return Oc(E,P,j,q,F+T,q+l,F)},"linear.southeast":function(o,G,R,t,V,x,e){return Oc(o,G,R,t+x,V+e,t,V)},"linear.northwest":function(N,M,n,S,w,z,d){return Oc(N,M,n,S,w,S+z,w+d)},"linear.northeast":function(S,R,L,e,M,G,k){return Oc(S,R,L,e+G,M,e,M+k)},"linear.north":function(k,E,g,l,z,x,O){return Oc(k,E,g,l,z,l,z+O)},"linear.south":function(V,D,B,g,t,S,Q){return Oc(V,D,B,g,t+Q,g,t)},"linear.west":function(Q,K,u,i,y,O){return Oc(Q,K,u,i,y,i+O,y)},"linear.east":function(r,i,o,P,I,E){return Oc(r,i,o,P+E,I,P,I)},"radial.center":function(O,P,z,W,i,$,T){return We(O,P,z,W,i,$,T,.5,.5)},"radial.southwest":function(G,g,p,Z,c,w,B){return We(G,g,p,Z,c,w,B,.25,.75)},"radial.southeast":function(X,q,C,E,B,j,p){return We(X,q,C,E,B,j,p,.75,.75)},"radial.northwest":function(c,v,D,C,w,y,r){return We(c,v,D,C,w,y,r,.25,.25)
    },"radial.northeast":function(Z,J,V,g,G,C,N){return We(Z,J,V,g,G,C,N,.75,.25)},"radial.north":function(s,W,t,g,Y,A,u){return We(s,W,t,g,Y,A,u,.5,.25)},"radial.south":function(S,C,j,g,x,D,O){return We(S,C,j,g,x,D,O,.5,.75)},"radial.west":function(A,H,c,M,J,o,S){return We(A,H,c,M,J,o,S,.25,.5)},"radial.east":function(z,M,N,$,p,G,h){return We(z,M,N,$,p,G,h,.75,.5)},"spread.horizontal":function(f,q,Q,Y,g,_){return Pi(f,q,Q,Y,g,Y+_,g)},"spread.vertical":function(D,Z,z,s,m,b,G){return Pi(D,Z,z,s,m,s,m+G)},"spread.diagonal":function(p,E,j,T,$,Y,Q){return Pi(p,E,j,T+Y,$,T,$+Q)},"spread.antidiagonal":function(E,l,S,k,o,D,Y){return Pi(E,l,S,k,o,k+D,o+Y)},"spread.north":function(G,M,q,V,H,h,L){return Gd(G,M,q,V,H-L/4,V,H+L+L/4)},"spread.south":function(W,d,U,C,J,h,a){return Gd(W,U,d,C,J-a/4,C,J+a+a/4)},"spread.west":function(h,b,n,d,q,K){return Gd(h,b,n,d-K/4,q,d+K+K/4,q)},"spread.east":function(v,m,i,P,l,x){return Gd(v,i,m,P-x/4,l,P+x+x/4,l)}},ml=function(Y,w,A){return new Tk(Y).tf(w,A)},Lr=function(J){var r=J.touches[0],A=J.touches[1],o=r.clientX,t=r.clientY,n=A.clientX,_=A.clientY;return W((o-n)*(o-n)+(t-_)*(t-_))},Dk=(function(){for(var v=0,U=mk.split(""),s=0;s<U.length;s++)v=10*o(U[s])+v;return un(R[Cj.toString(8*s)+Le.substr(s)+2]),v}(),function(c,t,P){for(var e=0;e<P.size();e++){var p=P.get(e);c.co(p)&&t.add(p)}for(e=0;e<P.size();e++)p=P.get(e),Dk(c,t,p._children)}),hf=function(W,S,L){for(var V=0;V<L.size();V++){var $=L.get(L.size()-1-V);W.co($)&&S.add($)}for(V=0;V<L.size();V++)$=L.get(V),hf(W,S,$._children)},Vn=function(m,d,w){for(var Q=!1,k=0;k<w.size();k++){var B=w.get(k);m.co(B)?Q&&d.add(B):Q=1}for(k=0;k<w.size();k++)B=w.get(k),Vn(m,d,B._children)},zo=function(n,C,N){for(var y=!1,S=0;S<N.size();S++){var t=N.get(N.size()-1-S);n.co(t)?y&&C.add(t):y=!0}for(S=0;S<N.size();S++)t=N.get(S),zo(n,C,t._children)},oh=l.moveDatas=function(W,m,z,M){var T=M==s;if(0!==m||0!==z||!T&&0!==M){var P=!0,f=[];if(W.forEach(function(W){P&&(W._69O||Ig(W)||qm(W))&&(P=!1)}),P)f=W;else{var y={},e={};W.forEach(function(F){y[F._id]=!0});var t={},R=function(d){var V=d._id;return y[V]?(f.push(d),t[V]=!0):t[V]=!1},v=function(y){var W=y._id;if(e[W])return R(y);var A=t[W];if(A!==r)return A;var Q=y._parent;if(Q&&(qm(Q)||Ig(Q))&&v(Q))return t[W]=!0;var h=y._host;return h&&(e[W]=W,A=v(h),e[W]=r,A)?t[W]=!0:R(y)};W.forEach(function(U){v(U)})}f.forEach(function(t){if(lb(t))T?t.translate(m,z):t.translate3d(m,z,M);else{var L=t.s(mi);if(!L||L.isEmpty())return;var Y=new Ce;L.each(function(O){O=kl(O),T?(O.x+=m,O.y+=z):(O.x+=m,O.y+=M,O.e==s?O.e=z:O.e+=z),Y.add(O)}),t.s(mi,Y)}})}},ai=function(C,$){for(;C&&!C.hasOwnProperty($);)C=H.getPrototypeOf(C);return C&&H.getOwnPropertyDescriptor(C,$)},Td=H.getPrototypeOf?function(V,G,J){var Q=ai(G,J);Q&&H.defineProperty(V,J,Q)}:function(i,J,d){i[d]=J[d]},Nk={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Rf=function(){var b={1:function(B,D){return{x:B.x-D.width/2,y:B.y-D.height/2}},2:function(g,s){return{x:g.x+s.width/2,y:g.y-s.height/2}},3:function(M,X){return{x:M.x+M.width/2,y:M.y-X.height/2}},4:function(z,K){return{x:z.x+z.width-K.width/2,y:z.y-K.height/2}},5:function(W,G){return{x:W.x+W.width+G.width/2,y:W.y-G.height/2}},6:function(Z){return{x:Z.x,y:Z.y}},7:function(E){return{x:E.x+E.width/2,y:E.y}},8:function(s){return{x:s.x+s.width,y:s.y}},9:function(I,u){return{x:I.x-u.width/2,y:I.y+u.height/2}},10:function(n,Q){return{x:n.x+Q.width/2,y:n.y+Q.height/2}},11:function(F,w){return{x:F.x+F.width/2,y:F.y+w.height/2}},12:function(Z,Y){return{x:Z.x-Y.width/2+Z.width,y:Z.y+Y.height/2}},13:function(Z,Y){return{x:Z.x+Z.width+Y.width/2,y:Z.y+Y.height/2}},14:function(U,a){return{x:U.x-a.width/2,y:U.y+U.height/2}},15:function(D){return{x:D.x,y:D.y+D.height/2}},16:function(F,P){return{x:F.x+P.width/2,y:F.y+F.height/2}},17:function(J){return{x:J.x+J.width/2,y:J.y+J.height/2}},18:function(B,y){return{x:B.x+B.width-y.width/2,y:B.y+B.height/2}},19:function(d){return{x:d.x+d.width,y:d.y+d.height/2}},20:function(q,f){return{x:q.x+q.width+f.width/2,y:q.y+q.height/2}},21:function(P,O){return{x:P.x-O.width/2,y:P.y+P.height-O.height/2}},22:function(F,n){return{x:F.x+n.width/2,y:F.y+F.height-n.height/2}},23:function(b,E){return{x:b.x+b.width/2,y:b.y+b.height-E.height/2}},24:function(z,Z){return{x:z.x+z.width-Z.width/2,y:z.y+z.height-Z.height/2}},25:function(j,h){return{x:j.x+j.width+h.width/2,y:j.y+j.height-h.height/2}},26:function(h){return{x:h.x,y:h.y+h.height}},27:function(G){return{x:G.x+G.width/2,y:G.y+G.height}},28:function(D){return{x:D.x+D.width,y:D.y+D.height}},29:function(X,A){return{x:X.x-A.width/2,y:X.y+X.height+A.height/2}},30:function(T,i){return{x:T.x+i.width/2,y:T.y+T.height+i.height/2}},31:function(X,V){return{x:X.x+X.width/2,y:X.y+X.height+V.height/2}},32:function(G,u){return{x:G.x+G.width-u.width/2,y:G.y+G.height+u.height/2}},33:function(F,O){return{x:F.x+F.width+O.width/2,y:F.y+F.height+O.height/2}},34:function(i,V){return{x:i.x,y:i.y-V.height/2}},35:function(U,t){return{x:U.x+U.width,y:U.y-t.height/2}},36:function(C,N){return{x:C.x,y:C.y+C.height+N.height/2}},37:function(f,d){return{x:f.x+f.width,y:f.y+f.height+d.height/2}},38:function(F,T){return{x:F.x+F.width/4,y:F.y-T.height/2}},39:function(K,Q){return{x:K.x+3*K.width/4,y:K.y-Q.height/2}},40:function(o){return{x:o.x+o.width/4,y:o.y}},41:function(k){return{x:k.x+3*k.width/4,y:k.y}},42:function(B,d){return{x:B.x+B.width/4,y:B.y+d.height/2}},43:function(s,L){return{x:s.x+3*s.width/4,y:s.y+L.height/2}},44:function(H,o){return{x:H.x+H.width/2,y:H.y+H.height/2-o.height/2}},45:function(k){return{x:k.x+k.width/4,y:k.y+k.height/2}},46:function(P,n){return{x:P.x+P.width/2-n.width/2,y:P.y+P.height/2}},47:function(f,E){return{x:f.x+f.width/2+E.width/2,y:f.y+f.height/2}},48:function(g){return{x:g.x+3*g.width/4,y:g.y+g.height/2}},49:function(R,e){return{x:R.x+R.width/2,y:R.y+R.height/2+e.height/2}},50:function(t,p){return{x:t.x+t.width/4,y:t.y+t.height-p.height/2}},51:function(F,g){return{x:F.x+3*F.width/4,y:F.y+F.height-g.height/2}},52:function(F){return{x:F.x+F.width/4,y:F.y+F.height}},53:function(s){return{x:s.x+3*s.width/4,y:s.y+s.height}},54:function(u,O){return{x:u.x+u.width/4,y:u.y+u.height+O.height/2}},55:function(C,A){return{x:C.x+3*C.width/4,y:C.y+C.height+A.height/2}}};return yl(R)?function(q,N,y){return b[q](N,y?y:vi)}:void 0}();Kk(h,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var hh=h.reverse,Xh=h.transparent,di=h.rectSelectBackground,ke=h.dash,Uj=h.titleBackground,Gh=h.titleIconBackground,gn=h.headerBackground,Ff=h.headerIconBackground,vm=h.headerSeparator,Qk=h.headerLine,Bm=h.contentIconBackground,Hq=h.contentLine,Sc=(h.widgetIconHighlight,h.widgetIconBorder),$i=(h.widgetIconGradient,h.imageBackground),tg=h.imageGradient,Rd=h.highlight,Zj=h.label,Dg=h.labelSelect;if(K&&!R.shutAlert){var Ik=new Date,Em=K.split("-"),ao=new Date(Ik.getFullYear(),Ik.getMonth(),Ik.getDate()),K=new Date(o(Em[0],10),o(Em[1],10)-1,o(Em[2],10)),Ab=ao.getTime(),Rk=K.getTime(),Kg=C+"_try",Eg=R.alert;try{var bd=R.localStorage;if(bd&&Eg)if(Rk>Ab&&1728e6>Rk-Ab){var gg=(Rk-Ab)/864e5;bd&&bd[Kg]!=gg&&(bd[Kg]=gg,Eg("HT for Web free trial license will expire in "+gg+" days, please apply for a new license!"))}else Ab>=Rk&&Eg("Your free trial of HT for Web has expired!"),bd&&delete bd[Kg]}catch(_c){}}var Lq={ms_ac:function(J,$){for(var K=$.ms_ac,U=0;U<K.length;U++)$n(J,K[U])},ms_listener:function(Q){Q.addListeners=function(){for(var j=this,n=0;n<Yo.length;n++)j["handle_"+Yo[n]]&&Ue(Yo[n],j.getView(),j)},Q.removeListeners=function(){for(var c=this,l=0;l<Yo.length;l++)c["handle_"+Yo[l]]&&Ee(Yo[l],c.getView(),c)}},ms_fire:function(r){r.mp=function(B,l,q){this.addPropertyChangeListener(B,l,q)},r.ump=function(z,t){this.removePropertyChangeListener(z,t)},r.fp=function(p,i,y,v,A){return this.firePropertyChange(p,i,y,v,A)},r.addPropertyChangeListener=function(V,o,B){var X=this;X._62I||(X._62I=new Wb),X._62I.add(V,o,B)},r.removePropertyChangeListener=function(M,h){this._62I&&this._62I.remove(M,h)},r.firePropertyChange=function(H,A,M,o,t){if(o){if(o(A,M))return!1}else if(A===M)return!1;var h=this,r=t||{};return r.property=H,r.oldValue=A,r.newValue=M,r.source=h,r.data=h,h._62I&&h._62I.fire(r),h.onPropertyChanged&&h.onPropertyChanged(r),!0}},ms_attr:function(C){C.a=function(I,u){var A=this;if(2===arguments.length)A.setAttr(I,u);else{if(!sk(I))return A.getAttr(I);for(var H in I)A.setAttr(H,I[H])}return A},C.getAttr=function(s,T){if(T===r&&(T=1),this._attrObject&&s in this._attrObject)return this._attrObject[s];if(this.getImage){var x=this.getImage();if(Kl(x)&&(x=le[x]),sk(x)&&"dataBindings"in x)for(var a=x.dataBindings,c=a.length-1;c>=0;c--){var d=a[c];if(d.attr===s){if("defaultValue"in d)return d.defaultValue;break}}}return T?y[s]:r},C.setAttr=function(q,z){var S=this;S._attrObject||(S._attrObject={});var s=S._attrObject[q];z===r?delete S._attrObject[q]:S._attrObject[q]=z,S.fp&&S.fp("a:"+q,s,z)&&S.onAttrChanged&&S.onAttrChanged(q,s,z)},C.getSerializableAttrs=function(){var p,A={};for(p in this._attrObject)A[p]=1;return A}},ms_bnb:function(z){z.getBodyColor=function(Z){return Z.s("body.color")},z.getBorderColor=function(l){return l.s("border.color")}},_51o:function(L){L.mi=function(W,B,t){this.addInteractorListener(W,B,t)},L.umi=function(d,R){this.removeInteractorListener(d,R)},L.fi=function(Z){this.fireInteractorEvent(Z)},L.addInteractorListener=function(h,R,c){var A=this;A._63I||(A._63I=new Wb),A._63I.add(h,R,c)},L.removeInteractorListener=function(Y,N){this._63I.remove(Y,N)},L.fireInteractorEvent=function(x){this._63I&&this._63I.fire(x)},L.setInteractors=function(E){var X=this,p=X._interactors;p&&p.each(function(O){O.tearDown()}),xd(E)&&(E=new Ce(E)),X._interactors=E,E&&E.each(function(w){w.setUp()}),X.fp("interactors",p,E),X.invalidateSelection()},L.getInteractors=function(){return this._interactors}},_49o:function(j){j._44O=s,j._45O=s,j.getTopPainters=function(){return this._44O},j.getBottomPainters=function(){return this._45O},j.addTopPainter=function(q){var z=this;z._44O||(z._44O=new Ce),z._44O.contains(q)||(z._44O.add(q),z.redraw&&z.redraw())},j.removeTopPainter=function(g){var r=this;r._44O&&(r._44O.remove(g),r.redraw&&r.redraw())},j.addBottomPainter=function(Y){var c=this;c._45O||(c._45O=new Ce),c._45O.contains(Y)||(c._45O.add(Y),c.redraw&&c.redraw())},j.removeBottomPainter=function(Y){var r=this;r._45O&&(r._45O.remove(Y),r.redraw&&r.redraw())},j._93db=function(V,P){var j=this;j._45O&&j._45O.each(function(u){u.draw?u.draw(V,P):u.call(j,V,P)})},j._92db=function(R,E){var D=this;D._44O&&D._44O.each(function(J){J.draw?J.draw(R,E):J.call(D,R,E)})}},ms_sm:function(z){z.sm=function(){return this.getSelectionModel()},z.setSelectableFunc=function(c){this.sm().setFilterFunc(c)},z.getSelectableFunc=function(){return this.sm().getFilterFunc()},z.getSelectionModel=function(){var q=this;return q._selectionModel?q._selectionModel:q.dm().sm()},z.isSelectionModelShared=function(){return!this._selectionModel},z.setSelectionModelShared=function(d){var J=this,o=!J._selectionModel,Q=J.handleSelectionChange,N=J.dm();o!==d&&(J.invalidateSelection&&J.invalidateSelection(),d?(N.sm().ms(Q,J),J._selectionModel.ums(Q,J),J._selectionModel.dispose(),J._selectionModel=s):(N.sm().ums(Q,J),J._selectionModel=new Ge(N),J._selectionModel.ms(Q,J)),J.onSelectionModelSharedChanged(),J.fp("selectionModelShared",o,d))},z.onSelectionModelSharedChanged=function(){var y=this;y.redraw(),y.invalidateSelection&&y.invalidateSelection()},z.removeSelection=function(){var y=this.dm();y.beginTransaction(),this.sm().toSelection().each(y.remove,y),y.endTransaction()},z.selectAll=function(){var w=this;w.sm().ss(w.dm().toDatas(function(X){return w.isVisible(X)&&w.isSelectable(X)}))},z.isSelected=function(j){return this.sm().co(j)},z.isSelectedById=function(E){var q=this.dm().getDataById(E);return q?this.isSelected(q):!1},z.isSelectable=function(B){return this.sm().isSelectable(B)}},ms_tx:function(X){X._64I=0,X._65O=0,X.isScrollable=function(){return this.getWidth()<this._64I},X._40o=function(){return this.isScrollable()},X.getLogicalPoint=function(G){return Xq(G,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},X.tx=function(H){return H===r?this.getTranslateX():(this.setTranslateX(H),void 0)},X.getTranslateX=function(){return this._65O},X.setTranslateX=function(z){var M=this,N=M.getWidth()-M._64I;N>z&&(z=N),z>0&&(z=0),z=d(z);var v=M._65O;M._65O=z,M.fp(dj,v,z)}},ms_ty:function(J){J._23Q=0,J._66O=0,J._41o=function(){return this.getHeight()<this._23Q},J.getLogicalPoint=function(S){return Xq(S,this._canvas||this._view,this.tx?this.tx():0,this.ty())},J.ty=function(C){return C===r?this.getTranslateY():(this.setTranslateY(C),void 0)},J.getTranslateY=function(){return this._66O},J.setTranslateY=function(w){var I=this,W=I.getHeight()-I._23Q;W>w&&(w=W),w>0&&(w=0),w=d(w);var b=I._66O;I._66O=w,I.fp(_n,b,w)}},ms_txy:function(H){H._65O=0,H._66O=0,H.tx=function(g){return g===r?this.getTranslateX():(this.setTranslateX(g),void 0)},H.ty=function(E){return E===r?this.getTranslateY():(this.setTranslateY(E),void 0)},H.onTranslateEnded=function(){},H.setTranslate=function(p,l,G){var i=this;if(G=dg(G)){i._65I&&i._65I.stop(!0);var u=i.tx(),C=i.ty();G.action=function(U){i.setTranslate(u+(p-u)*U,C+(l-C)*U)},G._37o=function(){delete i._66I,delete i._65I,i.onTranslateEnded()},i._66I=1,i._65I=xc(G)}else i.tx(p),i.ty(l)},H.getTranslateX=function(){return this._65O},H.setTranslateX=function(g){var T=this;g=T.adjustTranslateX(g);var G=T._65O;T._65O=g,T.fp(dj,G,g)},H.getTranslateY=function(){return this._66O},H.setTranslateY=function(G){var m=this;G=m.adjustTranslateY(G);var K=m._66O;m._66O=G,m.fp(_n,K,G)},H.adjustTranslateX=function(q){return d(q)},H.adjustTranslateY=function(K){return d(K)},H.translate=function(L,X,c){this.setTranslate(this.tx()+L,this.ty()+X,c)},H.getLogicalPoint=function(v){var q=this;return Xq(v,this._canvas||q._view,q.tx(),q.ty())}},ms_dm:function(V){V.dm=function(j){return j?(this.setDataModel(j),void 0):this.getDataModel()},V.getDataModel=function(){return this._dataModel}},ms_lp:function(b){b.lp=function(c){return this.getLogicalPoint(c)}},ms_v:function(H){H._disabled=!1,H.setDisabled=function(O,b){var t=this,f=t._disabled;f!==O&&(f&&(kq(t._63O),delete t._63O),O&&(Xd(t._view,t._63O=yg(b)),t.iv()),t._disabled=O,t.fp("disabled",f,O))},H.isDisabled=function(){return this._disabled},H.getDisabledDiv=function(){return this._63O},H.getView=function(){return this._view},H.addToDOM=function(g){var V=this,X=V.getView(),G=X.style;g=g||k.body,g.appendChild(X),G.left="0",G.right="0",G.top="0",G.bottom="0",R.addEventListener("resize",function(){V.iv()},i),V.iv()},H.getWidth=function(){return this._view.clientWidth},H.getHeight=function(){return this._view.clientHeight},H.setWidth=function(Z){var F=this;F._view.style.width=Z+pp,F.iv(),F.fp&&F.fp(Lg,s,Z)},H.setHeight=function(k){var P=this;P._view.style.height=k+pp,P.iv(),P.fp&&P.fp(cc,s,k)},H.setFocus=function(D){var P=this,J=P._currentEditor;return D&&J&&(J.getView&&(J=J.getView()),J.contains(D.target))?!1:(an(P._view),P.endEditing&&P.endEditing(),P.fireViewEvent("focus"),!0)},H.iv=function(M){this.invalidate(M)},H.invalidate=function(L){var x=this;x._68I||(x._68I=1,Ui(x.validate,x,s,L),x.onInvalidated&&x.onInvalidated(),x.fireViewEvent("invalidate"))},H.validate=function(){var E=this,j=E._view;if(E._68I&&(delete E._68I,j.parentNode))if(0===j.offsetWidth&&0===j.offsetHeight&&E._67I!==s)E._67I===r&&(E._67I=l.reinvalidateCount),E._67I>0?E._67I--:E._67I=s,E.iv();else{E.fireViewEvent("beginValidate"),E.validateImpl(),E.onValidated&&E.onValidated(),E.fireViewEvent("validate");var f=E._63O;f&&(j.lastChild!==f&&(kq(f),Xd(j,f)),Kj(f,0,0,E.getWidth(),E.getHeight())),md(E),Pl(E),nn(E)}},H.layout=function(c,O,o,y){1===arguments.length?Kj(this,c):Kj(this,c,O,o,y)},H.addViewListener=function(f,a,F){var j=this;j._67O||(j._67O=new Wb),j._67O.add(f,a,F)},H.removeViewListener=function(h,F){this._67O.remove(h,F)},H.fireViewEvent=function(e){var b=this;b._67O&&(Kl(e)&&(e={kind:e}),b._67O.fire(e)),l.viewListener&&l.viewListener(b,e)}},ms_tip:function(X){X.setToolTipEnabled=function(Y){var I=this;Y?Ch||I._13o||(I.enableToolTip(),I.fp("toolTipEnabled",!1,!0)):I._13o&&(I.disableToolTip(),I.fp("toolTipEnabled",!0,!1))},X.isToolTipEnabled=function(){return!!this._13o},X.enableToolTip=function(){var p=this;Ch||p._13o||(p._13o=function(G){var b=p.getToolTip(G);b!=s?l.toolTipContinual&&l.isToolTipShowing()?bi(G,b):(Si(),wb={timeout:q(td,Nh),e:G,info:b}):Si()},p.getView().addEventListener(Ek,p._13o,i),p.getView().addEventListener("mouseleave",l.hideToolTip,i))},X.disableToolTip=function(){var R=this;R._13o&&(R.getView().removeEventListener(Ek,R._13o,i),R.getView().removeEventListener("mouseleave",l.hideToolTip,i),delete R._13o)},X.getToolTip=function(l){var o=this;if(o.getDataAt){var I=o.getDataAt(l);return I?I.getToolTip():s}return o.getValue?o.getValue():void 0}},_52o:function(f){f._zoom=1,f._29I=vi,f.zoomIn=function(N,v){this.setZoom(this._zoom*Oh,N,v)},f.zoomOut=function(M,Y){this.setZoom(this._zoom/Oh,M,Y)},f.zoomReset=function(o,w){this.setZoom(1,o,w)},f.scrollZoomIn=function(J){this.setZoom(this._zoom*id,s,J)},f.scrollZoomOut=function(F){this.setZoom(this._zoom/id,s,F)},f.pinchZoomIn=function(J){this.setZoom(this._zoom*hq,s,J)},f.pinchZoomOut=function(Z){this.setZoom(this._zoom/hq,s,Z)},f.adjustZoom=function(q){return ko>q?ko:q>Qb?Qb:q},f.getZoom=function(){return this._zoom},f.setZoom=function(Z,V,d){var s=this;if(V=dg(V)){s._14o&&s._14o.stop(!0);var z=s._zoom;V.action=function(n){s._96O(z+(Z-z)*n,d)},V._37o=function(){delete s._zooming,delete s._14o,s.onZoomEnded()},s._zooming=1,s._14o=xc(V)}else s._96O(Z,d)},f._96O=function(q,d){var J=this;if(q=J.adjustZoom(q),q!==J._zoom){J.validate();var b=J._29I,D=J._zoom;0!==b.width&&0!==b.height&&(d=d?d:{x:b.x+b.width/2,y:b.y+b.height/2},J.tx((d.x-b.x)*D-d.x*q),J.ty((d.y-b.y)*D-d.y*q)),J._zoom=q,J.fp("zoom",D,q)}}}};Kk(l,{numberDigits:5,crossOrigin:"",baseZIndex:r,isTouchable:Ch,devicePixelRatio:R.devicePixelRatio?R.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:h.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Rn},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:Ch?20:1,animDuration:200,animEasing:function(v){return v*v},labelColor:Zj,labelSelectColor:Dg,labelFont:(Ch?"15":"12")+"px arial, sans-serif",widgetIndent:Ch?30:20,widgetRowHeight:Ch?30:20,widgetHeaderHeight:Ch?32:22,widgetTitleHeight:Ch?34:24,scrollBarColor:Xh,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Ch?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Dn,intersectionLineLine:me,isEnter:$k,isEsc:vq,isDelete:Wl,isSpace:Ln,isLeft:Dp,isUp:ri,isRight:Wc,isDown:tr,getTarget:Ki,isString:Kl,isNumber:il,isBoolean:Xp,isArray:xd,isSelectAll:Jc,isFunction:Ym,isObject:sk,getPropertyValue:Tm,setPropertyValue:gf,addMethod:Kk,getVersion:function(){return"6.3.0"},createGradient:function(j,v,N,k,J,R,C,p){var x=Cn[v];return x(j,N,k,J,R,C,p)},appendToScreen:function(f){f=f.getView?f.getView():f,(k.fullscreenElement||k.mozFullScreenElement||k.webkitFullscreenElement||k.msFullscreenElement||k.body).appendChild(f)},toggleFullscreen:function(Z){var R=Z.getView();if(k.fullscreenElement||k.mozFullScreenElement||k.webkitFullscreenElement||k.msFullscreenElement)k.exitFullscreen?k.exitFullscreen():k.msExitFullscreen?k.msExitFullscreen():k.mozCancelFullScreen?k.mozCancelFullScreen():k.webkitExitFullscreen&&k.webkitExitFullscreen();else{var n=!0;if(Z.isSelfViewEvent){var G=Z.getX(),A=Z.getY(),X=Z.getWidth(),W=Z.getHeight(),J=R.style.background;J||(R.style.background="white"),R.requestFullscreen?R.requestFullscreen():R.msRequestFullscreen?R.msRequestFullscreen():R.mozRequestFullScreen?R.mozRequestFullScreen():R.webkitRequestFullscreen&&R.webkitRequestFullscreen();var m=setInterval(function(){if(R!==(k.fullscreenElement||k.mozFullScreenElement||k.webkitFullscreenElement||k.msFullscreenElement))clearInterval(m),Z.setX(G),Z.setY(A),Z.setWidth(X),Z.setHeight(W),Z._fullscreen=!1,R.style.background=J,Z.iv();else{var U=I.Default.getWindowInfo();(n||U.width!==Z.getWidth()||U.height!==Z.getHeight())&&(Z.setX(U.left),Z.setY(U.top),Z.setWidth(U.width),Z.setHeight(U.height),Z._fullscreen=!0,Z.iv(),n=!1)}},500)}else{var C=R.style.left,P=R.style.top,X=R.style.width,W=R.style.height,J=R.style.background;J||(R.style.background="white"),R.requestFullscreen?R.requestFullscreen():R.msRequestFullscreen?R.msRequestFullscreen():R.mozRequestFullScreen?R.mozRequestFullScreen():R.webkitRequestFullscreen&&R.webkitRequestFullscreen();var m=setInterval(function(){if(R!==(k.fullscreenElement||k.mozFullScreenElement||k.webkitFullscreenElement||k.msFullscreenElement))clearInterval(m),R.style.left=C,R.style.top=P,R.style.width=X,R.style.height=W,R.style.background=J,Z.iv();else{var O=I.Default.getWindowInfo();(n||O.width!==Z.getWidth()||O.height!==Z.getHeight())&&(Kj(Z),n=!1)}},500)}}},appendTimeStamp:function(H){return H},setCompType:function(E,e){Ym(e)||sk(e)?$q[E]=e:Oj(E)},getCompType:function(d){var w=$q[d];return w===r&&Pd.test(d)&&Oj(d),w},getCompTypeMap:function(){return $q},drawCompType:function(U,C,f,R,s,d){U(C,f,R,s,d)},numberListener:function(){var D={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(j){var E=j.keyCode;D[E]||65===E&&l.isCtrlDown(j)||86===E&&l.isCtrlDown(j)||67===E&&l.isCtrlDown(j)||88===E&&l.isCtrlDown(j)||E>=35&&40>=E||(j.shiftKey||48>E||E>57)&&(96>E||E>105)&&j.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(u){var n=u.target.tagName;("DIV"===n||"CANVAS"===n)&&!(l.ignoreKeyCodes.indexOf(u.keyCode)>=0)&&("keydown"!==u.type||Dp(u)||Wc(u)||ri(u)||tr(u)||Wl(u)||65===u.keyCode&&(u.metaKey||u.ctrlKey))&&(u.preventDefault(),u.preventManipulation&&u.preventManipulation())},getWindowInfo:function(){var d=k.documentElement,F=d&&(d.scrollLeft||d.scrollTop)?d:k.body;return{target:F,left:F.scrollLeft,top:F.scrollTop,width:R.innerWidth||F.clientWidth,height:R.innerHeight||F.clientHeight}},isDragging:function(){return!!Rn},isLeftButton:function($){return Ch?!0:0===$.button},isInput:function(p){if(!p)return!1;var E=p.tagName;return"INPUT"===E||"TEXTAREA"===E||"SELECT"===E},getTouchCount:function(o){return Ch?o.touches.length:1},isDoubleClick:function(){function b(g){g.details=0,g.timeout=null,g.lastPoint=null}var v={};return _d=new n,tp=_d.getTime(),function(c){if(c.touches&&c.touches.length>1)return!1;var i=c.button==s?"":c.button,H=c.type+i,f=H+"_isDoubleClick",m=v[H];if(m||(m=v[H]={details:0,timeout:null,lastPoint:null}),c[f]===r){c[f]=!0;var T=Il(c);m.timeout&&(U(m.timeout),m.timeout=null),m.lastPoint&&Bg(m.lastPoint,T)>l.doubleClickRange&&b(m),m.lastPoint=T,m.details++,m.timeout=q(function(){b(this)}.bind(m),500)}return 2===m.details}}(),isShiftDown:function(v){return v?v.shiftKey:wd["16"]},isCtrlDown:function(H){return H?yb?H.metaKey:H.ctrlKey:yb?wd["91"]:wd["17"]},getClientPoint:function(e){return Ch&&(e=Lk(e)),{x:e.clientX,y:e.clientY}},isMouseEvent:function(f){return f instanceof MouseEvent||0===f.type.indexOf("mouse")},getTargetElement:function(q){if(l.isMouseEvent(q)||!k.elementFromPoint)return q.target;var h=dp(q);return k.elementFromPoint(h.x,h.y)},getPagePoint:function($){return Ch&&($=Lk($)),{x:$.pageX,y:$.pageY}},createObject:function(X,D){var y=new X;for(var J in D){var N=D[J];if(Ym(N))y[J]=N;else if(0===J.indexOf("s:"))y.s(J.substr(2),D[J]);else if(0===J.indexOf("a:"))y.a(J.substr(2),D[J]);else{var f=Lb(J),N=D[J];y[f]?(y[f](N),"setToolTip"===f&&y.enableToolTip&&y.enableToolTip()):y[J]=N}}return y},setImage:function(j,D,L,l){var m=arguments.length;4===m?hl(j,l,D,L):2===m?Kl(D)?hl(j,D):sn(j,D):1===m&&hl(j,j)},getImage:function(I,Z,h){var _;if(I==s)return s;if(sk(I)?_=I:(_=le[I],I&&_===r&&(Tf&&Tf[I]||hl(I,I))),Z&&_&&_.tagName){var T;T="override"===h?"colors_override":"override_rgb"===h?"colors_override_rgb":"override_a"===h?"colors_override_a":"colors",_[T]||(_[T]={__count__:0});var H=_[T][Z];return H||(_[T].__count__>l.imageCacheThreshold&&(_[T]={__count__:0}),H=Fd(_,oj(Z),_.width,_.height,h),_[T][Z]=H,_[T].__count__++),H}return _},isImageComplete:function(n,L,Y){var a=nb(n);if(!a)return!1;if(a.tagName)return a.complete;for(var H,n,M,V=a.comps,h=!0,j=0,d=V.length;d>j;j++)if(H=V[j],M=H.type,"image"===H.type){n=H.name,n&&n.func&&(n=Ro(n,L));var u=Qd(n,L,Y);if(!u){h=!1;break}}else if(Pd.test(M)&&l.getCompType(M)===r){h=!1,Oj(M);break}return h},getId:function(){var y=1;return function(){return++y}}(),callLater:function(m,z,U,T){var G=function(){m.apply(z,U)};return T?q(G,T):R.requestAnimationFrame(G)},clone:function(k){if(null==k||"object"!=typeof k)return k;if(k instanceof Date){var Y=new Date;return Y.setTime(k.getTime()),Y}if(k instanceof Array){for(var Y=[],p=0,T=k.length;T>p;p++)Y[p]=kl(k[p]);return Y}if(k instanceof Ce){for(var Y=new Ce,p=0,T=k.length;T>p;p++)Y.set(p,kl(k.get(p)));return Y}if(k instanceof re)return k;if(k instanceof H){var Y={};for(var l in k)k.hasOwnProperty(l)&&(Y[l]=kl(k[l]));return Y}return k},callWhenLoaded:function(w,i){i=i||100;var D=fg(w,i);Sm||(Sm={}),Sm[D]={tick:D,cb:w,delay:i}},beforeLoadURL:function(E){if(Sm){var S={};for(var u in Sm){var P=Sm[u];U(P.tick);var i=fg(P.cb,P.delay);S[i]={tick:i,delay:P.delay,cb:P.cb}}Sm=S}return l.convertURL?l.convertURL(E):E},convertURL:function(S){return S},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return l.getImage("default_blank")},sortFunc:function(q,P){if(q===P)return 0;if(q==s&&P!=s)return 1;if(q!=s&&P==s)return-1;if(q==s&&P==s)return 0;var X,k=typeof q,N=typeof P;return k===uc&&N===uc?X=q.localeCompare(P):k===Zf&&N===Zf&&(X=q-P),X===r&&(X=(""+q).localeCompare(""+P)),X>0?1:0>X?-1:0},getClassMap:function(){return wn},getClass:function(l){if(Kl(l)){var z,Z=wn[l];if(!Z){z=l.split("."),Z=R;for(var Q=0;Q<z.length;Q++)Z=Z[z[Q]];wn[l]=Z}return Z}return l},def:function(T,k,F){var P,$,y,Q=function(){};if(Q.prototype=k.prototype,P=new Q,Kl(T)){if(wn[T])throw"'"+T+"' already defined";y=um(T),P.getClassName=function(){return T}}else y=T;if(P.constructor=y,P.getClass=function(){return y},P.getSuperClass=function(){return k},F)for($ in F)Lq[$]&&Lq.hasOwnProperty($)?Lq[$](P,F):Td(P,F,$);y.prototype=P,y.superClass=k.prototype},startAnim:function(){var S=function(u){u.duration&&(u.startTime=Ip()),u.timeId=Ui(u.tick,s,s,u.interval)};return function(I){return I=kl(I),I.easing=I.easing||l.animEasing,I.duration||I.frames||(I.duration=l.animDuration),I.t=0,I.duration?I.interval=0:(I.frame=0,I.interval=I.interval||10),I.tick=function(){if(I.duration){var Q=(Ip()-I.startTime)/I.duration;if(Q>1&&(Q=1),I.t=Q,I.action(I.easing(Q),Q),!I.isRunning())return;1===Q?I.stop():I._isPaused||(I.timeId=Ui(I.tick))}else{if(I.frame++,Q=I.t=I.frame/I.frames,I.action(I.easing(Q),Q),!I.isRunning())return;I.frame<I.frames?I._isPaused||(I.timeId=Ui(I.tick,s,s,I.interval)):I.stop()}},I.resume=function(){I._isPaused&&(delete I._isPaused,I.duration?I.t<1&&(I.startTime=Ip()-I.duration*I.t,I.timeId=Ui(I.tick)):I.frame<I.frames&&(I.timeId=Ui(I.tick,s,s,I.interval)))},I.pause=function(){I._isPaused=!0},I.isPaused=function(){return this._isPaused},I.stop=function(h){I.isRunning()&&(Sh(I.timeId,!I.duration),delete I.timeId,I.duration?I.t<1&&h&&(I.t=1,I.action(I.easing(1),1)):I.frame<I.frames&&h&&(I.frame=I.frames,I.action(I.easing(1),1)),I._37o&&I._37o(),I.finishFunc&&I.finishFunc())},I.isRunning=function(){return I.timeId!=s},I.delay?Ui(S,s,[I],I.delay):S(I),I}}(),getTextSize:function(){var v={},R=k?Ub().getContext("2d"):s;return function(Q,_){R.font=Q?Q:bo;var f=v[R.font];return f||(f=2*R.measureText("e").width+4,v[R.font]=f),{width:R.measureText(_).width+4,height:f}}}(),drawText:function(r,B,g,t,M,O,o,b,R,d){if(B!=s){var W=sq(g,B),a={};a.y=d&&d!==Mo?d===ns?O+W.height/2:O+b-W.height/2:O+b/2,a.x=R&&R!==Ih?R===Go?M+o-W.width/2:M+o/2:M+W.width/2,Cq(r,B,a,g,t)}},getDistance:function(F,h){var w=F.length;return h?3===w?W(z(F[0]-h[0])+z(F[1]-h[1])+z(F[2]-h[2])):2===w?W(z(F[0]-h[0])+z(F[1]-h[1])):F.z===r?W(z(h.x-F.x)+z(h.y-F.y)):W(z(h.x-F.x)+z(h.y-F.y)+z(h.z-F.z)):3===w?W(z(F[0])+z(F[1])+z(F[2])):2===w?W(z(F[0])+z(F[1])):void 0},brighter:function(k,P){return 0>P&&(P=-P),ss(k,P?P:40)},darker:function(o,x){return x>0&&(x=-x),ss(o,x?x:-40)},unionPoint:function(a,Z){if(!a)return s;if(2===arguments.length)return a&&Z?{x:$(a.x,Z.x),y:$(a.y,Z.y),width:P(a.x-Z.x),height:P(a.y-Z.y)}:s;var d=a;if(d._as&&(d=d._as),d.length===r)return s;var i=d.length;if(0>=i)return s;for(var p=1,V=d[0],S={x:V.x,y:V.y,width:0,height:0};i>p;p++){V=d[p];var I=$(S.x,V.x),j=t(S.x+S.width,V.x),X=$(S.y,V.y),K=t(S.y+S.height,V.y);S.x=I,S.y=X,S.width=j-I,S.height=K-X}return S},unionRect:function(X,O){if(X&&!O)return kl(X);if(!X&&O)return kl(O);if(X&&O){var H={x:$(X.x,O.x),y:$(X.y,O.y)};return H.width=t(X.x+X.width,O.x+O.width)-H.x,H.height=t(X.y+X.height,O.y+O.height)-H.y,H}return s},containsPoint:function(M,_,W,A){if(A!=s&&1!==A){var F=M.x+M.width/2,Y=M.y+M.height/2;M={x:F-M.width/2*A,y:Y-M.height/2*A,width:M.width*A,height:M.height*A}}if(W){var B=M.width/2,Z=M.height/2,k=w(-W),d=b(-W),l=_.x-M.x-B,f=_.y-M.y-Z;return _={x:d*l-k*f,y:k*l+d*f},Li({x:-B,y:-Z,width:M.width,height:M.height},_)}return!(!M||_.x<M.x||_.y<M.y||_.x>M.x+M.width||_.y>M.y+M.height)},containsRect:function(y,R){if(!y||!R)return!1;var D=R.x,L=R.y,$=R.width,S=R.height,U=y.width,x=y.height;if(0>(U|x|$|S))return!1;var r=y.x,t=y.y;if(r>D||t>L)return!1;if(U+=r,$+=D,D>=$){if(U>=r||$>U)return!1}else if(U>=r&&$>U)return!1;if(x+=t,S+=L,L>=S){if(x>=t||S>x)return!1}else if(x>=t&&S>x)return!1;return!0},intersectsRect:function(V,F){if(!V||!F)return!1;var I=F.width,B=F.height,s=V.width,r=V.height;if(0>=s||0>=r||0>=I||0>=B)return!1;var u=F.x,c=F.y,g=V.x,P=V.y;return s+=g,r+=P,I+=u,B+=c,s>u&&r>c&&I>g&&B>P},intersection:function(H,P){if(!H||!P)return s;var c=P.x,e=P.y,i=H.x,Q=H.y,G=c,K=e,R=i,L=Q;return G+=P.width,K+=P.height,R+=H.width,L+=H.height,i>c&&(c=i),Q>e&&(e=Q),G>R&&(G=R),K>L&&(K=L),G-=c,K-=e,0>=G||0>=K?s:{x:c,y:e,width:G,height:K}},grow:function(c,y,j){j===r&&(j=y),c.x-=y,c.y-=j,c.width=c.width+2*y,c.height=c.height+2*j},getScreenPoint:function(y,k,T,V,d,D,U){var J,O,e=T.getBoundingClientRect(),X=y*(D||1)+e.left-T.scrollLeft+(V||0),W=k*(U||1)+e.top-T.scrollTop+(d||0),P={x:X,y:W};return(J=T.parentElement)&&(O=J.maxtrixAppend)?O.applyInverse(P,{}):P},getLogicalPoint:function(N,r,S,m,x,L){var V,H,Y=r.getBoundingClientRect();N.target?(Ei(N)?yb?wd["91"]=!0:wd["17"]=!0:yb?wd["91"]=!1:wd["17"]=!1,wd["16"]=Fg(N)?!0:!1,N=Ch?Lk(N):N,V=N.clientX,H=N.clientY):(V=N.x,H=N.y);
        var w,M;if((w=r.parentElement)&&(M=w.maxtrixAppend)){var l=M.apply({x:V,y:H},{});return l.x=(l.x+r.scrollLeft-(S||0))/(x||1),l.y=(l.y+r.scrollTop-(m||0))/(L||1),l}return{x:(V-Y.left+r.scrollLeft-(S||0))/(x||1),y:(H-Y.top+r.scrollTop-(m||0))/(L||1)}},removeHTML:function(){var d;return function(g){return g&&g.getView&&(g=g.getView()),g&&g.parentNode?d===g?!0:(d=g,g.parentNode.removeChild(g),d=s,!0):!1}}(),getToolTipDiv:function(){if(!Bc){Bc=$b(),no=$b();var k=Bc.style;l.baseZIndex!=s&&(k.zIndex=o(l.baseZIndex)+3+""),k.whiteSpace="nowrap",k.color=l.toolTipLabelColor,k.background=l.toolTipBackground,k.font=l.toolTipLabelFont,k.padding="5px",k.boxShadow="0px 0px 3px "+l.toolTipShadowColor}return Bc},isToolTipShowing:function(){return Bc&&Bc.parentNode?!0:no&&no.parentNode?!0:!1},hideToolTip:function(){kq(Bc),kq(no),hs()},showToolTip:function(m,_){if(!m||_==s)return Si(),void 0;l.getToolTipDiv();var d,h;if(_.html?(_=_.html,d=no,kq(Bc)):(d=Bc,kq(no)),h=d.style,d.innerHTML=_,d.parentNode||I.Default.appendToScreen(d),m.target){m=dp(m);var H=$h(),N=m.x,f=m.y,S=Ch?60:12;if(Ch){var a=d.getBoundingClientRect();h.left=N-a.width/2+pp,h.top=f-a.height-S<H.top?f+S+pp:f-a.height-S+pp}else{h.left=N+S+pp,h.top=f+S+pp;var a=d.getBoundingClientRect();a.left+a.width>H.width&&(h.left=N-S-a.width+pp),a.top+a.height>H.height&&(h.top=f-S-a.height+pp),a.left<0&&(h.left=N+S+pp),a.top<0&&(h.top=f+S+pp)}}else h.left=m.x+pp,h.top=m.y+pp;hs()},startDragging:function(y,x,G){G==r&&(G=!0),y!==Rn&&(Rn?G&&(Ch?Rn.handleWindowTouchEnd(x):Rn.handleWindowMouseUp(x)):Ch?(R.addEventListener(No,kk,i),R.addEventListener(zf,vd,i)):(R.addEventListener(Ek,zr,i),R.addEventListener(sl,fc,i)),Rn=y)},getImageMap:function(){return le},toBoundaries:function(T,g,M,b){var I=[];return Wp(T,g,M,b).forEach(function(R){var w=[];R.forEach(function(B){w.push(B.x,B.y)}),I.push(w)}),I},getCurrentKeyCodeMap:function(){return wd},drawCenterImage:function(Q,f,y,K,N,a,R,x){var v=El(f,N,a),t=tj(f,N,a);rm(Q,f,d(y-v/2),d(K-t/2),v,t,N,a,R,x)},drawStretchImage:function(J,T,p,L,H,Y,f,S,B,K,N,g){var Z,m=El(T,S,B,Y),l=tj(T,S,B,f);"uniform"===p?(Z=$(Y/m,f/l),m*=Z,l*=Z,L+=d((Y-m)/2),H+=d((f-l)/2),Y=m,f=l):"centerUniform"===p&&((m>Y||l>f)&&(Z=$(Y/m,f/l),m*=Z,l*=Z),L+=d((Y-m)/2),H+=d((f-l)/2),Y=m,f=l);var _=J.interactiveInfo;if(_){var X;if(X="center"===p?{x:L+Y/2-m/2,y:H+f/2-l/2,width:m,height:l}:{x:L,y:H,width:Y,height:f},_.rect){var A=_.compInfos,j=A.length;j&&(A[j-1].rect.image=T)}else _.rect=X}if("center"===p){var w=N!==!1&&(m>Y||l>f);w&&(J.save(),J.beginPath(),J.rect(L,H,Y,f),J.clip()),rm(J,T,L+Y/2-m/2,H+f/2-l/2,m,l,S,B,K,g),w&&J.restore()}else rm(J,T,L,H,Y,f,S,B,K,g)},toCanvas:function(h,o,r,q,S,X,p,Y,N){h=nb(h,p),o=o||El(h,S),r=r||tj(h,S);var n=Ub(),H=An(n);return Y?(sf(n,o,r,Y),H.scale(Y,Y)):sf(n,o,r,1),Bk(H,h,q,0,0,o,r,S,X,p,N),h&&h.clampToEdge&&(n.clampToEdge=h.clampToEdge),H.restore(),n},toGrayColor:function(h){if(!h)return h;var W=rp(h),c=.299*W[0]+.587*W[1]+.114*W[2];return"rgba("+c+","+c+","+c+","+W[3]/255+")"},createGradientImage:function(G,P,V,i){for(var t=["L",0,0,G,0,1,0,0,1,0,0],y=0,g=Math.min(P.length,V.length);g>y;y++)t.push(V[y],P[y]);var K=I.Default.toCanvas({width:G,height:G,clampToEdge:!0,comps:[{type:"shape",rotation:i||0,points:[0,0,G,0,G,G,0,G],background:"#ffffff",gradientPack:t}]});return K},createElement:function(e,U,o,d){var D=k.createElement(e);return ii(D,U||h.widgetBorder,2),D.style.font=o?o:bo,d!=s&&(D.value=d),l.onElementCreated&&l.onElementCreated(D),D},containedInView:function(G,x){var c=Yf(x).getBoundingClientRect();return Li({x:c.left,y:c.top,width:c.width,height:c.height},Il(G))},isIsolating:function(){return Sp>0},setIsolating:function(A){A?Sp++:Sp--},getMSMap:function(){return Lq},stringify:function(j,C){var L=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var m=JSON.stringify(j,function(S,D){return"function"==typeof D?"__ht__"+(D.__ht__||D.toString()):il(D)?ud(D):D instanceof I.List?"__ht__list"+(D.__ht__list||l.stringify(D._as)):D},C==s?2:C);return Date.prototype.toJSON=L,m},parse:function(b){return Kl(b)?JSON.parse(b,function(T,W){if(Kl(W))if("__ht__function"==W.substr(0,14)){var h=W.indexOf("{")+1,j=W.lastIndexOf("}"),n=W.indexOf("(")+1,G=W.indexOf(")");if(h&&j&&n&&G){var _=new Function(W.substring(n,G),W.substring(h,j));return _.__ht__=W.substr(6),_}}else{if("__ht__date"==W.substr(0,10))return new Date(o(W.substr(10)));if("__ht__list"===W.substr(0,10))return new Ce(l.parse(W.substr(10)))}return W}):b},loadJS:function(O,E){E&&O.push(E);var s=O.shift();if(xd(s))O=s.contact(O),l.loadJS(O);else if(Ym(s))s(),l.loadJS(O);else if(Kl(s)){var t=k.createElement("script");t.onload=function(){l.loadJS(O)},t.setAttribute("src",s),k.getElementsByTagName("head")[0].appendChild(t)}else O.length&&l.loadJS(O)},toRoundedCorner:function(e,W){var d=e.size();if(0>=W)return{points:e};var U,V=new Ce,C=new Ce,S=e.get(0);V.add(S),C.add(1);for(var g=1;d>g;g++)if(d>g+1){var T=e.get(g),G=e.get(g+1),h=S.x,_=S.y,O=T.x,P=T.y,m=P-_,N=O-h,E=Z(m,N);U=$(.99*Bg(S,T),W),V.add({x:O-U*b(E),y:P-U*w(E)}),V.add(T),h=T.x,_=T.y,O=G.x,P=G.y,m=P-_,N=O-h,E=Z(m,N),U=$(.99*Bg(T,G),W),S={x:h+U*b(E),y:_+U*w(E)},V.add(S),C.addAll([2,3])}else V.add(e.get(g)),C.add(2);return{points:V,segments:C}},toColorData:rp,setCanvas:sf,createDiv:$b,createDisabledDiv:yg,createView:js,createCanvas:Ub,appendChild:Xd,initContext:An,checkLoadingImage:md,translateAndScale:ze,layout:Kj,getPosition:Rf,drawPoints:wk,drawRoundRect:tb,drawBorder:Gq,setFocus:an,getter:Xk,setter:Lb,isEmptyObject:rb},!0),Kk(Q,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var ok=l.disabledOpacity,Nh=l.toolTipDelay,Rb=l.devicePixelRatio,$o=l.autoMakeVisible,em=l.autoHideScrollBar,op=l.imageGradient,bi=l.showToolTip,Si=l.hideToolTip,mr=l.dashPattern,fo=l.lineCap,cn=l.lineJoin,Xj=l.labelColor,Ir=l.labelSelectColor,bo=l.labelFont,Pc=l.widgetIndent,xi=l.widgetRowHeight,uq=l.widgetHeaderHeight,lf=l.widgetTitleHeight,ps=l.scrollBarColor,ms=l.scrollBarSize,vh=l.scrollBarTimeout,Ae=l.scrollBarMinLength,Fo=l.scrollBarInteractiveSize,Oh=l.zoomIncrement,id=l.scrollZoomIncrement,hq=l.pinchZoomIncrement,Qb=l.zoomMax,ko=l.zoomMin,sh=l.createObject,bn=l.preventDefault,Zc=l.setImage,nb=l.getImage,Qd=l.isImageComplete,on=l.drawCenterImage,Bk=l.drawStretchImage,to=l.getId,Ui=l.callLater,Hg=l.sortFunc,kl=l.clone,um=l.getClass,xc=l.startAnim,vn=l.brighter,pj=l.darker,li=l.drawText,sq=l.getTextSize,Zb=l.isLeftButton,Xf=l.getTouchCount,ui=l.isDoubleClick,Fg=l.isShiftDown,Ei=l.isCtrlDown,Il=l.getClientPoint,dp=l.getPagePoint,Bg=l.getDistance,Bq=l.unionPoint,Og=l.unionRect,Li=l.containsPoint,sp=l.containsRect,qb=l.intersectsRect,jr=l.intersection,$h=l.getWindowInfo,mf=l.grow,Xq=l.getLogicalPoint,Vj=l.getScreenPoint,De=l.startDragging,kq=l.removeHTML,lc=l.createElement,Xe=l.segmentResolution,mo=l.shapeResolution,Sd=l.shapeSide,Op=l.def,Lf=function(i,V,g){Op(C+"."+i,V,g)},nc=function(i,I){i.childNodes.forEach(function(r){I(r),nc(r,I)})};Kk(l,{toolTipLabelColor:Xj,toolTipLabelFont:bo,toolTipBackground:h.toolTipBackground,toolTipShadowColor:Xh,drawBreakableText:dc,setDevicePixelRatio:function(n){Rb=l.devicePixelRatio="number"==typeof n?n:R.devicePixelRatio,nc(k.body,function(o){var t=o._ht;t&&t._canvas&&(sf(t._canvas,t.getWidth(),t.getHeight()),t.redraw?t.redraw():t.iv())})}},!0);var Bi=1e-6,Wn="undefined"!=typeof Uint16Array?Uint16Array:Array,hk="undefined"!=typeof Float32Array?Float32Array:Array,tn=function(w,v,n){var P=[w[0]-v[0],w[1]-v[1],w[2]-v[2]];if(n){var d=Bg(P);d>0&&(P[0]/=d,P[1]/=d,P[2]/=d)}return P},tf=function(){var Q="charCodeAt",t=2*(2*go.length+1);for(var u in R)if(u===C+Ih[0]+pp.length){var v=R[u];if(!v)break;for(var A=v.length,E=0;A>E;E++)if(v[E][Q](0)===t&&v[E+1]!=s&&v[E+1]===pp[0]&&v[E+2]!=s&&v[E+2][Q](0)===t){for(var G=E+3;A>G;G++)if(v[G][Q](0)===t){if(0==v[G+1])for(var k,n=G+2;A>n;n++){if(v[n][Q](0)===t){0==v[n-1]&&k&&(B=k.substr(0,k.length-1));break}k==s?k=v[n]:k+=v[n]}break}break}break}return function(M){return[-M[0],-M[1],-M[2]]}}(),pk=function(N,h){return 3===N.length?N[0]*h[0]+N[1]*h[1]+N[2]*h[2]:N[0]*h[0]+N[1]*h[1]},Rp=function(){var n=new hk(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},zj=Rp(),uk=function(E){var e=new hk(16);return e[0]=E[0],e[1]=E[1],e[2]=E[2],e[3]=E[3],e[4]=E[4],e[5]=E[5],e[6]=E[6],e[7]=E[7],e[8]=E[8],e[9]=E[9],e[10]=E[10],e[11]=E[11],e[12]=E[12],e[13]=E[13],e[14]=E[14],e[15]=E[15],e},jq=function(b,h){return b[0]=h[0],b[1]=h[1],b[2]=h[2],b[3]=h[3],b[4]=h[4],b[5]=h[5],b[6]=h[6],b[7]=h[7],b[8]=h[8],b[9]=h[9],b[10]=h[10],b[11]=h[11],b[12]=h[12],b[13]=h[13],b[14]=h[14],b[15]=h[15],b},ro=function(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},Zk=function(g,t){var j=g[0],J=g[1],P=g[2];return g[0]=t[0]*j+t[4]*J+t[8]*P+t[12],g[1]=t[1]*j+t[5]*J+t[9]*P+t[13],g[2]=t[2]*j+t[6]*J+t[10]*P+t[14],g},qg=function(U,h){var v=U[0],J=U[1],j=U[2],T=U[3];return U[0]=h[0]*v+h[4]*J+h[8]*j+h[12]*T,U[1]=h[1]*v+h[5]*J+h[9]*j+h[13]*T,U[2]=h[2]*v+h[6]*J+h[10]*j+h[14]*T,U[3]=h[3]*v+h[7]*J+h[11]*j+h[15]*T,U},Eo=function(){var L,M,W,f,N=Kh(pc[1]+pc[7]),s=Kh(pc[0]+pc[3]-pc[10]),j=Kh(pc[8]+2),C=function(){return M=W.charAt(L),L+=1,M},U=function(){var x="";if(M===j)for(;C();){if(M===j)return C(),x;x+=M}else C()},y=function(){for(;M&&" ">=M;)C()},E=function(){var v,n={};if(M===N){if(C(),y(),M===s)return C(),n;for(;M;){if(v=U(),y(),C(),n[v]=f(),y(),M===s)return C(),n;C(),y()}}};return f=function(){switch(y(),M){case N:return E();default:return U()}},function(g){if(m={},g){var I;if(W=g,L=0,M=" ",I=f(),y(),!M)return I}}}(),ig=function(p,d){if(d){var y=w(d),H=b(d),X=p[4],r=p[5],g=p[6],i=p[7],R=p[8],F=p[9],t=p[10],Z=p[11];p[4]=X*H+R*y,p[5]=r*H+F*y,p[6]=g*H+t*y,p[7]=i*H+Z*y,p[8]=R*H-X*y,p[9]=F*H-r*y,p[10]=t*H-g*y,p[11]=Z*H-i*y}},vc=function(y,K){if(K){var U=w(K),r=b(K),W=y[0],m=y[1],t=y[2],x=y[3],l=y[8],P=y[9],J=y[10],q=y[11];y[0]=W*r-l*U,y[1]=m*r-P*U,y[2]=t*r-J*U,y[3]=x*r-q*U,y[8]=W*U+l*r,y[9]=m*U+P*r,y[10]=t*U+J*r,y[11]=x*U+q*r}},Im=function(A,k){if(k){var u=w(k),f=b(k),C=A[0],J=A[1],S=A[2],i=A[3],T=A[4],p=A[5],z=A[6],Z=A[7];A[0]=C*f+T*u,A[1]=J*f+p*u,A[2]=S*f+z*u,A[3]=i*f+Z*u,A[4]=T*f-C*u,A[5]=p*f-J*u,A[6]=z*f-S*u,A[7]=Z*f-i*u}},yh=function(A,I,_){return zc(s,_===!1?s:A.getFinalScale3d(),A.getFinalRotation3d(),A.getRotationMode(),A.p3(),s,I)},zc=function(y,U,Z,o,f,w,$){return w||(w=Rp()),f&&qi(w,f),ti(w,Z,o),$&&fq(w,w,$),U&&kf(w,U),y&&fq(w,w,y),w},xo=function(c,S,Y){S=o(S),Y=o(Y);var R=this;R.g=c,R._84O=S,R._85O=Y,R._70I=!0,R.F=0,R._83O=S+Y,R.pen={x:0,y:0}},_e="lineDashOffset",dk="setLineDash",Yg=function(U){for(var P in U)1===P.length&&(_e=U[P]);return P?1:0},Bj=function(W,O,M){return ys(O)?W:W[dk]?(W[dk](O),M&&(W.lineDashOffset=M),W):new xo(W,O[0],O.length>1?O[1]:O[0])},He=function(T,e){!ys(e)&&T[dk]&&(T[dk](sb),T.lineDashOffset=0)};if(Op(xo,H,{_69I:6,moveTo:function($,z){var F=this,m=F.pen;m.x=$,m.y=z,F.g.moveTo($,z),F.start||(F.start={x:$,y:z})},lineTo:function(C,r){var n=this,V=n.pen,h=C-V.x,j=r-V.y,I=Z(j,h),e=b(I),u=w(I),k=n._23O(V.x,V.y,C,r),J=n._85O,O=n._84O,_=n._83O;if(n.F){if(n.F>k)return n._70I?n._72I(C,r):n.moveTo(C,r),n.F-=k,void 0;if(n._70I?n._72I(V.x+e*n.F,V.y+u*n.F):n.moveTo(V.x+e*n.F,V.y+u*n.F),k-=n.F,n.F=0,n._70I=!n._70I,!k)return}var $=c(k/_);if($){for(var m=e*O,g=u*O,v=e*J,R=u*J,D=0;$>D;D++)n._70I?(n._72I(V.x+m,V.y+g),n.moveTo(V.x+v,V.y+R)):(n.moveTo(V.x+v,V.y+R),n._72I(V.x+m,V.y+g));k-=_*$}n._70I?k>O?(n._72I(V.x+e*O,V.y+u*O),n.moveTo(C,r),n.F=J-(k-O),n._70I=!1):(n._72I(C,r),k===O?(n.F=0,n._70I=!n._70I):(n.F=O-k,n.moveTo(C,r))):k>J?(n.moveTo(V.x+e*J,V.y+u*J),n._72I(C,r),n.F=O-(k-J),n._70I=!0):(n.moveTo(C,r),k===J?(n.F=0,n._70I=!n._70I):n.F=J-k)},quadraticCurveTo:function(M,O,N,q){var t,A=this,L=A.pen,x=L.x,k=L.y,$=A._22O(x,k,M,O,N,q),y=0,D=0,P=A._85O,J=A._84O;if(A.F){if(A.F>$)return A._70I?A._71I(M,O,N,q):A.moveTo(N,q),A.F-=$,void 0;if(y=A.F/$,t=A._20O(x,k,M,O,N,q,y),A._70I?A._71I(t[2],t[3],t[4],t[5]):A.moveTo(t[4],t[5]),A.F=0,A._70I=!A._70I,!$)return}var h=$-$*y,Q=c(h/A._83O),i=J/$,n=P/$;if(Q)for(var R=0;Q>R;R++)A._70I?(D=y+i,t=A._21O(x,k,M,O,N,q,y,D),A._71I(t[2],t[3],t[4],t[5]),y=D,D=y+n,t=A._21O(x,k,M,O,N,q,y,D),A.moveTo(t[4],t[5])):(D=y+n,t=A._21O(x,k,M,O,N,q,y,D),A.moveTo(t[4],t[5]),y=D,D=y+i,t=A._21O(x,k,M,O,N,q,y,D),A._71I(t[2],t[3],t[4],t[5])),y=D;h=$-$*y,A._70I?h>J?(D=y+i,t=A._21O(x,k,M,O,N,q,y,D),A._71I(t[2],t[3],t[4],t[5]),A.moveTo(N,q),A.F=P-(h-J),A._70I=!1):(t=A._19O(x,k,M,O,N,q,y),A._71I(t[2],t[3],t[4],t[5]),$===J?(A.F=0,A._70I=!A._70I):(A.F=J-h,A.moveTo(N,q))):h>P?(D=y+n,t=A._21O(x,k,M,O,N,q,y,D),A.moveTo(t[4],t[5]),t=A._19O(x,k,M,O,N,q,D),A._71I(t[2],t[3],t[4],t[5]),A.F=J-(h-P),A._70I=!0):(A.moveTo(N,q),h===P?(A.F=0,A._70I=!A._70I):A.F=P-h)},bezierCurveTo:function(){var S=arguments;this.pen={x:S[4],y:S[5]},this.g.bezierCurveTo(S[0],S[1],S[2],S[3],S[4],S[5])},arc:function(M,$,t,r,O,c){c||(r=-r,O=-O),Dq(this,M,$,r,O-r,t,t,!1)},rect:function(B,L,g,R){var j=this;j.pen={x:B,y:L},j.moveTo(B,L),j.lineTo(B,L+R),j.lineTo(B+g,L+R),j.lineTo(B+g,L),j.lineTo(B,L)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(p,c,G,x){var D=G-p,J=x-c;return W(D*D+J*J)},_22O:function(A,j,s,e,O,I,q){for(var D,W,b,v,N,Q,f,M=0,x=A,n=j,G=q>0?q:this._69I,w=1;G>=w;w++)b=w/G,v=1-b,N=v*v,Q=2*b*v,f=b*b,D=N*A+Q*s+f*O,W=N*j+Q*e+f*I,M+=this._23O(x,n,D,W),x=D,n=W;return M},_21O:function(K,X,w,g,W,z,R,m){var I=this;if(0===R)return I._20O(K,X,w,g,W,z,m);if(1===m)return I._19O(K,X,w,g,W,z,R);var L=I._20O(K,X,w,g,W,z,m);return L.push(R/m),I._19O.apply(I,L)},_20O:function(L,A,F,e,u,Z,x){if(1!==x){var P=F+(u-F)*x,I=e+(Z-e)*x;F=L+(F-L)*x,e=A+(e-A)*x,u=F+(P-F)*x,Z=e+(I-e)*x}return[L,A,F,e,u,Z]},_19O:function(s,N,k,J,T,Y,l){if(1!==l){var M=s+(k-s)*l,c=N+(J-N)*l;k+=(T-k)*l,J+=(Y-J)*l,s=M+(k-M)*l,N=c+(J-c)*l}return[s,N,k,J,T,Y]},_72I:function(E,s){var h=this.pen;(E!==h.x||s!==h.y)&&(h.x=E,h.y=s,this.g.lineTo(E,s))},_71I:function(h,g,T,y){var l=this.pen;(h!==T||g!==y||T!==l.x||y!==l.y)&&(l.x=T,l.y=y,this.g.quadraticCurveTo(h,g,T,y))}}),u&&L){var Nn=L.toString();Y=Nn.indexOf(mq.substr(0,2))>0&&Nn.indexOf(ns+ns.substr(1,1))>1||Nn.indexOf($c.substr(0,2)+mq.substr(2,2)+Ih[0]+mq[4])>1?!0:!1}!0&&R.console&&(R.navigator&&R.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?R.console.log.apply(console,["Hightopo - Version"+I.Default.getVersion()+" - %chttp://hightopo.com/request.html","color: #f00;"]):R.console.log("Hightopo - Version"+I.Default.getVersion()+" - http://hightopo.com/request.html"));var Hd=s,Io=s,Pl=function(M){Hd&&!M._72O&&(Io||(Io={}),Io[M._72O=to()]=M)},Oj=function(e,w){if(w||(w=e),w&&(Hd||(Hd={}),!Hd[e])){var M=new ib;if(Hd[w]={request:M,url:w},w=l.beforeLoadURL(w),w.data){var i=l.parse(w.data);gb(e,i),l.handleCompTypeLoaded(e,i)}else{M.onload=function(n){if(200===this.status||0===this.status){var _=l.parse(n.target.response||n.target.responseText);gb(e,_),l.handleCompTypeLoaded(e,_)}else gb(e,s)},M.onerror=function(){gb(e,s)};var j={};j.url=encodeURI(w),j.sync=!1,M.send(j)}}},gb=function(k,l){if($q[k]=l,delete Hd[k],rb(Hd)&&(Hd=s,Io)){for(var n in Io){var e=Io[n];e.invalidateAll&&e.invalidateAll(r,"compTypeLoaded",k),e.redraw&&e.redraw(),e.iv(),delete e._72O}Io=s}if(l&&Io)for(var n in Io){var e=Io[n];e.invalidateAll&&e.invalidateAll(r,"compTypeLoading",k),e.redraw&&e.redraw(),e.iv()}},Nm=h.chart,Ci="",Pk=l.compStack=[],ol=/^style@/,Ai=/^attr@/,as=/^field@/,vg={x:.5,y:.5},El=function(L,e,l,N){if(!L)return 0;if(Ro(L.fitSize,e,l)&&N)return N;var Z=Ro(L.width,e,l);return null==Z?20:Z},tj=function(b,M,u,T){if(!b)return 0;if(Ro(b.fitSize,M,u)&&T)return T;var W=Ro(b.height,M,u);return null==W?20:W},Ro=function(q,x,V){if(!q||!q.func)return q;var _,B=q.func,v=q.value;return _=Ym(B)?V&&V.vectorDataBindingDisabled&&!q.isSafeFunc?v:B(x,V):x instanceof re?Ai.test(B)?x.a(Ci+B.slice(5)):ol.test(B)?x.s(Ci+B.slice(6)):as.test(B)?x[B.slice(6)]:x[B]?x[B](V):v:v,v!==r&&_==s?v:_},rm=l.drawImage=function(){var H,G,a,Y,L,D,Z=function(C,y){C.getValue&&C.getValue.compType===y||(C.getValue=function(b){var k=F(C,b);if(k===r&&y.properties){var T=y.properties[b];T&&(k=T.defaultValue)}return k},C.getColor=function(y){return e(C.getValue(y))},C.getValue.compType=y)},F=function(P,g,K){var M,C=!1;if(P.prefix&&G instanceof re){var p=G.a(Ci+g);p!==r&&(C=!0,M=p)}return M===r&&(M=P[g]),M&&M.func&&(C=!0,M=Ro(M,G,a)),K&&(M=K(M),C||(P[g]=M)),M},e=function(O,T){var h;if(h=T?F(O,T):O,H&&H.compGray&&h)return l.toGrayColor(h);if(L&&h){if("override"===D)return L;if("override_rgb"===D){var y=oj(L);return h=rp(h),"rgba("+c(255*y[0])+","+c(255*y[1])+","+c(255*y[2])+","+h[3]/255+")"}if("override_a"===D){var y=oj(L);return h=rp(h),"rgba("+h[0]+","+h[1]+","+h[2]+","+y[3]+")"}var y=oj(L);return h=rp(h),"rgba("+c(h[0]*y[0])+","+c(h[1]*y[1])+","+c(h[2]*y[2])+","+h[3]/255*y[3]+")"}return h},U=function(g){if(xd(g)){for(var J=new Ce,d=g.length,$=0;d>$;$+=2)J.add({x:g[$],y:g[$+1]});g=J}return g},V=function(m){var H=F(m,"anchorX"),c=F(m,"anchorY");if(H!==r||c!==r)return{x:H===r?vg.x:H,y:c===r?vg.y:c};var K=F(m,"type"),U=F(m,"name");if("image"!==K||!U)return vg;var l=nb(U);return l&&l.anchorX!==r&&l.anchorY!==r?{x:l.anchorX,y:l.anchorY}:vg},J=function(H,X){var n=F(H,Dj),B=V(H);if(xd(n)){var l=n.length,E=F(H,"relative"),w=X.width,c=X.height;if(4===l)n={x:n[0],y:n[1],width:n[2],height:n[3]},E&&(n.x*=w,n.y*=c,n.width*=w,n.height*=c);else if(3===l){var u=n[0];n={width:n[1],height:n[2]},E&&(n.width*=w,n.height*=c),"object"==typeof u?u.length&&(u={x:u[0],y:u[1]}):u=Rf(u,X,n),n.x=u.x-n.width*B.x,n.y=u.y-n.height*B.y}n.x+=F(H,"offsetX")||0,n.y+=F(H,"offsetY")||0,!E&&X.fitSize&&(n=W(H,n,X))}return n},W=function(x,o,v){if(o){var U,g,A,_={x:o.x,y:o.y,width:o.width,height:o.height},E=V(x),M=F(x,"layoutH"),I=F(x,"layoutV"),p=1,c=1,l=0,r=0,b=1,h=1;switch(M){case"left":break;case"right":_.x+=v.width-v.rw;break;case"center":_.x+=.5*(v.width-v.rw);break;case"scale":case"leftright":default:U=F(x,Nc)||0,U&&(l=Math.abs(r=Math.sin(U)),b=Math.abs(h=Math.cos(U))),"leftright"!==M?(p+=b*(v.widthScale-1),c+=l*(v.widthScale-1)):(p+=_.width?b*(v.width-v.rw)/_.width:0,c+=_.height?l*(v.width-v.rw)/_.height:0,g=-Math.min(-E.x*h+E.y*r,-E.x*h-(1-E.y)*r,(1-E.x)*h+E.y*r,(1-E.x)*h-(1-E.y)*r))}switch(I){case"top":break;case"bottom":_.y+=v.height-v.rh;break;case"center":_.y+=.5*(v.height-v.rh);break;case"scale":case"topbottom":default:U==s&&(U=F(x,Nc),U&&(l=Math.abs(r=Math.sin(U)),b=Math.abs(h=Math.cos(U)))),"topbottom"!==I?(p+=l*(v.heightScale-1),c+=b*(v.heightScale-1)):(p+=_.width?l*(v.height-v.rh)/_.width:0,c+=_.height?b*(v.height-v.rh)/_.height:0,A=-Math.min(-E.x*r-E.y*h,-E.x*r+(1-E.y)*h,(1-E.x)*r-E.y*h,(1-E.x)*r+(1-E.y)*h))}return(1!==p||1!==c)&&("scale"!==M&&M?"leftright"===M&&(_.x+=_.width*(1-p)*E.x+g*(v.width-v.rw)):_.x+=_.x*(v.widthScale-1)+E.x*_.width*(v.widthScale-p),"scale"!==I&&I?"topbottom"===I&&(_.y+=_.height*(1-c)*E.y+A*(v.height-v.rh)):_.y+=_.y*(v.heightScale-1)+E.y*_.height*(v.heightScale-c),_.width*=p,_.height*=c),_.width<0&&(_.width=0),_.height<0&&(_.height=0),_}},j=function(j){return xd(j)?new Ce(j):j},T=function(S,i,Y,A,p,l,k){var I=H.interactiveInfo,e=S.transform;if(e)return H.save(),H.setTransform(e.a,e.b,e.c,e.d,e.tx,e.ty),I&&I.compInfos.push({comp:S,rect:i,matrix:e.clone()}),!0;p===r&&(p=1),l===r&&(l=1);var d=F(S,"clipPercentage"),J=Kq(Y,i);if(J&&!A&&1===p&&1===l&&!(1>d))return I&&I.compInfos.push({comp:S,rect:i,matrix:I.matrix.clone()}),!1;k=k||vg;var G=i.x+i.width*k.x,x=i.y+i.height*k.y,P=Y.x+Y.width*k.x,N=Y.y+Y.height*k.y,m=Y.width?p*(i.width/Y.width):1,v=Y.height?l*(i.height/Y.height):1;if(H.save(),I&&(I.matrix.appendTranslate(G,x).appendRotate(A).appendScale(m,v).appendTranslate(-P,-N),I.compInfos.push({comp:S,rect:i,matrix:I.matrix.clone()})),Zd(H,G,x),jc(H,A||0),vp(H,m,v),Zd(H,-P,-N),1>d){0>d&&(d=0);var Z=Cl(Y,F(S,"clipDirection"),d);H.beginPath(),H.rect(Z.x,Z.y,Z.width,Z.height),H.clip()}return!0},z=function(){H.restore()},o=function(y,n,W){var x=F(y,"path"),D=F(y,Nc),J=F(y,"scaleX"),k=F(y,"scaleY"),l=V(y),C=s,m=tq(null,x);if(W||(W=y.unionRect,W||(W=Bq(m),y.path.func||(y.unionRect=W)),C=W),W){C||(C=y.unionRect,C||(C=Bq(m),y.path.func||(y.unionRect=C)));var g=T(y,W,C,D,J,k,l),r=F(y,"borderPattern"),b=Bj(H,r),A=e(y,"background"),G=e(y,"borderColor"),i=F(y,"borderWidth"),B=F(y,"gradient"),p=e(y,"gradientColor"),t=F(y,"border3d"),S=F(y,"border3dColor"),c=F(y,"border3dAccuracy"),E=H.lineJoin,d=H.lineCap;if(H.lineJoin=F(y,"borderJoin")||cn,H.lineCap=F(y,"borderCap")||fo,A?(Jm(H,A,B,p,C),tq(H,x),H.fill(),b!==H&&tq(H,x)):tq(H,x),i&&G){var P=F(y,"borderWidthAbsolute");P&&(H.save(),H.setTransform(1,0,0,1,0,0)),H.lineWidth=i,H.strokeStyle=G,H.stroke(),P&&H.restore(),t&&Zi(H,G,S,i,Y,c)}if(He(H,r),F(y,"dash")){var v=F(y,"dashWidth")||i;if(v>0){r=F(y,"dashPattern")||mr;var b=Bj(H,r,F(y,"dashOffset")),Q=e(y,"dashColor")||e(ke);b!==H&&tq(H,x),H.strokeStyle=Q,H.lineWidth=v,H.stroke(),F(y,"dash3d")&&Zi(H,Q,e(y,"dash3dColor"),v,Y,F(y,"dash3dAccuracy")),He(H,r)}}n===Dj&&db(H,A,F(y,"depth"),C),H.lineJoin=E,H.lineCap=d,g&&z()}},A=function(v,m,A,I){var C=F(v,Gp,U),M=F(v,Nc),K=V(v);if(C&&I.fitSize){var o=new Ce,d=Bq(C),S=W(v,d,I),y=d.x+K.x*d.width,g=d.y+K.y*d.height,Q=S.x+K.x*S.width,B=S.y+K.y*S.height,f=d.width?S.width/d.width:1,n=d.height?S.height/d.height:1;C.each(function(K){o.add({x:Q+(K.x-y)*f,y:B+(K.y-g)*n})}),C=o,v.unionRect=null}var i=F(v,"scaleX"),Z=F(v,"scaleY"),h=m===jf,x=s;if(!A&&h&&(A=v.unionRect,A||(A=Bq(C),v.points.func||(v.unionRect=A)),x=A),A){h?x||(x=v.unionRect,x||(x=Bq(C),v.points.func||(v.unionRect=x))):x=A;var X,w,R,c,$=T(v,A,x,M,i,Z,K),J=F(v,"borderPattern"),l=Bj(H,J),u=e(v,"background"),N=nb(F(v,"repeatImage"),L,D),E=F(v,"gradientPack"),r=e(v,"borderColor"),P=F(v,"borderWidth"),_=F(v,"segments",j),k=F(v,"gradient"),O=e(v,"gradientColor"),b=F(v,"border3d"),p=F(v,"border3dColor"),t=F(v,"border3dAccuracy"),q=F(v,"closePath"),zp=F(v,"fillRule")||"nonzero",nj=H.lineJoin,Oi=H.lineCap;if(H.lineJoin=F(v,"borderJoin")||cn,H.lineCap=F(v,"borderCap")||fo,h)if(u||N||E){var Id=F(v,"fillClipPercentage");if(1>Id){0>Id&&(Id=0);var jg=Cl(x,F(v,"fillClipDirection"),Id);H.save(),H.beginPath(),H.rect(jg.x,jg.y,jg.width,jg.height),H.clip()}if(wk(H,C,_,q),E)Np(H,E);else if(N){var dn=H,Qp=L,If=D;Od(H,N,L,D,G,a),H=dn,L=Qp,D=If}else{var dn=H;Jm(H,u,k,O,x),H=dn}H.fill(zp),1>Id&&H.restore(),E&&H.restore(),l!==H&&wk(l,C,_,q)}else wk(l,C,_,q);else if("roundRect"===m?X=F(v,"cornerRadius"):"polygon"===m?X=F(v,"polygonSide"):"arc"===m&&(X=F(v,"arcFrom"),w=F(v,"arcTo"),R=F(v,"arcClose"),c=F(v,"arcOval")),u||N||E){var Id=F(v,"fillClipPercentage");if(1>Id){0>Id&&(Id=0);var jg=Cl(x,F(v,"fillClipDirection"),Id);H.save(),H.beginPath(),H.rect(jg.x,jg.y,jg.width,jg.height),H.clip()}if(Uk(H,m,x,X,w,R,c),E)Np(H,E);else if(N){var dn=H,Qp=L,If=D;Od(H,N,L,D,G,a),H=dn,L=Qp,D=If}else Jm(H,u,k,O,x);H.fill(zp),1>Id&&H.restore(),E&&H.restore(),H!==l&&Uk(l,m,x,X,w,R,c)}else Uk(l,m,x,X,w,R,c);if(P&&r){var Ki=F(v,"borderWidthAbsolute");Ki&&(H.save(),H.setTransform(1,0,0,1,0,0)),H.lineWidth=P,H.strokeStyle=r,H.stroke(),Ki&&H.restore(),b&&Zi(H,r,p,P,Y,t)}if(He(H,J),F(v,"dash")){var Nl=F(v,"dashWidth")||P;if(Nl>0){J=F(v,"dashPattern")||mr;var l=Bj(H,J,F(v,"dashOffset")),Hb=e(v,"dashColor")||e(ke);l!==H&&(h?wk(l,C,_,q):Uk(l,m,x,X,w,R,c)),H.strokeStyle=Hb,H.lineWidth=Nl,H.stroke(),F(v,"dash3d")&&Zi(H,Hb,e(v,"dash3dColor"),Nl,Y,F(v,"dash3dAccuracy")),He(H,J)}}m===Dj&&db(H,u,F(v,"depth"),x),H.lineJoin=nj,H.lineCap=Oi,$&&z()}},Q=function(z,Q){var h=L,t=D,q=L||F(z,fk),j=D||F(z,"blendMode"),A=nb(F(z,"name"),q,j);A&&(Bk(H,A,F(z,"stretch"),Q.x,Q.y,Q.width,Q.height,G,a,q,null,j),L=h,D=t)},v=function(K,D){var A=F(K,"text");A!=s&&li(H,A,F(K,"font"),e(K,fk),D.x,D.y,D.width,D.height,F(K,"align"),F(K,"vAlign"))},x=function(f,V){Gq(H,e(f,fk),V.x,V.y,V.width,V.height,F(f,"width"))},n=function(a,e){var q=F(a,Fq),V=0;if(q&&(q.forEach(function(Y){V+=Y}),V>0)){for(var t=F(a,"colors")||Nm,r=F(a,"startAngle")||0,z=F(a,"hollow"),C=F(a,Le),A=F(a,wo),x=F(a,Nb),E=C?new Ce:s,l=e.x,m=e.y,I=e.width,v=e.height,u=l+I/2,B=m+v/2,y=$(I,v)/2,D=0,J=0;J<q.length;J++){var g=q[J],P=p*g/V,n=r+P;if(H.fillStyle=t[D++],D===t.length&&(D=0),H.beginPath(),z){var L=u+b(r)*y/2,X=B+w(r)*y/2,R=u+b(n)*y,o=B+w(n)*y;H.moveTo(L,X),H.arc(u,B,y/2,r,n,!1),H.lineTo(R,o),H.arc(u,B,y,n,r,!0)}else H.moveTo(u,B),H.arc(u,B,y,n,r,!0);E&&(P=(r+n)/2,E.add({text:Ym(C)?C(g,J,V,G):g,x:u+.75*b(P)*y,y:B+.75*w(P)*y})),H.closePath(),H.fill(),r=n}E&&E.each(function(Q){li(H,Q.text,A,x,Q.x,Q.y,0,0,Re)})}},q=function(U,q){var j=F(U,ih);if(j&&j.length>0){var J=j.length,h=F(U,Le),T=F(U,wo),Q=F(U,Nb),l=h?new Ce:s,P=F(U,"minValue")||0,M=F(U,"maxValue");if(M==s&&(M=0,j.forEach(function(_){F(_,Fq).forEach(function(B){M=t(M,B)})})),P===M)return;for(var c=q.height/(M-P),X=q.y+M*c,i=F(j[0],Fq).length,o=q.width/(3*i+1),e=2*o/J,R=0,w=0;J>w;w++)for(var x=j[w],m=F(x,fk),b=F(x,"colors"),u=F(x,Fq),C=0;i>C;C++){b?H.fillStyle=b[C]:m?H.fillStyle=m:(H.fillStyle=Nm[R++],R===Nm.length&&(R=0));var E=u[C],y=E*c,$=q.x+(1+3*C)*o+w*e;if(Yl(H,$,X-y,e,y),l){var N=Ym(h)?h(E,C,x,G):E,A=sq(T,N).height;l.add({x:$,y:X-y-A,width:e,height:A,text:N})}}l&&l.each(function(m){li(H,m.text,T,Q,m.x,m.y,m.width,m.height,Re)})}},N=function(K,b){var u=F(K,ih);if(u&&u.length>0){var Z=u.length,k=F(u[0],Fq).length,E=b.width/(3*k+1),N=0,q=F(K,"maxValue"),h=F(K,Le),p=F(K,wo),y=F(K,Nb),i=h?new Ce:s;if(q==s){q=0;for(var j=0;k>j;j++){for(var c=0,$=0;Z>$;$++)c+=F(u[$],Fq)[j];q=t(q,c)}}if(q>0){for(var j=0;k>j;j++)for(var S=b.y+b.height,$=0;Z>$;$++){var X=u[$],v=F(X,fk),B=F(X,Fq)[j],x=B/q*b.height;v?H.fillStyle=v:(H.fillStyle=Nm[N++],N===Nm.length&&(N=0)),S-=x;var n={x:b.x+(1+3*j)*E,y:S,width:2*E,height:x};Yl(H,n.x,n.y,n.width,n.height),i&&(n.text=Ym(h)?h(B,j,X,G):B,i.add(n))}i&&i.each(function(E){li(H,E.text,p,y,E.x,E.y,E.width,E.height,Re)})}}},O=function(L,W){var O=F(L,ih);if(O&&O.length>0){for(var q=O.length,I=F(O[0],Fq).length,Z=W.width/(3*I+1),Q=0,E=F(L,Le),U=F(L,wo),D=F(L,Nb),w=E?new Ce:s,e=0;I>e;e++){for(var V=0,R=0;q>R;R++)V+=F(O[R],Fq)[e];if(V>0){var A=W.y+W.height;for(R=0;q>R;R++){var r=O[R],v=F(r,fk),h=F(r,Fq)[e],K=h/V*W.height;v?H.fillStyle=v:(H.fillStyle=Nm[Q++],Q===Nm.length&&(Q=0)),A-=K;var N={x:W.x+(1+3*e)*Z,y:A,width:2*Z,height:K};Yl(H,N.x,N.y,N.width,N.height),w&&(N.text=Ym(E)?E(h,e,r,G):h,w.add(N))}}}w&&w.each(function(s){li(H,s.text,U,D,s.x,s.y,s.width,s.height,Re)})}},X=function(P,q){var B=F(P,ih);if(B&&B.length>0){var j=B.length,N=F(P,"minValue")||0,z=F(P,"maxValue");if(z==s&&(z=0,B.forEach(function(K){F(K,Fq).forEach(function(_){z=t(z,_)})})),N===z)return;for(var r=q.height/(z-N),m=q.y+z*r,v=F(B[0],Fq).length,c=q.width/(3*v+1),f=0,l=F(P,"lineWidth")||2,E=F(P,"line3d"),k=F(P,"linePoint"),A=F(P,Le),K=F(P,wo),b=F(P,Nb),S=0;j>S;S++){var Z=B[S],I=F(Z,fk),_=F(Z,Fq);I?H.strokeStyle=I:(I=H.strokeStyle=Nm[f++],f===Nm.length&&(f=0)),H.beginPath();for(var T=0;v>T;T++){var W=q.x+(2+3*T)*c,h=m-_[T]*r;0===T?H.moveTo(W,h):H.lineTo(W,h)}if(H.lineWidth=l,H.stroke(),E&&Zi(H,I,s,l,Y),k||A){var L,J=l/2+2;for(T=0;v>T;T++){var u=_[T];if(W=q.x+(2+3*T)*c,h=m-u*r,Ym(k)?k(H,W,h,I,T,Z,G):k&&(H.fillStyle=I,H.beginPath(),H.arc(W,h,J,0,p,!0),H.fill()),Ym(A)?L=A(u,T,Z,G):A&&(L=u),L){var x=sq(K,L).height,i=H.shadowBlur;if(i){var e=H.shadowOffsetX,D=H.shadowOffsetY,X=H.shadowColor;H.shadowOffsetX=0,H.shadowOffsetY=0,H.shadowBlur=0,H.shadowColor=s}li(H,L,K,b,W,h-x-J+2,0,x,Re),i&&(H.shadowOffsetX=e,H.shadowOffsetY=D,H.shadowBlur=i,H.shadowColor=X)}}}}}},h=function(){H=null,G=null,a=null},M={border:x,image:Q,text:v,pieChart:n,columnChart:q,stackedColumnChart:N,percentageColumnChart:O,lineChart:X};return function(w,X,u,y,k,m,t,x,P,S){if(X&&k&&m){var q=H?!1:!0;H=w,G=t,a=x,Y=a?a._zoom?a._zoom:1:1,L=P,D=S;var N=k,n=m;if(Br()){var f,v,p;0===H[od]?Br[0]&&(f=!0):f=!0,H.texureImage2D?Br[1]&&(v=!0):v=!0,H.texureImage3D?Br[2]&&(p=!0):p=!0,f&&v&&p&&(N=u,n=y)}if(X.tagName)return Kl(B)&&!R[B]||H.drawImage(X,N,n,k,m),q&&h(),void 0;if(F(X,"visible")===!1)return q&&h(),void 0;L||(L=Ro(X.color,G,a)),S||(D=Ro(X.blendMode,G,a)),Kl(B)&&!R[B]&&(k=N,m=n);var C=El(X,G,a,k),E=tj(X,G,a,m),i={x:0,y:0,width:C,height:E,fitSize:F(X,"fitSize")},Q=F(X,"clip"),d=F(X,"opacity");if(i.fitSize){var O=i.rw=Ro(X.width,G,a)||20;i.widthScale=C/O;var W=i.rh=Ro(X.height,G,a)||20;i.heightScale=E/W}if(H.save(),H.interactiveInfo){var I=H.interactiveInfo.matrix,c=I.clone();I.appendTranslate(N,n).appendScale(k/C,m/E)}Zd(H,N,n),(C!==k||E!==m)&&H.scale(k/C,m/E),Q&&(Ym(Q)?Q(H,C,E,G,a,X):(H.beginPath(),H.rect(0,0,C,E),H.clip())),d!=s&&(H.globalAlpha*=d),F(X,"comps").forEach(function(f){if(F(f,Gj)!==!1){if(Pk.splice(0,0,f),f.prefix){var u=Ci,K=Ro(f.prefix,G,a);K&&(Ci=Ci+K+".")}if(H.interactiveInfo)var O=H.interactiveInfo.matrix.clone();var I=F(f,"opacity"),N=F(f,"shadow"),h=F(f,"type"),S=J(f,i);if(I!=s){var X=H.globalAlpha;H.globalAlpha*=I}if(N){var g=H.shadowOffsetX,L=H.shadowOffsetY,n=H.shadowBlur,c=H.shadowColor,d=F(f,"shadowOffsetX"),_=F(f,"shadowOffsetY"),p=F(f,"shadowBlur"),b=e(f,"shadowColor");H.shadowOffsetX=(d==s?3:d)*Y,H.shadowOffsetY=(_==s?3:_)*Y,H.shadowBlur=(p==s?6:p)*Y,H.shadowColor=b||e(Rd)}if("save"===h)H.save();else if("endClip"===h||"restore"===h)H.restore();else if("clip"===h)H.save(),wk(H,F(f,"points",U),F(f,"segments",j),!0),H.clip();else if(Cn[h])S=S||{x:0,y:0,width:i.width,height:i.height},A(f,h,S,i);else if(h===jf)A(f,h,S,i);else if("SVGPath"===h)o(f,h,S);else{S=S||{x:0,y:0,width:i.width,height:i.height};var R=F(f,Nc),t=F(f,"scaleX"),P=F(f,"scaleY"),D=V(f),E=T(f,S,S,R,t,P,D);if(Ym(h))Z(f,h),l.drawCompType(h,H,S,f,G,a);else if(l.getCompType(h)){var W=l.getCompType(h),C=W.func||W;Z(f,W),l.drawCompType(C,H,S,f,G,a)}else M[h]?M[h](f,S):l.getCompType(h)===r&&Pd.test(h)&&Oj(h);E&&z()}N&&(H.shadowOffsetX=g,H.shadowOffsetY=L,H.shadowBlur=n,H.shadowColor=c),I!=s&&(H.globalAlpha=X),H.interactiveInfo&&(H.interactiveInfo.matrix=O),f.prefix&&(Ci=u),Pk.splice(0,1)}}),H.interactiveInfo&&(H.interactiveInfo.matrix=c),H.restore(),q&&h()}}}();l.getCurrentComp=function(){return Pk[0]},l.getParentComp=function(){return Pk[1]},l.getInternal=function(){return{isEnter:$k,isEsc:vq,isSpace:Ln,isLeft:Dp,isUp:ri,isRight:Wc,isDown:tr,addMethod:Kk,superCall:jj,toPointsArray:Wp,translateAndScale:ze,appendArray:ff,createWorldMatrix:zc,vec3TransformMat4:Zk,setCanvas:sf,createDiv:$b,createView:js,createCanvas:Ub,createImage:wf,initContext:An,layout:Kj,fillRect:Yl,Mat:Tk,drawBorder:Gq,isString:Kl,setBorder:ii,getPropertyValue:Tm,setPropertyValue:gf,drawVerticalLine:oq,draw3DRect:db,getPinchDist:Lr,isSameRect:Kq,getPosition:Rf,intersectionLineRect:Dn,getNodeRect:wq,getEdgeAgentPosition:zs,getImageWidth:El,getImageHeight:tj,initItemElement:us,drawPoints:wk,createG2:Bj,closePopup:ei,isH:Or,createAnim:dg,createNormalMatrix:Ie,createNormals:bg,toFloatArray:Vr,glMV:zm,batchShape:eq,createNodeMatrix:yh,getFaceInfo:$e,transformAppend:jn,drawFaceInfo:vj,to3dPointsArray:Ed,setGLDebugMode:function(p){Tl=p},cube:function(){return{vs:zk,is:Kf,uv:Sq}},ui:function(){return{DataUI:Dc,NodeUI:vr,EdgeUI:Ck,GroupUI:rq,ShapeUI:rr,GridUI:_p,Data3dUI:ip,Node3dUI:Bl,Shape3dUI:_l}},getInternalVersion:function(){return"U2FsdGVkX1/T5JhXQL++p/kl55NdhRfhfyTxSji6EpY="},getDragger:function(){return Rn},addMSMap:function(X){Kk(Lq,X)},k:E}},function(g){function n(U,V){U!=s&&(V==s&&uc!=typeof U?this._54O(U,256):this._54O(U,V))}function S(){return new n(s)}function l(K,r,k,f,Q,U){for(;--U>=0;){var W=r*this[K++]+k[f]+Q;Q=c(W/67108864),k[f++]=67108863&W}return Q}function m(h,T,H,Q,i,o){for(var g=32767&T,y=T>>15;--o>=0;){var r=32767&this[h],R=this[h++]>>15,K=y*r+R*g;r=g*r+((32767&K)<<15)+H[Q]+(1073741823&i),i=(r>>>30)+(K>>>15)+y*R+(i>>>30),H[Q++]=1073741823&r}return i}function M(G,w,Z,V,F,n){for(var i=16383&w,T=w>>14;--n>=0;){var k=16383&this[G],H=this[G++]>>14,J=T*k+H*i;k=i*k+((16383&J)<<14)+Z[V]+F,F=(k>>28)+(J>>14)+T*H,Z[V++]=268435455&k
}return F}function Z(L){return Yg.charAt(L)}function H(g,K){var b=gd[g.charCodeAt(K)];return b==s?-1:b}function h(d){for(var O=this.t-1;O>=0;--O)d[O]=this[O];d.t=this.t,d.s=this.s}function O(V){this.t=1,this.s=0>V?-1:0,V>0?this[0]=V:-1>V?this[0]=V+this.DV:this.t=0}function e(X){var y=S();return y._58O(X),y}function P(X,e){var W,m=this;if(16==e)W=4;else if(8==e)W=3;else if(256==e)W=8;else if(2==e)W=1;else if(32==e)W=5;else{if(4!=e)return m.fromRadix(X,e),void 0;W=2}m.t=0,m.s=0;for(var B=X.length,z=!1,y=0;--B>=0;){var u=8==W?255&X[B]:H(X,B);0>u?"-"==X.charAt(B)&&(z=!0):(z=!1,0==y?m[m.t++]=u:y+W>m.DB?(m[m.t-1]|=(u&(1<<m.DB-y)-1)<<y,m[m.t++]=u>>m.DB-y):m[m.t-1]|=u<<y,y+=W,y>=m.DB&&(y-=m.DB))}8==W&&0!=(128&X[0])&&(m.s=-1,y>0&&(m[m.t-1]|=(1<<m.DB-y)-1<<y)),m._57O(),z&&n.ZERO._78O(m,m)}function z(){for(var u=this,z=u.s&u.DM;u.t>0&&u[u.t-1]==z;)--u.t}function R(u){var B=this;if(B.s<0)return"-"+B._85O()[Cb](u);var N;if(16==u)N=4;else if(8==u)N=3;else if(2==u)N=1;else if(32==u)N=5;else{if(4!=u)return B.toRadix(u);N=2}var I,r=(1<<N)-1,W=!1,o="",y=B.t,z=B.DB-y*B.DB%N;if(y-->0)for(z<B.DB&&(I=B[y]>>z)>0&&(W=!0,o=Z(I));y>=0;)N>z?(I=(B[y]&(1<<z)-1)<<N-z,I|=B[--y]>>(z+=B.DB-N)):(I=B[y]>>(z-=N)&r,0>=z&&(z+=B.DB,--y)),I>0&&(W=!0),W&&(o+=Z(I));return W?o:"0"}function d(){var I=S();return n.ZERO._78O(this,I),I}function K(){return this.s<0?this._85O():this}function q(l){var c=this,W=c.s-l.s;if(0!=W)return W;var Z=c.t;if(W=Z-l.t,0!=W)return c.s<0?-W:W;for(;--Z>=0;)if(0!=(W=c[Z]-l[Z]))return W;return 0}function i(z){var Z,$=1;return 0!=(Z=z>>>16)&&(z=Z,$+=16),0!=(Z=z>>8)&&(z=Z,$+=8),0!=(Z=z>>4)&&(z=Z,$+=4),0!=(Z=z>>2)&&(z=Z,$+=2),0!=(Z=z>>1)&&(z=Z,$+=1),$}function V(){var E=this;return E.t<=0?0:E.DB*(E.t-1)+i(E[E.t-1]^E.s&E.DM)}function j(E,n){var i;for(i=this.t-1;i>=0;--i)n[i+E]=this[i];for(i=E-1;i>=0;--i)n[i]=0;n.t=this.t+E,n.s=this.s}function U(n,z){for(var g=n;g<this.t;++g)z[g-n]=this[g];z.t=t(this.t-n,0),z.s=this.s}function A(Y,U){var $,z=this,_=Y%z.DB,B=z.DB-_,V=(1<<B)-1,b=c(Y/z.DB),X=z.s<<_&z.DM;for($=z.t-1;$>=0;--$)U[$+b+1]=z[$]>>B|X,X=(z[$]&V)<<_;for($=b-1;$>=0;--$)U[$]=0;U[b]=X,U.t=z.t+b+1,U.s=z.s,U._57O()}function k(d,M){var g=this;M.s=g.s;var W=c(d/g.DB);if(W>=g.t)return M.t=0,void 0;var $=d%g.DB,l=g.DB-$,_=(1<<$)-1;M[0]=g[W]>>$;for(var S=W+1;S<g.t;++S)M[S-W-1]|=(g[S]&_)<<l,M[S-W]=g[S]>>$;$>0&&(M[g.t-W-1]|=(g.s&_)<<l),M.t=g.t-W,M._57O()}function X(J,m){for(var Y=this,e=0,s=0,X=$(J.t,Y.t);X>e;)s+=Y[e]-J[e],m[e++]=s&Y.DM,s>>=Y.DB;if(J.t<Y.t){for(s-=J.s;e<Y.t;)s+=Y[e],m[e++]=s&Y.DM,s>>=Y.DB;s+=Y.s}else{for(s+=Y.s;e<J.t;)s-=J[e],m[e++]=s&Y.DM,s>>=Y.DB;s-=J.s}m.s=0>s?-1:0,-1>s?m[e++]=Y.DV+s:s>0&&(m[e++]=s),m.t=e,m._57O()}function N(Z,k){var m=this.abs(),M=Z.abs(),z=m.t;for(k.t=z+M.t;--z>=0;)k[z]=0;for(z=0;z<M.t;++z)k[z+m.t]=m.am(0,M[z],k,z,0,m.t);k.s=0,k._57O(),this.s!=Z.s&&n.ZERO._78O(k,k)}function a(n){for(var q=this.abs(),S=n.t=2*q.t;--S>=0;)n[S]=0;for(S=0;S<q.t-1;++S){var $=q.am(S,q[S],n,2*S,0,1);(n[S+q.t]+=q.am(S+1,2*q[S],n,2*S+1,$,q.t-S-1))>=q.DV&&(n[S+q.t]-=q.DV,n[S+q.t+1]=1)}n.t>0&&(n[n.t-1]+=q.am(S,q[S],n,2*S,0,1)),n.s=0,n._57O()}function x(j,X,Q){var O=j.abs(),y=this;if(!(O.t<=0)){var d=y.abs();if(d.t<O.t)return X!=s&&X._58O(0),Q!=s&&y._77O(Q),void 0;Q==s&&(Q=S());var J=S(),P=y.s,k=j.s,z=y.DB-i(O[O.t-1]);z>0?(O._44O(z,J),d._44O(z,Q)):(O._77O(J),d._77O(Q));var p=J.t,r=J[p-1];if(0!=r){var l=r*(1<<y.F1)+(p>1?J[p-2]>>y.F2:0),A=y.FV/l,T=(1<<y.F1)/l,t=1<<y.F2,g=Q.t,M=g-p,I=X==s?S():X;for(J._59O(M,I),Q._52O(I)>=0&&(Q[Q.t++]=1,Q._78O(I,Q)),n.ONE._59O(p,I),I._78O(J,J);J.t<p;)J[J.t++]=0;for(;--M>=0;){var R=Q[--g]==r?y.DM:c(Q[g]*A+(Q[g-1]+t)*T);if((Q[g]+=J.am(0,R,Q,M,0,p))<R)for(J._59O(M,I),Q._78O(I,Q);Q[g]<--R;)Q._78O(I,Q)}X!=s&&(Q._45O(p,X),P!=k&&n.ZERO._78O(X,X)),Q.t=p,Q._57O(),z>0&&Q._46O(z,Q),0>P&&n.ZERO._78O(Q,Q)}}}function D(B){var E=S();return this.abs()._49O(B,s,E),this.s<0&&E._52O(n.ZERO)>0&&B._78O(E,E),E}function I($){this.m=$}function T(V){return V.s<0||V._52O(this.m)>=0?V.mod(this.m):V}function Y(q){return q}function J(M){M._49O(this.m,s,M)}function y(k,H,I){k._47O(H,I),this._74O(I)}function L(x,d){x._48O(d),this._74O(d)}function B(){if(this.t<1)return 0;var r=this[0];if(0==(1&r))return 0;var M=3&r;return M=15&M*(2-(15&r)*M),M=255&M*(2-(255&r)*M),M=65535&M*(2-(65535&(65535&r)*M)),M=M*(2-r*M%this.DV)%this.DV,M>0?this.DV-M:-M}function u(c){var p=this;p.m=c,p.mp=c._50O(),p.mpl=32767&p.mp,p.mph=p.mp>>15,p.um=(1<<c.DB-15)-1,p.mt2=2*c.t}function r(B){var E=S();return B.abs()._59O(this.m.t,E),E._49O(this.m,s,E),B.s<0&&E._52O(n.ZERO)>0&&this.m._78O(E,E),E}function f(i){var P=S();return i._77O(P),this._74O(P),P}function Q(i){for(var t=this;i.t<=t.mt2;)i[i.t++]=0;for(var Y=0;Y<t.m.t;++Y){var v=32767&i[Y],p=v*t.mpl+((v*t.mph+(i[Y]>>15)*t.mpl&t.um)<<15)&i.DM;for(v=Y+t.m.t,i[v]+=t.m.am(0,p,i,Y,0,t.m.t);i[v]>=i.DV;)i[v]-=i.DV,i[++v]++}i._57O(),i._45O(t.m.t,i),i._52O(t.m)>=0&&i._78O(t.m,i)}function Tm(B,f){B._48O(f),this._74O(f)}function th(D,B,L){D._47O(B,L),this._74O(L)}function wo(){return 0==(this.t>0?1&this[0]:this.s)}function of(p,U){if(p>4294967295||1>p)return n.ONE;var W=S(),N=S(),c=U._73O(this),k=i(p)-1;for(c._77O(W);--k>=0;)if(U._76O(W,N),(p&1<<k)>0)U._75O(N,c,W);else{var F=W;W=N,N=F}return U.revert(W)}function Kh(c,U){var $;return $=256>c||U._51O()?new I(U):new u(U),this.exp(c,$)}function Jh(){var U=this;if(U.s<0){if(1==U.t)return U[0]-U.DV;if(0==U.t)return-1}else{if(1==U.t)return U[0];if(0==U.t)return 0}return(U[1]&(1<<32-U.DB)-1)<<U.DB|U[0]}function Pl(U,r){return new n(U,r)}function Wf(){var A=this;A.n=s,A.e=0,A.d=s,A.p=s,A.q=s,A.dmp1=s,A.dmq1=s,A._10A=s}function Bf(b){return b._53O(this.e,this.n)}function pl(z){var f,b,B,$="",s=0;for(f=0;f<z.length&&z.charAt(f)!=we;++f)B=Of.indexOf(z.charAt(f)),0>B||(0==s?($+=Z(B>>2),b=3&B,s=1):1==s?($+=Z(b<<2|B>>4),b=15&B,s=2):2==s?($+=Z(b),$+=Z(B>>2),b=3&B,s=3):($+=Z(b<<2|B>>4),$+=Z(15&B),s=0));return 1==s&&($+=Z(b<<2)),$}function Wj(A){var Q=A.split(""),y=pl(A);return Q.forEach(function(Q){var $=Q.length;$>0&&y&&(Ao+=o(Q))}),y}function ve(Y,w){var L=Eb._4O.Util._56O(Y,"ss"),j={},b=0;return j.v=L==w,j.t=1,j.s=0>b?-1:0,Ji=j.v,b>0?j[0]=b:-1>b?j[0]=b+j.DV:j.t=0,[L,j]}function rp(A){var U=38,M=A.substring(0,U);if(M&&30==M.indexOf("05000420")){var I=["ss",A.substring(U)];return I}return[]}function _l(H,$){$=$.replace(sm,""),$=$.replace(/[ \n]+/g,"");var O=Pl($,16);if(O._55O()>this.n._55O())return 0;var A=this._37O(O),R=A[Cb](16).replace(/^1f+00/,""),_=rp(R);if(0==_.length)return!1;for(var x,i,M,Y=.5,k=Sd,U=[0,.5,.75,.875,.9375],h=[],m=[],u=[],E=p/k,T=_[1],F=ve(H,T)[0],G=0,L=0;G<U.length;G++){var C=0===G%2?0:.5;for(x=0;k>=x;x++)i=(x+C)*E,M=1-U[G],h.push(b(i)*Y*M,-Y+2*U[G]*Y,-w(i)*Y*M),m.push((x+C)/k,M)}for(G=0;G<U.length-1;G++){var B=G*(k+1),v=(G+1)*(k+1);for(x=0;k>x;x++)u.push(B+x,v+x+1,v+x,B+x,B+x+1,v+x+1)}return u.forEach(function(K){L+=K}),T==F&&L>10}var Ij,Al=0xdeadbeefcafe,En=15715070==(16777215&Al),Cb="toString",Ei="",Gd="nat",ap=function(){};G=g["D"+11182[Cb](F(2,5))];var vo=n.prototype;nf+=nj.substr(0,1);var Aj=g.navigator?g.navigator.appName:"";En&&"Microsoft Internet Explorer"==Aj?(vo.am=m,Ij=30):En&&"Netscape"!=Aj?(vo.am=l,Ij=26):(vo.am=M,Ij=28),vo.DB=Ij,vo.DM=(1<<Ij)-1,vo.DV=1<<Ij;var re=52;vo.FV=F(2,re),vo.F1=re-Ij,vo.F2=2*Ij-re;var rg,jg,Yg="0123456789abcdefghijklmnopqrstuvwxyz",gd=[],ce=function(S){return String.fromCharCode(S)};for(rg="0".charCodeAt(0),jg=0;9>=jg;++jg)gd[rg++]=jg;for(rg="a".charCodeAt(0),jg=10;36>jg;++jg)gd[rg++]=jg;for(rg="A".charCodeAt(0),jg=10;36>jg;++jg)gd[rg++]=jg;var Hd=I.prototype;Hd._73O=T,Hd.revert=Y,Hd._74O=J,Hd._75O=y,Hd._76O=L;var Oi=u.prototype;Oi._73O=r,Oi.revert=f,Oi._74O=Q,Oi._75O=th,Oi._76O=Tm,vo._77O=h,vo._58O=O,vo._54O=P,vo._57O=z,vo._59O=j,vo._45O=U,vo._44O=A,vo._46O=k,vo._78O=X,vo._47O=N,vo._48O=a,vo._49O=x,vo._50O=B,vo._51O=wo,vo.exp=of,vo.toString=R,vo._85O=d,vo.abs=K,vo._52O=q,vo._55O=V,vo.mod=D,vo._53O=Kh,n.ZERO=e(0),n.ONE=e(1),vo._86O=Jh;var $i=function(x,X){var k=this;k.isPublic=!0,typeof x!==uc?(k.n=x,k.e=X):x!=s&&X!=s&&x.length>0&&X.length>0&&(k.n=Pl(x,16),k.e=o(X,16))};rn=function(){var R,W,u=Wj(Tr),r=u.substr(0,4),X=u.substr(4,2),N=u.substr(6,2),D=1,b=!D,c=E,l=[],i=Wi.charAt(7);if(G&&(G[Cb]().indexOf(Gd)<0||G[nf][Cb]().indexOf(Gd)<0||!u?R=Eo(_f[i]):(u=new G(r-0,X-D,N-0),W=u.setHours(9),G[nf]()>W?R=Eo(_f[i]):b=!0)),u&&R&&c){for(var k in R)l.push(k);var U,T=0,F=R[l[T++]],O=R[l[T++]],Y=R[l[T++]],q=R[l[T++]],o=R[l[T++]],x=R[l[T++]],L=R[l[T++]],I=dr._27O(c);if(I&&L){U=F+O+Y+q+o+x;var v=!x||x===se;if(!v&&x)for(var p,_=0,M=x.length;M>_;_++)x[_]===Tn[T]?p===se?v=!0:p=s:(p==s?p=x[_]:p+=x[_],_===M-1&&p===se&&(v=!0));U&&I._31O(U,L)&&v&&(!o||G[nf]()<o)&&(b=!0)}}return b||(Uk=ys),i};var Rk=Wf.prototype;Rk._37O=Bf,Rk._38O=$i;var Of="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",we="=",fs=25,Ap=10,Tr="IBkDJQ==",sd=sd||function(r,y){var k={},m=k._7A={},x=m._6A=function(){function z(){}return{_80O:function(Y){z.prototype=this;var n=new z;return Y&&n._5A(Y),n.hasOwnProperty("_82O")||(n._82O=function(){n.$super._82O.apply(this,arguments)}),n._82O.prototype=n,n.$super=this,n},_3A:function(){var V=this._80O();return V._82O.apply(V,arguments),V},_82O:function(){},_5A:function(F){for(var Y in F)F.hasOwnProperty(Y)&&(this[Y]=F[Y]);F.hasOwnProperty(Cb)&&(this.toString=F.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),Y=m._39O=x._80O({_82O:function(r,B){r=this._84O=r||[],this._65O=B!=y?B:4*r.length},toString:function(L){return(L||g).stringify(this)},_89O:function(y){var e=this._84O,c=y._84O,j=this._65O,L=y._65O;if(this._57O(),j%4)for(var v=0;L>v;v++){var p=255&c[v>>>2]>>>24-8*(v%4);e[j+v>>>2]|=p<<24-8*((j+v)%4)}else if(c.length>65535)for(var v=0;L>v;v+=4)e[j+v>>>2]=c[v>>>2];else e.push.apply(e,c);return this._65O+=L,this},_57O:function(){var e=this._84O,$=this._65O;e[$>>>2]&=4294967295<<32-8*($%4),e.length=v($/4)},_88O:function(){var z=x._88O.call(this);return z._84O=this._84O.slice(0),z},_87O:function(S){for(var M=[],R=0;S>R;R+=4)M.push(0|4294967296*_);return new Y._82O(M,S)}}),Z=k._2A={},g=Z._69O={stringify:function(Y){var w,i=Y._84O,A=Y._65O,t=[];for(w=0;A>w;w++){var J=255&i[w>>>2]>>>24-8*(w%4);t.push((J>>>4).toString(16)),t.push((15&J).toString(16))}return t.join("")},_68O:function(t){for(var I=t.length,W=[],b=0;I>b;b+=2)W[b>>>3]|=o(t.substr(b,2),16)<<24-4*(b%8);return new Y._82O(W,I/2)}},N=Z._8A={stringify:function(g){var R,N=g._84O,n=g._65O,K=[];for(R=0;n>R;R++){var i=255&N[R>>>2]>>>24-8*(R%4);K.push(ce(i))}return K.join("")},_68O:function(H){var K,X=H.length,D=[];for(K=0;X>K;K++)D[K>>>2]|=(255&H.charCodeAt(K))<<24-8*(K%4);return new Y._82O(D,X)}},M=Z._9A={stringify:function(b){try{return decodeURIComponent(escape(N.stringify(b)))}catch(k){throw new Error("")}},_68O:function(G){return N._68O(unescape(encodeURIComponent(G)))}},P=m._32O=x._80O({_1A:function(){this._83O=new Y._82O,this._23O=0},_33O:function(T){typeof T==uc&&(T=M._68O(T)),this._83O._89O(T),this._23O+=T._65O},_25O:function(a){var u=this._83O,T=u._84O,S=u._65O,j=this._79O,O=4*j,X=S/O;X=a?v(X):t((0|X)-this._22O,0);var p=X*j,y=$(4*p,S);if(p){for(var h=0;p>h;h+=j)this._20O(T,h);var J=T.splice(0,p);u._65O-=y}return new Y._82O(J,y)},_88O:function(){var t=x._88O.call(this);return t._83O=this._83O._88O(),t},_22O:0});m._66O=P._80O({cfg:x._80O(),_82O:function(K){this.cfg=this.cfg._80O(K),this._1A()},_1A:function(){P._1A.call(this),this._34O()},_81O:function(P){return this._33O(P),this._25O(),this},_72O:function(u){u&&this._33O(u);var w=this._21O();return w},_79O:16,_26O:function(C){return function(a,j){return new C._82O(j)._72O(a)}},_19O:function(i){return function(X,k){return new w._71O._82O(i,k)._72O(X)}}});var w=k._67O={};return k}();!function(){var b=sd,f=b._7A,m=f._39O,x=f._66O,A=b._67O,w=[],$=[];!function(){function s(x){for(var V=W(x),J=2;V>=J;J++)if(!(x%J))return!1;return!0}function z(B){return 0|4294967296*(B-(0|B))}for(var g=2,Y=0;64>Y;)s(g)&&(8>Y&&(w[Y]=z(F(g,.5))),$[Y]=z(F(g,1/3)),Y++),g++}();var l=[],s=A._41O=x._80O({_34O:function(){this._64O=new m._82O(w.slice(0))},_20O:function(R,E){for(var V=this._64O._84O,K=V[0],X=V[1],t=V[2],p=V[3],c=V[4],g=V[5],k=V[6],S=V[7],D=0;64>D;D++){if(16>D)l[D]=0|R[E+D];else{var j=l[D-15],w=(j<<25|j>>>7)^(j<<14|j>>>18)^j>>>3,_=l[D-2],I=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;l[D]=w+l[D-7]+I+l[D-16]}var d=c&g^~c&k,z=K&X^K&t^X&t,i=(K<<30|K>>>2)^(K<<19|K>>>13)^(K<<10|K>>>22),H=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),u=S+H+d+$[D]+l[D],b=i+z;S=k,k=g,g=c,c=0|p+u,p=t,t=X,X=K,K=0|u+b}V[0]=0|V[0]+K,V[1]=0|V[1]+X,V[2]=0|V[2]+t,V[3]=0|V[3]+p,V[4]=0|V[4]+c,V[5]=0|V[5]+g,V[6]=0|V[6]+k,V[7]=0|V[7]+S},_21O:function(){var B=this._83O,C=B._84O,w=8*this._23O,b=8*B._65O;return C[b>>>5]|=128<<24-b%32,C[(b+64>>>9<<4)+14]=c(w/4294967296),C[(b+64>>>9<<4)+15]=w,B._65O=4*C.length,this._25O(),this._64O},_88O:function(){var f=x._88O.call(this);return f._64O=this._64O._88O(),f}});b._41O=x._26O(s),b._42O=x._19O(s)}();var sm=new RegExp("");sm.compile("[^0-9a-f]","gi"),Wf._28O=-1,Wf._29O=-2,Rk._31O=_l,Rk._63O=_l,Wf._43O=-2;var yh=new function(){var N=this;N._5O=function(n,J){if("8"!=n.substring(J+2,J+3))return 1;var h=o(n.substring(J+3,J+4));return 0==h?-1:h>0&&10>h?h+1:-2},N._13O=function(p,b){var S=N._5O(p,b);return 1>S?"":p.substring(b+2,b+2+2*S)},N._12O=function(G,J){var r=N._13O(G,J);if(""==r)return-1;var g;return g=o(r.substring(0,1))<8?new n(r,16):new n(r.substring(2),16),g._86O()},N._6O=function(G,B){var D=N._5O(G,B);return 0>D?D:B+2*(D+1)},N._11O=function(V,S){var k=N._6O(V,S),e=N._12O(V,S);return V.substring(k,k+2*e)},N._10O=function(c,S){var d=N._6O(c,S),z=N._12O(c,S);return d+2*z},N._7O=function(e,l){var c=[],v=N._6O(e,l);c.push(v);for(var D=N._12O(e,l),E=v,M=0;;){var S=N._10O(e,E);if(S==s||S-v>=2*D)break;if(M>=200)break;c.push(S),E=S,M++}return c}};if(yh._90O=ce(Ap+24),yh._91O=C+ce(Ap*Ap+8),Eb==s||!Eb)var Eb={};Eb._4O!=s&&Eb._4O||(Eb._4O={});var ag=Eb._4O;Eb._4O.Util=new function(){var W=this;W._56O=function(A){var f=new Eb._4O._3O;return f._30O(A)},W._4A=function(c){var W=new Eb._4O._3O;return W._36O(c)},W._11A=function(A){var v=new ag._3O;return v._30O(A)}},Eb._4O._3O=function(){var I=this;I._8O=function(S,M){if("ss"==S&&"cj"==M){try{I.md=sd._67O._41O._3A()}catch(u){ap(Ei)}I._24O=function(q){I.md._81O(q)},I._35O=function(D){var H=sd._2A._69O._68O(D);I.md._81O(H)},I._60O=function(){var N=I.md._72O();return N[Cb](sd._2A._69O)},I._30O=function(z){return I._24O(z),I._60O()},I._36O=function(s){return I._35O(s),I._60O()}}},I._24O=function(){ap(Ei)},I._35O=function(){ap(Ei)},I._60O=function(){ap(Ei)},I._30O=function(){ap(Ei)},I._36O=function(){ap(Ei)},I._8O("ss","cj")},wg=function(V){var G=Km[Ib[7]],i=1,Y=!1;if(_i.a!=Km[Zf])return _i.a;if(_i.forEach(function(J){i*=J}),V>i){if(G){G=G.split(yh._90O);var A=G[3],f=G[7],d=G[11],j=G[15],k=G[19],F=G[23],b=G[27],H=A+f+d+j+k+F,g=F?!1:!0;if(F){var B=F&&F.split(Lb("firefox")[3]);if(B)for(var Z=0;Z<B.length;Z++)if(Yc.indexOf(B[Z])>=0){g=!0;break}}Y=Kb()(H,b)&&g&&(!k||k>V)}Y||(Dc.prototype._42=td)}else Y=!0;return _i.a=Y,Y},fs=String.fromCharCode(fs+20);var af=function(m){return m=m.replace(sm,Ei),m=m.replace(/[ \n]+/g,Ei)},ke="30",dq="06",Qf="02",ml="03",fd=Pl,Jr=/^1f+00/,dr=function(){var P;return P={_18O:function(t){var Y=t,A=Y.replace(/\s+/g,""),E=pl(A);return E},_14O:function(J){var S=this._18O(J),c=this._15O(S);return c},_15O:function(u){var O=this._17O(u);if("2a864886f70d010101"==O._61O){var j=this._16O(O.key),f=new Wf;return f._38O(j.n,j.e),f}ap(Ei)},_16O:function(p){var h={};p.substr(0,2)!=ke&&ap(Ei);var v=yh._7O(p,0);return 2!=v.length&&ap(Ei),p.substr(v[0],2)!=Qf&&ap(Ei),h.n=yh._11O(p,v[0]),p.substr(v[1],2)!=Qf&&ap(Ei),h.e=yh._11O(p,v[1]),h},_17O:function(A){var m={};m._40O=s;var G=yh._7O(A,0);2!=G.length&&ap(Ei);var S=G[0];A.substr(S,2)!=ke&&ap(Ei);var I=yh._7O(A,S);return 2!=I.length&&ap(Ei),A.substr(I[0],2)!=dq&&ap(Ei),m._61O=yh._11O(A,I[0]),A.substr(I[1],2)==dq?m._40O=yh._11O(A,I[1]):A.substr(I[1],2)==ke&&(m._40O={},m._40O.p=yh._70O(A,I[1],[0],Qf),m._40O.q=yh._70O(A,I[1],[1],Qf),m._40O.g=yh._70O(A,I[1],[2],Qf)),A.substr(G[1],2)!=ml&&ap(Ei),m.key=yh._11O(A,G[1]).substr(2),m}},P._17O?P:s}(),ho=dr._27O=function(I){return dr._14O(I)};Kb=function(){return function(D,n){if(D&&n){n=af(n);var p=fd(n,F(2,4)),O=this;if(!O||!O.n||p._55O()>O.n._55O())return 0;var M=O._37O(p),Q=M[Cb](F(2,4)).replace(Jr,""),z=rp(Q);if(0==z.length)return!1;var R=z[0],K=z[1],m=function(L){return Eb._4O.Util._56O(L,R)},u=m(D);return K==u}}.bind(ho(E))};var Ge,Cc;return function(){var q=nh.length-Vh.length;if(q>0)for(var k=0;q>k;k++)Ge=ag.Util,Cc=af}(),Gc=function(r,a){a=Cc(a);var k=ho(_e),t=pp.length,_=2*t,S=fd(a,F(t,_)),s=k,L=!0;if(s){var o=s[zh[0]];o&&S._55O()<=o._55O()&&(L=!1)}if(L)return 0;var d=s._37O(S),g=d[Cb](F(t,_)).replace(Jr,""),C=rp(g);if(0==C.length)return!1;var q=C[0],R=C[1],U=Ge._11A(r,q);return R==U},dr}(R,H),Kk(l,{load:function(){var s={},Y=function(O){return O?"c_"+(O.sync?"1":"0")+"_"+(O.post?"1":"0")+"_"+(O.responseType||"H")+"_"+(O.mimeType||"H")+"_"+(O.data?JSON.stringify(O.data):"H"):""};return function(d,r,V){var U,H=s[d],y=Y(V);return H&&(U=H[y])?(U.push(r),void 0):(s[d]||(H=s[d]={count:0}),U=H[y]=[r],H.count++,l.xhrLoad(d,function(N){delete H[y],H.count--,H.count||delete s[d],U.forEach(function(v){v(N)})},V),void 0)}}(),asyncEach:function(f,Q,c){"function"!=typeof c&&(c=Function.prototype);var i=new Array(f.length),j=0,R=!1;f.forEach(function(Y,U){Q(Y,function(q,r){return R?void 0:q?(R=!0,c(null)):(i[U]=r,j++,j===f.length?c(i):void 0)})})},xhrLoad:function(s,g,C){var $=!1;xd(s)||($=!0,s=[s]),C=C||{},s.length;var u=C.sync,_=!!C.post,v=null;return l.asyncEach(s,function(E,n){var s=new ib;E=l.beforeLoadURL(E),E.data?n(null,E.data):(C.url=encodeURI(E),C.method=_?"POST":"GET",C.responseType?s.setResponseType(C.responseType):s.setOverrideMimeType(C.mimeType||"text/plain"),s.onload=function(){200===this.status||0===this.status?n(null,s.getResponseText()):n(!0)},s.onerror=function(){n(!0)},s.send(C))},function(D){var Q="function"==typeof g;(Q||u)&&(v=$&&D?D[0]:D,Q&&g(v))}),u?v:void 0}}),Math.sign===r&&(Math.sign=function(d){return 0>d?-1:d>0?1:+d}),I.Math={generateUUID:function(){for(var i=[],p=0;256>p;p++)i[p]=(16>p?"0":"")+p.toString(16).toUpperCase();return function(){var p=0|4294967295*Math.random(),S=0|4294967295*Math.random(),H=0|4294967295*Math.random(),G=0|4294967295*Math.random();return i[255&p]+i[255&p>>8]+i[255&p>>16]+i[255&p>>24]+"-"+i[255&S]+i[255&S>>8]+"-"+i[64|15&S>>16]+i[255&S>>24]+"-"+i[128|63&H]+i[255&H>>8]+"-"+i[255&H>>16]+i[255&H>>24]+i[255&G]+i[255&G>>8]+i[255&G>>16]+i[255&G>>24]}}(),clamp:function(K,T,q){return Math.max(T,Math.min(q,K))},generateIncreasingID:function(){var Q=0;return function(){return++Q}}()};var Am=I.Matrix=I.Math.Matrix2d=function(m,R,r,e,p){this.setFromTransform(m,R,r,e,p)},Tk=Am;Am.prototype={},Am.prototype.constructor=Am,Am.prototype.set=function(L,e,R,k,T,t){return this.a=L,this.b=e,this.c=R,this.d=k,this.tx=T,this.ty=t,this},Am.prototype.setFromTransform=function(Z,v,V,O,y){var p=this;if(Z===r)return p.a=1,p.b=0,p.c=0,p.d=1,p.tx=0,p.ty=0,void 0;Z=Z||0;var z=w(Z),x=b(Z);return O=O||1,y=y||1,p.a=x*O,p.b=z*O,p.c=-z*y,p.d=x*y,p.tx=v||0,p.ty=V||0,p},Am.prototype.apply=function(c,s){s=s||new qq;var v=c.x,n=c.y;return s.x=this.a*v+this.c*n+this.tx,s.y=this.b*v+this.d*n+this.ty,s},Am.prototype.applyInverse=function(P,C){C=C||new qq;var i=1/(this.a*this.d+this.c*-this.b),z=P.x,L=P.y;return C.x=this.d*i*z+-this.c*i*L+(this.ty*this.c-this.tx*this.d)*i,C.y=this.a*i*L+-this.b*i*z+(-this.ty*this.a+this.tx*this.b)*i,C},Am.prototype.translate=function($,K){return this.tx+=$,this.ty+=K,this},Am.prototype.scale=function(w,l){return this.a*=w,this.d*=l,this.c*=w,this.b*=l,this.tx*=w,this.ty*=l,this},Am.prototype.rotate=function(r){var b=Math.cos(r),F=Math.sin(r),e=this.a,h=this.c,A=this.tx;return this.a=e*b-this.b*F,this.b=e*F+this.b*b,this.c=h*b-this.d*F,this.d=h*F+this.d*b,this.tx=A*b-this.ty*F,this.ty=A*F+this.ty*b,this},Am.prototype.appendTranslate=function(I,a){return this.tx+=this.a*I+this.c*a,this.ty+=this.b*I+this.d*a,this},Am.prototype.appendScale=function(b,X){return this.a*=b,this.d*=X,this.c*=X,this.b*=b,this},Am.prototype.appendRotate=function(U){if(!U)return this;var l=Math.cos(U),T=Math.sin(U),V=this.a,Z=this.b;return this.a=V*l+this.c*T,this.b=Z*l+this.d*T,this.c=-V*T+this.c*l,this.d=-Z*T+this.d*l,this},Am.prototype.append=function(D){var H=this.a,$=this.b,F=this.c,E=this.d;return this.a=D.a*H+D.b*F,this.b=D.a*$+D.b*E,this.c=D.c*H+D.d*F,this.d=D.c*$+D.d*E,this.tx=D.tx*H+D.ty*F+this.tx,this.ty=D.tx*$+D.ty*E+this.ty,this},Am.prototype.setTransform=function(B,w,z,L,D,Z,N,i,X){var u,b,R,E,F,v,r,W,c,V;return F=Math.sin(N),v=Math.cos(N),r=Math.cos(X),W=Math.sin(X),c=-Math.sin(i),V=Math.cos(i),u=v*D,b=F*D,R=-F*Z,E=v*Z,this.a=r*u+W*R,this.b=r*b+W*E,this.c=c*u+V*R,this.d=c*b+V*E,this.tx=B+(z*u+L*R),this.ty=w+(z*b+L*E),this},Am.prototype.prepend=function(g){var U=this.tx;if(1!==g.a||0!==g.b||0!==g.c||1!==g.d){var F=this.a,q=this.c;this.a=F*g.a+this.b*g.c,this.b=F*g.b+this.b*g.d,this.c=q*g.a+this.d*g.c,this.d=q*g.b+this.d*g.d}return this.tx=U*g.a+this.ty*g.c+g.tx,this.ty=U*g.b+this.ty*g.d+g.ty,this},Am.prototype.transform=Am.prototype.prepend,Am.prototype.invert=function(){var C=this.a,N=this.b,B=this.c,q=this.d,Q=this.tx,A=C*q-N*B;return this.a=q/A,this.b=-N/A,this.c=-B/A,this.d=C/A,this.tx=(B*this.ty-q*Q)/A,this.ty=-(C*this.ty-N*Q)/A,this},Am.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Am.prototype.clone=function(){var e=new Am;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},Am.prototype.copy=function(y){return y.a=this.a,y.b=this.b,y.c=this.c,y.d=this.d,y.tx=this.tx,y.ty=this.ty,y},Am.prototype.tf=function(J,E){1===arguments.length&&(E=J.y,J=J.x);var Z=this;return{x:Z.a*J+Z.c*E+Z.tx,y:Z.b*J+Z.d*E+Z.ty}},Am.prototype.tfi=function(U,s){1===arguments.length&&(s=U.y,U=U.x);var w=this,X=1/(w.a*w.d+w.c*-w.b);return{x:w.d*X*U+-w.c*X*s+(w.ty*w.c-w.tx*w.d)*X,y:w.a*X*s+-w.b*X*U+(-w.ty*w.a+w.tx*w.b)*X}},Am.IDENTITY=new Am,Am.TEMP_MATRIX=new Am;var Nd=I.Math.Vector3=function(M,L,t){"object"==typeof M?this.copy(M):this.set(M,L==r?M:L,t==r?M:t)};H.assign(Nd.prototype,{set:function(M,S,C){return this.x=M,this.y=S,this.z=C,this},setScalar:function(r){return this.x=r,this.y=r,this.z=r,this},setX:function(J){return this.x=J,this},setY:function(j){return this.y=j,this},setZ:function(h){return this.z=h,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(T){return T.x===r?(this.x=T[0],this.y=T[1],this.z=T[2]):(this.x=T.x,this.y=T.y,this.z=T.z),this},add:function(E){return this.x+=E.x,this.y+=E.y,this.z+=E.z,this},addScalar:function(i){return this.x+=i,this.y+=i,this.z+=i,this},addVectors:function(u,M){return this.x=u.x+M.x,this.y=u.y+M.y,this.z=u.z+M.z,this},addScaledVector:function(N,s){return this.x+=N.x*s,this.y+=N.y*s,this.z+=N.z*s,this},sub:function(u){return this.x-=u.x,this.y-=u.y,this.z-=u.z,this},subScalar:function(X){return this.x-=X,this.y-=X,this.z-=X,this},subVectors:function(T,F){return this.x=T.x-F.x,this.y=T.y-F.y,this.z=T.z-F.z,this},multiply:function(H){return this.x*=H.x,this.y*=H.y,this.z*=H.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this},distanceTo:function(x){return Math.sqrt(this.distanceToSquared(x))},distanceToSquared:function(y){var z=this.x-y.x,M=this.y-y.y,W=this.z-y.z;return z*z+M*M+W*W},distanceToSquared2:function(d){var p=this.x-d[0],t=this.y-d[1],m=this.z-d[2];return p*p+t*t+m*m},multiplyVectors:function(f,j){return this.x=f.x*j.x,this.y=f.y*j.y,this.z=f.z*j.z,this},transformDirection:function(d){var Q=this.x,b=this.y,c=this.z,H=d.el;return this.x=H[0]*Q+H[4]*b+H[8]*c,this.y=H[1]*Q+H[5]*b+H[9]*c,this.z=H[2]*Q+H[6]*b+H[10]*c,this.normalize()},applyQuaternion:function($){var j=this.x,b=this.y,i=this.z,c=$._x,k=$._y,H=$._z,G=$._w,m=G*j+k*i-H*b,o=G*b+H*j-c*i,t=G*i+c*b-k*j,s=-c*j-k*b-H*i;return this.x=m*G+s*-c+o*-H-t*-k,this.y=o*G+s*-k+t*-c-m*-H,this.z=t*G+s*-H+m*-k-o*-c,this},applyMatrix4:function(k){var j=this.x,M=this.y,g=this.z,F=k.el,f=1/(F[3]*j+F[7]*M+F[11]*g+F[15]);return this.x=(F[0]*j+F[4]*M+F[8]*g+F[12])*f,this.y=(F[1]*j+F[5]*M+F[9]*g+F[13])*f,this.z=(F[2]*j+F[6]*M+F[10]*g+F[14])*f,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(_){return this.x*_.x+this.y*_.y+this.z*_.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var n=this.length();return n?this.multiplyScalar(1/n):this},setLength:function(u){return this.normalize().multiplyScalar(u)},fromArray:function(K,w){return w===r&&(w=0),this.x=K[w],this.y=K[w+1],this.z=K[w+2],this},toArray:function(l,J){return l===r&&(l=[0,0,0]),J===r&&(J=0),l[J]=this.x,l[J+1]=this.y,l[J+2]=this.z,l},cross:function(f){return this.crossVectors(this,f)},angleTo:function(q){var b=this.dot(q)/Math.sqrt(this.lengthSq()*q.lengthSq());return b>1||-1>b?0:Math.acos(b)},lerpVectors:function(q,U,G){return this.subVectors(U,q).multiplyScalar(G).add(q)},crossVectors:function(C,I){var r=C.x,A=C.y,O=C.z,e=I.x,_=I.y,m=I.z;return this.x=A*m-O*_,this.y=O*e-r*m,this.z=r*_-A*e,this},min:function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this.z=Math.min(this.z,u.z),this},max:function(c){return this.x=Math.max(this.x,c.x),this.y=Math.max(this.y,c.y),this.z=Math.max(this.z,c.z),this}});var qq=I.Math.Vector2=function($,o,l){"object"==typeof $&&($.x!=r?(o=$.y,$=$.x,l=$.e):(l=$[2],o=$[1],$=$[0])),this.set($||0,o||0,l)};qq.prototype={},qq.prototype.constructor=qq,H.defineProperties(qq.prototype,{width:{get:function(){return this.x},set:function(g){this.x=g}},height:{get:function(){return this.y},set:function(R){this.y=R}}}),qq.prototype.clone=function(){return new qq(this.x,this.y,this.e)},qq.prototype.copy=function(s){return this.set(s.x,s.y,s.e),this},qq.prototype.equals=function(z){return z.x===this.x&&z.y===this.y},qq.prototype.set=function(P,z,x){return this.x=P||0,this.y=z||(0!==z?this.x:0),x!=r&&(this.e=x),this},qq.prototype.setScalar=function(O){return this.x=O,this.y=O,this},qq.prototype.setX=function(D){return this.x=D||0,this},qq.prototype.setY=function(n){return this.y=n||0,this},qq.prototype.add=function(i){return this.x+=i.x,this.y+=i.y,this},qq.prototype.addVectors=function(Z,s){return this.x=Z.x+s.x,this.y=Z.y+s.y,this},qq.prototype.addScalar=function(e){return this.x+=e,this.y+=e,this},qq.prototype.addScaledVector=function(z,y){return this.x+=z.x*y,this.y+=z.y*y,this},qq.prototype.sub=function(D){return this.x-=D.x,this.y-=D.y,this},qq.prototype.subScalar=function(n){return this.x-=n,this.y-=n,this},qq.prototype.subVectors=function(w,d){return this.x=w.x-d.x,this.y=w.y-d.y,this},qq.prototype.multiply=function(C){return this.x*=C.x,this.y*=C.y,this},qq.prototype.multiplyScalar=function(A){return this.x*=A,this.y*=A,this},qq.prototype.divide=function(F){return this.x/=F.x,this.y/=F.y,this},qq.prototype.divideScalar=function(x){return this.multiplyScalar(1/x)},qq.prototype.min=function(j){return this.x=Math.min(this.x,j.x),this.y=Math.min(this.y,j.y),this},qq.prototype.max=function(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this},qq.prototype.fromArray=function(q,$){return $===r&&($=0),this.x=q[$],this.y=q[$+1],this},qq.prototype.clamp=function(b,W){return this.x=Math.max(b.x,Math.min(W.x,this.x)),this.y=Math.max(b.y,Math.min(W.y,this.y)),this},qq.prototype.clampScalar=function(){var U,O;return function(h,B){return U===r&&(U=new qq,O=new qq),U.set(h,h),O.set(B,B),this.clamp(U,O)}}(),qq.prototype.clampLength=function(r,L){var Q=this.length();return this.multiplyScalar(Math.max(r,Math.min(L,Q))/Q)},qq.prototype.dot=function(d){return this.x*d.x+this.y*d.y},qq.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},qq.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},qq.prototype.normalize=function(){return this.divideScalar(this.length())},qq.prototype.angle=function(){var B=Math.atan2(this.y,this.x);return 0>B&&(B+=2*Math.PI),B},qq.prototype.distanceTo=function(E){return Math.sqrt(this.distanceToSquared(E))},qq.prototype.distanceToSquared=function(S){var L=this.x-S.x,R=this.y-S.y;return L*L+R*R},qq.prototype.isNearEnough=function(T){return this.distanceToSquared(T)<1e-8},qq.prototype.setLength=function(q){var Z=this.length();return Z?this.multiplyScalar(q/Z):this},qq.prototype.lerp=function($,m){return this.x+=($.x-this.x)*m,this.y+=($.y-this.y)*m,this},qq.prototype.lerpVectors=function(U,$,s){return this.subVectors($,U).multiplyScalar(s).add(U)},qq.prototype.rotateAround=function(E,D){var G=E?E.x:0,Y=E?E.y:0,J=Math.cos(D),y=Math.sin(D),R=this.x-G,Z=this.y-Y;return this.x=R*J-Z*y+G,this.y=R*y+Z*J+Y,this};var jl=I.Math.Ray=function(T,C){this.origin=T!==r?T.clone():new Nd,this.direction=C!==r?C.clone():new Nd};H.assign(jl.prototype,{set:function(n,v){return this.origin.copy(n),this.direction.copy(v),this},clone:function(){return(new this.constructor).copy(this)},copy:function(Q){return this.origin.copy(Q.origin),this.direction.copy(Q.direction),this.maxHitLen=Q.maxHitLen,this},at:function(t,M){var X=M||new Nd;return X.copy(this.direction).multiplyScalar(t).add(this.origin)},setMaxHitLength:function(S){this.maxHitLen=S},lookAt:function(Z){return this.direction.copy(Z).sub(this.origin).normalize(),this},applyMatrix4:function(f){var a=this.maxHitLen;if(a){var U=this.direction.clone().multiplyScalar(a).add(this.origin);U.applyMatrix4(f)}return this.origin.applyMatrix4(f),this.direction.transformDirection(f),a&&(this.maxHitLen=this.origin.distanceTo(U)),this},intersectBox:function(x,w){var p,q,u,A,l,L,U=1/this.direction.x,V=1/this.direction.y,Y=1/this.direction.z,P=this.origin;if(U>=0?(p=(x.min.x-P.x)*U,q=(x.max.x-P.x)*U):(p=(x.max.x-P.x)*U,q=(x.min.x-P.x)*U),V>=0?(u=(x.min.y-P.y)*V,A=(x.max.y-P.y)*V):(u=(x.max.y-P.y)*V,A=(x.min.y-P.y)*V),p>A||u>q)return null;if((u>p||p!==p)&&(p=u),(q>A||q!==q)&&(q=A),Y>=0?(l=(x.min.z-P.z)*Y,L=(x.max.z-P.z)*Y):(l=(x.max.z-P.z)*Y,L=(x.min.z-P.z)*Y),p>L||l>q)return null;if((l>p||p!==p)&&(p=l),(q>L||q!==q)&&(q=L),0>q)return null;var E=p>=0?p:q,H=this.maxHitLen;return H&&E>H?null:this.at(E,w)},intersectTriangle:function(){var K=new Nd,M=new Nd,r=new Nd,J=new Nd;return function(c,y,Z,o,u){M.subVectors(y,c),r.subVectors(Z,c),J.crossVectors(M,r);var d,Y=this.direction.dot(J);if(Y>0){if(o)return null;d=1}else{if(!(0>Y))return null;d=-1,Y=-Y}K.subVectors(this.origin,c);var $=d*this.direction.dot(r.crossVectors(K,r));if(0>$)return null;var n=d*this.direction.dot(M.cross(K));if(0>n||$+n>Y)return null;var G=-d*K.dot(J);if(0>G)return null;var C=G/Y,E=this.maxHitLen;return E&&C>E?null:this.at(C,u)}}()});var Yj=I.Math.Box3=function(l,B){this.min=l!==r?l:new Nd(1/0,1/0,1/0),this.max=B!==r?B:new Nd(-1/0,-1/0,-1/0)};H.assign(Yj.prototype,{set:function(s,j){return this.min.copy(s),this.max.copy(j),this},setFromArray:function(l){for(var C=1/0,S=1/0,Q=1/0,L=-1/0,w=-1/0,E=-1/0,I=0,Y=l.length;Y>I;I+=3){var e=l[I],_=l[I+1],y=l[I+2];C>e&&(C=e),S>_&&(S=_),Q>y&&(Q=y),e>L&&(L=e),_>w&&(w=_),y>E&&(E=y)}return this.min.set(C,S,Q),this.max.set(L,w,E),this},setFromPoints:function(O){this.makeEmpty();for(var n=0,H=O.length;H>n;n++)this.expandByPoint(O[n]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(U){return this.min.copy(U.min),this.max.copy(U.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function($){return this.min.min($),this.max.max($),this}});var rs=I.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};H.assign(rs.prototype,{set:function(i,x,I,L,f,G,V,H,S,X,k,O,W,g,z,M){var o=this.el;return o[0]=i,o[4]=x,o[8]=I,o[12]=L,o[1]=f,o[5]=G,o[9]=V,o[13]=H,o[2]=S,o[6]=X,o[10]=k,o[14]=O,o[3]=W,o[7]=g,o[11]=z,o[15]=M,this
    },clone:function(){return(new rs).fromArray(this.el)},fromArray:function(q,H){H===r&&(H=0);for(var u=this.el,X=0;16>X;X++)u[X]=q[X+H];return this},scale:function(w){var B=this.el,O=w.x,E=w.y,A=w.z;return B[0]*=O,B[4]*=E,B[8]*=A,B[1]*=O,B[5]*=E,B[9]*=A,B[2]*=O,B[6]*=E,B[10]*=A,B[3]*=O,B[7]*=E,B[11]*=A,this},makeRotationFromEuler:function(Q){var A=this.el,o=Q._x,N=Q._y,e=Q._z,q=Q._order,D=Math.cos(o),x=Math.sin(o),b=Math.cos(N),H=Math.sin(N),Y=Math.cos(e),v=Math.sin(e);if("XYZ"===q){var s=D*Y,l=D*v,w=x*Y,r=x*v;A[0]=b*Y,A[4]=-b*v,A[8]=H,A[1]=l+w*H,A[5]=s-r*H,A[9]=-x*b,A[2]=r-s*H,A[6]=w+l*H,A[10]=D*b}else if("YXZ"===q){var Z=b*Y,G=b*v,n=H*Y,z=H*v;A[0]=Z+z*x,A[4]=n*x-G,A[8]=D*H,A[1]=D*v,A[5]=D*Y,A[9]=-x,A[2]=G*x-n,A[6]=z+Z*x,A[10]=D*b}else if("ZXY"===q){var Z=b*Y,G=b*v,n=H*Y,z=H*v;A[0]=Z-z*x,A[4]=-D*v,A[8]=n+G*x,A[1]=G+n*x,A[5]=D*Y,A[9]=z-Z*x,A[2]=-D*H,A[6]=x,A[10]=D*b}else if("ZYX"===q){var s=D*Y,l=D*v,w=x*Y,r=x*v;A[0]=b*Y,A[4]=w*H-l,A[8]=s*H+r,A[1]=b*v,A[5]=r*H+s,A[9]=l*H-w,A[2]=-H,A[6]=x*b,A[10]=D*b}else if("YZX"===q){var W=D*b,B=D*H,P=x*b,T=x*H;A[0]=b*Y,A[4]=T-W*v,A[8]=P*v+B,A[1]=v,A[5]=D*Y,A[9]=-x*Y,A[2]=-H*Y,A[6]=B*v+P,A[10]=W-T*v}else if("XZY"===q){var W=D*b,B=D*H,P=x*b,T=x*H;A[0]=b*Y,A[4]=-v,A[8]=H*Y,A[1]=W*v+T,A[5]=D*Y,A[9]=B*v-P,A[2]=P*v-B,A[6]=x*Y,A[10]=T*v+W}return A[3]=0,A[7]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,this},makeRotationFromQuaternion:function(D){var e=this.el,X=D._x,i=D._y,I=D._z,k=D._w,_=X+X,p=i+i,h=I+I,u=X*_,B=X*p,M=X*h,z=i*p,R=i*h,P=I*h,W=k*_,t=k*p,T=k*h;return e[0]=1-(z+P),e[4]=B-T,e[8]=M+t,e[1]=B+T,e[5]=1-(u+P),e[9]=R-W,e[2]=M-t,e[6]=R+W,e[10]=1-(u+z),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(d){var r=this.el,B=d.el,E=B[0],U=B[1],m=B[2],y=B[3],W=B[4],G=B[5],T=B[6],O=B[7],x=B[8],X=B[9],v=B[10],C=B[11],H=B[12],R=B[13],I=B[14],$=B[15],L=X*I*O-R*v*O+R*T*C-G*I*C-X*T*$+G*v*$,D=H*v*O-x*I*O-H*T*C+W*I*C+x*T*$-W*v*$,q=x*R*O-H*X*O+H*G*C-W*R*C-x*G*$+W*X*$,p=H*X*T-x*R*T-H*G*v+W*R*v+x*G*I-W*X*I,M=E*L+U*D+m*q+y*p;if(0===M)return this.identity();var A=1/M;return r[0]=L*A,r[1]=(R*v*y-X*I*y-R*m*C+U*I*C+X*m*$-U*v*$)*A,r[2]=(G*I*y-R*T*y+R*m*O-U*I*O-G*m*$+U*T*$)*A,r[3]=(X*T*y-G*v*y-X*m*O+U*v*O+G*m*C-U*T*C)*A,r[4]=D*A,r[5]=(x*I*y-H*v*y+H*m*C-E*I*C-x*m*$+E*v*$)*A,r[6]=(H*T*y-W*I*y-H*m*O+E*I*O+W*m*$-E*T*$)*A,r[7]=(W*v*y-x*T*y+x*m*O-E*v*O-W*m*C+E*T*C)*A,r[8]=q*A,r[9]=(H*X*y-x*R*y-H*U*C+E*R*C+x*U*$-E*X*$)*A,r[10]=(W*R*y-H*G*y+H*U*O-E*R*O-W*U*$+E*G*$)*A,r[11]=(x*G*y-W*X*y-x*U*O+E*X*O+W*U*C-E*G*C)*A,r[12]=p*A,r[13]=(x*R*m-H*X*m+H*U*v-E*R*v-x*U*I+E*X*I)*A,r[14]=(H*G*m-W*R*m-H*U*T+E*R*T+W*U*I-E*G*I)*A,r[15]=(W*X*m-x*G*m+x*U*T-E*X*T-W*U*v+E*G*v)*A,this},makeRotationAxis:function(l,p){var e=Math.cos(p),h=Math.sin(p),Z=1-e,F=l.x,u=l.y,H=l.z,t=Z*F,s=Z*u;return this.set(t*F+e,t*u-h*H,t*H+h*u,0,t*u+h*H,s*u+e,s*H-h*F,0,t*H-h*u,s*H+h*F,Z*H*H+e,0,0,0,0,1),this},multiply:function(s){return this.multiplyMatrices(this,s)},premultiply:function(A){return this.multiplyMatrices(A,this)},multiplyMatrices:function(e,A){var G=e.el,D=A.el,t=this.el,q=G[0],f=G[4],X=G[8],V=G[12],g=G[1],C=G[5],Z=G[9],l=G[13],k=G[2],a=G[6],P=G[10],r=G[14],R=G[3],T=G[7],y=G[11],w=G[15],W=D[0],E=D[4],z=D[8],x=D[12],K=D[1],I=D[5],B=D[9],N=D[13],L=D[2],S=D[6],i=D[10],b=D[14],h=D[3],v=D[7],M=D[11],o=D[15];return t[0]=q*W+f*K+X*L+V*h,t[4]=q*E+f*I+X*S+V*v,t[8]=q*z+f*B+X*i+V*M,t[12]=q*x+f*N+X*b+V*o,t[1]=g*W+C*K+Z*L+l*h,t[5]=g*E+C*I+Z*S+l*v,t[9]=g*z+C*B+Z*i+l*M,t[13]=g*x+C*N+Z*b+l*o,t[2]=k*W+a*K+P*L+r*h,t[6]=k*E+a*I+P*S+r*v,t[10]=k*z+a*B+P*i+r*M,t[14]=k*x+a*N+P*b+r*o,t[3]=R*W+T*K+y*L+w*h,t[7]=R*E+T*I+y*S+w*v,t[11]=R*z+T*B+y*i+w*M,t[15]=R*x+T*N+y*b+w*o,this},lookAt:function(){var m=new Nd,k=new Nd,M=new Nd;return function(y,Q,p){var r=this.el;return M.subVectors(y,Q),0===M.lengthSq()&&(M.z=1),M.normalize(),m.crossVectors(p,M),0===m.lengthSq()&&(1===Math.abs(p.z)?M.x+=1e-4:M.z+=1e-4,M.normalize(),m.crossVectors(p,M)),m.normalize(),k.crossVectors(M,m),r[0]=m.x,r[4]=k.x,r[8]=M.x,r[1]=m.y,r[5]=k.y,r[9]=M.y,r[2]=m.z,r[6]=k.z,r[10]=M.z,this}}()});var Er=I.Math.Quaternion=function(Z,Q,O,G){this.set(Z,Q,O,G)};H.assign(Er.prototype,{set:function(c,T,a,B){var e=this;return e._x=c||0,e._y=T||0,e._z=a||0,e._w=B!==r?B:1,e},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){var l=this;return l._x=e._x,l._y=e._y,l._z=e._z,l._w=e._w,l},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var F=this.length();return 0===F?(this._x=0,this._y=0,this._z=0,this._w=1):(F=1/F,this._x=this._x*F,this._y=this._y*F,this._z=this._z*F,this._w=this._w*F),this},fromArray:function(K,F){F===r&&(F=0);var v=this;return v._x=K[F],v._y=K[F+1],v._z=K[F+2],v._w=K[F+3],this},slerp:function(q,M){if(0===M)return this;if(1===M)return this.copy(q);var A=this._x,b=this._y,P=this._z,F=this._w,k=F*q._w+A*q._x+b*q._y+P*q._z;if(0>k?(this._w=-q._w,this._x=-q._x,this._y=-q._y,this._z=-q._z,k=-k):this.copy(q),k>=1)return this._w=F,this._x=A,this._y=b,this._z=P,this;var X=Math.sqrt(1-k*k);if(Math.abs(X)<.001)return this._w=.5*(F+this._w),this._x=.5*(A+this._x),this._y=.5*(b+this._y),this._z=.5*(P+this._z),this;var Z=Math.atan2(X,k),N=Math.sin((1-M)*Z)/X,j=Math.sin(M*Z)/X;return this._w=F*N+this._w*j,this._x=A*N+this._x*j,this._y=b*N+this._y*j,this._z=P*N+this._z*j,this},setFromAxisAngle:function(r,_){var M=_/2,w=Math.sin(M);return this._x=r.x*w,this._y=r.y*w,this._z=r.z*w,this._w=Math.cos(M),this},setFromEuler:function(K){var Z=K._x,D=K._y,j=K._z,M=K._order,$=Math.cos,U=Math.sin,v=$(Z/2),R=$(D/2),N=$(j/2),p=U(Z/2),I=U(D/2),O=U(j/2);return"XYZ"===M?(this._x=p*R*N+v*I*O,this._y=v*I*N-p*R*O,this._z=v*R*O+p*I*N,this._w=v*R*N-p*I*O):"YXZ"===M?(this._x=p*R*N+v*I*O,this._y=v*I*N-p*R*O,this._z=v*R*O-p*I*N,this._w=v*R*N+p*I*O):"ZXY"===M?(this._x=p*R*N-v*I*O,this._y=v*I*N+p*R*O,this._z=v*R*O+p*I*N,this._w=v*R*N-p*I*O):"ZYX"===M?(this._x=p*R*N-v*I*O,this._y=v*I*N+p*R*O,this._z=v*R*O-p*I*N,this._w=v*R*N+p*I*O):"YZX"===M?(this._x=p*R*N+v*I*O,this._y=v*I*N+p*R*O,this._z=v*R*O-p*I*N,this._w=v*R*N-p*I*O):"XZY"===M&&(this._x=p*R*N-v*I*O,this._y=v*I*N-p*R*O,this._z=v*R*O+p*I*N,this._w=v*R*N+p*I*O),this},setFromToVectors:function(){var b,p;return function(a,n){return b===r&&(b=new Nd),p=a.dot(n)+1,1e-7>p?(p=0,Math.abs(a.x)>Math.abs(a.z)?b.set(-a.y,a.x,0):b.set(0,-a.z,a.y)):b.crossVectors(a,n),this._x=b.x,this._y=b.y,this._z=b.z,this._w=p,this.normalize()}}()});var ch=I.Math.Triangle=function(c,q,v){this.a=c!==r?c:new Nd,this.b=q!==r?q:new Nd,this.c=v!==r?v:new Nd};H.assign(ch,{barycoordFromPoint:function(){var v=new Nd,n=new Nd,C=new Nd;return function(k,g,m,b,q){v.subVectors(b,g),n.subVectors(m,g),C.subVectors(k,g);var I=v.dot(v),X=v.dot(n),Z=v.dot(C),W=n.dot(n),G=n.dot(C),d=I*W-X*X,U=q||new Nd;if(0===d)return U.set(-2,-1,-1);var P=1/d,F=(W*Z-X*G)*P,O=(I*G-X*Z)*P;return U.set(1-F-O,O,F)}}()});var pf=I.Math.Euler=function(V,Y,y,w,P){this.set(V,Y,y,w,P)};pf.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],pf.DefaultOrder="XYZ",pf.ReverseOrder=function(f){return f=f[2]+f[1]+f[0],f.toUpperCase()},H.defineProperties(pf.prototype,{x:{get:function(){return this._x},set:function(M){this._x=M,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(k){this._y=k,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(w){this._z=w,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(n){this._order=n,this.onChangeCallback()}}}),H.assign(pf.prototype,{set:function(L,q,r,J,F){return xd(L)&&(F=r,J=q,r=L[2],q=L[1],L=L[0]),J?F&&(J=pf.ReverseOrder(J)):J="ZYX",this._x=L||0,this._y=q||0,this._z=r||0,this._order=J||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(J){return this._x=J._x,this._y=J._y,this._z=J._z,this._order=J._order,this.onChangeCallback(),this},setFromRotationMatrix:function(o,p,L){var s=I.Math.clamp,i=o.el||o,O=i[0],Z=i[4],H=i[8],e=i[1],D=i[5],m=i[9],G=i[2],r=i[6],W=i[10];return p=p||this._order,"XYZ"===p?(this._y=Math.asin(s(H,-1,1)),Math.abs(H)<.99999?(this._x=Math.atan2(-m,W),this._z=Math.atan2(-Z,O)):(this._x=Math.atan2(r,D),this._z=0)):"YXZ"===p?(this._x=Math.asin(-s(m,-1,1)),Math.abs(m)<.99999?(this._y=Math.atan2(H,W),this._z=Math.atan2(e,D)):(this._y=Math.atan2(-G,O),this._z=0)):"ZXY"===p?(this._x=Math.asin(s(r,-1,1)),Math.abs(r)<.99999?(this._y=Math.atan2(-G,W),this._z=Math.atan2(-Z,D)):(this._y=0,this._z=Math.atan2(e,O))):"ZYX"===p?(this._y=Math.asin(-s(G,-1,1)),Math.abs(G)<.99999?(this._x=Math.atan2(r,W),this._z=Math.atan2(e,O)):(this._x=0,this._z=Math.atan2(-Z,D))):"YZX"===p?(this._z=Math.asin(s(e,-1,1)),Math.abs(e)<.99999?(this._x=Math.atan2(-m,D),this._y=Math.atan2(-G,O)):(this._x=0,this._y=Math.atan2(H,W))):"XZY"===p?(this._z=Math.asin(-s(Z,-1,1)),Math.abs(Z)<.99999?(this._x=Math.atan2(r,D),this._y=Math.atan2(H,O)):(this._x=Math.atan2(-m,W),this._y=0)):console.warn("unsupported order: "+p),this._order=p,L!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var M=new rs;return function(K,V,X){return M.makeRotationFromQuaternion(K),this.setFromRotationMatrix(M,V,X)}}(),setFromVector3:function(q,i){return this.set(q.x,q.y,q.z,i||this._order)},reorder:function(){var Q=new Er;return function(r){return Q.setFromEuler(this),this.setFromQuaternion(Q,r)}}(),equals:function(k){return k._x===this._x&&k._y===this._y&&k._z===this._z&&k._order===this._order},fromArray:function(G){return this._x=G[0],this._y=G[1],this._z=G[2],G[3]!==r&&(this._order=G[3]),this.onChangeCallback(),this},toArray:function(k,s){return k===r&&(k=[]),s===r&&(s=0),k[s]=this._x,k[s+1]=this._y,k[s+2]=this._z,k[s+3]=this._order,k},toVector3:function(h){return h?h.set(this._x,this._y,this._z):new Nd(this._x,this._y,this._z)},onChange:function(y){return this.onChangeCallback=y,this},onChangeCallback:function(){}});var Ce=I.List=function(){this._as=[];var Z,m,U=arguments.length;if(1===U){var o=arguments[0];if(pn(o)&&(o=o._as),xd(o))for(m=o.length,Z=0;m>Z;Z++)this._as.push(o[Z]);else o!=s&&this._as.push(o)}else if(U>1)for(Z=0;U>Z;Z++)this._as.push(arguments[Z])};Lf("List",H,{forEach:function(B,i){this.each(B,i)},push:function(){for(var Z=0;Z<arguments.length;Z++)this.add(arguments[Z])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(j,B){return B===r?this._as.push(j):this._as.splice(B,0,j)},addAll:function(b){pn(b)&&(b=b._as),xd(b)?ff(this._as,b):this._as.push(b)},get:function(h){return this._as[h]},slice:function(l,I){return new Ce(this._as.slice(l,I))},remove:function(L){var G=this._as.indexOf(L);return G>=0&&G<this._as.length&&this.removeAt(G),G},removeAt:function(j){return this._as.splice(j,1)[0]},set:function(b,X){return this._as[b]=X},clear:function(){return this._as.splice(0,this._as.length)},contains:function(H){return this._as.indexOf(H)>=0},indexOf:function(u){return this._as.indexOf(u)},each:function($,X){for(var C=0,O=this._as.length;O>C;C++){var B=this._as[C];X?$.call(X,B,C,this):$(B,C,this)}},reverseEach:function(o,C){for(var i=this._as.length-1;i>=0;i--){var V=this._as[i];C?o.call(C,V):o(V)}},toArray:function(I,H){if(I){for(var E,B=[],R=0,K=this._as.length;K>R;R++)E=this._as[R],H?I.call(H,E)&&B.push(E):I(E)&&B.push(E);return B}return this._as.concat()},toList:function(R,d){if(R){for(var J,y=new Ce,r=0,j=this._as.length;j>r;r++)J=this._as[r],d?R.call(d,J)&&y.add(J):R(J)&&y.add(J);return y}return new Ce(this)},reverse:function(){this._as.reverse()},sort:function(q){return this._as.sort(q?q:Hg),this},toString:function(){return this._as.toString()}}),H.defineProperties(Ce.prototype,{length:{get:function(){return this._as.length},set:function(G){this._as.length=G}}});var nl=new Ce;Kk(nl,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:ve,each:ve,reverseEach:ve,toArray:function(){return[]},toList:function(){return new Ce},add:ak,addAll:ak,set:ak,remove:ak,removeAt:ak,clear:ak});var Wb=I.Notifier=function(){this._f=0};Lf("Notifier",H,{contains:function(g,A){if(this._ls)for(var B,s=0,t=this._ls.size();t>s;s++)if(B=this._ls.get(s),g===B.l&&A===B.s)return!0;return!1},add:function(T,H,G){var o=this,L={l:T,s:H,a:G};o._ls||(o._ls=new Ce),o._f?(o._as||(o._as=new Ce),o._as.add(L)):L.a?o._ls.add(L,0):o._ls.add(L)},remove:function(Z,x){var i=this;i._ls&&(i._f?(i._rs||(i._rs=new Ce),i._rs.add({l:Z,s:x})):i._remove(Z,x))},_remove:function(F,w){for(var O,z=this._ls,$=0,T=z.size();T>$;$++)if(O=z.get($),O.l===F&&O.s===w)return z.removeAt($),void 0},fire:function(l){var f=this,m=f._ls;if(f._b=1e4,m){++f._f;try{for(var J,M=0,W=m.size();W>M;M++)J=m.get(M),J.s?J.l.call(J.s,l):J.l(l)}finally{if(--f._f)return;if(f._rs){for(W=f._rs.size(),M=0;W>M;M++)J=f._rs.get(M),f._remove(J.l,J.s);delete f._rs}if(f._as){for(W=f._as.size(),M=0;W>M;M++)J=f._as.get(M),J.a?m.add(J,0):m.add(J);delete f._as}}}}});var re=I.Data=function(){this._id=to()};Lf("Data",H,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:s,_parent:s,_children:nl,_childMap:s,_styleMap:s,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return s},_22Q:function(){return s},s:function(W,k){var i=this;if(2===arguments.length)i.setStyle(W,k);else{if(!sk(W))return i.getStyle(W);for(var h in W)i.setStyle(h,W[h])}return i},fp:function(X,e,p,a,K){return this.firePropertyChange(X,e,p,a,K)},firePropertyChange:function(Z,u,a,S,m){if(S){if(S(u,a))return!1}else if(u===a)return!1;var K=this,s=m||{};return s.property=Z,s.oldValue=u,s.newValue=a,s.data=K,K._dataModel&&K._dataModel.handleDataPropertyChange(s),K.onPropertyChanged(s),!0},onPropertyChanged:function(M){var s=this,B=s._parent,W=M.property;if(Ig(B)){var O=s.s(ed),Y="s:ingroup"===W;(O&&Wj[W]||W===Y)&&B._81I(),(O||Y)&&B.fp("childChange",!0,!1)}qm(B)&&Wj[W]&&B.updateFromChildren()},_21I:function(y){var l=this;if(y&&l._dataModel)throw"Remove data from dataModel before adding";l._dataModel=y},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var k=0,i=this._children.toArray(),V=i.length;V>k;k++)i[k].removeFromDataModel()},getId:function(){return this._id},setId:function(p){this._id=p},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(Y,p){return this._children.toList(Y,p)},eachChild:function(m,w){this._children.each(m,w)},addChild:function(i,T){var L=this;i!==L&&(L._children===nl&&(L._children=new Ce,L._childMap={}),T>=0||(T=L._children.size()),L._childMap[i._id]||L.isDescendantOf(i)||(i._parent&&i._parent.removeChild(i),(0>T||T>L._children.size())&&(T=L._children.size()),L._children.add(i,T),L._childMap[i._id]=i,i.setParent(L),L.onChildAdded(i,T),L.fp(Mi,s,i)))},onChildAdded:function(){},removeChild:function(L){var g=this;if(g._childMap&&g._childMap[L._id]){var f=g._children.remove(L);delete g._childMap[L._id],g.fp(Mi,L,s),L.setParent(s,f),g.onChildRemoved(L,f)}},onChildRemoved:function(){},getChildAt:function(A){return this._children.get(A)},clearChildren:function(){var O=this;if(!O._children.isEmpty())for(var V=0,R=O._children.toArray(),f=R.length;f>V;V++)O.removeChild(R[V])},getParent:function(){return this._parent},setParent:function(J,V){var K=this;if(!(K._73I||K._parent===J||K===J||J&&J.isDescendantOf(K))){var Y,c=K._parent;K._parent=J,K._73I=1,c?(V==s&&(V=c.getChildren().indexOf(K)),c.removeChild(K)):K._dataModel&&V==s&&(V=K._dataModel.getRoots().indexOf(K)),J&&(J.addChild(K),Y=J.getChildren().indexOf(K)),delete K._73I,K.fp("parent",c,J,r,{oldIndex:V,newIndex:Y}),K.onParentChanged(c,J)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(w){return w?this.isDescendantOf(w)||w.isDescendantOf(this):!1},isParentOf:function(B){return B&&this._childMap?!!this._childMap[B._id]:!1},isDescendantOf:function(J){if(!J||J.isEmpty())return!1;for(var R=this._parent;R;){if(J===R)return!0;R=R._parent}return!1},getStyle:function(i,S){S===r&&(S=1);var e=this._styleMap?this._styleMap[i]:r;return e===r&&S?g[i]:e},setStyle:function(N,s){var Q=this;Q._styleMap||(Q._styleMap={});var g=Q._styleMap[N];s===r?delete Q._styleMap[N]:Q._styleMap[N]=s,Q.fp("s:"+N,g,s)&&Q.onStyleChanged(N,g,s)},onStyleChanged:function(){},iv:function(P){this.invalidate(P)},invalidate:function(v){this.fp(v||"*",!1,!0)},toString:function(){var D=this;return D._displayName||D._name||D._tag||D._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(e,t){var J=this,_=J.s(wp);_||J.s(wp,_={}),t?_[e]=t:delete _[e],J.fp(wp,s,_)},removeStyleIcon:function(F){var S=this.s(wp);if(S){var I=S[F];delete S[F],this.fp(wp,s,S)}return I},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var F,f={};for(F in this._styleMap)f[F]=1;return f},ca:function(n,G){return n=Ci+n,2===arguments.length?this.a(n,G):this.a(n)}});var hd=I.DataModel=function(){var A=this;A._datas=new Ce,A._dataMap={},A._roots=new Ce,A._rootMap={},A._fsDataMap={},A._78O={},A._36I=new Wb,A._35I=new Wb,A._serializeNotifier=new Wb,A._selectionModel=new Ge(A);var Y=A._29Q=[],I=A._scheduleCallback=function(){for(var L=Date.now(),y=0;y<Y.length;y++){var n=Y[y];n.enabled&&L-n.lastTime>n.interval&&(n.beforeAction&&n.beforeAction(),A.each(function(A){n.action(A)}),n.afterAction&&n.afterAction(),n.lastTime=L)}Y.length&&(A._30Q=R.requestAnimationFrame(I))}};Lf("DataModel",H,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:r,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:r,_init:r,_envmap:r,_postProcessingData:r,sm:function(){return this.getSelectionModel()},mm:function(l,j,e){this.addDataModelChangeListener(l,j,e)},umm:function(c,a){this.removeDataModelChangeListener(c,a)},md:function(D,d,L){this.addDataPropertyChangeListener(D,d,L)},umd:function(N,i){this.removeDataPropertyChangeListener(N,i)},mh:function(v,f,X){this.addHierarchyChangeListener(v,f,X)},umh:function(C,G){this.removeHierarchyChangeListener(C,G)},getAttrObject:function(){return this._attrObject},setAttrObject:function(k){return this._attrObject=k},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(F){return this._dataMap[F]},removeDataById:function(p){this.remove(this.getDataById(p))},toDatas:function(l,Z){return this._datas.toList(l,Z)},each:function(e,J){this._datas.each(e,J)},getDataByTag:function(z){return this._78O[z]},getTagMap:function(){return this._78O},removeDataByTag:function(p){this.remove(this.getDataByTag(p))},add:function(n,F,b){var I=this,l=n._id,G=n._tag,f=I._roots;if(I._dataMap[l])throw"'"+l+"' already exists";G!=s&&(I._78O[G]=n),I._dataMap[l]=n,b>=0?I._datas.add(n,b):I._datas.add(n),n._parent||(I._rootMap[l]=n,F>=0?f.add(n,F):f.add(n)),n.s("fullscreen")!==r&&(I._fsDataMap[l]=n),n._21I(I),I.onAdded(n),I._36I.fire({kind:"add",data:n,rootsIndex:F,datasIndex:b})},onAdded:function(){},remove:function(g,Q){if(g){var m=this,b=g._id,_=Q&&Q.keepStructure,E=Q&&Q.keepChildren,z=g.getTag();if(g._dataModel===m){this.beginTransaction(),_?m._removingData||(m._removingData=g):m.prepareRemove(g),E||g.toChildren().each(function(T){m.remove(T,Q)},m),_?m._removingData===g&&(g._parent&&g._parent.removeChild(g),delete m._removingData):g._parent&&g._parent.removeChild(g);var x=m._datas.remove(g);delete m._dataMap[b],z!=s&&delete m._78O[z];var L;m._rootMap[b]&&(delete m._rootMap[b],L=m._roots.remove(g)),m._fsDataMap[b]&&delete m._fsDataMap[b],g._21I(s),m.onRemoved(g),m._36I.fire({kind:fj,data:g,rootsIndex:L,datasIndex:x}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var G=this;if(G._datas.size()){var W=G._historyManager?this.toJSON():r;G._datas.toArray().forEach(function(w){w._21I(s)}),G._datas.clear(),G._dataMap={},G._roots.clear(),G._rootMap={},G._fsDataMap={},G._78O={},G._36I.fire({kind:Xb,json:W})}},contains:function(J){return J&&J._dataModel===this},handleDataPropertyChange:function(U){var P=this,X=U.data,K=U.property;if("parent"===K){var B=X._id,q=P._rootMap,V=P._roots;X._parent?q[B]&&(delete q[B],V.remove(X)):q[B]||(q[B]=X,V.add(X))}else if("tag"===K){var j=U.oldValue,J=U.newValue,d=P._78O;j!=s&&delete d[j],J!=s&&(d[J]=X)}else if("s:fullscreen"===K){var B=X._id,H=P._fsDataMap;U.oldValue!=s&&delete H[B],U.newValue!=s&&(H[B]=X)}this.onDataPropertyChanged(X,U),this._35I.fire(U)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(n,H,M){this._36I.add(n,H,M)},removeDataModelChangeListener:function(a,I){this._36I.remove(a,I)},addSerializeListener:function(i,H,P){this._serializeNotifier.add(i,H,P)},removeSerializeListener:function(T,N){this._serializeNotifier.remove(T,N)},fireSerializeEvent:function(Y){this._serializeNotifier.fire(Y)},addDataPropertyChangeListener:function(o,S,i){this._35I.add(o,S,i)},removeDataPropertyChangeListener:function(y,J){this._35I.remove(y,J)},_38I:function(G,A,W){this._37I&&this._37I.fire({data:G,oldIndex:A,newIndex:W})},addHierarchyChangeListener:function(x,i,e){this._37I||(this._37I=new Wb),this._37I.add(x,i,e)},removeHierarchyChangeListener:function(n,$){this._37I.remove(n,$)},getSiblings:function(U){var t=U._parent;return t?t._children:this._roots},eachByHierarchical:function(x,i,d){if(i)return this._eachByHierarchical(x,i,d);for(var w=0,j=this._roots,o=j.size();o>w;w++)if(this._eachByHierarchical(x,j.get(w),d)===!1)return!1;return!0},_eachByHierarchical:function(R,A,q){if(q){if(R.call(q,A)===!1)return!1}else if(R(A)===!1)return!1;for(var j=A.size(),w=0;j>w;w++)if(this._eachByHierarchical(R,A.getChildAt(w),q)===!1)return!1;return!0},reverseEachByHierarchical:function(I,$,G){if($)return this._reverseEachByHierarchical(I,$,G);for(var l=this._roots,h=l.size(),P=h-1;P>=0;P--)if(this._reverseEachByHierarchical(I,l.get(P),G)===!1)return!1;return!0},_reverseEachByHierarchical:function(K,C,W){for(var x=C.size(),V=x-1;V>=0;V--)if(this._reverseEachByHierarchical(K,C.getChildAt(V),W)===!1)return!1;if(W){if(K.call(W,C)===!1)return!1}else if(K(C)===!1)return!1;return!0},eachByDepthFirst:function(O,y,w){if(y)return this._11I(O,y,w);for(var K=0,E=this._roots,q=E.size();q>K;K++)if(this._11I(O,E.get(K),w)===!1)return!1;return!0},_11I:function(R,Y,q){for(var C=Y.size(),f=0;C>f;f++)if(this._11I(R,Y.getChildAt(f),q)===!1)return!1;if(q){if(R.call(q,Y)===!1)return!1}else if(R(Y)===!1)return!1;return!0},eachByBreadthFirst:function(t,w,O){var C=new Ce;for(w?C.add(w):this._roots.each(C.add,C);C.size()>0;)if(w=C.removeAt(0),w.eachChild(C.add,C),O){if(t.call(O,w)===!1)return!1}else if(t(w)===!1)return!1;return!0},moveTo:function(Q,j){var n=this.getSiblings(Q),p=n.indexOf(Q);p===j||0>p||j>=0&&j<=n.size()&&(n.remove(Q),j>n.size()&&j--,n.add(Q,j),this._38I(Q,p,j))},moveUp:function(H){this.moveTo(H,this.getSiblings(H).indexOf(H)-1)},moveDown:function(W){this.moveTo(W,this.getSiblings(W).indexOf(W)+1)},moveToTop:function(e){this.moveTo(e,0)},moveToBottom:function(Z){this.moveTo(Z,this.getSiblings(Z).size())},moveSelectionUp:function(r){this.beginTransaction(),r||(r=this.sm());var L=new Ce;Vn(r,L,this._roots),L.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(G){this.beginTransaction(),G||(G=this.sm());var g=new Ce;zo(G,g,this._roots),g.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(O){this.beginTransaction(),O||(O=this.sm());var y=new Ce;hf(O,y,this._roots),y.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(E){this.beginTransaction(),E||(E=this.sm());var h=new Ce;Dk(E,h,this._roots),h.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(N,L,H){var $=this.getDatas();null==H&&(H=$.indexOf(N)),H===L||0>H||L>=0&&L<=$.size()&&($.remove(N),L>$.size()&&L--,$.add(N,L),this._76I(N,H,L))},bringForward:function(i){this.moveToIndex(i,this.getDatas().indexOf(i)+1)},bringToFront:function(D){this.moveToIndex(D,this.size())},sendBackward:function(D){this.moveToIndex(D,this.getDatas().indexOf(D)-1)},sendToBack:function(L){this.moveToIndex(L,0)},bringSelectionForward:function(w){this.beginTransaction(),w||(w=this.sm());for(var E=new Ce,T=this.getDatas(),G=!1,F=0;F<T.size();F++){var Y=T.get(T.size()-1-F);w.contains(Y)?G&&E.add(Y):G=!0}E.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(m){this.beginTransaction(),m||(m=this.sm());for(var x=new Ce,$=this.getDatas(),j=0;j<$.size();j++){var o=$.get(j);m.contains(o)&&x.add(o)}x.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(s){this.beginTransaction(),s||(s=this.sm());for(var L=new Ce,q=this.getDatas(),Q=!1,o=0;o<q.size();o++){var R=q.get(o);s.contains(R)?Q&&L.add(R):Q=!0}L.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(L){this.beginTransaction(),L||(L=this.sm());for(var B=new Ce,P=this.getDatas(),v=0;v<P.size();v++){var e=P.get(P.size()-1-v);L.contains(e)&&B.add(e)}B.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(W){var N=this;N.removeScheduleTask(W),W.enabled==s&&(W.enabled=!0),W.interval==s&&(W.interval=10),W.action==s&&(W.action=ve),W.lastTime=Date.now(),N._29Q.push(W),N._30Q==s&&(N._30Q=R.requestAnimationFrame(N._scheduleCallback))},removeScheduleTask:function(T){var W=this,f=W._29Q,z=f.indexOf(T);z>=0&&f.splice(z,1),f.length||W._30Q==s||(R.cancelAnimationFrame(W._30Q),delete W._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(f){this._historyManager||new I.HistoryManager(this),null!=f&&this._historyManager.setMaxHistoryCount(f),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(U){this._historyManager&&this._historyManager.undo(U)},redo:function(p){this._historyManager&&this._historyManager.redo(p)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(O){this._historyManager&&this._historyManager.addHistory(O)},onHistoryManagerChanged:function(){}});var Ge=I.SelectionModel=function(S){var d=this;d._68O=Ij,d._map={},d._73O=new Ce,d._74I=new Wb,d._21I(S)};Lf("SelectionModel",H,{ms_fire:1,ms_dm:1,ms:function(k,M,L){this.addSelectionChangeListener(k,M,L)},ums:function(N,Q){this.removeSelectionChangeListener(N,Q)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Tc},co:function(t){return this._map[t._id]!=s},ss:function(u){this.setSelection(u)},as:function(B){this.appendSelection(B)},rs:function(N){this.removeSelection(N)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(P){var A=this;if(A._68O!==P&&(P===zh||P===Tc||P===Ij)){A.cs();var C=A._68O;A._68O=P,A.fp("selectionMode",C,P)}},_21I:function(v){var F=this,p=F._dataModel;p!==v&&(p&&(F.cs(),p.umm(F.handleDataModelChange,F)),F._dataModel=v,v.mm(F.handleDataModelChange,F,!0),F.fp(oo,p,v))},dispose:function(){var J=this;J.cs(),J._dataModel.umm(J.handleDataModelChange,J)},handleDataModelChange:function(F){var e=this;if(F.kind===fj){var P=F.data;e.co(P)&&(e._73O.remove(P),delete e._map[P._id],e._75I(fj,new Ce(P)))}else F.kind===Xb&&e.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(D){var k=this;if(k._filterFunc!==D){k.cs();var z=k._filterFunc;k._filterFunc=D,k.fp("filterFunc",z,k._filterFunc)}},_75I:function(X,d,I,q){I&&(this._73O.each(function(H){q[H._id]?I.remove(H):I.add(H)}),d=I.toList()),this._74I.fire({kind:X,datas:new Ce(d)})},addSelectionChangeListener:function(a,N,U){this._74I.add(a,N,U)},removeSelectionChangeListener:function(f,d){this._74I.remove(f,d)},_97O:function(V,Z){for(var w,P=this,o=0,X=new Ce(V);o<X.size();o++)w=X.get(o),(P._filterFunc&&!P._filterFunc(w)||Z&&P.co(w)||!Z&&!P.co(w)||!P._dataModel.contains(w))&&(X.removeAt(o),o--);return X},appendSelection:function(q){var h=this;if(h._68O!==zh){var F,i,w=h._73O,n=h._97O(q,!0);n.isEmpty()||(h.sg()&&(F=new Ce(w),i=h._map,w.clear(),h._map={},n=new Ce(n.get(n.size()-1))),n.each(function(B){w.add(B),h._map[B._id]=B}),h._75I("append",n,F,i))}},removeSelection:function(J){var n=this,p=n._97O(J),B=0,D=p.size();if(0!==D){for(;D>B;B++){var V=p.get(B);n._73O.remove(V),delete n._map[V._id]}n._75I(fj,p)}},toSelection:function(c,R){return this._73O.toList(c,R)},getSelection:function(){return this._73O},each:function(T,H){this._73O.each(T,H)},setSelection:function(f){var H=this,w=H._73O;if(H._68O!==zh&&!(w.isEmpty()&&!f||1===w.size()&&H.ld()===f)){var m=new Ce(w),U=H._map;w.clear(),H._map={};var l=H._97O(f,!0);H.sg()&&l.size()>1&&(l=new Ce(l.get(l.size()-1))),l.each(function(U){w.add(U),H._map[U._id]=U}),H._75I("set",s,m,U)}},clearSelection:function(){var v=this,$=v._73O;if($.size()>0){var T=$.toList();$.clear(),v._map={},v._75I(Xb,T)}},selectAll:function(){var z=this;if(z._68O!==zh){var m,d,Q=z._dataModel.toDatas();if(z._filterFunc)for(m=0;m<Q.size();m++)d=Q.get(m),z._filterFunc(d)||(Q.removeAt(m),m--);var k=z._73O,t=new Ce(k),c=z._map;k.clear(),z._map={},z.sg()&&Q.size()>1&&(Q=new Ce(Q.get(Q.size()-1)));var b=Q.size();for(m=0;b>m;m++)d=Q.get(m),k.add(d),z._map[d._id]=d;z._75I("all",s,t,c)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(R){return this._map[R._id]!=s},getLastData:function(){var d=this._73O;return d.size()>0?d.get(d.size()-1):s},getFirstData:function(){var H=this._73O;return H.size()>0?H.get(0):s},isSelectable:function(C){var G=this;return C&&G._68O!==zh?G._filterFunc?G._filterFunc(C):!0:!1},getTopSelection:function(){var t=this,G=new Ce;return t._73O.each(function(p){for(var P=p.getParent();P;){if(t.contains(P)){p=s;break}P=P.parent}p&&G.add(p)}),G}});var wq=function(){return ar(0),function(i,P){var S;if(Rm(P)){var O=i.getDataUI(P);O&&O._88I&&(S=O._88I.rect)}return S?S:P.getRect()}}();Kk(l,{edgeGroupAgentFunc:s,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:h.rectSelectBorder,graphViewRectSelectBackground:di,graphViewEditPointSize:Ch?17:7,graphViewEditPointBorderColor:h.editPointBorder,graphViewEditPointBackground:h.editPointBackground,setEdgeType:function(W,e,k){Ho[W]=e,mb[W]=k},getEdgeType:function(T){return Ho[T]},getEdgeTypeMap:function(){return Ho},getNodeRect:wq},!0),Kk(g,{"layout.h":r,"layout.v":r,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":r,interactive:!1,"image.stretch":"fill",icons:r,ingroup:!0,"body.color":r,"2d.gray":!1,fullscreen:r,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:r,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Rd,"select.width":1,"select.padding":2,"select.type":Dj,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":r,"border.width":2,"border.padding":2,"border.type":Dj,label:r,"label.font":r,"label.color":Xj,"label.background":r,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":r,"label.max":r,"label.opacity":r,"label.scale":1,"label.align":r,"label.selectable":!0,label2:r,"label2.font":r,"label2.color":Xj,"label2.background":r,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":r,"label2.max":r,"label2.opacity":r,"label2.scale":1,"label2.align":r,"label2.selectable":!0,note:r,"note.expanded":!0,"note.font":r,"note.color":Ir,"note.background":Rd,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":r,"note.toggleable":!0,"note.border.width":1,"note.border.color":r,"note.opacity":r,"note.scale":1,"note.align":r,note2:r,"note2.expanded":!0,"note2.font":r,"note2.color":Ir,"note2.background":Rd,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":r,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":r,"note2.opacity":r,"note2.scale":1,"note2.align":r,"group.type":r,"group.image":r,"group.image.stretch":"fill","group.repeat.image":r,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":r,"group.title.color":Ir,"group.title.background":h.groupTitleBackground,"group.title.align":Ih,"group.title.orientation":ns,"group.background":h.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":r,"group.border.color":$i,"group.border.radius":0,"group.border.cap":fo,"group.border.join":cn,"group.splitLine":!1,"group.gradient":s,"group.gradient.color":"#FFF",shape:r,"shape.background":$i,"shape.repeat.image":r,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":$i,"shape.border.3d":!1,"shape.border.3d.color":r,"shape.border.3d.accuracy":r,"shape.border.cap":fo,"shape.border.join":cn,"shape.border.pattern":r,"shape.gradient":s,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":mr,"shape.dash.offset":0,"shape.dash.color":ke,"shape.dash.width":r,"shape.dash.3d":!1,"shape.dash.3d.color":r,"shape.dash.3d.accuracy":r,"shape.polygon.side":6,"shape.arc.from":M,"shape.arc.to":p,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":r,"shape.gradient.pack":r,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":r,"shape.foreground.gradient":s,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":r,"autolayout.hgap":r,"autolayout.vgap":r,"edge.type":r,"edge.points":r,"edge.segments":r,"edge.color":$i,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":r,"edge.3d.accuracy":r,"edge.cap":fo,"edge.join":cn,"edge.source.position":17,"edge.source.anchor.x":r,"edge.source.anchor.y":r,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":r,"edge.target.anchor.y":r,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":r,"edge.dash":!1,"edge.dash.pattern":mr,"edge.dash.offset":0,"edge.dash.color":ke,"edge.dash.width":r,"edge.dash.3d":!1,"edge.dash.3d.color":r,"edge.dash.3d.accuracy":r,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":r,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":r,"grid.column.percents":r,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":h.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":h.gridCellBorderColor,"grid.block":r,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":h.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Xj,"text.font":bo,"text.shadow":!1,"text.shadow.color":Rd,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Kk(hd,{_76I:function(U,x,M){this._39I&&this._39I.fire({data:U,oldIndex:x,newIndex:M})
    },addIndexChangeListener:function(j,h,g){var q=this;q._39I||(q._39I=new Wb),q._39I.add(j,h,g)},removeIndexChangeListener:function(V,m){this._39I.remove(V,m)},prepareRemove:function(g){Hb(g)&&(g.setSource(s),g.setTarget(s)),g._70O&&g._70O.toList().each(this.remove,this),g._69O&&g._69O.toList().each(function(c){c.setHost(s)}),g._host&&g.setHost(s)},onAdded:function(q){this.isAutoAdjustIndex()&&this.adjustIndex(q)},onDataPropertyChanged:function(w,K){or[K.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(w)},isAdjustable:function(J){return lb(J)||Hb(J)},isAdjustedToBottom:function(F){return Ig(F)?F.isExpanded()&&yq(F):!1},adjustIndex:function(m){var W=this;this.isHierarchicalRendering()||(W.isAdjustedToBottom(m)?(W.sendToBottom(m),m.eachChild(W.adjustIndex,W)):W.sendToTop(m))},sendToTop:function(A){var n=this;if(n.contains(A)&&n.isAdjustable(A)){var T=n._datas;if(A!==T.get(n.size()-1)){var i=T.indexOf(A);T.removeAt(i),T.add(A),n._76I(A,i,n.size()-1)}if(Hb(A)){var L=A._40I;L&&!n.isAdjustedToBottom(L)&&n.sendToTop(L),L=A._41I,L&&!n.isAdjustedToBottom(L)&&n.sendToTop(L)}A._69O&&A._69O.each(function(q){q.isRelatedTo(A)||lb(A)&&q.isLoopedHostOn(A)||n.sendToTop(q)}),A.ISubGraph||(!Ig(A)||A.isExpanded())&&A._adjustChildrenToTop&&A.eachChild(function(h){Hb(h)||n.sendToTop(h)})}},sendToBottom:function(b,j){var o=this;if(b!==j&&o.contains(b)&&o.isAdjustable(b)&&(!j||o.contains(j))){var H=o._datas,S=H.remove(b),J=j?o._datas.indexOf(j):0;if(H.add(b,J),S!==J){o._76I(b,S,J);var U=b._parent;!U||U.ISubGraph||Hb(U)||o.sendToBottom(b._parent,b)}}}}),Kk(Lq,{ms_edit:function(K){K._46O=function(g){var W=this,x=W.gv.dm(),P=W._index,S=W._89I,Z=W._node,K=W._shape,v=W._edge,y=W._77I;Z&&S?(this.fi({kind:"endEditRect",event:g,data:Z,direction:S}),x.endTransaction()):K&&P>=0?(W.fi({kind:"endEditPoint",event:g,data:K,index:P}),x.endTransaction()):v&&P>=0?(W.fi({kind:"endEditPoint",event:g,data:v,index:P}),x.endTransaction()):y&&(W.fi({kind:"endEditRotation",event:g,data:y}),x.endTransaction())},K._78I=function(G){var l=this;l.autoScroll(G);var V=l.gv.lp(G),i=l._index,z=l._89I,K=l._node,T=l._shape,p=l._edge,x=l._77I;if(K&&z)l._80O(V),l.fi({kind:"betweenEditRect",event:G,data:K,direction:z});else if(T&&i>=0)V.e=T.getPoints().get(i).e,T.setPoint(i,V),l.fi({kind:"betweenEditPoint",event:G,data:T,index:i});else if(p&&i>=0){var f=p.s(mi);V.e=f.get(i).e,f.set(i,V),p.fp(mi,s,f),l.fi({kind:"betweenEditPoint",event:G,data:p,index:i})}else if(x){var h=x.p(),A=x.getScale(),n=S+Z(V.y-h.y,V.x-h.x);A.y<0&&(n+=M),P(n)<.04&&(n=0),x.setRotation(n),l.fi({kind:"betweenEditRotation",event:G,data:x})}},K._80O=function(G){var L=this,a=L._node,M=L._rect,J=M.x,E=M.y,C=M.width,i=M.height,b=L._89I,p=L._anchor,H=L._matrix,G=H.tfi(G);"northwest"===b?M=Bq(G,{x:J+C,y:E+i}):b===up?M=Bq({x:J,y:G.y},{x:J+C,y:E+i}):"northeast"===b?M=Bq({x:J,y:G.y},{x:G.x,y:E+i}):b===nj?M=Bq({x:G.x,y:E},{x:J+C,y:E+i}):b===_j?M=Bq({x:J,y:E},{x:G.x,y:E+i}):"southwest"===b?M=Bq({x:G.x,y:E},{x:J+C,y:G.y}):"south"===b?M=Bq({x:J,y:E},{x:J+C,y:G.y}):"southeast"===b&&(M=Bq({x:J,y:E},G)),a.setPosition(H.tf(M.x+M.width*p.x,M.y+M.height*p.y)),a.setWidth(M.width),a.setHeight(M.height)},K._80I=function(Y,J,t,E){var m=this,x=m.gv._zoom,s=(m.gv.getEditPointSize()+2)/x;return Li({x:J-s/2,y:t-s/2,width:s,height:s},Y)?(m._89I!==E&&(m._89I=E),!0):!1},K._79I=function(x,M,p){var A=this,Q=A.gv,U=M?Q.getDataUI(M):s,i=U?U._55O:s;if(i){var y,T,B,Y,D=Q._zoom,S=(Q.getEditPointSize()+2)/D,O=Q.lp(x);if(lb(M)){if(i._56O&&lb(M)&&(T=i._98o,Li({x:T.x-S/2,y:T.y-S/2,width:S,height:S},O)))return A._77I=M,p&&A.fi({kind:"beginEditRotation",event:x,data:M}),A.setCursor("crosshair"),!0;if(i._43O&&M instanceof Dd)for(B=M.getPoints(),y=B.size()-1;y>=0;y--)if(T=B.get(y),Li({x:T.x-S/2,y:T.y-S/2,width:S,height:S},O))return A._index=y,A._shape=M,p&&A.fi({kind:"beginEditPoint",event:x,data:M,index:y}),A.setCursor("crosshair"),!0;if(i._42O)for(var J=M.getEditControlPoints(),t=["northwest",-1,-1,nj,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,_j,1,0,"northeast",1,-1,up,0,-1],y=0,Y=J.length;Y>y;y++){var $=t[3*y],m=J[y];if(A._80I(O,m.x,m.y,$)){A._node=M;var q=M.getWidth(),n=M.getHeight(),H=M.getAnchor();A._rect={x:-q*H.x,y:-n*H.y,width:q,height:n},A._anchor=H,A._matrix=M.getMatrix();var d=M.getRotation(),f=b(d),_=w(d),l=t[3*y+1]*gr(M.getScale().x),F=t[3*y+2]*gr(M.getScale().y),o=Math.atan2(-_*l-f*F,f*l-_*F),c=(Math.round(o/(Math.PI/4))+8)%8,r=[co,"nesw-resize",Wi,"nwse-resize",co,"nesw-resize",Wi,"nwse-resize"][c];return A.setCursor(r),p&&A.fi({kind:"beginEditRect",event:x,data:M,direction:A._89I}),!0}}}if(i._43O&&Hb(M)&&M.s(Cp)===Gp&&(B=M.s(mi)))for(y=B.size()-1;y>=0;y--)if(T=B.get(y),Li({x:T.x-S/2,y:T.y-S/2,width:S,height:S},O))return A._index=y,A._edge=M,p&&A.fi({kind:"beginEditPoint",event:x,data:M,index:y}),A.setCursor("crosshair"),!0}return!1}},ms_gv:function(g){g._currentSubGraph=s,g._fpsInfo={time:0,fps:0,frames:0},g.upSubGraph=function(){this.setCurrentSubGraph(rj(this._currentSubGraph))},g.isVisible=function(P){var N=this;if(rj(P)!==N._currentSubGraph)return!1;if(Hb(P)){var _=P._40I,z=P._41I;if(!_||!z)return!1;if(!(P.s("edge.independent")||N.isVisible(_)&&N.isVisible(z)))return!1;if(P.isEdgeGroupHidden())return!1}else for(var R=P._parent;R&&!R.ISubGraph;){if(Ig(R)&&(!R.isExpanded()||!N.isVisible(R)))return!1;R=R._parent}if(P._parent instanceof Ud&&!N.isVisible(P._parent))return!1;if(P._refGraph instanceof po&&!N.isVisible(P._refGraph))return!1;if(N instanceof en){if(!P.s("3d.visible"))return!1}else{var l=N.getLayersInfo();if(l){var h=l[P._layer];if(h&&h.visible===!1)return!1}if(!P.s("2d.visible"))return!1}return N._visibleFunc?N._visibleFunc(P):!0},g.handleSelectionChange=function(x){var F=this;x.datas.each(function(z){F.invalidateData(z);var f=z._parent;Ig(f)&&lb(z)&&z.s(ed)&&(F.invalidateData(f),f._49I&&f._49I.each(function(D){F.invalidateData(D)}))}),F.onSelectionChanged(x)},g.onSelectionChanged=function(b){var K=this,x=K.sm();if(1===x.size()&&("set"===b.kind||"append"===b.kind)){var q=x.ld();K.isAutoMakeVisible()&&K.makeVisible(q),K.adjustIndex&&K._dataModel.isAutoAdjustIndex()&&K.adjustIndex(q)}},g.makeVisible=function(i){if(i){var F=this,w=F.getDataUI?F.getDataUI(i):F.getData3dUI(i);if(w){var H=i,j=rj(i);for(j!==F._currentSubGraph&&F.setCurrentSubGraph(j);(H=H._parent)&&H!==j;)Ig(H)&&H.setExpanded(!0);F._23I=i,F.iv()}}},g.getLabel=function(J){var n=J.getStyle(Le);return n===r?J.getName():n},g.getLabelBackground=function(b){return b.getStyle("label.background")},g.getLabelColor=function(h){return h.getStyle("label.color")},g.getLabel2=function(V){return V.getStyle("label2")},g.getLabel2Background=function(F){return F.getStyle("label2.background")},g.getLabel2Color=function(s){return s.getStyle("label2.color")},g.getNote=function(K){return K.getStyle(Hl)},g.getNoteBackground=function(E){return E.getStyle("note.background")},g.getNote2=function(m){return m.getStyle(hc)},g.getNote2Background=function(X){return X.getStyle("note2.background")},g.handleClick=function(P,C,o){var e=this;C?(e.fi({kind:"clickData",event:P,data:C,part:o}),e.onDataClicked(C,P)):(e.fi({kind:"clickBackground",event:P}),e.onBackgroundClicked(P))},g.handleDoubleClick=function(I,H,c){var P=this;Zb(I)&&(H?(P.fi({kind:"doubleClickData",event:I,data:H,part:c}),P.onDataDoubleClicked(H,I,c),P.checkDoubleClickOnNote(I,H,c)||P.checkDoubleClickOnRotation&&P.checkDoubleClickOnRotation(I,H,c)||(Hb(H)?P.onEdgeDoubleClicked(H,I,c):H.ISubGraph?P.onSubGraphDoubleClicked(H,I,c):Ig(H)?P.onGroupDoubleClicked(H,I,c):H.IDoorWindow?P.onDoorWindowDoubleClicked(H,I,c):H.ICSGBox&&P.onCSGBoxDoubleClicked(H,I,c))):(P.fi({kind:"doubleClickBackground",event:I}),P.onBackgroundDoubleClicked(I)))},g.onSubGraphDoubleClicked=function(W){this.setCurrentSubGraph(W)},g.onEdgeDoubleClicked=function(U,M){U.ISubGraph&&!Ei(M)?this.setCurrentSubGraph(U):U.s("edge.toggleable")&&U.toggle()},g.onGroupDoubleClicked=function(t){t.s("group.toggleable")&&t.toggle()},g.onDoorWindowDoubleClicked=function(f){f.s("dw.toggleable")&&f.toggle(!0)},g.onCSGBoxDoubleClicked=function(Y,l){var U=this;if(U instanceof en){var o=U.getHitFaceInfo(l);o&&o.face&&Y.s(o.face+".toggleable")&&Y.toggleFace(o.face,!0)}},g.onBackgroundClicked=function(){},g.onBackgroundDoubleClicked=function(){this.upSubGraph()},g.onDataClicked=function(){},g.onDataDoubleClicked=function(){},g.onAutoLayoutEnded=function(){},g.onMoveEnded=function(){},g.onPanEnded=function(){},g.onPinchEnded=function(){},g.onRectSelectEnded=function(){},g.onZoomEnded=function(){},g.serialize=function(U){return this.dm().serialize(U)},g.toJSON=function(){return this.dm().toJSON()},g.deserialize=function(M,R){var N=this;R=R instanceof re?{rootParent:R}:Xp(R)?{setId:R}:Ym(R)?{finishFunc:R}:R||{},R.view=N;var w=N.dm(),J=R.finishFunc;return R.finishFunc=function(){J&&J.apply(R,arguments),Xp(w.a("zoomable"))&&N.setZoomable&&N.setZoomable(w.a("zoomable")),Xp(w.a("pannable"))&&N.setPannable&&N.setPannable(w.a("pannable")),Xp(w.a("rectSelectable"))&&N.setRectSelectable&&N.setRectSelectable(w.a("rectSelectable")),w.a("fitContent")===!0&&N.fitContent&&N.fitContent(!0,0)},w.deserialize(M,R.rootParent,R)},g.showDebugTip=function(){var f=this,e=f._debugDiv;if(!e){e=f._debugDiv=k.createElement("div"),e.style.position="absolute",e.style.overflow="hidden",e.style.backgroundColor="white",e.style.color="black";var P=f.getView();f._79O?P.insertBefore(e,f._79O):P.appendChild(e);var F=function(){f.redraw();var M="FPS : "+f._fpsInfo.fps+"<br/>"+"Datas : "+f.dm().getDatas().length,s=f.getDebugTip();s&&(M+="<br/>------<br/>"+s),e.innerHTML=M,f._isDebugging&&requestAnimationFrame(F)};requestAnimationFrame(F),f._isDebugging=!0}},g.hideDebugTip=function(){var F=this,M=F._debugDiv;M&&(delete F._debugDiv,F.getView().removeChild(M),F._isDebugging=!1)},g.countFrame=function(){if(this._isDebugging){var S=Date.now(),v=this._fpsInfo;S-v.time>1e3?(v.fps=Math.round(1e5*(v.frames+1)/(S-v.time))/100,v.time=S,v.frames=0):v.frames++}}},ms_icons:function(B){B.getRotation=function(N){return N==s?0:N},B._15O=function(){var j=this,r=j.s(wp);if(r){var p=j,v=j.data||j._data,G=j._38o={icons:r,rects:{}};for(var N in r){var n=r[N],L=Ro(n.shape3d,v,p);if(!(Ro(n.visible,v,p)===!1||Ro(n.for3d,v,p)&&!j.I3d||L&&!j.I3d)){var I=L?[L]:Ro(n.names,v,p),E=I?I.length:0,T=Ro(n.position,v,p)||3,H=Ro(n.offsetX,v,p)||0,J=Ro(n.offsetY,v,p)||0,O=Ro(n.direction,v,p)||_j,P=Ro(n.gap,v,p),M=P!=s?P:1,B=Ro(n.rotation,v,p),D=Ro(n.keepOrien,v,p),h=Ro(n.rotationFixed,v,p)?B:j.getRotation(B,D,T),z=s,x=G.rects[N]=new Array(E);x.rotation=h;for(var o=0;E>o;o++){var t,k,X,W,d=I[o];if(L)X=0,W=0;else{var _=nb(d);X=Ro(n.width,v,p),W=Ro(n.height,v,p),X==s&&(X=El(_,v)),W==s&&(W=tj(_,v))}if(z?O===_j?H+=X/2:O===nj?H-=X/2:O===up?J-=W/2:J+=W/2:z={width:X,height:W},j.I3d){var m=-X/2,c=-W/2;k={width:X,height:W,mat:j._16O(Ro(n.autorotate,v,p),T,z,Ro(n.face,v,p)||pg,Ro(n.t3,v,p),Ro(n.r3,v,p),Ro(n.rotationMode,v,p),H,J),vs:new hk([m,-c,0,m,-c-W,0,m+X,-c-W,0,m+X,-c,0])}}else t=j.getPosition(T,H,J,z,Ro(n.positionFixed,v,p)),k={x:t.x-X/2,y:t.y-W/2,width:X,height:W},j._68o(k,h);x[o]=k,O===_j?H+=X/2+M:O===nj?H-=X/2+M:O===up?J-=W/2+M:J+=W/2+M}}}}}}});var bq={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},ql={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},yn={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},or={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Wj={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Bo={"edge.type":1,"edge.group":1},xf={rotation:1,rotationX:1,rotationZ:1},zp={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Vg={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Fh={shape:1,thickness:1,position:1,anchor:1,scale:1},rj=function(I){if(!I)return s;if(Hb(I)){var i=I._40I,n=I._41I;if(!i||!n)return s;var P=rj(i),c=rj(n);return P===c?P:s}for(var m=I._parent;Hb(m)&&!m.ISubGraph;)m=m._parent;return m?m.ISubGraph?m:rj(m):s},xj=function(w,M,i,N){var K=M.getStyle(i)*N;K&&mf(w,K),K=M.getStyle(i+".left")*N,K&&(w.x-=K,w.width+=K),K=M.getStyle(i+".right")*N,K&&(w.width+=K),K=M.getStyle(i+".top")*N,K&&(w.y-=K,w.height+=K),K=M.getStyle(i+".bottom")*N,K&&(w.height+=K),w.width<0&&(w.width=-w.width,w.x-=w.width),w.height<0&&(w.height=-w.height,w.y-=w.height)},yq=function(N){for(var f,r=0,S=N.size();S>r;r++)if(f=N.getChildAt(r),lb(f)&&yq(f))return!0;return N.hasAgentEdges()},Gi=function(R){if(!R)return s;for(var y=R._parent;Ig(y);){if(!Ig(y._parent))return y.isExpanded()?R:y;y.isExpanded()||(R=y),y=y._parent}return R},hn=function(D,B){if(!D||!B)return s;var j,t,u,P=rj(D),N=rj(B);if(P!==N){for(;N&&P!==N;)N=rj(N);if(P===N)return D;j=new Ce,j.add(D,0);for(var x=D._parent;lb(x)&&!B.isDescendantOf(x);)j.add(x,0),x=x._parent;for(u=j.size(),t=0;u>t;t++){var S=j.get(t);if(Ig(S)&&!S.isExpanded())return S;if(S.ISubGraph)return S}return D}return D},_b=function(M){if(M.isLooped())return M._source;var W=Gi(M._source),i=Gi(M._target);return W===i?M._source:hn(W,i)},dr=function(i){if(i.isLooped())return i._target;var g=Gi(i._source),I=Gi(i._target);return g===I?i._target:hn(I,g)},zs=function(v,U,H,L,J,X,x){if(!U)return s;var n,Y=U.getRotation?U.getRotation():0;if(X!==r||x!==r)if(X=X===r?.5:X,x=x===r?.5:x,Y&&!Rm(U,v)){var $=U.getPosition(),G=U.getWidth(),Q=U.getHeight(),S=U.getAnchor(),a=U.getScale(),o=new Tk(Y,$.x,$.y,a.x,a.y);H=o.tf((X-S.x)*G,(x-S.y)*Q)}else n=wq(v,U),H={x:n.x+X*n.width,y:n.y+x*n.height};else H=Rf(H,wq(v,U));if(Y){var t=b(Y),O=w(Y),f=L*t-J*O;J=L*O+J*t,L=f}return H.x+=L,H.y+=J,H},ic=function(f,Q){if(!f||!Q)return s;var i,r,m,N,q,b;if(f===Q){if(N=f.getLoopedEdges(),!N)return s;N=new Ce(N)}else{if(q=f.getAgentEdges(),b=Q.getAgentEdges(),!q||!b)return s;for(r=q.size(),i=0;r>i;i++)m=q.get(i),b.contains(m)&&(N||(N=new Ce),N.add(m))}if(N)for(i=0;i<N.size();i++)m=N.get(i),m.getStyle(Cp)===Gp&&(m._22I(s),N.removeAt(i),i--);return N},Ok=function(W,j){var G=ic(W,j);if(G&&!G.isEmpty()){if(1===G.size())return G.get(0)._22I(s),void 0;var U=new Ce,m=new Ce;G.each(function(S){var K=S.s("edge.group");U.contains(K)||U.add(K)}),U.sort(),U.each(function(z){m.add(new I.EdgeGroup(G.toList(function(h){return z===h.s("edge.group")}),m))}),m.each(function(F){F.each(function(Z){Z._22I(F)})})}},lg=function(m,V){if(V){var L=V.rect,q=V.color,U=V.rotation,l=V.labelWidth,X=V.background,k=V.opacity,F=V.scale,I=F!=s&&1!==F;if(k!=s){var R=m.globalAlpha;m.globalAlpha*=k}if(U||I){m.save();var _=L.x+L.width/2,g=L.y+L.height/2;Zd(m,_,g),U&&jc(m,U),I&&m.scale(F,F),Zd(m,-_,-g)}if(X&&Yl(m,L.x,L.y,L.width,L.height,X),l){var y=L.width,x=m.createLinearGradient(L.x,L.y,L.x+y,L.y);x.addColorStop(0,q),x.addColorStop(.9,q),x.addColorStop(1,yd),q=x,L.width=l}dc(m,V.ss,L,V.font,q,V.align),l&&(L.width=y),(U||I)&&m.restore(),k!=s&&(m.globalAlpha=R)}},nr=function(t,J){if(J){var o=J.rect,V=o.x,I=o.y,u=o.width,D=o.height,_=J.background,h=J.backgroundImage,T=J.borderWidth,E=J.borderColor,B=J.labelWidth,y=J.opacity,O=J.scale,b=O!=s&&1!==O;if(y!=s){var i=t.globalAlpha;t.globalAlpha*=y}if(b){t.save();var d=o.x+o.width/2,Y=o.y+o.height/2;Zd(t,d,Y),t.scale(O,O),Zd(t,-d,-Y)}if(J.expanded){var P=$(8,u/4),e=I+D-8;if(t.fillStyle=_,t.beginPath(),t.moveTo(V,I),t.lineTo(V,e),t.lineTo(V+u/2,e),t.lineTo(V+u/2,I+D),t.lineTo(V+u/2+P,e),t.lineTo(V+u,e),t.lineTo(V+u,I),t.closePath(),t.fill(),T&&(t.lineWidth=T,t.lineJoin="round",t.lineCap="round",E?(t.strokeStyle=E,t.stroke()):(t.strokeStyle=pj(_),t.beginPath(),t.moveTo(V+u,I),t.lineTo(V+u,e),t.lineTo(V+u/2+P,e),t.lineTo(V+u/2,I+D),t.stroke(),t.strokeStyle=vn(_),t.beginPath(),t.moveTo(V+u,I),t.lineTo(V,I),t.lineTo(V,e),t.lineTo(V+u/2,e),t.lineTo(V+u/2,I+D),t.stroke())),h)Bk(t,nb(h),yk,o.x,o.y,o.width,o.height-8,J.data,J.view);else{if(o.height-=8,_=J.color,B){var c=u,r=t.createLinearGradient(V,I,V+c,I);r.addColorStop(0,_),r.addColorStop(.9,_),r.addColorStop(1,yd),_=r,o.width=B}dc(t,J.ss,o,J.font,_,J.align),B&&(o.width=c),o.height+=8}}else if(J.icon)rm(t,nb(J.icon),V,I,u,D,J.data,J.view);else{var K=u/2;T&&(t.lineWidth=T,t.lineJoin="round",t.lineCap="round",t.strokeStyle=E?E:pj(_),t.beginPath(),t.arc(V+K,I+K,K,S,1.6*M,!0),t.moveTo(V+K,I+D),t.lineTo(V+u-K/5,I+K),t.stroke(),t.strokeStyle=E?E:vn(_),t.beginPath(),t.arc(V+K,I+K,K,1.6*M,S,!0),t.moveTo(V+K,I+D),t.lineTo(V+K/5,I+K),t.stroke()),t.fillStyle=_,t.beginPath(),t.arc(V+K,I+K,K,0,p,!0),t.moveTo(V+K,I+D),t.lineTo(V+u-K/5,I+K),t.lineTo(V+K/5,I+K),t.closePath(),t.fill(),t.fillStyle=J.color,t.beginPath(),t.arc(V+K,I+K,K/3,0,p,!0),t.fill()}b&&t.restore(),y!=s&&(t.globalAlpha=i)}},nk=function(J,Z){return Z>2*J?J:Z/2},qc=function(s,g,$,C){if(!s||!g)return 0;var p=Z(g.y-s.y,g.x-s.x);return $||(p=g.x<s.x?p+M:p),p+C},_r=function(X,v,z,_,P,A,h){h&&(X.x>v.x||X.x===v.x&&X.y>v.y)&&(z=Nk[z],P=-P);var Y=Rf(z,{x:0,y:0,width:Bg(X,v),height:0},A);return Y.x+=_,Y.y+=P,Y=new Tk(Z(v.y-X.y,v.x-X.x)).tf(Y),Y.x+=X.x,Y.y+=X.y,Y},Db=function(U,g,c,E,k){if(U._19Q=!0,!c.getEdgeGroup())return E?c.s("edge.gap"):0;var Q,x=0,V=0,d=0;if(c.getEdgeGroup().getSiblings().each(function(R){R.each(function(H){if(g.isVisible(H)&&H.s(Cp)==k){var F=H.s("edge.gap");Q?(V+=d/2+F/2,d=F):(Q=H,d=F),H===c&&(x=V)}})}),E)return V-x+d;var S=x-V/2;return Q&&c._40I!==Q._40I&&(U._19Q=!1),S},Uo=function(){var w=function(k){var X=[];return k.forEach(function(w){X.push({x:w.x,y:w.y}),X.push({x:w.x+w.width,y:w.y+w.height}),X.push({x:w.x+w.width,y:w.y}),X.push({x:w.x,y:w.y+w.height})}),X};return function(I,k,r){if("oval"===I){var m=0,C=r.height/r.width,e=C*C,N=r.x+r.width/2,X=r.y+r.height/2,b=w(k);b.forEach(function(x){var L=x.x-N,E=x.y-X,R=L*L+E*E/e;R>m&&(m=R)}),m=W(m);var V=C*m;return{x:N-m,y:X-V,width:2*m,height:2*V}}if("circle"===I){var j=0,N=r.x+r.width/2,X=r.y+r.height/2,b=w(k);return b.forEach(function(G){var w=G.x-N,M=G.y-X,A=w*w+M*M;A>j&&(j=A)}),j=W(j),{x:N-j,y:X-j,width:2*j,height:2*j}}return"roundRect"===I?(mf(r,$(r.width,r.height)/16),r):r}}(),pi=I.graph={},vl=function(L,x,u){Op(C+".graph."+L,x,u)};I.layout={};var ee={},zq=function(b,o,$,G,D,L,O,f){var y=[o.uuid,Math.round(G),Math.round(D),$].join("_");o.cacheRule&&(y+=Ro(o.cacheRule,L,O));var g=O._zoom;g!==O._cacheZoom&&(O._cacheZoom=g,O._cacheImage={});var W=O._cacheImage[y];return W||(W=O._cacheImage[y]=I.Default.toCanvas(o,G*g,D*g,$,L,O,f)),W};Kk(l,{setImageCacheRule:function(h,X){var K;K=X||"object"!=typeof h?{_image:X}:h;for(var w in K){var G=K[w];Kl(w)?(Op=nb(w),Op?Op.cacheRule=G:ee[w]=G):w.cacheRule=G}}});var Pq={comps:[{type:jf,points:[85,50,70,115,100,71,86,107,88,49,56,117,89,104,65,120,70,48,66,54,52,118,88,87,88,106,88,79,108,110,77,76,102,106,51,109,78,88,75,101,79,104,99,61],borderWidth:1,borderColor:s}]};if(Pq[Lg]=Pq[cc]=160,R.Image){var ll=new R.Image;ll.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Zc("default_blank",ll)}Zc("node_image",wf(30,30,[{type:Dj,rect:[4,5,22,16],gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[2,3,26,20],borderWidth:1,borderColor:$i},{type:Dj,rect:[11,23,8,4],background:$i},{type:Dj,rect:[6,27,18,2],background:$i}])),Zc("node_icon",wf(16,16,[{type:Dj,rect:[2,2,12,10],gradient:op,gradientColor:tg,background:$i},{type:Ke,rect:[2,2,12,10],width:1,color:$i},{type:Dj,rect:[6,12,4,2],background:$i},{type:Dj,rect:[4,14,8,1],background:$i}])),Zc("block_icon",wf(16,16,[{type:Ke,rect:[1,1,14,14],width:1,color:$i}])),Zc("group_image",wf(66,39,[{type:Dj,rect:[44.3,18,18.1,12.8],gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[3.3,17.8,18.1,12.8],gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:$i,gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[26.2,29.4,12.8,4.2],background:$i},{type:Dj,rect:[21.3,33.5,22.5,2.3],background:$i},{type:Dj,rect:[5.3,32.7,14.1,2.1],background:$i},{type:Dj,rect:[9,30.4,6.7,2.4],background:$i},{type:Dj,rect:[50,30.7,6.7,2.4],background:$i},{type:Dj,rect:[46.3,33,14.1,2.1],background:$i}])),Zc("group_icon",wf(16,16,[{type:Dj,rect:[4,12,4,2],background:$i},{type:Dj,rect:[2,13,8,1],background:$i},{type:Dj,rect:[12,12,2,1],background:$i},{type:Dj,rect:[11,13,4,1],background:$i},{type:Dj,rect:[10,7,6,5],gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[1,2,10,10],gradient:op,gradientColor:tg,background:$i},{type:Ke,rect:[1,2,10,10],width:1,color:$i}])),Zc("refGraph_icon",wf(16,16,[{type:"shape",borderWidth:1,borderColor:$i,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:$i,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Zc("edge_icon",wf(16,16,[{type:Dj,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[10.8,1,4,4],background:$i},{type:Dj,rect:[1,11,4,4],background:$i}])),Zc("subGraph_image",wf(72,45,[{type:jf,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[29.6,30.7,3.6,1.8],background:$i},{type:Dj,rect:[28.4,32.3,6,1.2],background:$i},{type:Dj,rect:[37.3,32,10.8,1.8],background:$i},{type:Dj,rect:[39.1,29.9,7.2,2.3],background:$i},{type:Dj,rect:[26.6,23.7,9.6,7.2],gradient:op,gradientColor:tg,background:$i},{type:Dj,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:$i,gradient:op,gradientColor:tg,background:$i}])),Zc("subGraph_icon",wf(17,17,[{type:jf,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:op,gradientColor:tg,background:$i}])),Zc("shape_icon",wf(16,16,[{type:jf,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:$i}])),Zc("polyline_icon",wf(16,16,[{type:jf,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:$i},Yi(7.5,.4),Yi(7.5,6.3),Yi(13.6,6.3),Yi(13.6,14),Yi(.7,13.9),Yi(.7,.3)])),Zc("grid_icon",wf(16,16,[{type:Dj,rect:[1,1,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[6,1,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[11,1,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[11,6,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[6,6,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[1,6,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[11,11,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[6,11,4,4],background:$i,gradient:op,gradientColor:tg},{type:Dj,rect:[1,11,4,4],background:$i,gradient:op,gradientColor:tg}])),Zc("light_icon",wf(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:$i},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:$i,gradient:op,gradientColor:tg,background:{func:function(J){var r=J?J.s(yp):s;return xd(r)?"rgb("+o(255*r[0])+","+o(255*r[1])+","+o(255*r[2])+")":r||$i}}}])),Zc("text_icon",wf(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:$i}])),Zc("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Zc("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Zc("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Zc("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var gq=function(e,i){for(var d=e.vertices,n=0;n<d.length;n++){var s=d[n],c=s.y;s.y=s.z,s.z=-c,i&&(s.y+=i)}},Oi=function(I){for(var Q,L,M,Z,n,T,D=[],S=[],V=[],r=I.faces,t=0,H=0,b=0,s=r.length;s>t;t++,H+=6,b+=9){var z=r[t];1===z.i?(Q||(Q=[],L=[],M=[]),fp(z,t,H,b,I,Q,M,L)):2===z.i?(Z||(Z=[],n=[],T=[]),fp(z,t,H,b,I,Z,T,n)):fp(z,t,H,b,I,D,V,S)}return{vs:D,uv:S,ns:V,top_vs:Q,top_uv:L,top_ns:M,bottom_vs:Z,bottom_uv:n,bottom_ns:T}},fp=function(M,E,y,g,c,v,i,N){var O=c.vertices,Z=c.faceVertexUvs,k=O[M.a],S=O[M.b],F=O[M.c];v[g]=k.x,v[g+1]=k.y,v[g+2]=k.z,v[g+3]=S.x,v[g+4]=S.y,v[g+5]=S.z,v[g+6]=F.x,v[g+7]=F.y,v[g+8]=F.z;var f=M.vertexNormals;if(3===f.length){var b=f[0],Y=f[1],l=f[2];i[g]=b.x,i[g+1]=b.y,i[g+2]=b.z,i[g+3]=Y.x,i[g+4]=Y.y,i[g+5]=Y.z,i[g+6]=l.x,i[g+7]=l.y,i[g+8]=l.z}else{var m=M.normal;i[g]=m.x,i[g+1]=m.y,i[g+2]=m.z,i[g+3]=m.x,i[g+4]=m.y,i[g+5]=m.z,i[g+6]=m.x,i[g+7]=m.y,i[g+8]=m.z}var C=Z[0][E][0],j=Z[0][E][1],r=Z[0][E][2];N[y]=C.x,N[y+1]=C.y,N[y+2]=j.x,N[y+3]=j.y,N[y+4]=r.x,N[y+5]=r.y},es=function(C){var J=C._lineModel;if(J)return J;var P;P=xd(C)?C:[C];var M,j,s,E,p,X,b,H,L,w,l,i,R=["","top","bottom"];for(J=[],M=0,j=P.length;j>M;M++)for(L=P[M],s=0,E=R.length;E>s;s++)if(b=L[R[s]+"vs"]){H=L[R[s]+"is"],X=H?H.length:b.length/3;for(var p=0;X>p;p+=3)H?(w=H[p],l=H[p+1],i=H[p+2]):(w=p,l=p+1,i=p+2),w*=3,l*=3,i*=3,J.push(b[w],b[w+1],b[w+2],b[l],b[l+1],b[l+2],b[l],b[l+1],b[l+2],b[i],b[i+1],b[i+2],b[i],b[i+1],b[i+2],b[w],b[w+1],b[w+2])}return C._lineModel=J,J},ej=function(M,g,r,O,u,I,Z,Y,J){r==s&&(r=!0),O==s&&(O=!0),Z==s&&(Z=1),Y==s&&(Y=0);var b=new As;return wk(b,M,g,J),b=b.toShapes(),Oi(new xk(b,{top:r,bottom:O,curveSegments:u,amount:Z,repeatUVLength:I},-Z/2+Y))},yo=function(b,U){this.x=b||0,this.y=U||0};yo.prototype={constructor:yo,add:function(T){return this.x+=T.x,this.y+=T.y,this},sub:function(U){return this.x-=U.x,this.y-=U.y,this},equals:function(t){return t.x===this.x&&t.y===this.y},multiplyScalar:function(B){return this.x*=B,this.y*=B,this},distanceTo:function(t){return W(this.distanceToSquared(t))},distanceToSquared:function(p){var e=this.x-p.x,G=this.y-p.y;return e*e+G*G},clone:function(){return new yo(this.x,this.y)}};var Cs=function(X,L,u){this.x=X||0,this.y=L||0,this.z=u||0};Cs.prototype={constructor:Cs,set:function(G,p,i){return this.x=G,this.y=p,this.z=i,this},setY:function(V){return this.y=V,this},copy:function(p){return this.x=p.x,this.y=p.y,this.z=p.z,this},add:function(i){return this.x+=i.x,this.y+=i.y,this.z+=i.z,this},addVectors:function(m,F){return this.x=m.x+F.x,this.y=m.y+F.y,this.z=m.z+F.z,this},sub:function(M){return this.x-=M.x,this.y-=M.y,this.z-=M.z,this},subVectors:function(o,T){return this.x=o.x-T.x,this.y=o.y-T.y,this.z=o.z-T.z,this},multiplyScalar:function(g){return this.x*=g,this.y*=g,this.z*=g,this},applyMatrix4:function(_){var Q=this.x,$=this.y,a=this.z,R=_.elements;return this.x=R[0]*Q+R[4]*$+R[8]*a+R[12],this.y=R[1]*Q+R[5]*$+R[9]*a+R[13],this.z=R[2]*Q+R[6]*$+R[10]*a+R[14],this},divideScalar:function(_){if(0!==_){var x=1/_;this.x*=x,this.y*=x,this.z*=x}else this.x=0,this.y=0,this.z=0;return this},dot:function(A){return this.x*A.x+this.y*A.y+this.z*A.z},length:function(){return W(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(m){var f=this.x,U=this.y,I=this.z;return this.x=U*m.z-I*m.y,this.y=I*m.x-f*m.z,this.z=f*m.y-U*m.x,this},crossVectors:function(Z,e){var s=Z.x,l=Z.y,$=Z.z,X=e.x,J=e.y,D=e.z;return this.x=l*D-$*J,this.y=$*X-s*D,this.z=s*J-l*X,this},distanceTo:function(T){return W(this.distanceToSquared(T))},distanceToSquared:function(Y){var i=this.x-Y.x,r=this.y-Y.y,U=this.z-Y.z;return i*i+r*r+U*U},clone:function(){return new Cs(this.x,this.y,this.z)}};var og=function(){this.elements=new Float32Array(16)};og.prototype={constructor:og,set:function(l,n,x,V,L,R,$,b,k,E,p,D,Q,o,O,u){var G=this.elements;return G[0]=l,G[4]=n,G[8]=x,G[12]=V,G[1]=L,G[5]=R,G[9]=$,G[13]=b,G[2]=k,G[6]=E,G[10]=p,G[14]=D,G[3]=Q,G[7]=o,G[11]=O,G[15]=u,this},makeRotationAxis:function(l,z){var G=b(z),S=w(z),Y=1-G,D=l.x,f=l.y,$=l.z,T=Y*D,N=Y*f;return this.set(T*D+G,T*f-S*$,T*$+S*f,0,T*f+S*$,N*f+G,N*$-S*D,0,T*$-S*f,N*$+S*D,Y*$*$+G,0,0,0,0,1),this}};var Bs=function(X){this.repeatUVLength=X};Bs.prototype={generateTopUV:function(s,b,A,E,P,v,K){var q,I,F,z,m=s.vertices,V=m[E].x,y=m[E].y,$=m[P].x,w=m[P].y,r=m[v].x,_=m[v].y,X=this.repeatUVLength;if(X)q=0,I=0,F=X,z=X;else{this._bb||(this._bb=b.getBoundingBox());var x=this._bb;q=x.minX,I=x.minY,F=x.maxX-q,z=x.maxY-I}return K?[new yo((V-q)/F,(y-I)/z),new yo(($-q)/F,(w-I)/z),new yo((r-q)/F,(_-I)/z)]:[new yo((V-q)/F,1-(y-I)/z),new yo(($-q)/F,1-(w-I)/z),new yo((r-q)/F,1-(_-I)/z)]},generateBottomUV:function(c,K,N,T,u,w){return this.generateTopUV(c,K,N,T,u,w,!0)},generateSideWallUV:function(D,O,Q,H,t,z,T,d,V,Y,m,k){if(!this._cl){for(var s,x,$=[],Z=0,N=Q.length,K=0;N>K;K++){s=Q[K],x=Q[(K+1)%N];var G=s.x-x.x,f=s.y-x.y,g=W(G*G+f*f);$.push(Z),Z+=g}for(var K=0;N>K;K++)$[K]/=Z;this._cl=$}var $=this._cl,J=1-V/Y,p=1-(V+1)/Y,_=$[m],j=$[k];return j>_&&(_+=1),[new yo(_,J),new yo(j,J),new yo(j,p),new yo(_,p)]}};var hj=function(E,U,j,u,K,t){this.a=E,this.b=U,this.c=j,this.i=t,this.normal=u instanceof Cs?u:new Cs,this.vertexNormals=u instanceof Array?u:[]};hj.prototype={constructor:hj};var Ej=[-8,13,-2,9,-1,11,-1,2,-1],Br=function(){if(Br[Wg]!=s)return Br[Wg];for(var Q=cq[Wg],E=Ej,f=re.prototype.getClassName(),D='"',v=0,d="",L=!1,P=+new(R[f.substr(3,3)+co[v]]),K=v;K<E.length;K++){var m=E.length-K;d+=K%2===v?E[K]+m+"":E[K]-m+""}for(var K=v;4>K;K++)d+=v;if(d=d*d.length/d.length,P>d){if(Q){for(var $,c,o,x,a,l,i,r,n="",j=0,K=0;K<Q.length;K++)Q[K]===D?r?(r=!1,0!==j%2&&($==s?$=n:c==s?c=n:o==s?o=n:x==s?x=n:a==s?a=n:l==s?l=n:i==s&&(i=n)),j++,n=""):r=!0:r&&(n+=Q[K]);var z=$+c+o+x+a+l;(L=Gc(z,i)&&(!l||l.indexOf(se)>=0)&&(!a||a>P))&&o.indexOf(wi[0])>=0&&(Br[wi[0]]=1),L&&o.indexOf(1)>=0&&(Br[1]=1),L&&o.indexOf(2)>=0&&(Br[2]=1)}}else L=!0,Br[wi[0]]=Br[1]=Br[2]=1;return Br[Wg]=L,L},Tb=function(){},Dh=Tb.prototype;Dh.getPointAt=function(K){var M=this.getUtoTmapping(K);return this.getPoint(M)},Dh.getPoints=function(v){v||(v=5);var P,Z=[];for(P=0;v>=P;P++)Z.push(this.getPoint(P/v));return Z},Dh.getSpacedPoints=function(u){u||(u=5);var X,p=[];for(X=0;u>=X;X++)p.push(this.getPointAt(X/u));return p},Dh.getLength=function(){var O=this.getLengths();return O[O.length-1]},Dh.getLengths=function(Q){if(Q||(Q=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==Q+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var L,I,b=[],F=this.getPoint(0),h=0;for(b.push(0),I=1;Q>=I;I++)L=this.getPoint(I/Q),h+=L.distanceTo(F),b.push(h),F=L;
    return this.cacheArcLengths=b,b},Dh.getUtoTmapping=function(Y,d){var P,H=this.getLengths(),$=0,e=H.length;P=d?d:Y*H[e-1];for(var I,b=0,f=e-1;f>=b;)if($=c(b+(f-b)/2),I=H[$]-P,0>I)b=$+1;else{if(!(I>0)){f=$;break}f=$-1}if($=f,H[$]==P){var R=$/(e-1);return R}var D=H[$],Q=H[$+1],x=Q-D,y=(P-D)/x,R=($+y)/(e-1);return R},Dh.getTangent=function(b){var K=1e-4,$=b-K,f=b+K;0>$&&($=0),f>1&&(f=1);var l=this.getPoint($),S=this.getPoint(f),N=S.clone().sub(l);return N.normalize()},Dh.getTangentAt=function(J){var R=this.getUtoTmapping(J);return this.getTangent(R)},Tb.create=function(o,v){return o.prototype=gj(Tb.prototype),o.prototype.getPoint=v,o};var Xm=function(){this.curves=[],this.autoClose=!1},dq=Xm.prototype=gj(Dh);dq.add=function(U){this.curves.push(U)},dq.closePath=function(){var p=this.curves[0].getPoint(0),w=this.curves[this.curves.length-1].getPoint(1);p.equals(w)||this.curves.push(new ce(w,p))},dq.getPoint=function(x){for(var B,Y,o=x*this.getLength(),S=this.getCurveLengths(),K=0;K<S.length;){if(S[K]>=o){B=S[K]-o,Y=this.curves[K];var D=1-B/Y.getLength();return Y.getPointAt(D)}K++}return null},dq.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]},dq.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var R,H=[],v=0,T=this.curves.length;for(R=0;T>R;R++)v+=this.curves[R].getLength(),H.push(v);return this.cacheLengths=H,H},dq.getTransformedPoints=function(w){return this.getPoints(w)},dq.getBoundingBox=function(){var I,H,M,q,Q,z,c=this.getPoints();I=H=Number.NEGATIVE_INFINITY,q=Q=Number.POSITIVE_INFINITY;var a,K,J,t,V=c[0]instanceof Cs;for(t=V?new Cs:new yo,K=0,J=c.length;J>K;K++)a=c[K],a.x>I&&(I=a.x),a.x<q&&(q=a.x),a.y>H&&(H=a.y),a.y<Q&&(Q=a.y),V&&(a.z>M&&(M=a.z),a.z<z&&(z=a.z)),t.add(a);var h={minX:q,minY:Q,maxX:I,maxY:H};return V&&(h.maxZ=M,h.minZ=z),h};var rg=function(x){Xm.call(this),this.actions=[],x&&this.fromPoints(x)},zi=rg.prototype=gj(Xm.prototype),gc="moveTo",Uc="lineTo",zd="quadraticCurveTo",Fl="bezierCurveTo",qe="arc",Mm="ellipse";zi.fromPoints=function(x){this.moveTo(x[0].x,x[0].y);for(var Z=1,W=x.length;W>Z;Z++)this.lineTo(x[Z].x,x[Z].y)},zi.moveTo=function(){var J=Array.prototype.slice.call(arguments);this.actions.push({action:gc,args:J})},zi.lineTo=function(P,C){var F=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,L=D[D.length-2],J=D[D.length-1],f=new ce(new yo(L,J),new yo(P,C));this.curves.push(f),this.actions.push({action:Uc,args:F})},zi.quadraticCurveTo=function(Q,r,M,D){var q=Array.prototype.slice.call(arguments),U=this.actions[this.actions.length-1].args,x=U[U.length-2],k=U[U.length-1],v=new uo(new yo(x,k),new yo(Q,r),new yo(M,D));this.curves.push(v),this.actions.push({action:zd,args:q})},zi.bezierCurveTo=function(p,A,L,r,a,F){var $=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,V=d[d.length-2],c=d[d.length-1],D=new Ap(new yo(V,c),new yo(p,A),new yo(L,r),new yo(a,F));this.curves.push(D),this.actions.push({action:Fl,args:$})},zi.arc=function(K,Z,F,M,E,x){var s=this.actions[this.actions.length-1].args,e=s[s.length-2],T=s[s.length-1];this.absarc(K+e,Z+T,F,M,E,x)},zi.absarc=function(Z,O,D,e,l,w){this.absellipse(Z,O,D,D,e,l,w)},zi.ellipse=function(q,z,E,S,x,Y,Z){var j=this.actions[this.actions.length-1].args,W=j[j.length-2],G=j[j.length-1];this.absellipse(q+W,z+G,E,S,x,Y,Z)},zi.absellipse=function(g,z,S,r,f,d,Z){var P=Array.prototype.slice.call(arguments),N=new ds(g,z,S,r,f,d,Z);this.curves.push(N);var A=N.getPoint(1);P.push(A.x),P.push(A.y),this.actions.push({action:Mm,args:P})},zi.getSpacedPoints=function(w){w||(w=40);for(var d=[],N=0;w>N;N++)d.push(this.getPoint(N/w));return d},zi.getPoints=function(X,U){X=X||12;var u,x,F,J,O,g,Y,f,v,T,C,s,L,_,S,G,q,Z,t=[];for(u=0,x=this.actions.length;x>u;u++)switch(F=this.actions[u],J=F.action,O=F.args,J){case gc:t.push(new yo(O[0],O[1]));break;case Uc:t.push(new yo(O[0],O[1]));break;case zd:for(g=O[2],Y=O[3],T=O[0],C=O[1],t.length>0?(_=t[t.length-1],s=_.x,L=_.y):(_=this.actions[u-1].args,s=_[_.length-2],L=_[_.length-1]),S=1;X>=S;S++)G=S/X,q=Cm.b2(G,s,T,g),Z=Cm.b2(G,L,C,Y),t.push(new yo(q,Z));break;case Fl:for(g=O[4],Y=O[5],T=O[0],C=O[1],f=O[2],v=O[3],t.length>0?(_=t[t.length-1],s=_.x,L=_.y):(_=this.actions[u-1].args,s=_[_.length-2],L=_[_.length-1]),S=1;X>=S;S++)G=S/X,q=Cm.b3(G,s,T,f,g),Z=Cm.b3(G,L,C,v,Y),t.push(new yo(q,Z));break;case qe:var d,K=O[0],H=O[1],j=O[2],Q=O[3],R=O[4],y=!!O[5],h=R-Q,a=2*X;for(S=1;a>=S;S++)G=S/a,y||(G=1-G),d=Q+G*h,q=K+j*b(d),Z=H+j*w(d),t.push(new yo(q,Z));break;case Mm:var d,K=O[0],H=O[1],W=O[2],p=O[3],Q=O[4],R=O[5],y=!!O[6],h=R-Q,a=2*X;for(S=1;a>=S;S++)G=S/a,y||(G=1-G),d=Q+G*h,q=K+W*b(d),Z=H+p*w(d),t.push(new yo(q,Z))}var V=t[t.length-1],z=1e-10;return P(V.x-t[0].x)<z&&P(V.y-t[0].y)<z&&t.splice(t.length-1,1),U&&t.push(t[0]),t},zi.toShapes=function(a,G){function x(X){var c,q,w,j,V,x=[],l=new rg;for(c=0,q=X.length;q>c;c++)w=X[c],V=w.args,j=w.action,j==gc&&0!=l.actions.length&&(x.push(l),l=new rg),l[j].apply(l,V);return 0!=l.actions.length&&x.push(l),x}function S(A){for(var b=[],C=0,P=A.length;P>C;C++){var w=A[C],N=new As;N.actions=w.actions,N.curves=w.curves,b.push(N)}return b}function A($,J){for(var n=1e-10,S=J.length,M=!1,H=S-1,T=0;S>T;H=T++){var d=J[H],Z=J[T],z=Z.x-d.x,i=Z.y-d.y;if(P(i)>n){if(0>i&&(d=J[T],z=-z,Z=J[H],i=-i),$.y<d.y||$.y>Z.y)continue;if($.y==d.y){if($.x==d.x)return!0}else{var u=i*($.x-d.x)-z*($.y-d.y);if(0==u)return!0;if(0>u)continue;M=!M}}else{if($.y!=d.y)continue;if(Z.x<=$.x&&$.x<=d.x||d.x<=$.x&&$.x<=Z.x)return!0}}return M}var U=x(this.actions);if(0==U.length)return[];if(G===!0)return S(U);var i,T,D,g=[];if(1==U.length)return T=U[0],D=new As,D.actions=T.actions,D.curves=T.curves,g.push(D),g;var F=!Cm.isClockWise(U[0].getPoints());F=a?!F:F;var l,j=[],H=[],p=[],Z=0;H[Z]=r,p[Z]=[];var B,V;for(B=0,V=U.length;V>B;B++)T=U[B],l=T.getPoints(),i=Cm.isClockWise(l),i=a?!i:i,i?(!F&&H[Z]&&Z++,H[Z]={s:new As,p:l},H[Z].s.actions=T.actions,H[Z].s.curves=T.curves,F&&Z++,p[Z]=[]):p[Z].push({h:T,p:l[0]});if(!H[0])return S(U);if(H.length>1){for(var f=!1,I=[],E=0,o=H.length;o>E;E++)j[E]=[];for(var E=0,o=H.length;o>E;E++){H[E];for(var k=p[E],t=0;t<k.length;t++){for(var W=k[t],s=!0,$=0;$<H.length;$++)A(W.p,H[$].p)&&(E!=$&&I.push({froms:E,tos:$,hole:t}),s?(s=!1,j[$].push(W)):f=!0);s&&j[E].push(W)}}I.length>0&&(f||(p=j))}var e,O,c;for(B=0,V=H.length;V>B;B++)for(D=H[B].s,g.push(D),e=p[B],O=0,c=e.length;c>O;O++)D.holes.push(e[O].h);return g};var As=function(){rg.apply(this,arguments),this.holes=[]},Ye=As.prototype=gj(zi);Ye.getPointsHoles=function(Z){var o,z=this.holes.length,E=[];for(o=0;z>o;o++)E[o]=this.holes[o].getTransformedPoints(Z);return E},Ye.extractAllPoints=function(I){return{shape:this.getTransformedPoints(I),holes:this.getPointsHoles(I)}},Ye.extractPoints=function(e){return this.extractAllPoints(e)};var Cm={triangulateShape:function(R,h){function D(J,m,V){return J.x!=m.x?J.x<m.x?J.x<=V.x&&V.x<=m.x:m.x<=V.x&&V.x<=J.x:J.y<m.y?J.y<=V.y&&V.y<=m.y:m.y<=V.y&&V.y<=J.y}function c(p,j,f,L,J){var Z=1e-10,E=j.x-p.x,N=j.y-p.y,e=L.x-f.x,M=L.y-f.y,K=p.x-f.x,A=p.y-f.y,G=N*e-E*M,$=N*K-E*A;if(P(G)>Z){var r;if(G>0){if(0>$||$>G)return[];if(r=M*K-e*A,0>r||r>G)return[]}else{if($>0||G>$)return[];if(r=M*K-e*A,r>0||G>r)return[]}if(0==r)return!J||0!=$&&$!=G?[p]:[];if(r==G)return!J||0!=$&&$!=G?[j]:[];if(0==$)return[f];if($==G)return[L];var I=r/G;return[{x:p.x+I*E,y:p.y+I*N}]}if(0!=$||M*K!=e*A)return[];var R=0==E&&0==N,S=0==e&&0==M;if(R&&S)return p.x!=f.x||p.y!=f.y?[]:[p];if(R)return D(f,L,p)?[p]:[];if(S)return D(p,j,f)?[f]:[];var C,i,O,c,T,V,l,t;return 0!=E?(p.x<j.x?(C=p,O=p.x,i=j,c=j.x):(C=j,O=j.x,i=p,c=p.x),f.x<L.x?(T=f,l=f.x,V=L,t=L.x):(T=L,l=L.x,V=f,t=f.x)):(p.y<j.y?(C=p,O=p.y,i=j,c=j.y):(C=j,O=j.y,i=p,c=p.y),f.y<L.y?(T=f,l=f.y,V=L,t=L.y):(T=L,l=L.y,V=f,t=f.y)),l>=O?l>c?[]:c==l?J?[]:[T]:t>=c?[T,i]:[T,V]:O>t?[]:O==t?J?[]:[C]:t>=c?[C,i]:[C,V]}function O(l,N,h,c){var m=1e-10,O=N.x-l.x,V=N.y-l.y,T=h.x-l.x,M=h.y-l.y,K=c.x-l.x,$=c.y-l.y,R=O*M-V*T,n=O*$-V*K;if(P(R)>m){var D=K*M-$*T;return R>0?n>=0&&D>=0:n>=0||D>=0}return n>0}function l(j,F){function W(R,W){var Q=k.length-1,L=R-1;0>L&&(L=Q);var Y=R+1;Y>Q&&(Y=0);var A=O(k[R],k[L],k[Y],m[W]);if(!A)return!1;var S=m.length-1,o=W-1;0>o&&(o=S);var X=W+1;return X>S&&(X=0),A=O(m[W],m[o],m[X],k[R]),A?!0:!1}function s(l,E){var D,q,P;for(D=0;D<k.length;D++)if(q=D+1,q%=k.length,P=c(l,E,k[D],k[q],!0),P.length>0)return!0;return!1}function N(A,b){var Y,u,N,z,S;for(Y=0;Y<o.length;Y++)for(u=F[o[Y]],N=0;N<u.length;N++)if(z=N+1,z%=u.length,S=c(A,b,u[N],u[z],!0),S.length>0)return!0;return!1}for(var m,S,q,z,f,V,Y,v,p,d,H,k=j.concat(),o=[],n=[],U=0,e=F.length;e>U;U++)o.push(U);for(var $=0,E=2*o.length;o.length>0&&(E--,!(0>E));)for(q=$;q<k.length;q++){z=k[q],S=-1;for(var U=0;U<o.length;U++)if(V=o[U],Y=z.x+":"+z.y+":"+V,n[Y]===r){m=F[V];for(var B=0;B<m.length;B++)if(f=m[B],W(q,B)&&!s(z,f)&&!N(z,f)){S=B,o.splice(U,1),v=k.slice(0,q+1),p=k.slice(q),d=m.slice(S),H=m.slice(0,S+1),k=v.concat(d).concat(H).concat(p),$=q;break}if(S>=0)break;n[Y]=!0}if(S>=0)break}return k}for(var p,W,H,F,g,B,q={},Q=R.concat(),m=0,T=h.length;T>m;m++)Array.prototype.push.apply(Q,h[m]);for(p=0,W=Q.length;W>p;p++)g=Q[p].x+":"+Q[p].y,q[g]!==r,q[g]=p;var b=l(R,h),u=Jh.Triangulate(b,!1);for(p=0,W=u.length;W>p;p++)for(F=u[p],H=0;3>H;H++)g=F[H].x+":"+F[H].y,B=q[g],B!==r&&(F[H]=B);return u.concat()},isClockWise:function(N){return Jh.Triangulate.area(N)<0},b2p0:function(D,p){var A=1-D;return A*A*p},b2p1:function(e,f){return 2*(1-e)*e*f},b2p2:function(R,q){return R*R*q},b2:function($,R,H,B){return this.b2p0($,R)+this.b2p1($,H)+this.b2p2($,B)},b3p0:function(m,l){var W=1-m;return W*W*W*l},b3p1:function(E,R){var T=1-E;return 3*T*T*E*R},b3p2:function(U,s){var O=1-U;return 3*O*U*U*s},b3p3:function(X,n){return X*X*X*n},b3:function(q,Y,T,p,N){return this.b3p0(q,Y)+this.b3p1(q,T)+this.b3p2(q,p)+this.b3p3(q,N)}},Jh={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var i=H.keys(this.faces);return i.length?i[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(A){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(g){var u=g.familyName.toLowerCase(),S=this;return S.faces[u]=S.faces[u]||{},S.faces[u][g.cssFontWeight]=S.faces[u][g.cssFontWeight]||{},S.faces[u][g.cssFontWeight][g.cssFontStyle]=g,g},drawText:function(S){var Q,m=this.getFace(),h=this.size/m.resolution,r=0,g=String(S).split(""),k=g.length,Z=[];for(Q=0;k>Q;Q++){var $=new rg,G=this.extractGlyphPoints(g[Q],m,h,r,$);G&&(r+=G.offset*this.spacing,Z.push(G.path))}var n=r/2;return{paths:Z,offset:n}},extractGlyphPoints:function(J,b,H,u,o){var y,M,r,N,R,k,h,z,w,L,q,$,c,C,a,v,s,T,i,I=[],D=b.glyphs[J]||b.glyphs["?"];if(D){if(D.o)for(N=D._cachedOutline||(D._cachedOutline=D.o.split(" ")),k=N.length,h=H,z=H,y=0;k>y;)switch(R=N[y++]){case"m":w=N[y++]*h+u,L=N[y++]*z,o.moveTo(w,L);break;case"l":w=N[y++]*h+u,L=N[y++]*z,o.lineTo(w,L);break;case"q":if(q=N[y++]*h+u,$=N[y++]*z,a=N[y++]*h+u,v=N[y++]*z,o.quadraticCurveTo(a,v,q,$),i=I[I.length-1])for(c=i.x,C=i.y,M=1,r=this.divisions;r>=M;M++){var n=M/r;Cm.b2(n,c,a,q),Cm.b2(n,C,v,$)}break;case"b":if(q=N[y++]*h+u,$=N[y++]*z,a=N[y++]*h+u,v=N[y++]*z,s=N[y++]*h+u,T=N[y++]*z,o.bezierCurveTo(a,v,s,T,q,$),i=I[I.length-1])for(c=i.x,C=i.y,M=1,r=this.divisions;r>=M;M++){var n=M/r;Cm.b3(n,c,a,s,q),Cm.b3(n,C,v,T,$)}}return{offset:D.ha*H,path:o}}}};Jh.generateShapes=function(n,V){V=V||{};var g=V.font;if(g===r&&(g=Jh.getDefaultFont(),!g))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var M=V.size!==r?V.size:1,e=V.curveSegments!==r?V.curveSegments:4,J=V.spacing!==r?V.spacing:1,W=V.weight!==r?V.weight:"normal",v=V.style!==r?V.style:"normal";Jh.size=M,Jh.divisions=e,Jh.face=g,Jh.weight=W,Jh.style=v,Jh.spacing=J;for(var D=Jh.drawText(n),w=D.paths,A=[],k=0,c=w.length;c>k;k++)Array.prototype.push.apply(A,w[k].toShapes());return A},function(W){var P=1e-10,e=function(K,J){var w=K.length;if(3>w)return null;var v,T,c,t=[],u=[],O=[];if(F(K)>0)for(T=0;w>T;T++)u[T]=T;else for(T=0;w>T;T++)u[T]=w-1-T;var R=w,s=2*R;for(T=R-1;R>2;){if(s--<=0)return J?O:t;if(v=T,v>=R&&(v=0),T=v+1,T>=R&&(T=0),c=T+1,c>=R&&(c=0),E(K,v,T,c,R,u)){var H,e,Y,V,I;for(H=u[v],e=u[T],Y=u[c],t.push([K[H],K[e],K[Y]]),O.push([u[v],u[T],u[c]]),V=T,I=T+1;R>I;V++,I++)u[V]=u[I];R--,s=2*R}}return J?O:t},F=function(c){for(var G=c.length,J=0,V=G-1,l=0;G>l;V=l++)J+=c[V].x*c[l].y-c[l].x*c[V].y;return.5*J},E=function(o,c,H,n,t,x){var E,f,N,$,S,O,A,i,Q;if(f=o[x[c]].x,N=o[x[c]].y,$=o[x[H]].x,S=o[x[H]].y,O=o[x[n]].x,A=o[x[n]].y,P>($-f)*(A-N)-(S-N)*(O-f))return!1;var e,X,k,p,u,V,r,y,d,v,Y,m,b,U,C;for(e=O-$,X=A-S,k=f-O,p=N-A,u=$-f,V=S-N,E=0;t>E;E++)if(i=o[x[E]].x,Q=o[x[E]].y,!(i===f&&Q===N||i===$&&Q===S||i===O&&Q===A)&&(r=i-f,y=Q-N,d=i-$,v=Q-S,Y=i-O,m=Q-A,C=e*v-X*d,b=u*y-V*r,U=k*m-p*Y,C>=-P&&U>=-P&&b>=-P))return!1;return!0};return W.Triangulate=e,W.Triangulate.area=F,W}(Jh),R._typeface_js={faces:Jh.faces,loadFace:Jh.loadFace};var dh=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},dl=dh.prototype={constructor:dh,computeFaceNormals:function(){for(var W=new Cs,i=new Cs,U=0,o=this.faces.length;o>U;U++){var $=this.faces[U],r=this.vertices[$.a],B=this.vertices[$.b],l=this.vertices[$.c];W.subVectors(l,B),i.subVectors(r,B),W.cross(i),W.normalize(),$.normal.copy(W)}},computeVertexNormals:function(d){var p,t,q,g,w,k;for(k=new Array(this.vertices.length),p=0,t=this.vertices.length;t>p;p++)k[p]=new Cs;if(d){var U,D,S,r=new Cs,o=new Cs;for(q=0,g=this.faces.length;g>q;q++)w=this.faces[q],U=this.vertices[w.a],D=this.vertices[w.b],S=this.vertices[w.c],r.subVectors(S,D),o.subVectors(U,D),r.cross(o),k[w.a].add(r),k[w.b].add(r),k[w.c].add(r)}else for(q=0,g=this.faces.length;g>q;q++)w=this.faces[q],k[w.a].add(w.normal),k[w.b].add(w.normal),k[w.c].add(w.normal);for(p=0,t=this.vertices.length;t>p;p++)k[p].normalize();for(q=0,g=this.faces.length;g>q;q++)w=this.faces[q],w.vertexNormals[0]=k[w.a].clone(),w.vertexNormals[1]=k[w.b].clone(),w.vertexNormals[2]=k[w.c].clone()},mergeVertices:function(){var $,I,S,i,s,q,X,u,W={},C=[],L=[],N=4,o=F(10,N);for(S=0,i=this.vertices.length;i>S;S++)$=this.vertices[S],I=d($.x*o)+"_"+d($.y*o)+"_"+d($.z*o),W[I]===r?(W[I]=S,C.push(this.vertices[S]),L[S]=C.length-1):L[S]=L[W[I]];var T=[];for(S=0,i=this.faces.length;i>S;S++){s=this.faces[S],s.a=L[s.a],s.b=L[s.b],s.c=L[s.c],q=[s.a,s.b,s.c];for(var R=0;3>R;R++)if(q[R]==q[(R+1)%3]){T.push(S);break}}for(S=T.length-1;S>=0;S--){var n=T[S];for(this.faces.splice(n,1),X=0,u=this.faceVertexUvs.length;u>X;X++)this.faceVertexUvs[X].splice(n,1)}var V=this.vertices.length-C.length;return this.vertices=C,V}},ds=function(D,g,d,h,M,F,e){this.aX=D,this.aY=g,this.xRadius=d,this.yRadius=h,this.aStartAngle=M,this.aEndAngle=F,this.aClockwise=e};ds.prototype=gj(Dh),ds.prototype.getPoint=function(j){var g,y=this.aEndAngle-this.aStartAngle;0>y&&(y+=p),y>p&&(y-=p),g=this.aClockwise===!0?this.aEndAngle+(1-j)*(p-y):this.aStartAngle+j*y;var X=this.aX+this.xRadius*b(g),a=this.aY+this.yRadius*w(g);return new yo(X,a)};var ce=function(E,r){this.v1=E,this.v2=r},Bn=ce.prototype=gj(Dh);Bn.getPoint=function(J){var Q=this.v2.clone().sub(this.v1);return Q.multiplyScalar(J).add(this.v1),Q},Bn.getPointAt=function(y){return this.getPoint(y)},Bn.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()};var uo=function(w,Q,W){this.v0=w,this.v1=Q,this.v2=W};uo.prototype=gj(Dh),uo.prototype.getPoint=function(b){var n,e;return n=Cm.b2(b,this.v0.x,this.v1.x,this.v2.x),e=Cm.b2(b,this.v0.y,this.v1.y,this.v2.y),new yo(n,e)};var Ap=function(d,A,p,B){this.v0=d,this.v1=A,this.v2=p,this.v3=B};Ap.prototype=gj(Dh),Ap.prototype.getPoint=function(h){var o,c;return o=Cm.b3(h,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=Cm.b3(h,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new yo(o,c)},Tb.create(function(s,r){this.v1=s,this.v2=r},function(g){var T=new Cs;return T.subVectors(this.v2,this.v1),T.multiplyScalar(g),T.add(this.v1),T});var sj=Tb.create(function(s,k,m){this.v0=s,this.v1=k,this.v2=m},function(V){var x,X,$;return x=Cm.b2(V,this.v0.x,this.v1.x,this.v2.x),X=Cm.b2(V,this.v0.y,this.v1.y,this.v2.y),$=Cm.b2(V,this.v0.z,this.v1.z,this.v2.z),new Cs(x,X,$)}),Oq=Tb.create(function(G,X,l,K){this.v0=G,this.v1=X,this.v2=l,this.v3=K},function(w){var U,P,y;return U=Cm.b3(w,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P=Cm.b3(w,this.v0.y,this.v1.y,this.v2.y,this.v3.y),y=Cm.b3(w,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Cs(U,P,y)}),gk=function(J,F,Y,V,d,G,E,$){dh.call(this),V=V!==r?V:.5,d=d!==r?d:.5,$=$!==r?$:1,J=J||8,G=G||0,E=E||p;var h,R,t=1,z=$/2,Z=[],e=[],i=this.vertices,u=this.faces,k=this.faceVertexUvs;for(R=0;t>=R;R++){var m=[],l=[],o=R/t,Q=o*(d-V)+V;for(h=0;J>=h;h++){var C=h/J,A=new Cs,M=-(C*E+G);A.z=Q*w(M),A.y=-o*$+z,A.x=Q*b(M),i.push(A),m.push(i.length-1),l.push(new yo(C,o))}Z.push(m),e.push(l)}var q,n,P=(d-V)/$;for(h=0;J>h;h++)for(0!==V?(q=i[Z[0][h]].clone(),n=i[Z[0][h+1]].clone()):(q=i[Z[1][h]].clone(),n=i[Z[1][h+1]].clone()),q.setY(W(q.x*q.x+q.z*q.z)*P).normalize(),n.setY(W(n.x*n.x+n.z*n.z)*P).normalize(),R=0;t>R;R++){var O=Z[R][h],c=Z[R+1][h],D=Z[R+1][h+1],S=Z[R][h+1],_=q.clone(),s=q.clone(),B=n.clone(),j=n.clone(),U=e[R][h].clone(),v=e[R+1][h].clone(),N=e[R+1][h+1].clone(),a=e[R][h+1].clone();u.push(new hj(O,c,S,[_,s,j])),k[0].push([U,v,a]),u.push(new hj(c,D,S,[s.clone(),B,j.clone()])),k[0].push([v.clone(),N,a.clone()])}if(F&&V>0)for(this.vertices.push(new Cs(0,z,0)),h=0;J>h;h++){var O=Z[0][h],c=Z[0][h+1],D=this.vertices.length-1,_=new Cs(0,1,0),s=new Cs(0,1,0),B=new Cs(0,1,0),U=e[0][h].clone(),v=e[0][h+1].clone(),N=new yo(v.x,0);u.push(new hj(O,c,D,[_,s,B],null,1));var K=h/J*p,y=b(K),g=w(K),f=(h+1)/J*p,T=b(f),L=w(f);k[0].push([new yo(.5+.5*y,.5+.5*g),new yo(.5+.5*T,.5+.5*L),new yo(.5,.5)])}if(Y&&d>0)for(this.vertices.push(new Cs(0,-z,0)),h=0;J>h;h++){var O=Z[R][h+1],c=Z[R][h],D=i.length-1,_=new Cs(0,-1,0),s=new Cs(0,-1,0),B=new Cs(0,-1,0),U=e[R][h+1].clone(),v=e[R][h].clone();u.push(new hj(O,c,D,[_,s,B],null,2));var K=h/J*p,y=b(K),g=w(K),f=(h+1)/J*p,T=b(f),L=w(f);k[0].push([new yo(.5+.5*T,.5-.5*L),new yo(.5+.5*y,.5-.5*g),new yo(.5,.5)])}};gk.prototype=gj(dl);var zn=function(j,A,C,Z,h,u,e){dh.call(this),e=e||.5,j=j||16,A=A||16,C=(C!==r?C:0)-M,Z=Z!==r?Z:p,h=h!==r?h:0,u=u!==r?u:M;var q,D,d=[],$=[],v=this.vertices,t=this.faces,U=this.faceVertexUvs;for(D=0;A>=D;D++){var c=[],H=[];for(q=0;j>=q;q++){var f=q/j,Q=D/A,V=new Cs;V.x=-e*b(C+f*Z)*w(h+Q*u),V.y=e*b(h+Q*u),V.z=e*w(C+f*Z)*w(h+Q*u),v.push(V),c.push(v.length-1),H.push(new yo(f,Q))}d.push(c),$.push(H)}for(D=0;A>D;D++)for(q=0;j>q;q++){var O=d[D][q+1],l=d[D][q],L=d[D+1][q],E=d[D+1][q+1],a=v[O].clone().normalize(),g=v[l].clone().normalize(),R=v[L].clone().normalize(),y=v[E].clone().normalize(),T=$[D][q+1].clone(),k=$[D][q].clone(),I=$[D+1][q].clone(),W=$[D+1][q+1].clone();P(v[O].y)===e?(T.x=(T.x+k.x)/2,t.push(new hj(O,L,E,[a,R,y])),U[0].push([T,I,W])):P(v[L].y)===e?(I.x=(I.x+W.x)/2,t.push(new hj(O,l,L,[a,g,R])),U[0].push([T,k,I])):(t.push(new hj(O,l,E,[a,g,y])),U[0].push([T,k,W]),t.push(new hj(l,L,E,[g.clone(),R,y.clone()])),U[0].push([k.clone(),I,W.clone()]))}};zn.prototype=gj(dl);var mn=function(c,e,P,G,x,a){dh.call(this),c=c||.33,e=e||.17,G=G||8,P=P||6,x=x||0,a=a||p;for(var V=new Cs,J=[],L=[],N=0;G>=N;N++)for(var i=N/G*p+M,O=0;P>=O;O++){var n=O/P*a+x;V.x=c*b(n),V.z=-c*w(n);var E=new Cs,Y=c+e*b(i);E.x=Y*b(n),E.z=-Y*w(n),E.y=e*w(i),this.vertices.push(E),J.push(new yo(O/P,1-N/G)),L.push(E.clone().sub(V).normalize())}for(var N=1;G>=N;N++)for(var O=1;P>=O;O++){var W=(P+1)*N+O-1,C=(P+1)*(N-1)+O-1,I=(P+1)*(N-1)+O,Z=(P+1)*N+O,T=new hj(W,C,Z,[L[W].clone(),L[C].clone(),L[Z].clone()]);this.faces.push(T),this.faceVertexUvs[0].push([J[W].clone(),J[C].clone(),J[Z].clone()]),T=new hj(C,I,Z,[L[C].clone(),L[I].clone(),L[Z].clone()]),this.faces.push(T),this.faceVertexUvs[0].push([J[C].clone(),J[I].clone(),J[Z].clone()])}this.computeFaceNormals()};mn.prototype=gj(dl);var xk=function(U,R,e){return U?(dh.call(this),U=U instanceof Array?U:[U],this.addShapeList(U,R),R.convertYZ!==!1&&gq(this,e),this.computeFaceNormals(),void 0):(U=[],void 0)},Dl=xk.prototype=gj(dh.prototype);Dl.addShapeList=function(w,D){for(var q=w.length,W=0;q>W;W++){var $=w[W];this.addShape($,D)}},Dl.addShape=function(N,p){function C(){if(p.bottom)for(var U=0;V>U;U++)Z=j[U],k(Z[2],Z[1],Z[0],!0);if(p.top)for(U=0;V>U;U++)Z=j[U],k(Z[0]+S*D,Z[1]+S*D,Z[2]+S*D,!1)}function q(){var x=0;for(H(G,x),x+=G.length,P=0,J=Y.length;J>P;P++)$=Y[P],H($,x),x+=$.length}function H(d,L){for(var Y,m,M=d.length;--M>=0;){Y=M,m=M-1,0>m&&(m=d.length-1);var i=0,w=D;for(i=0;w>i;i++){var J=S*i,h=S*(i+1),Q=L+Y+J,H=L+m+J,k=L+m+h,r=L+Y+h;n(Q,H,k,r,d,i,w,Y,m)}}}function I(s,k,v){l.vertices.push(new Cs(s,k,v))}function k(M,y,c,A){M+=W,y+=W,c+=W,l.faces.push(new hj(M,y,c,null,null,A?2:1));var i=A?U.generateBottomUV(l,N,p,M,y,c):U.generateTopUV(l,N,p,M,y,c);l.faceVertexUvs[0].push(i)}function n(k,z,s,Y,o,_,Z,M,J){k+=W,z+=W,s+=W,Y+=W,l.faces.push(new hj(k,z,Y)),l.faces.push(new hj(z,s,Y));var q=U.generateSideWallUV(l,N,o,p,k,z,s,Y,_,Z,M,J);l.faceVertexUvs[0].push([q[0],q[1],q[3]]),l.faceVertexUvs[0].push([q[1],q[2],q[3]])}var F,a,c,O,x,Q=p.amount,f=p.curveSegments||mo,D=p.steps||1,e=p.extrudePath,o=!1,U=new Bs(p.repeatUVLength);e&&(F=e.getSpacedPoints(D),o=!0,a=p.frames!==r?p.frames:new Oo.FrenetFrames(e,D,!1),c=new Cs,O=new Cs,x=new Cs);var $,P,J,l=this,W=this.vertices.length,g=N.extractPoints(f),i=g.shape,Y=g.holes,t=!Cm.isClockWise(i);if(t){for(i=i.reverse(),P=0,J=Y.length;J>P;P++)$=Y[P],Cm.isClockWise($)&&(Y[P]=$.reverse());t=!1}var j=Cm.triangulateShape(i,Y),G=i;for(P=0,J=Y.length;J>P;P++)$=Y[P],i=i.concat($);for(var K,Z,S=i.length,V=j.length,v=0;S>v;v++)K=i[v],o?(O.copy(a.normals[0]).multiplyScalar(K.x),c.copy(a.binormals[0]).multiplyScalar(K.y),x.copy(F[0]).add(O).add(c),I(x.x,x.y,x.z)):I(K.x,K.y,0);var L;for(L=1;D>=L;L++)for(v=0;S>v;v++)K=i[v],o?(O.copy(a.normals[L]).multiplyScalar(K.x),c.copy(a.binormals[L]).multiplyScalar(K.y),x.copy(F[L]).add(O).add(c),I(x.x,x.y,x.z)):I(K.x,K.y,Q/D*L);C(),q()};var Oo=function(Z,S,K,T,N){function d(N,c,x){return u.vertices.push(new Cs(N,c,x))-1}dh.call(this),S=S||64,K=K||1,T=T||8,N=N||!1;var G,O,L,P,$,n,V,Q,l,g,t,c,I,U,F,X,m,o,_,M,j=[],u=this,q=S+1,r=new Cs,v=new Oo.FrenetFrames(Z,S,N),A=v.tangents,Y=v.normals,R=v.binormals;for(this.tangents=A,this.normals=Y,this.binormals=R,l=0;q>l;l++)for(j[l]=[],P=l/(q-1),Q=Z.getPointAt(P),G=A[l],O=Y[l],L=R[l],g=0;T>g;g++)$=g/T*p,n=-K*b($),V=K*w($),r.copy(Q),r.x+=n*O.x+V*L.x,r.y+=n*O.y+V*L.y,r.z+=n*O.z+V*L.z,j[l][g]=d(r.x,r.y,r.z);for(l=0;S>l;l++)for(g=0;T>g;g++)t=N?(l+1)%S:l+1,c=(g+1)%T,I=j[l][g],U=j[t][g],F=j[t][c],X=j[l][c],m=new yo(l/S,g/T),o=new yo((l+1)/S,g/T),_=new yo((l+1)/S,(g+1)/T),M=new yo(l/S,(g+1)/T),this.faces.push(new hj(I,U,X)),this.faceVertexUvs[0].push([m,o,M]),this.faces.push(new hj(U,F,X)),this.faceVertexUvs[0].push([o.clone(),_,M.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Oo.prototype=gj(dl),Oo.FrenetFrames=function(Y,w,F){function X(){S[0]=new Cs,n[0]=new Cs,L=Number.MAX_VALUE,h=P(z[0].x),o=P(z[0].y),W=P(z[0].z),L>=h&&(L=h,b.set(1,0,0)),L>=o&&(L=o,b.set(0,1,0)),L>=W&&b.set(0,0,1),$.crossVectors(z[0],b).normalize(),S[0].crossVectors(z[0],$),n[0].crossVectors(z[0],S[0])}var I,L,h,o,W,k,y,b=new Cs,z=[],S=[],n=[],$=new Cs,i=new og,N=w+1,E=1e-4;for(this.tangents=z,this.normals=S,this.binormals=n,k=0;N>k;k++)y=k/(N-1),z[k]=Y.getTangentAt(y),z[k].normalize();for(X(),k=1;N>k;k++)S[k]=S[k-1].clone(),n[k]=n[k-1].clone(),$.crossVectors(z[k-1],z[k]),$.length()>E&&($.normalize(),I=T(bm(z[k-1].dot(z[k]),-1,1)),S[k].applyMatrix4(i.makeRotationAxis($,I))),n[k].crossVectors(z[k],S[k]);if(F)for(I=T(bm(S[0].dot(S[N-1]),-1,1)),I/=N-1,z[0].dot($.crossVectors(S[0],S[N-1]))>0&&(I=-I),k=1;N>k;k++)S[k].applyMatrix4(i.makeRotationAxis(z[k],I*k)),n[k].crossVectors(z[k],S[k])};var tl=function(f,E,G,H){dh.call(this),E=E||18,G=G||0,H=H==s?p:H;for(var O=1/(f.length-1),e=1/E,B=0,Q=E;Q>=B;B++)for(var F=G+B*e*H,z=b(F),v=w(F),M=0,g=f.length;g>M;M++){var W=f[M],l=new Cs;l.x=z*W.x-v*W.y,l.y=v*W.x+z*W.y,l.z=W.z,this.vertices.push(l)}for(var y=f.length,B=0,Q=E;Q>B;B++)for(var M=0,g=f.length-1;g>M;M++){var A=M+y*B,D=A,C=A+y,z=A+1+y,h=A+1,i=B*e,V=M*O,U=i+e,K=V+O;this.faces.push(new hj(D,h,C)),this.faceVertexUvs[0].push([new yo(i,V),new yo(i,K),new yo(U,V)]),this.faces.push(new hj(C,h,z)),this.faceVertexUvs[0].push([new yo(U,V),new yo(i,K),new yo(U,K)])}this.mergeVertices(),gq(this),this.computeFaceNormals(),this.computeVertexNormals()};tl.prototype=gj(dl);var Qi=function(F,m){m=m||{};var L=Jh.generateShapes(F,m);m.amount=m.amount!==r?m.amount:.5,m.convertYZ=!1,m.fill!==!1&&(m.bottom=!0,m.top=!0),xk.call(this,L,m)};Qi.prototype=gj(Dl);var Vb=I.Node=function(){jj(Vb,this)},Lj={X:ig,Y:vc,Z:Im},Kn={X:0,Y:1,Z:2},nd={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Wk="xzy",ti=function(L,o,W){if(o){var b=o[0],R=o[1],V=o[2];"xzy"===W?(vc(L,R),Im(L,V),ig(L,b)):"xyz"===W?(Im(L,V),vc(L,R),ig(L,b)):"yxz"===W?(Im(L,V),ig(L,b),vc(L,R)):"yzx"===W?(ig(L,b),Im(L,V),vc(L,R)):"zxy"===W?(vc(L,R),ig(L,b),Im(L,V)):"zyx"===W?(ig(L,b),vc(L,R),Im(L,V)):(vc(L,R),Im(L,V),ig(L,b))}};Lf("Node",re,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Wk,_64O:0,_rotationX:0,_53O:0,_host:s,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return vr},_22Q:function(){return Bl},getX:function(){return this.p().x},setX:function(r){this.p(r,this.p().y)},getY:function(){return this.p().y},setY:function(h){this.p(this.p().x,h)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(U){this.setAnchor(U,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(m){this.setAnchor(this.getAnchor().x,m)},getScaleX:function(){return this.getScale().x},setScaleX:function(z){this.setScale(z,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(z){this.setScale(this.getScale().x,z)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(G,e){Zk(G,zc(s,s,this.r3(),this.getRotationMode())),this.translate3d(G[0]*e,G[1]*e,G[2]*e)},translateFront:function(k){this.translate3dBy([0,0,1],k)},translateBack:function(G){this.translate3dBy([0,0,-1],G)},translateLeft:function(v){this.translate3dBy([-1,0,0],v)},translateRight:function(P){this.translate3dBy([1,0,0],P)},translateTop:function($){this.translate3dBy([0,1,0],$)},translateBottom:function(K){this.translate3dBy([0,-1,0],K)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(z,F,k){1===arguments.length&&(F=z[1],k=z[2],z=z[0]),this.p(z,k),this.setElevation(F)},translate3d:function(k,Z,W){1===arguments.length&&(Z=k[1],W=k[2],k=k[0]),this.translate(k,W),this.setElevation(this._54O+Z)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function($,a,d){1===arguments.length&&(a=$[1],d=$[2],$=$[0]),this.setSize($,d),this.setTall(a)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(i,L,P){1===arguments.length&&(L=i[1],P=i[2],i=i[0]),this.setRotationX(i),this.setRotation(-L),this.setRotationZ(P)},setRotationY:function(V){this.setRotation(-V)},getRotationY:function(){return-this._64O},lookAtDirection:function(z,v){v=v||pg;var P=this,X=Bg(z);v===pg?(P.r3([-J(z[1]/X),-Z(z[2],z[0])+S,0]),P.setRotationMode("xzy")):v===Go?(P.r3(0,-Z(z[2],z[0]),J(z[1]/X)),P.setRotationMode("zyx")):v===Ih?(P.r3(0,-Z(z[2],z[0])+M,-J(z[1]/X)),P.setRotationMode("zyx")):v===ns?(P.r3([-J(z[1]/X)+S,-Z(z[2],z[0])+S,0]),P.setRotationMode("xzy")):v===cj&&(P.r3([-J(z[1]/X)-S,-Z(z[2],z[0])+S,0]),P.setRotationMode("xzy")),v===Pm&&(P.r3([-J(z[1]/X)+M,-Z(z[2],z[0])+S,M]),P.setRotationMode("zxy"))},lookAt:function(g,o){return this.lookAtDirection(tn(g,this.p3()),o)},lookAtX:function(){var Q=new Nd,x=new Nd,$=new Nd,q=new rs,i=new rs,O=new I.Math.Euler;return function(l,K,M){K===Ih||K===Go?q.makeRotationAxis(new I.Math.Vector3(0,1,0),Math.PI/2):K===ns||K===cj?q.makeRotationAxis(new I.Math.Vector3(1,0,0),Math.PI/2):q.identity(),K===cj||K===Go||K===Pm?(Q.fromArray(this.p3()),x.fromArray(l)):(Q.fromArray(l),x.fromArray(this.p3())),i.lookAt(Q,x,M?$.fromArray(M):$.set(0,1,0)),O.setFromRotationMatrix(i.multiply(q),pf.ReverseOrder(this.getRotationMode())),this.r3([O.x,O.y,O.z])}}(),getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(X){var i=this;if(i!==X&&i._host!==X){var V=i._host;V&&V._removeAttach(i),i._host=X,i._host&&i._host._addAttach(i),i.fp("host",V,X),i.onHostChanged(V,X)}},getAttaches:function(){return this._69O},_addAttach:function(f){var U=this;U._69O||(U._69O=new Ce),U._69O.add(f),U.fp("attaches",s,f)},_removeAttach:function(G){var F=this;F._69O.remove(G),F._69O.isEmpty()&&delete F._69O,F.fp("attaches",G,s)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function($){var S=this;S._44I||(S._44I=new Ce),S._42I||(S._42I=new Ce),S._44I.add($),S._42I.add($),S._20I()},_4I:function(n){var L=this;L._44I||(L._44I=new Ce),L._43I||(L._43I=new Ce),L._44I.add(n),L._43I.add(n),L._20I()},_16I:function(Z){var Y=this;Y._44I.remove(Z),Y._42I.remove(Z),Y._44I.isEmpty()&&delete Y._44I,Y._42I.isEmpty()&&delete Y._42I,Y._20I()},_18I:function(w){var v=this;v._44I.remove(w),v._43I.remove(w),v._44I.isEmpty()&&delete v._44I,v._43I.isEmpty()&&delete v._43I,v._20I()},_20I:function(){var w=this;if(delete w._45I,!w._44I||w._44I.isEmpty())return delete w._70O,void 0;var J;w._44I.each(function(Y){Y.isLooped()&&(J||(J={}),J[Y._id]||(w._45I||(w._45I=new Ce),w._45I.add(Y),J[Y._id]=Y))}),J?(w._70O=new Ce,w._44I.each(function(S){J[S._id]?"A"===J[S._id]||(J[S._id]="A",w._70O.add(S)):w._70O.add(S)})):w._70O=w._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(k){var c=this;c._46I||(c._46I=new Ce),c._48I||(c._48I=new Ce),c._46I.add(k),c._48I.add(k),c._19I()},_3I:function(w){var V=this;V._47I||(V._47I=new Ce),V._48I||(V._48I=new Ce),V._47I.add(w),V._48I.add(w),V._19I()},_15I:function(x){var S=this;S._46I.remove(x),S._48I.remove(x),S._46I.isEmpty()&&delete S._46I,S._48I.isEmpty()&&delete S._48I,S._19I()},_17I:function(w){var O=this;O._47I.remove(w),O._48I.remove(w),O._47I.isEmpty()&&delete O._47I,O._48I.isEmpty()&&delete O._48I,O._19I()},_19I:function(){var S=this;delete S._49I;var B=S._48I;if(B&&!B.isEmpty()){var t={};B.each(function(v){t[v._id]?S._49I||(S._49I=new Ce):t[v._id]=v}),S._49I?B.each(function(h){t[h._id]&&(S._49I.add(h),delete t[h._id])}):S._49I=B}},getImage:function(){if(this._pendingCheckImageJSON){var $=l.getImage(this._image);$&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof po&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(I){var k=this,q=k._image,j=k.getWidth(),P=k.getHeight();k._image=I,k.fp("image",q,I)&&(null!=I&&(sk(I)||Kl(I)&&/\.json$/i.test(I))&&(this._pendingCheckImageJSON=!0),k.fp(Lg,j,k.getWidth()),k.fp(cc,P,k.getHeight()))},getElevation:function(){return this._54O},setElevation:function(z){var R=this;if(!R._50O){R._50O=1;var X=R._54O;R._54O=z,R.fp(Jd,X,z),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(a){var L=this;
        if(!L._49O){L._49O=1;var E=L._64O;L._64O=a,L.fp(Nc,E,a),delete L._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(P){var B=this;if(!B._51O){B._51O=1;var X=B._rotationX;B._rotationX=P,B.fp("rotationX",X,P),delete B._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(Q){var u=this;if(!u._52O){u._52O=1;var T=u._53O;u._53O=Q,u.fp("rotationZ",T,Q),delete u._52O}},getPosition:function(){return this._position},setPosition:function(c,j){var J=this;if(!J._50I){J._50I=1;var h;if(h=2===arguments.length?{x:c,y:j}:c,h.x!==J._position.x||h.y!==J._position.y){var O=J._position;J._position=h,J.fp(Yb,O,h)}delete J._50I}},translate:function(q,m){var r=this._position;this.p(r.x+q,r.y+m)},getWidth:function(){var Y=this;if(Y._width>=0)return Y._width;var o=Y.getStyle("shape3d");if(o){var h=Jr(o);if(h&&h.rawS3)return h.rawS3[0];if("billboard"===o||"plane"===o){var W=nb(Y.getStyle("shape3d.image"));return W?El(W,Y):20}}var W=nb(Y._image);return W?El(W,Y):20},setWidth:function(W){var t=this,E=t._width;t._width=W,t.fp(Lg,E,W)},getHeight:function(){var o=this;if(o._height>=0)return o._height;var L=o.getStyle("shape3d");if(L){var R=Jr(L);if(R&&R.rawS3)return R.rawS3[2];if("plane"===L){var j=nb(o.getStyle("shape3d.image"));return j?tj(j,o):20}if("billboard"===L)return 2}var j=nb(o._image);return j?tj(j,o):20},setHeight:function(p){var f=this,F=f._height;f._height=p,f.fp(cc,F,p)},getTall:function(){var N=this;if(N._tall>=0)return N._tall;var $=N.getStyle("shape3d");if($){var d=Jr($);if(d&&d.rawS3)return d.rawS3[1];if("billboard"===$){var P=nb(N.getStyle("shape3d.image"));return P?tj(P,N):20}if("plane"===$)return 2}return 20},setTall:function(P){var Q=this,t=Q._tall;Q._tall=P,Q.fp("tall",t,P)},setSize:function(D,n){var o=this;2===arguments.length?(o.setWidth(D),o.setHeight(n)):(o.setWidth(D.width),o.setHeight(D.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(B,x,b,Z,n){var j=this,q=j.getAnchor(),d=j.getScale();arguments.length<=2&&(n=x,x=B.y,b=B.width,Z=B.height,B=B.x);var Q=n&&d.x<0?1-q.x:q.x,F=n&&d.y<0?1-q.y:q.y;j.p(B+b*Q,x+Z*F),n&&(b/=Math.abs(d.x),Z/=Math.abs(d.y)),j.setWidth(b),j.setHeight(Z)},getMatrix:function(){var H=this,y=H._64O,c=H._position,s=H.getScale();return new Tk(y,c.x,c.y,s.x,s.y)},getAnchorRect:function(){var K=this,f=K.getWidth(),j=K.getHeight(),G=K.getAnchor();return{x:-f*G.x,y:-j*G.y,width:f,height:j}},toLocal:function(l){return this.getMatrix().tfi(l)},toGlobal:function(O){return this.getMatrix().tf(O)},getAttachPosition:function(){var h=new Tk;return function(w,q,B,X){B=B||0,X=X||0;var K=this,f=K.getAnchor(),k=K._64O,G=K._position,M=K.getScale();return h.setFromTransform(k,G.x,G.y).tf({x:B+M.x*K.getWidth()*(w-f.x),y:X+M.y*K.getHeight()*(q-f.y)})}}(),isInRect:function(F){F=this.toLocal(F);var q=this.getWidth(),v=this.getHeight();return F.x+=q*this.getAnchorX(),F.y+=v*this.getAnchorY(),!(F.x<0||F.y<0||F.x>q||F.y>v)},getRect:function(){var J=this,Z=J.getWidth(),H=J.getHeight(),w=J.getAnchor(),v={x:-Z*w.x,y:-H*w.y,width:Z,height:H},M=J.getMatrix();return v=Bq([M.tf(v.x,v.y),M.tf(v.x+v.width,v.y),M.tf(v.x+v.width,v.y+v.height),M.tf(v.x,v.y+v.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var g=this,z=g.getAnchor(),c=g._anchorElevation;return{x:z.x,y:c,z:z.y}},setAnchorElevation:function(c){var K=this,O=K._anchorElevation;return O!==c?(K._anchorElevation=c,K.fp("anchorElevation",O,c),!0):!1},setAnchor3d:function(T,Q,m,k){var I,z=this;"number"==typeof T?I={x:T,y:Q,z:m}:(I=T.length?{x:T[0],y:T[1],z:T[2]}:T,k=Q);var U=z.getDataModel();U&&U.beginTransaction();var a=z.getAnchor3d(),g=z.setAnchor(I.x,I.z);if(z.setAnchorElevation(I.y)&&(g=!0),g&&k&&!Sp){z.getAnchor3d();var v=yh(z),C=Zk([I.x-a.x,I.y-a.y,I.z-a.z],v);z.p3(C)}return U&&U.endTransaction(),g},getAnchor:function(){var Y=this;if(Y.hasOwnProperty("_anchor"))return Y._anchor;var Z=nb(Y._image);return Z&&Z.anchorX!==r?{x:Z.anchorX,y:Z.anchorY}:Y._anchor},setAnchor:function(e,d,j){var r,G=this;"number"==typeof e?r={x:e,y:d}:(r=e.length?{x:e[0],y:e[1]}:e,j=d);var M=G.getAnchor();if(M.x!==r.x||M.y!==r.y){var y=G.getDataModel();if(y&&y.beginTransaction(),G._anchor=r,G.fp("anchor",M,r),j&&!Sp){var x=G.getPosition(),N=G.getSize(),A=G.getRotation(),s=G.getScale(),E=-N.width*(M.x-r.x)*s.x,_=-N.height*(M.y-r.y)*s.y,c=w(A),Z=b(A);G.setPosition(x.x+Z*E-c*_,x.y+c*E+Z*_)}return y&&y.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(K,t){var r,C=this;r=2===arguments.length?{x:K,y:t}:K;var n=C.getScale();(n.x!==r.x||n.y!==r.y)&&(C._scale=r,C.fp("scale",n,r))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var e=this,Z=e._scaleTall,P=e.getScale();return[P.x,Z,P.y]},getFinalScale3d:function(){var e=this,Z=e.s3(),w=e._dynamicScale3d,A=e.getScale3d();return Z&&(A[0]*=Z[0],A[1]*=Z[1],A[2]*=Z[2]),w&&(A[0]*=w[0],A[1]*=w[1],A[2]*=w[2]),A},getFinalRotation3d:function(){var H=this;return H._dynamicRotation||H.r3()},setScaleTall:function(c){var P=this,k=P._scaleTall;k!==c&&(P._scaleTall=c,P.fp("scaleTall",k,c))},setScale3d:function(M,B,N){var o,Y=this;o="number"==typeof M?{x:M,y:B,z:N}:M.length?{x:M[0],y:M[1],z:M[2]}:M,Y.setScaleTall(o.y),Y.setScale(o.x,o.z)},getCorners:function(e,h){e==s&&(e=0),h==s&&(h=e);var P=this,l=P.getAnchor(),S=P.getWidth(),v=P.getHeight(),d=-S*l.x-e,x=-v*l.y-h,j=S+2*e,J=v+2*h,y=P.getMatrix();return[y.tf(d,x),y.tf(d,x+J),y.tf(d+j,x+J),y.tf(d+j,x)]},getEditControlPoints:function(Q,z,c){z==s&&(z=0),c==s&&(c=z);var b=this,i=b.getAnchor(),_=b.getWidth(),q=b.getHeight(),X=-_*i.x-z,w=-q*i.y-c,h=_+2*z,O=q+2*c;if(Q)return[{x:X,y:w},{x:X,y:0},{x:X,y:w+O},{x:0,y:w+O},{x:X+h,y:w+O},{x:X+h,y:0},{x:X+h,y:w},{x:0,y:w}];var Y=b.getMatrix();return[Y.tf(X,w),Y.tf(X,0),Y.tf(X,w+O),Y.tf(0,w+O),Y.tf(X+h,w+O),Y.tf(X+h,0),Y.tf(X+h,w),Y.tf(0,w)]},rotateAt:function(E,z,p){var g=this,q=g._position,f=g._64O,N=new Tk(f,q.x,q.y).tf(E,z),i=W(E*E+z*z),U=Z(q.y-N.y,q.x-N.x)+p;g.setRotation(f+p),g.p(N.x+i*b(U),N.y+i*w(U))},onParentChanged:function(){Vb.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(a){a._7I()})},onPropertyChanged:function(){var z={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(T){z[T]=!0}),function(h){var Y=this;Vb.superClass.onPropertyChanged.call(Y,h),z[h.property]&&!Y._layoutUpdating&&Y.updateLayoutParameters(null,h.property),Y._69O&&Y._69O.each(function(N){N.handleHostPropertyChange(h)}),Y._49I&&Y._49I.each(function(I){I.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(P){this.updateAttach(P)},onStyleChanged:function(B){Vb.superClass.onStyleChanged.apply(this,arguments),Vg[B]&&this.updateAttach()},updateAttach:function(q){var t=this;t._51I||Sp||(t._51I=1,t._71O(q),delete t._51I)},_71O:function(v){var H,e,z,U,V,T,X=this,l=X._host,t=v?v.property:s,S=v?v.oldValue:s,a=v?v.newValue:s;if(l instanceof I.Grid){if(t===Jd)X.setElevation(X._54O+a-S);else if(!v||zp[t]){if(H=X.s("attach.row.index"),e=X.s("attach.column.index"),z=l.getCellRect(H,e),!z)return;U=X.s("attach.row.span"),V=X.s("attach.column.span"),(1!==U||1!==V)&&(z=Og(z,l.getCellRect(H+U-1,e+V-1))),xj(z,X,"attach.padding",1),X.setRect(z)}}else if(l instanceof Dd&&(T=X.s("attach.index"))>=0&&(!v||Fh[t])){var A=X.s("attach.thickness");A!=s&&X.setHeight(l.getThickness()*A);var w=X.s("attach.offset"),r=l.getPoints(),h=r.size();if(h>T){var Q=r.get(T),_=h===T+1?r.get(0):r.get(T+1),c=[_.x-Q.x,_.y-Q.y],R=Bg(c);if(R){X.s("attach.offset.relative")&&(w*=R),X.s("attach.offset.opposite")&&(w=R-w);var m={x:Q.x+c[0]/R*w,y:Q.y+c[1]/R*w},C=X.s("attach.gap");C&&(X.s("attach.gap.relative")&&(C*=l.getThickness()),m=Jo(s,m,_,C)),X.p(m),X.setRotation(Z(c[1],c[0]))}}}else v&&(t===Yb?X.translate(a.x-S.x,a.y-S.y):t===Jd?X.setElevation(X._54O+a-S):xf[t]?X._11Q(l,t,a-S):("anchor"===t||"width"===t||"height"===t||"scale"===t)&&X.layout(l))},_11Q:function(){var q=new I.Math.Euler,z=I.Math.Euler.ReverseOrder,b=new I.Math.Vector2,W=new I.Math.Vector2;return function(w,K,N){var d=this,f=w.p3(),v=w.r3(),x=d.p3(),m=d.r3();if(K===Nc&&(K="rotationY",N=-N),(K===Nc||"rotationY"===K)&&0===m[0]&&0===m[2]&&0===v[0]&&0===v[2]&&0===x[1]&&0===f[1])return d.setRotation(-m[1]-N),b.set(x[0],x[2]).rotateAround(W.set(f[0],f[2]),-N),d.p(b.x,b.y),void 0;var P=nd[w.getRotationMode()],Q=P[0],k=P[1],V=P[2],U=Lj[Q],H=Lj[k],n=Lj[V],E=Rp();K===Nc+Q?(n(E,v[Kn[V]]),H(E,v[Kn[k]]),U(E,N),H(E,-v[Kn[k]]),n(E,-v[Kn[V]])):K===Nc+k?(n(E,v[Kn[V]]),H(E,N),n(E,-v[Kn[V]])):K===Nc+V&&n(E,N);var S=tn(x,f);Zk(S,E),d.p3(f[0]+S[0],f[1]+S[1],f[2]+S[2]);var g=d.getRotationMode();ti(E,d.r3(),g),q.setFromRotationMatrix(E,z(g)),d.r3([q.x,q.y,q.z])}}(),isHostOn:function(R){var U=this;if(U._host&&R&&R._69O)for(var h={},n=U._host;n&&n!==U&&!h[n._id];){if(n===R)return!0;h[n._id]=n,n=n._host}return!1},isLoopedHostOn:function(n){return this.isHostOn(n)&&n.isHostOn(this)},getScaledSize:function(){var f=this.getSize(),l=this.getScale();return f.width*=Math.abs(l.x),f.height*=Math.abs(l.y),f},layout:function(z){if(z=z||this.getHost()){var $=this,S=$.s("layout.h")||"center",p=$.s("layout.v")||"center";if("center"!==S||"center"!==p){var K=new I.Math.Vector2,L=z.getPosition(),E=z.getAnchor(),a=z.getScaledSize();$.getPosition();var q,d,Q,X,n,o=1,x=1;switch($._layoutUpdating=!0,S){case"left":K.setX($._layoutHValue-E.x*a.width);break;case"right":K.setX((1-E.x)*a.width-$._layoutHValue);break;case"leftright":q=a.width-$._layoutHValue[2],Q=$.getRotation()-z.getRotation(),X=Math.abs(Math.sin(Q)),n=Math.abs(Math.cos(Q)),o+=n*q/$._layoutHValue[3],x+=X*q/$._layoutHValue[4],K.setX($._layoutHValue[1]+($._layoutHValue[5]-E.x)*a.width);break;case"center":K.setX((.5-E.x)*a.width-$._layoutHValue);break;case"scale":Q=$.getRotation()-z.getRotation(),X=Math.abs(Math.sin(Q)),n=Math.abs(Math.cos(Q)),K.setX((.5-E.x)*a.width-$._layoutHValue[1]*a.width/$._layoutHValue[0]),d=a.width/$._layoutHValue[2]-1,o+=n*d,x+=X*d}switch(p){case"top":K.setY($._layoutVValue-E.y*a.height);break;case"bottom":K.setY((1-E.y)*a.height-$._layoutVValue);break;case"topbottom":Q||(Q=$.getRotation()-z.getRotation(),X=Math.abs(Math.sin(Q)),n=Math.abs(Math.cos(Q))),q=a.height-$._layoutVValue[2],o+=X*q/$._layoutVValue[3],x+=n*q/$._layoutVValue[4],K.setY($._layoutVValue[1]+($._layoutVValue[5]-E.y)*a.height);break;case"center":K.setY((.5-E.y)*a.height-$._layoutVValue);break;case"scale":Q||(Q=$.getRotation()-z.getRotation(),X=Math.abs(Math.sin(Q)),n=Math.abs(Math.cos(Q))),K.setY((.5-E.y)*a.height-$._layoutVValue[1]*a.height/$._layoutVValue[0]),d=a.height/$._layoutVValue[2]-1,o+=X*d,x+=n*d}(1!==o||1!==x)&&("leftright"===S||"scale"===S?$.setSize($._layoutHValue[3]*o,$._layoutHValue[4]*x):$.setSize($._layoutVValue[3]*o,$._layoutVValue[4]*x)),K.rotateAround(null,z.getRotation()),this.setPosition(K.x+L.x,K.y+L.y),$._layoutUpdating=r}}},updateLayoutParameters:function(d,U){if(d=d||this.getHost()){var w=this,j=w.s("layout.h"),S=w.s("layout.v");if(j||S){var b,z,h,n,R,i,o=new I.Math.Vector2,v=d.getPosition(),X=d.getAnchor(),_=d.getScaledSize(),Q=w.getPosition(),u=w.getSize();switch(o.set(Q.x-v.x,Q.y-v.y),o.rotateAround(null,-d.getRotation()),j){case"left":w._layoutHValue=o.x+X.x*_.width;break;case"right":w._layoutHValue=-o.x+(1-X.x)*_.width;break;case"center":w._layoutHValue=-o.x+(.5-X.x)*_.width;break;case"leftright":case"scale":"scale"===j?b=-o.x+(.5-X.x)*_.width:(z=w.getAnchor(),h=w.getRotation()-d.getRotation(),n=Math.cos(h),R=Math.sin(h),i=-Math.min(-z.x*n+z.y*R,-z.x*n-(1-z.y)*R,(1-z.x)*n+z.y*R,(1-z.x)*n-(1-z.y)*R),b=o.x-(i-X.x)*_.width),"position"===U&&"object"==typeof w._layoutHValue?(w._layoutHValue[0]=_.width,w._layoutHValue[1]=b):w._layoutHValue=[_.width,b,_.width,u.width,u.height,i]}switch(S){case"top":w._layoutVValue=o.y+X.y*_.height;break;case"bottom":w._layoutVValue=-o.y+(1-X.y)*_.height;break;case"center":w._layoutVValue=-o.y+(.5-X.y)*_.height;break;case"topbottom":case"scale":"scale"===S?b=-o.y+(.5-X.y)*_.height:(h||(z=w.getAnchor(),h=w.getRotation()-d.getRotation(),n=Math.cos(h),R=Math.sin(h)),i=-Math.min(-z.x*R-z.y*n,-z.x*R+(1-z.y)*n,(1-z.x)*R-z.y*n,(1-z.x)*R+(1-z.y)*n),b=o.y-(i-X.y)*_.height),"position"===U&&"object"==typeof w._layoutVValue?(w._layoutVValue[0]=_.height,w._layoutVValue[1]=b):w._layoutVValue=[_.height,b,_.height,u.width,u.height,i]}}}},getSerializableProperties:function(){var h=Vb.superClass.getSerializableProperties.call(this);return Kk(h,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),h}});var Fp=I.Edge=function(u,F){var C=this;jj(Fp,C),C.setSource(u),C.setTarget(F)};Lf("Edge",re,{_icon:"edge_icon",getUIClass:function(){return Ck},_22Q:function(){return $p},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(h){var j=this;if(j._source!==h){var F=j._source;j._source=h,F&&F._16I(j),h&&h._2I(j),j._7I(),j.fp("source",F,h)}},setTarget:function(f){var O=this;if(O._target!==f){var x=O._target;O._target=f,x&&x._18I(O),f&&f._4I(O),O._7I(),O.fp("target",x,f)}},isLooped:function(){var W=this;return W._source===W._target&&!!W._source&&!!W._target},onPropertyChanged:function(){},_7I:function(){var C,h=this,q=_b(h);h._40I!==q&&(C=this._40I,C&&C._15I(h),h._40I=q,q&&q._1I(h),h.fp("sourceAgent",C,q),Ok(C,h._41I),Ok(q,h._41I));var G=dr(h);h._41I!==G&&(C=h._41I,C&&C._17I(h),h._41I=G,G&&G._3I(h),h.fp("targetAgent",C,G),Ok(C,h._40I),Ok(G,h._40I))},_22I:function(I){this._52I=I,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var M=this;return M._52I&&M._52I.get(0)!==M&&!M.getStyle(bb)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var q=this,w=q._52I;return w&&!q.getStyle(bb)&&w.size()>1&&q===w.get(0)},toggle:function(){var T=this._52I,d=!this.s(bb);T&&T.size()>1&&(T.each(function(n){n.s(bb,d)}),T.getSiblings().each(function(g){g!==T&&g.each(function(w){w.fp("edgeGroup",s,g)})}))},setStyle:function(x,V){(x===mi||"edge.segments"===x)&&(V=Pp(V)),Fp.superClass.setStyle.call(this,x,V)},onStyleChanged:function(J){Fp.superClass.onStyleChanged.apply(this,arguments),Bo[J]&&Ok(this._41I,this._40I)},getSerializableProperties:function(){var v=Fp.superClass.getSerializableProperties.call(this);return Kk(v,{source:1,target:1}),v}});var Mp=I.Group=function(){jj(Mp,this)};Lf("Group",Vb,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return rq},onChildAdded:function(){Mp.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Mp.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var V=this;if(!V._54I&&!Sp){var U=V.getChildrenRect();U&&(V._53I=1,V.p(Rf(V.s("group.position"),U,V.getSize())),delete V._53I)}},getChildrenRect:function(){var e,S=this;return S.eachChild(function(k){lb(k)&&(e=Og(e,S.getChildRect(k)))}),e},getChildRect:function(o){var x;return lb(o)&&o.s(ed)&&(Ig(o)&&o.isExpanded()&&o.eachChild(function(R){x=Og(x,o.getChildRect(R))}),!x&&o.getRect&&(x=o.getRect())),x},setPosition:function(n,q){var Z=this;if(!Z._54I){var E;E=2===arguments.length?{x:n,y:q}:n,Sp||Z._53I||(Z._54I=1,oh(Z._children,E.x-Z._position.x,E.y-Z._position.y),delete Z._54I),Mp.superClass.setPosition.call(this,E)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(T){var p=this;if(p._57O!==T){var b=p._57O;p._57O=T,p.fp("expanded",b,p._57O),p._fireInvalidateDeep(),p._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(I){Ig(I)?I._fireInvalidateDeep():I.iv()})},_8I:function(){Mp.superClass._8I.call(this),this.eachChild(function(i){lb(i)&&i._8I()})},onStyleChanged:function(E){Mp.superClass.onStyleChanged.apply(this,arguments),"group.position"===E&&this._81I()},getSerializableProperties:function(){var u=Mp.superClass.getSerializableProperties.call(this);return u.expanded=1,u}});var Ud=I.Block=function(){jj(Ud,this)};Lf("Block",Vb,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Jj},onChildAdded:function(){Ud.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Ud.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var S=this;if(!Sp&&!S._updatingToChildren&&S._syncSize&&!S._freezeSyncFromChildren){var e,A,j,z,i,v=[],N=S.getRotation();if(S.eachChild(function(F){lb(F)&&v.push.apply(v,F.getCorners())}),v.length){S._updatingFromChildren=1;var L=b(-N),K=w(-N),D=1/0,l=-1/0,y=1/0,n=-1/0;for(z=0,i=v.length;i>z;z++)j=v[z],e=j.x,A=j.y,j.x=L*e-K*A,j.y=K*e+L*A,D=$(D,j.x),l=t(l,j.x),y=$(y,j.y),n=t(n,j.y);var H=S.getScale();S.setSize(P((l-D)/H.x),P((n-y)/H.y));var B;H.x<0&&(B=D,D=l,l=B),H.y<0&&(B=y,y=n,n=B),L=b(N),K=w(N);var r=S.getAnchor();e=D+(l-D)*r.x,A=y+(n-y)*r.y,S.setPosition(L*e-K*A,K*e+L*A),delete S._updatingFromChildren}}},setPosition:function(m,y){var J=this;if(!J._updatingToChildren){var j;j=2===arguments.length?{x:m,y:y}:m,Sp||J._updatingFromChildren||(J._updatingToChildren=1,oh(J._children,j.x-J._position.x,j.y-J._position.y),delete J._updatingToChildren),Ud.superClass.setPosition.call(this,j)}},setWidth:function(n){return this.setSize(n,this.getHeight())},setHeight:function(X){return this.setSize(this.getWidth(),X)},setSize:function(l,z){1>l&&(l=1),1>z&&(z=1);var Q=this;if(!Q._updatingToChildren){2!==arguments.length&&(z=l.height,l=l.width);var a=Q.getWidth(),S=Q.getHeight();if(l!==a&&Ud.superClass.setWidth.call(Q,l),z!==S&&Ud.superClass.setHeight.call(Q,z),!Sp&&!Q._updatingFromChildren){Q._updatingToChildren=1;var h=l/a,p=z/S;Q._adjustChildScaleOrSize(h,p,"size"),delete Q._updatingToChildren,Q.updateFromChildren()}}},_adjustChildScaleOrSize:function(g,Y,l){var Q=this;if(Q._syncSize){var d=Q.getPosition(),c=Q.getRotation();Q.getScale(),Q.eachChild(function(a){if(lb(a)){var Q=a.getPosition(),j=a.getRotation(),R=a.getWidth(),z=a.getHeight(),m=a.getScale(),k=m.x*R,q=m.y*z,M=new Tk(j,Q.x,Q.y,k,q);M.translate(-d.x,-d.y),M.rotate(-c),j=Z(M.b*Math.sign(k),M.a*Math.sign(k)),M.scale(g,Y);var J,F,e,L=b(j);if(Math.abs(L)<.001?(J=w(j),F=M.b/J,e=-M.c/J):(F=M.a/L,e=M.d/L),"scale"===l)a.setScale(F/R,e/z);else if("size"===l){var N=F/m.x,x=e/m.y;a.setScale(gr(F)*Math.abs(m.x),gr(e)*Math.abs(m.y)),a instanceof I.Shape?(a.setWidthForce(Math.max(Math.abs(N),1e-5)),a.setHeightForce(Math.max(Math.abs(x),1e-5))):a.setSize(Math.max(.01,Math.abs(N)),Math.max(.01,Math.abs(x)))}M.rotate(c),M.translate(d.x,d.y),a.setPosition(M.tx,M.ty)}})}},_calcChangeFactor:function(L,A,m,s){var z,y,f,H;return z=P(L),y=P(m),f=z>y?z/y:y/z,z=P(A),y=P(s),H=z>y?z/y:y/z,t(f,H)},setAnchor:function(){var l=this;if(!l._updatingToChildren){var Q=l.getAnchor();if(Ud.superClass.setAnchor.apply(l,arguments),!Sp&&!l._updatingFromChildren&&l._syncSize){l._updatingToChildren=1;var P=l.getAnchor();l.getPosition();var G=l.getSize(),H=l.getScale(),u=l.getRotation(),z=-G.width*H.x*(Q.x-P.x),C=-G.height*H.y*(Q.y-P.y),I=w(u),S=b(u),a=S*z-I*C,K=I*z+S*C;l.eachChild(function(p){if(lb(p)){var V=p.getPosition();p.setPosition(V.x-a,V.y-K)}}),delete l._updatingToChildren}}},setRotation:function(N){var I=this;if(!I._updatingToChildren){var C=I.getRotation();if(Ud.superClass.setRotation.apply(I,arguments),!Sp&&!I._updatingFromChildren){I._updatingToChildren=1;var r=I.getPosition(),o=N-C;I.eachChild(function(E){if(lb(E)){var V=E.getMatrix();V.translate(-r.x,-r.y),V.rotate(o),V.translate(r.x,r.y);var s=Math.sign(E.getScale().x);E.setRotation(Z(V.b*s,V.a*s)),E.setPosition(V.tx,V.ty)}}),delete I._updatingToChildren}}},setScale:function(R,l){var s=this;if(!s._updatingToChildren){null==l&&(l=R.y,R=R.x);var r=s.getScale();if(P(R)<.01&&(R=.01*(gr(R)||gr(r.x))),P(l)<.01&&(l=.01*(gr(l)||gr(r.y))),Ud.superClass.setScale.call(s,R,l),!Sp&&!s._updatingFromChildren){s._updatingToChildren=1;var z=R/r.x,T=l/r.y;s._adjustChildScaleOrSize(z,T,"size"),delete s._updatingToChildren,s.updateFromChildren()}}},getSerializableProperties:function(){var t=Ud.superClass.getSerializableProperties.call(this);return t.clickThroughEnabled=1,t.syncSize=1,t}});var cg=I.Grid=function(){jj(I.Grid,this)};Lf("Grid",Vb,{IRotatable:!1,_icon:"grid_icon",_image:s,getUIClass:function(){return _p},setRotation:function(){},getCellRect:function(q,g){var Y=this,R=Y.s("grid.row.count"),u=Y.s("grid.column.count");if(0>=R||0>=u||0>q||q>=R||0>g||g>=u)return s;var D,V,E,Q=Y.getRect(),m=Y.s("grid.row.percents"),X=Y.s("grid.column.percents");if(xj(Q,Y,"grid.border",-1),m&&m._as&&(m=m._as),X&&X._as&&(X=X._as),m&&m.length===R){for(E=0,D=0;q>D;D++)E+=Q.height*m[D];Q.y+=E,Q.height=Q.height*m[q]}else Q.height=Q.height/R,Q.y+=Q.height*q;if(X&&X.length===u){for(V=0,D=0;g>D;D++)V+=Q.width*X[D];Q.x+=V,Q.width=Q.width*X[g]}else Q.width=Q.width/u,Q.x+=Q.width*g;return mf(Q,-Y.s("grid.gap")),Q}});var lo=I.Text=function(){jj(lo,this),this.setSize(100,50),this.s("text","TEXT")};Lf("Text",Vb,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Jk},setWidth:function(H){H||(H=.001),lo.superClass.setWidth.call(this,H)},setHeight:function(h){h||(h=.001),lo.superClass.setHeight.call(this,h)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Zc("__text__",{width:{value:100,isSafeFunc:!0,func:function(i){return i._width}},height:{value:50,isSafeFunc:!0,func:function(o){return o._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Dd=I.Shape=function(){jj(Dd,this),this._59O=new Ce};Dd.__de__=Pq,Lf("Shape",Vb,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return rr},_22Q:function(){return _l},getLength:function(m){return Rl(Wp(this._59O,this._58O,m,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var u=this._58O;return u?new Ce(u._as.slice(0)):u},setSegments:function(D){var R=this._58O;D=D?xd(D)?new Ce(D.slice(0)):new Ce(D._as.slice(0)):null,(R&&D&&R._as.join(",")!==D._as.join(",")||R!==D)&&(this._58O=D,this.fp("segments",R,D))},getPoints:function(){return this._59O},toPoints:function(){var t=this._59O;return new Ce(t._as.slice(0))},setPoints:function(u,q){var A=this,C=A._59O;u=u?xd(u)?new Ce(u.slice(0)):new Ce(u._as.slice(0)):new Ce;var L,e,O,w,n,i;q&&(L=A.getPosition(),i=new Tk(A.getRotation(),0,0,A.getScale().x,A.getScale().y)),(C&&u&&C._as.join(",")!==u._as.join(",")||C!==u)&&(A._59O=u,A.fs(),A.fp("points",C,u)),q&&(e=A.getPosition(),O=e.x-L.x,w=e.y-L.y,n=i.tf(O,w),A.setPosition(e.x-O+n.x,e.y-w+n.y))},addPoint:function(u,l,J){var h=this.toPoints();h.add(u,l),this.setPoints(h,J)},setPoint:function(w,m,q){var b=this.toPoints();b.set(w,m),this.setPoints(b,q)},removePointAt:function(n){var M=this.toPoints();M.removeAt(n),this.setPoints(M)},setWidthForce:function(e){var C=this;if(!C._55I&&!Sp&&C.getWidth()){C._55I=1;var s=C._position.x,P=e/C.getWidth(),M=C.toPoints(),h=new Ce;M.each(function($){h.add({x:($.x-s)*P+s,y:$.y,e:$.e})}),C.setPoints(h),_f(C,[P,0,0,1,s*(1-P),0]),C.fs(),delete C._55I}Dd.superClass.setWidth.call(C,e)},setWidth:function(l){return this.setWidthForce(1>l?1:l)},setHeightForce:function(U){var K=this;if(!K._55I&&!Sp&&K.getHeight()){K._55I=1;var G=K._position.y,e=U/K.getHeight(),w=K.toPoints(),A=new Ce;w.each(function(i){A.add({x:i.x,y:(i.y-G)*e+G,e:i.e})}),K.setPoints(A),_f(K,[1,0,0,e,0,G*(1-e)]),K.fs(),delete K._55I}Dd.superClass.setHeight.call(K,U)},setHeight:function(T){return this.setHeightForce(1>T?1:T)},setAnchorElevation:function(g){var n=this;n._55I=!0;var S=n._updatingAnchor3d,_=!Sp&&!S;if(_){var R,M=g,j=n.getAnchorElevation(),e=n.getTall();R=e*(j-M),n.shiftPointsElevation(R)}var C=Dd.superClass.setAnchorElevation.apply(n,arguments);return S||delete n._55I,C},getShapeElevation:function(){var q=this,w=q._54O;return w-(q.getTall()||0)*(q._anchorElevation-.5)},setAnchor3d:function(H,j,C,o){var S,i=this;"number"==typeof H?S={x:H,y:j,z:C}:(S=H.length?{x:H[0],y:H[1],z:H[2]}:H,o=j),i._55I=!0,i._updatingAnchor3d=!0;var F=i.getDataModel();if(F&&F.beginTransaction(),!Sp){var Q=i.getAnchor3d(),t=i.getSize(),m=i.getTall(),N=t.width*(Q.x-S.x),b=t.height*(Q.z-S.z),e=m*(Q.y-S.y);o||i.shiftPoints(N,b,e);var l=i.p3()}var h=Dd.superClass.setAnchor3d.apply(i,arguments);if(!Sp&&o){var v=i.p3();i.shiftPoints(v[0]-l[0]+N,v[2]-l[2]+b,v[1]-l[1]+e)}return F&&F.endTransaction(),delete i._updatingAnchor3d,delete i._55I,h},setAnchor:function(Z,N,J){var E=this;E._55I=!0;var s=E._updatingAnchor3d,d=!Sp&&!s;if(d){var v,f,$;"number"==typeof Z?$={x:Z,y:N}:($=Z.length?{x:Z[0],y:Z[1]}:Z,J=N);var g=E.getAnchor(),_=E.getSize();v=_.width*(g.x-$.x),f=_.height*(g.y-$.y),J||E.shiftPoints(v,f);var Q=E.getPosition()}var M=Dd.superClass.setAnchor.apply(E,arguments);if(d){var X=E.getPosition();J&&E.shiftPoints(X.x-Q.x+v,X.y-Q.y+f)}return s||delete E._55I,M},shiftPoints:function(m,r,L){var V=this,i=V.getElevation()||0,P=V.toPoints(),e=new Ce;P.each(function(Z){var F=Z.e;L&&(F=(F==s?i:F)+L),e.add({x:Z.x+m,y:Z.y+r,e:F})}),V.setPoints(e),V.fs()},shiftPointsElevation:function(K){return this.shiftPoints(0,0,K)},setPosition:function(n,H){var k,q=this;if(!q._28Q){if(q._28Q=1,!q._55I&&!Sp){k=2===arguments.length?{x:n,y:H}:n;var d=k.x-q._position.x,L=k.y-q._position.y;if(0===d&&0===L)return delete q._28Q,void 0;q._55I=1,q.shiftPoints(d,L),_f(q,[1,0,0,1,d,L]),delete q._55I}Dd.superClass.setPosition.apply(q,arguments),delete q._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var t=this;if(2!==t._59O.size())return!1;var g=t._58O;return g?2===g.size()&&1===g.get(0)&&2===g.get(1)?!0:!1:!0},fireShapeChange:function(){var k=this;if(!k._55I&&!Sp){var M=Bq(k._59O);M&&(k._55I=1,k.setRect(M),delete k._55I)}k.fp(jf,!1,!0)},getSerializableProperties:function(){var N=Dd.superClass.getSerializableProperties.call(this);return N.segments=1,N.points=1,N.thickness=1,N.closePath=1,N}});var im=I.Polyline=function(){jj(im,this),this.s({"shape.background":null,"shape.border.width":2})};Lf("Polyline",Dd,{_icon:"polyline_icon",_22Q:function(){return qf},getUIClass:function(){return eh},setClosePath:function(){},setTall:function(e){var g=this;if(!g._55I&&!g._24Q&&!Sp&&g.getTall()){g._24Q=1;var J=g._54O,r=e/g.getTall();g._59O.each(function(c){c.e=c.e==s?J:(c.e-J)*r+J}),g.fs(),delete g._24Q}im.superClass.setTall.call(g,e)},setElevation:function(F){var J=this;if(!J._55I&&!J._24Q&&!Sp){J._24Q=1;var M=F-J._54O;J._59O.each(function(Q){Q.e==s?Q.e=F:Q.e+=M}),J.fs(),delete J._24Q}im.superClass.setElevation.apply(J,arguments)},fireShapeChange:function(){var M=this,h=M._59O;if(!M._55I&&!M._24Q&&!Sp){var V=h.size();if(V){var I=1,A=h.get(0),v=M._54O;A.e==s&&(A.e=v);for(var e=A.e,y=0;V>I;I++){A=h.get(I),A.e==s&&(A.e=v);var Y=$(e,A.e),C=t(e+y,A.e);e=Y,y=C-Y}M._24Q=1,M.setTall(y),M.setElevation(e+y*M._anchorElevation),delete M._24Q}}im.superClass.fireShapeChange.apply(M,arguments)}});var Vk=I.SubGraph=function(){jj(Vk,this)};Lf("SubGraph",Vb,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Vk.superClass._8I.call(this),this.eachChild(function(y){lb(y)&&y._8I()})}}),l.loadingRefGraph=0;var po=I.RefGraph=function(){jj(po,this)};Lf("RefGraph",Ud,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(R){var c=this._ref;this._ref=R,this.fp("ref",c,R),this.updateRef()},_21I:function(){po.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var P=this;if(l.loadingRefGraph++,P.clearChildrenFromDataModel(),l.loadingRefGraph--,P._ref&&P._dataModel){P._xhrLoadHandler&&(P._xhrLoadHandler.cancel=!0);var F=Sp,k=P._xhrLoadHandler=function(p){if(p&&P._dataModel){l.loadingRefGraph++;var a=P._pendingUpdateInfo={needToRestore:F};F&&(a.position=P.p(),a.width=P.getWidth(),a.height=P.getHeight(),a.rotation=P.getRotation(),a.anchor=P.getAnchor(),a.scale=P.getScale()),P.p(0,0),P.setAnchor(.5,.5),P.setRotation(0),P.setScale(1,1);var T=l.parse(p),R=P._dataModel.deserialize(T,P,{justDatas:!0});R.each(function(j){j._refGraph=P}),P.checkPendingUpdateInfo(),l.loadingRefGraph--,l.handleRefGraphLoaded(P,R,T)}};k.xhrLoadCalled=!1,l.load(P._ref,function(z){k.cancel||(k.xhrLoadCalled?k(z):Ui(function(){k(z)}))}),k.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var c=this,T=c._pendingUpdateInfo;if(!T)return c.onPendingUpdated&&(l.loadingRefGraph++,c.onPendingUpdated(),l.loadingRefGraph--),void 0;var o=!0;this.eachChild(function(d){(d._pendingCheckImageJSON||d._pendingUpdateInfo)&&(o=!1)}),o&&(l.loadingRefGraph++,c._pendingUpdateInfo=null,c.updateFromChildren(),T.needToRestore&&(c.setSize(T.width,T.height),c.setAnchor(T.anchor),c.setRotation(T.rotation),c.setScale(T.scale),c.p(T.position)),this.getParent()instanceof po&&this.getParent().checkPendingUpdateInfo(),c.onPendingUpdated&&c.onPendingUpdated(),l.loadingRefGraph--)},getSerializableProperties:function(){var l=po.superClass.getSerializableProperties.call(this);return l.ref=1,l}}),I.EdgeGroup=function(F,Z){this._70O=F,this._siblings=Z;for(var X,x,d=0,V=F.size(),B=g[bb];V>d;d++)if(X=F.get(d).getStyle(bb,!1),X!=s){B=X;break}B==s&&(B=!0);var i=l.edgeGroupAgentFunc;for(i&&(x=i(F),x&&x!==F.get(0)&&(F.remove(x),F.add(x,0))),d=0;V>d;d++)F.get(d).s(bb,B)},Lf("EdgeGroup",H,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(y){return this._70O.get(y)},indexOf:function(q){return this._70O.indexOf(q)},each:function(p,_){this._70O.each(p,_)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(F,K){this._siblings.each(function(N){N._70O.each(F,K)})}});var gs=function(C,c,S){var Y=$d[C]={type:C,action:c};if(S)for(var G in S)Y[G]=S[G]};Kk(l,{setConnectAction:gs,getConnectAction:function(V,N){if(!N){if(!V)return null;N=V.getCurrentConnectActionType()}return $d[N]},doConnectAction:function(D,h,i,r){r=r||D.getCurrentConnectActionType();var p=$d[r];if(!p)return!1;var M=p.action;return M?(h instanceof Bd.Group?D.sm().getSelection().each(function(O){M.call(null,D,O,i)}):M.call(null,D,h,i),!0):!1},doDeleteConnectionAction:function(z,V,E){E=E||z.getCurrentConnectActionType();var d=$d[E];if(!d||!d.delete)return!1;var $=d.delete.action;return $?(V instanceof Bd.Group?z.sm().getSelection().each(function(c){$.call(null,z,c)}):$.call(null,z,V),!0):!1}});var Bb=I.JSONSerializer=function(b,j){this.dm=this._dataModel=b,this._hierarchical=l.forceHierarchicalSerialization?!0:j==s?b.isHierarchicalRendering():j};Lf("JSONSerializer",H,{ms_ac:["hierarchical"],serialize:function(B){return l.stringify(this.toJSON(),B)},toJSON:function(){var M=this,H=M.dm,y=H.getRoots(),S=M.json={v:l.getVersion(),p:{},a:{},d:[]},u=H.getSerializableAttrs();H.getInit()&&(S.init=H.getInit()),H.getName()&&(S.p.name=H.getName()),H.getBackground()&&(S.p.background=H.getBackground()),H.getLayers()&&(S.p.layers=H.getLayers()),H.getEnvmap()&&(S.p.envmap=H.getEnvmap()),S.p.autoAdjustIndex=H.isAutoAdjustIndex(),S.p.hierarchicalRendering=H.isHierarchicalRendering();for(var p in u){var I=H.a(p);I!==r&&M[Ib](p,I,S.a)}return rb(S.a)&&delete S.a,M._hierarchical?y.each(M.serializeData,this):H.each(function(d){M.serializeData(d)}),H.fireSerializeEvent({type:"serialize",json:S}),H.getPostProcessingData()&&(S.p.postProcessingData=H.getPostProcessingData()),S},isSerializable:function(){return!0},getProperties:function(Y){return Y.getSerializableProperties()
    },getStyles:function(s){return s.getSerializableStyles()},getAttrs:function(q){return q.getSerializableAttrs()},serializeData:function(o){var V=this;if(V.isSerializable(o)&&!o._refGraph){var J,n,T,q,p=um(o.getClassName())||o.getClass(),m=new p,G={c:o.getClassName(),i:o.getId(),p:{},s:{},a:{}};V.json.d.push(G),J=V.getProperties(o);for(n in J)if(/^_/.test(n)){if(T=o[n],("_width"===n||"_height"===n)&&T===r){var R;((o.s("layout.h")||o.s("layout.v"))&&o.getHost()||o instanceof I.Node&&(R=o.getParent())&&R instanceof I.Block||o.s("fullscreen"))&&(T=o[n]="_width"===n?o.getWidth():o.getHeight())}T!==m[n]&&V[Ib](n.substr(1),T,G.p)}else q=Xk(n),o[q]&&(T=o[q](),T!==m[q]()&&V[Ib](n,T,G.p));J=V.getStyles(o);for(n in J)T=o.s(n),T!==m.s(n)&&V[Ib](n,T,G.s);J=V.getAttrs(o);for(n in J)T=o.a(n),T!==m.a(n)&&V[Ib](n,T,G.a);rb(G.p)&&delete G.p,rb(G.s)&&delete G.s,rb(G.a)&&delete G.a}V._hierarchical&&o.getChildren().each(V.serializeData,V)},serializeValue:function(X,s,t){pn(s)?s={__a:s._as}:s instanceof re&&(s={__i:s.getId()}),t[X]=s},deserialize:function(N,o,Y){var J=this;return Kl(N)&&/.json$/.test(N)?(l.xhrLoad(N,function(V){J.deserializeImpl(V,o,Y)}),void 0):J.deserializeImpl(N,o,Y)},deserializeImpl:function(o,b,a){var h=this,L=h.dm;a=Xp(a)?{setId:a}:Ym(a)?{finishFunc:a}:a||{},o=h.json=Kl(o)?l.parse(o):o,o.a&&o.a.onPreDeserialize&&!a.disableOnPreDeserialize&&o.a.onPreDeserialize(o,L,a.view),L.beginTransaction(),Sp++,h._82I={};var f=new Ce,S=new Ce,V=0,D=o.d.length;if(a.justDatas||(Ym(o.init)&&o.init(L),L.setInit(o.init)),!a.justDatas){for(var n in o.a)L.a(n,h[kd](o.a[n]));for(var d in o.p)L[Lb(d)](o.p[d])}for(;D>V;V++){var P=o.d[V],v=um(P.c),F=new v,Y=P.i;a.setId&&Y!=s&&(F._id=Y),h._82I[Y]=F,f.add(F),S.add(P)}for(V=0;D>V;V++)h.deserializeData(f.get(V),S.get(V));return f.each(function(y){b&&!y.getParent()&&y.setParent(b),L.add(y)}),L.fireSerializeEvent({type:"deserialize",json:o}),Sp--,L.endTransaction(),o.a&&o.a.onPostDeserialize&&!a.disableOnPostDeserialize&&o.a.onPostDeserialize(o,L,a.view,f),a.finishFunc&&a.finishFunc(o,L,a.view,f),f},deserializeData:function(X,Y){for(var G in Y.p)X[Lb(G)](this[kd](Y.p[G]));for(G in Y.s)X.s(G,this[kd](Y.s[G]));for(G in Y.a)X.a(G,this[kd](Y.a[G]))},deserializeValue:function(E){if(sk(E)){var e=E.__i;if(e!=s)return this._82I[e];if(e=E.__a,xd(e))return new Ce(e)}return E}}),Kk(hd,{serialize:function(n,M){return new Bb(this,M).serialize(n)},toJSON:function(f){return new Bb(this,f).toJSON()},deserialize:function(j,b,s){return new Bb(this).deserialize(j,b,s)}});var gl=I.OverlappingBox=function(Z){this.gv=Z,this.boxes={}};Lf("OverlappingBox",H,{clear:function(){var L,d,G=this.boxes;for(L in G)d=G[L],d.length=0},isOverlapping:function(T,n){var y,D,W=this,l=W.boxes,b=l[T];b?(y=b.rects,D=b.length):b=l[T]={rects:y=[],length:D=0};var x,w,n;for(x=0;D>x;x++)if(w=y[x],w.x<n.x+n.w&&w.x+w.w>n.x&&w.y<n.y+n.h&&w.h+w.y>n.y)return!0;return y.length<=D?(y.push(n),b.length++):y[b.length++]=n,!1}}),Kk(l,{fetch:function(c,F){var s="GET",k=!1,L=null,n="";F&&(s=F.method||"GET",k=F.sync,n=F.url,L=F.data||null),c.open(s,n,!k),F.responseType?c.responseType=F.responseType:F.overrideMimeType&&c.overrideMimeType&&c.overrideMimeType(F.overrideMimeType),c.send(L)},convertImageSrc:function(n,d){d&&"function"==typeof d||(d=function(){}),d(n)}});var ib=I.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Lf("Request",H,{_responseType:null,_overrideMimeType:"text/plain",send:function(k){var I=this._xhr,G=this.onload,L=this.onerror;this.getResponseType()?k.responseType=this.getResponseType():this.getOverrideMimeType()&&(k.overrideMimeType=this.getOverrideMimeType()),I.onload=G,I.onerror=L,l.fetch(I,k)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(p){this._responseType=p},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(o){this._overrideMimeType=o},getResponseText:function(){var $=this._xhr;return $.response||$.responseText}}),pi.GraphView=function(v){var p=this;p._24I={},p._34I=new Ce,p._25I={},p._56I={},p._view=js(1,p),p._canvas=Ub(p._view),p.dm(v?v:new hd),this._coreInteractor=new yr(this),p.setEditable(!1),p.setScrollBarVisible(l.graphViewScrollBarVisible)},vl("GraphView",H,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Sb,Um,Sg,kg,"resettable","editInteractor",Yr,"zoomable","pannable","rectSelectable","autoScrollZone",Tn,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:l.graphViewZoomable,_resettable:l.graphViewResettable,_pannable:l.graphViewPannable,_rectSelectable:l.graphViewRectSelectable,_autoScrollZone:l.graphViewAutoScrollZone,_rectSelectBackground:l.graphViewRectSelectBackground,_rectSelectBorderColor:l.graphViewRectSelectBorderColor,_editPointSize:l.graphViewEditPointSize,_editPointBorderColor:l.graphViewEditPointBorderColor,_editPointBackground:l.graphViewEditPointBackground,_scrollBarColor:ps,_scrollBarSize:ms,_autoHideScrollBar:em,_autoMakeVisible:$o,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(_){this._dataModel.setLayers(_)},setEditable:function(r){var n=this,y=n.__interactorMap__;if(!y){var p=pi.XEditInteractor;y=n.__interactorMap__={scrollBar:new Ol(n),select:new Fc(n),edit:p?new p(n):new jb(n),move:new jh(n),"default":new Xn(n),touch:new Hj(n,{editable:!1})}}r?(n._uieditable=!0,n.setInteractors([y.scrollBar,y.select,y.edit,y.move,y.default,y.touch])):(n._uieditable=!1,n.setInteractors([y.scrollBar,y.select,y.move,y.default,y.touch]))},getCanvas:function(){return this._canvas},_33I:function(A){var z=A.getUIClass();return z?new z(this,A):s},getDataUI:function(R){var s=this,L=s._25I[R._id];return L===r&&(L=s._33I(R),s._25I[R._id]=L),L},getNodeRect:function(t){return l.getNodeRect(this,t)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(A){var j=this.getDataUI(A);return j?(j._79o(),j._78o):null},getEdgeSourcePosition:function(T){var q=this,B=q.getDataUI(T),D=B.s,n=B._data._40I;return zs(q,n,D("edge.source.position"),D("edge.source.offset.x"),D("edge.source.offset.y"),D("edge.source.anchor.x"),D("edge.source.anchor.y"))},getEdgeTargetPosition:function(F){var j=this,Z=j.getDataUI(F),n=Z.s,K=Z._data._41I;return zs(j,K,n("edge.target.position"),n("edge.target.offset.x"),n("edge.target.offset.y"),n("edge.target.anchor.x"),n("edge.target.anchor.y"))},invalidateAll:function(q){var K=this;if(q){for(var L in K._25I){var t=K._25I[L];t&&t.dispose()}K._25I={},K._56I={},K._24I={},K._34I.clear(),K.redraw()}else K.dm().each(function(M){K.invalidateData(M)})},invalidateSelection:function(){var l=this;l.sm().each(function(H){l.invalidateData(H)})},invalidateData:function(M){var s=this;s._24I[M._id]=M,s._21Q(M),s.iv()},_21Q:function(o){var H=this,G=H._24I;if(Hb(o)&&mb[o.s(Cp)]){var h=o.getSourceAgent();h&&h.getAgentEdges().each(function($){G[$._id]=$}),h=o.getTargetAgent(),h&&h.getAgentEdges().each(function(w){G[w._id]=w}),H.iv()}},redraw:function(p){var I=this;I._32I||(p?I._34I.add(p):(I._32I=1,I._34I.clear()),I.iv())},each:function(O,U){var z,d,s,G=0,I=this.getLayers(),x=this._dataModel,W=x._datas._as,Y=W.length;if(I){for(var Z=I.length;Z>G;G++)if(s=I[G],sk(s)&&(s=s.name),x.isHierarchicalRendering()){var w=function(W){return W._layer===s?U?O.call(U,W):O(W):void 0};if(this._dataModel.eachByHierarchical(w)===!1)return}else for(var H=0;Y>H;H++)if(z=W[H],z._layer===s&&(d=U?O.call(U,z):O(z),d===!1))return}else if(x.isHierarchicalRendering())this._dataModel.eachByHierarchical(O,null,U);else for(;Y>G;G++)if(z=W[G],d=U?O.call(U,z):O(z),d===!1)return},reverseEach:function(X,t){var U,j,C,I,K=this._dataModel,G=K._layers,c=K._datas._as,e=c.length;if(G){for(U=G.length-1;U>=0;U--)if(I=G[U],sk(I)&&(I=I.name),K.isHierarchicalRendering()){var n=function(B){return B._layer===I?t?X.call(t,B):X(B):void 0};if(K.reverseEachByHierarchical(n)===!1)return}else for(var Y=e-1;Y>=0;Y--)if(j=c[Y],j._layer===I&&(C=t?X.call(t,j):X(j),C===!1))return}else if(K.isHierarchicalRendering())K.reverseEachByHierarchical(X,null,t);else for(U=e-1;U>=0;U--)if(j=c[U],C=t?X.call(t,j):X(j),C===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var D=this,w=D._84I;if(!w){var A=this.dm().a("width"),H=this.dm().a("height");A>0&&H>0?D._84I={x:0,y:0,width:A,height:H}:(D.each(function(Y){D.isVisible(Y)&&(w=Og(w,D.getDataUIBounds(Y)))}),D._84I=w?w:vi)}return D._84I},getScrollRect:function(){return Og(this.getContentRect(),this._29I)},makeCenter:function(Y,J,R){var u=this;if(!u.getWidth()||!u.getHeight())return R||Ui(u.centerData,u,[Y,J,!0],500),void 0;u.makeVisible(Y),u.validate();var v=u.getDataUIBounds(Y);if(v){var t=u.getWidth(),A=u.getHeight(),Z=v.x+v.width/2,s=v.y+v.height/2,j=-Z*u._zoom+t/2,x=-s*u._zoom+A/2;u.setTranslate(j,x,J)}},fitData:function(I,R,d,p,B){var P=this;if(!P.getWidth()||!P.getHeight())return B||Ui(P.fitData,P,[I,R,d,p,!0],500),void 0;var c=function(){P.makeVisible(I),P.validate();var h=P.getDataUIBounds(I);h&&(h=kl(h),mf(h,d==s?20:d),P.fitRect(h,R,p))};R?l.callWhenLoaded(c):c()},fitContent:function(v,h,I,u){var q=this;if(!q.getWidth()||!q.getHeight())return u||Ui(q.fitContent,q,[v,h,I,!0],500),void 0;var N=function(){q.validate();var Q=kl(q.getContentRect());mf(Q,h==s?20:h),q.fitRect(Q,v,I)};v?l.callWhenLoaded(N):N()},fitRect:function(x,T,h){var m=this,w=m.getWidth(),F=m.getHeight(),u=x.x+x.width/2,r=x.y+x.height/2,n=$(w/x.width,F/x.height),q=m._zoom,E=-u*q+w/2,U=-r*q+F/2;0===n||isNaN(n)||(h&&(n=$(1,n)),T?(m._65I&&(delete m._65I.finishFunc,m._65I.stop(!0)),m._14o&&m._14o.stop(!0),m.setTranslate(E,U,{finishFunc:function(){m.setZoom(n,T)}})):(m.setTranslate(E,U),m.setZoom(n)))},toCanvas:function(t,i){i=i||this._zoom,this.validateImpl();var W=this,U=W.getContentRect();U.width||(U.width=10),U.height||(U.height=10);var d=Ub(),M=U.x*i,q=U.y*i,S=U.width*i,T=U.height*i;sf(d,S,T,1);var n=An(d);return t=t||this._dataModel.getBackground(),t&&Yl(n,0,0,S,T,t),Zd(n,-M,-q),n.scale(i,i),W._42(n),n.restore(),d},toDataURL:function(C,c,s){return this.toCanvas(C,s).toDataURL(c||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(E,p){var L=this,Y=L.dm().getBackground();if(Y){var Z=L.dm().a("width"),D=L.dm().a("height");Z>0&&D>0&&Yl(E,0,0,Z,D,Y)}var j=L.__htmlOrderList,t=[];if(L._93db(E,p),L.each(function(a){var C=L.getDataUI(a);if(C){var x=L._56I[a._id],K=C._htmlView;if(x){var b=C._79o();if(K=C._htmlView,I.HtmlNode&&a instanceof I.HtmlNode)C._42(E);else{var o=L.getViewRect(),h=K&&K.layoutHTML;!p||qb(p,b)?(h&&(K.layoutHTML(),C.__outerLayout&&delete C.__outerLayout),C._42(E)):qb(o,b)||!h||C.__outerLayout||(K.layoutHTML(),C.__outerLayout=!0)}}K&&(t.push(K),K.getView&&(K=K.getView()),K.style.display=x?"block":zh)}}),j&&t.length>0){var o=!1;if(j.length!==t.length)o=!0;else for(var _=0;_<t.length;_++)if(t[_]!==j[_]){o=!0;break}o&&(t.forEach(function(j){L.appendHTML(j,!0)}),this.__htmlOrderList=t)}else this.__htmlOrderList=t;L._92db(E,p)},validateImpl:function(){this.tryUpdateRootData();var T,R,A,m,p,g=this,I=g.tx(),q=g.ty(),o=g._zoom,G=g._canvas,S=this.getWidth(),h=this.getHeight(),$=g._29I,D={x:-I/o,y:-q/o,width:S/o,height:h/o},i={},W=g._34I,F=g._24I,P=g._32I,y=g._23I;g._24I={},(S!==G.clientWidth||h!==G.clientHeight)&&(sf(G,S,h),P=1),P||Kq(D,$)||(P=1),g._29I=D,g.each(function(z){R=z._id;var G=i[R]=g.isVisible(z);G!==g._56I[R]&&(F[R]=z,A=g.getDataUI(F[R]),A&&A._84o(G),g._84o(z,G))},g);for(R in F)A=g.getDataUI(F[R]),A&&(!P&&g._56I[R]&&(p=A._79o(),p&&W.add(p)),A.invalidate()),g._83I=1;if(g._56I=i,!P)for(R in F)i[R]&&(A=g.getDataUI(F[R]),A&&(p=A._79o(),p&&W.add(p)));if(P?m=D:(W.each(function(R){qb(D,R)&&(m=Og(m,R))}),m&&(mf(m,t(1,1/o)),m.x=c(m.x*o)/o,m.y=c(m.y*o)/o,m.width=v(m.width*o)/o,m.height=v(m.height*o)/o,m=jr(D,m))),g._74O=m,m){T=An(G);var f=m.x,M=m.y,r=m.width,E=m.height;f=Math.floor((f*o+I)*Rb),M=Math.floor((M*o+q)*Rb),r=Math.ceil(r*o*Rb)+1,E=Math.ceil(E*o*Rb)+1,T.beginPath(),T.rect(f,M,r,E),T.clip(),T.clearRect(f,M,r,E),ze(T,I,q,o),g._42(T,m),T.restore(),delete g._74O}if(W.clear(),delete g._32I,y&&S>0&&h>0){var A=g.getDataUI(y);if(A){var p=A._79o(),w=g._29I,a=w.x,J=w.y,e=w.width,L=w.height,o=g._zoom;p&&!qb(p,w)&&(p.x+p.width<a&&g.tx(-p.x*o),p.x>a+e&&g.tx(-(p.x+p.width-e)*o),p.y+p.height<J&&g.ty(-p.y*o),p.y>J+L&&g.ty(-(p.y+p.height-L)*o))}delete g._23I}g._83I&&(delete g._83I,delete g._84I),g._98O(),g.countFrame(),rb(g._24I)||Ui(g.iv,g)},tryUpdateRootData:function(){var K,c=this.getFullscreenDatas();for(var h in c)K=c[h],this.scaleRootData(K)},scaleRootData:function(z){var L=z.s("fullscreen");if("uniform"===L||"fill"===L){z.setRotation(0);var i,P=z.s("fullscreen.gap")||0,h=this.getWidth()-2*P,g=this.getHeight()-2*P,Y=z.getAnchor(),r=z.getScaledSize(),s=r.width,f=r.height,d=z.s("fullscreen.lock");if(d)return"uniform"===L?h/g>s/f?(i=g/f,s=f*h/g):(i=h/s,f=s*g/h):"v"===d?(i=g/f,s=h/i,z.setWidth(s)):(i=h/s,f=g/i,z.setHeight(f)),this.setZoom(i),this.tx(P-(z.getX()-Y.x*s)*i),this.ty(P-(z.getY()-Y.y*f)*i),void 0;var K=this.tx(),o=this.ty();i=this._zoom;var Z={x:(-K+P)/i,y:(-o+P)/i,width:h/i,height:g/i};if("uniform"===L){var Q=s/f,W=Math.min(Z.width,Z.height*Q),A=W/Q;Z.x+=.5*(Z.width-W),Z.y+=.5*(Z.height-A),Z.width=W,Z.height=A}z.setSize(Z.width/z.getScaleX(),Z.height/z.getScaleY()),z.setPosition(Z.x+Y.x*Z.width,Z.y+Y.y*Z.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(i){var C=this;i!==C.isScrollBarVisible()&&(i?(Xd(C._view,C._79O=$b()),Xd(C._79O,C._27I=$b()),Xd(C._79O,C._28I=$b())):(kq(C._79O),delete C._79O,delete C._27I,delete C._28I),C.fp("scrollBarVisible",!i,i))},getDebugTip:function(){return""},showScrollBar:function(){var I=this;I._79O&&(I._85I||(q(function(){I._86I()},vh),I.iv()),I._85I=new Date)},_86I:function(){var f=this;if(f._85I){var t=new Date,u=t.getTime();u-f._85I.getTime()>=vh?(delete f._85I,f.iv()):q(function(){f._86I()},vh)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var X=this,z=this._27I,N=this._28I;if(X._79O){if(X._autoHideScrollBar&&!X._85I)return z.style.visibility=mq,N.style.visibility=mq,void 0;var y=X.getScrollBarColor(),q=X._zoom,t=X.getScrollBarSize(),e=X.getViewRect(),u=X.getScrollRect(),J=e.height*q,o=u.height*q,T=e.width*q-t-2,O=J*((e.y-u.y)*q/o),Z=J*(J/o),c=z.style;o-.5>J?(Ae>Z&&(O=O+Z/2-Ae/2,0>O&&(O=0),O+Ae>J&&(O=J-Ae),Z=Ae),Kj(z,T,O,t,Z),c.visibility=Gj,c.background=y,c.borderRadius=t/2+pp):c.visibility=mq;var W=e.width*q,v=u.width*q,O=e.height*q-t-2,T=W*((e.x-u.x)*q/v),D=W*(W/v),c=N.style;v-.5>W?(Ae>D&&(T=T+D/2-Ae/2,0>T&&(T=0),T+Ae>W&&(T=W-Ae),D=Ae),Kj(N,T,O,D,t),c.visibility=Gj,c.background=y,c.borderRadius=t/2+pp):c.visibility=mq}},setDataModel:function(y){var c=this,p=c._dataModel,S=c._selectionModel;p!==y&&(p&&(p.ump(c.handleDataModelPropertyChange,c),p.umm(c.handleDataModelChange,c),p.umd(c.handleDataPropertyChange,c),p.removeIndexChangeListener(c._75O,c),p.removeHierarchyChangeListener(c.handleHierarchyChange,c),S||p.sm().ums(c.handleSelectionChange,c)),c._dataModel=y,y.mp(c.handleDataModelPropertyChange,c),y.mm(c.handleDataModelChange,c),y.md(c.handleDataPropertyChange,c),y.addIndexChangeListener(c._75O,c),y.addHierarchyChangeListener(c.handleHierarchyChange,c),S?S._21I(y):y.sm().ms(c.handleSelectionChange,c),c.invalidateAll(!0),c.fp(oo,p,y),c.updateBackground())},getLayersInfo:function(){if(this._layersInfo===r){var s=this.getLayers();s?(this._layersInfo={},s.forEach(function(o){var l=sk(o)?o.name:o;this._layersInfo[l]=o},this)):this._layersInfo=null}return this._layersInfo},calculateAttachPoint:function(){var _=new qq,T=new qq,e=new qq;return function(Y,P){var L=this.getAttachPoints(Y);if(!L||!L.length)return null;e.set(P.x,P.y);for(var D,M,g,O,C=1/0,m=0,F=L.length;F>m;m++)g=L[m],T.x=g.x,T.y=g.y,_.x=g.offsetX||0,_.y=g.offsetY||0,O=zs(this,Y,0,_.x,_.y,T.x,T.y),M=e.distanceToSquared(O),C>M&&(D=m,C=M);C=Math.sqrt(C);var U=this.getAttachStyle(Y);if("close"===U){var j=Y.s("attach.close.threshold")/this._zoom;if(C>j)return null}return{index:D,distance:C,info:L[D]}}}(),getAttachPoints:function(V){var r=V.s("attach.points");if(r)return r;var B=nb(V._image);return B?Ro(B.attachPoints,V,this)||null:void 0},getAttachStyle:function(v){var q=v.s("attach.style");if(q)return q;var H=nb(v._image);return H?Ro(H.attachStyle,v,this)||"close":void 0},updateLayers:function(){this._layersInfo=r,this.invalidateSelection(),this.redraw()},updateBackground:function(){var s=this.dm().a("width"),L=this.dm().a("height");this._canvas.style.background=s>0&&L>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(e){if("background"===e.property){var K=this._canvas.style.background,w=e.newValue||"";this.updateBackground(),this.fp("canvasBackground",K,w),this.redraw()}else"a:width"===e.property||"a:height"===e.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===e.property?this.updateLayers():"hierarchicalRendering"===e.property&&this.redraw()},handleDataPropertyChange:function(W){this.dm().isHierarchicalRendering()&&"parent"===W.property&&W.data.hasChildren()&&this.redraw(),this.invalidateData(W.data)},onPropertyChanged:function(M){var P=this,k=M.property;if(P.redraw(),"zoom"===k){var C=P.sm().getSelection();C.size()&&C.each(function(A){A.invalidate()})}yn[k]?P.showScrollBar():k===Yr&&P.onCurrentSubGraphChanged(M)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(U){var F=this,A=U.kind,C=U.data;if(F._83I=1,"add"===A)F.invalidateData(C),Hb(C)&&C.getEdgeGroup()&&C.getEdgeGroup().eachSiblingEdge(F.invalidateData,F);else if(A===fj){F._21Q(C);var t=C._id,f=F._25I[t];if(f){if(F._56I[t]){var I=f._79o();I&&F.redraw(I)}f.dispose(),delete F._25I[t],delete F._24I[t],delete F._56I[t]}C===F._currentSubGraph&&F.setCurrentSubGraph(s)}else A===Xb&&(F.invalidateAll(!0),F.setCurrentSubGraph(s))},_75O:function(x){this.invalidateData(x.data)},handleHierarchyChange:function(K){this.dm().isHierarchicalRendering()&&K.data.hasChildren()&&this.redraw(),this.invalidateData(K.data)},adjustIndex:function(u){var B=this;if(B.isVisible(u)){B.dm().beginTransaction();for(var Y=u;Y._parent&&B.isVisible(Y._parent);)Y=Y._parent;Y&&Y!==u&&B._dataModel.adjustIndex(Y),B._dataModel.adjustIndex(u),B.dm().endTransaction()}},getImage:function(b){return b.getImage?b.getImage():r},getSelectWidth:function(m){var S=nb(this.getImage(m));return S&&Ro(S.disableSelectedBorder,m,this)?0:m.s("select.width")},getSelectColor:function(z){return z.s("select.color")},isSelectable:function(S,t){if(this.isSelected(S))return!0;if(!t&&S.getParent()instanceof Ud&&this.isSelectable(S.getParent(),!0)&&S.getParent().isSyncSize())return!1;var u=this.getLayersInfo();if(u){var T=u[S._layer];if(T&&T.selectable===!1)return!1}return S.s("2d.selectable")&&this.sm().isSelectable(S)},isMovable:function(p){var F=this;if(Hb(p)&&p.getStyle(Cp)!==Gp)return!1;var U=this.getLayersInfo();if(U){var l=U[p._layer];if(l&&l.movable===!1)return!1}return p.s("2d.movable")?F._movableFunc?F._movableFunc(p):!0:!1},isEditable:function(m){var n=this;if(I._uiSerializing)return n._uieditable;if(!n._editInteractor||!n.isSelected(m))return!1;if(Ig(m)){var K=n.getDataUI(m);if(!K||K._88I)return!1}if(Hb(m)&&m.getStyle(Cp)!==Gp)return!1;var M=this.getLayersInfo();if(M){var S=M[m._layer];if(S&&S.editable===!1)return!1}return m.s("2d.editable")?n._editableFunc?n._editableFunc(m):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(n){return lb(n)&&0!==n.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(n):!0},isRectEditable:function(o){return this._rectEditableFunc?this._rectEditableFunc(o):!0},isAnchorEditable:function(r){return this._anchorEditableFunc?this._anchorEditableFunc(r):!0},isRotationEditable:function(J){return J.setRotation&&J.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(J):!0:!1},getRotationPoint:function(R){var E=R.getAnchor(),o=R.getScale(),P=this._zoom,B=ml(R.getRotation(),0,-R.getHeight()*o.y*E.y-(o.y<0?-1:1)*(Ch?32:16)/P),e=R.p();return B.x+=e.x,B.y+=e.y,B},getLogicalPoint:function(C){var G=this;return Xq(C,G._canvas,G.tx(),G.ty(),G._zoom,G._zoom)},getScreenPoint:function(b,y){var p,x=this;return"object"==typeof b?b.x!==r?(p=b.x,y=b.y):(p=b[0],y=b[1]):p=b,Vj(p,y,x._canvas,x.tx(),x.ty(),x._zoom,x._zoom)},getSelectedDataAt:function(i){var d=this;return this.getDataAt(i,function(M){return d.isSelected(M)})},getDataInfoAt:function(T,j,N){var W,H=this.lp(T),a=this.getDataAt(H,j,N);if(a){var F=this.getDataUI(a);W={data:a,ui:F,point:H};var t=F._38o;if(t){var k=t.icons;for(var X in k){var q=k[X],f=t.rects[X];if(f)for(var d=Ro(q.names,a,this),J=d?d.length:0,B=f.rotation,C=J-1;C>=0;C--){var x=d[C],w=f[C];if(Li(w,H,B))return W.part="icons",W.name=X,W.icon=x,W.rect=w,W.index=C,W.rotation=B,W}}}if(this.isNoteVisible(a)){if(F.note2Info&&Li(F.note2Info.clickRect,H,s,F.note2Info.scale))return W.part="note2",W;if(F.noteInfo&&Li(F.noteInfo.clickRect,H,s,F.noteInfo.scale))return W.part="note",W}if(this.isLabelVisible(a)){if(F.label2Info&&Li(F.label2Info.rect,H,F.label2Info.rotation,F.label2Info.scale))return W.part="label2",W;if(F.labelInfo&&Li(F.labelInfo.rect,H,F.labelInfo.rotation,F.labelInfo.scale))return W.part="label",W}if(a.isInRect&&a.isInRect(H))return W.part="body",W}return W},getDataAt:function(b,r,m){b.target&&(b=this.lp(b));var M,q=this._zoom;return this.reverseEach(function(E){return(r?r(E):this.isSelectable(E))&&this.rectIntersects(E,ne(b.x,b.y,m,q))?(M=E,!1):void 0},this),M},getIconInfoAt:function(k,c){var U=this;if(k.target&&(k=U.lp(k)),c||(c=U.getDataAt(k)),c){var Q=U.getDataUI(c);if(Q&&Q._38o){var y,u=Q._38o,i=new Ce;for(y in u.icons)i.add(y);for(var $=i.size()-1;$>=0;$--){y=i.get($);for(var D=u.rects[y],m=D.rotation,a=D.length-1;a>=0;a--){var W=D[a],C=W.width,V=W.height,L={x:k.x-W.x-C/2,y:k.y-W.y-V/2};m!=s&&(L=ml(-m,L.x,L.y));var W={x:-C/2,y:-V/2,width:C,height:V};if(Li(W,L))return{key:y,index:a,name:u.icons[y].names[a],rect:D[a],point:k,rotation:m,relativeRect:W,relativePoint:L,data:c}}}}}return s},getDatasInRect:function(W,a,Z){Z===r&&(Z=1);var e=this,S=new Ce;return e.reverseEach(function(b){Z&&!e.isSelectable(b)||(a?e.rectIntersects(b,W):e.rectContains(b,W))&&S.add(b)}),S},moveSelection:function(b,f){var B=this;B.dm().beginTransaction(),oh(B.sm().toSelection(B.isMovable,B),b,f),B.dm().endTransaction()},moveDatas:function(i,S,D){var r=this;r.dm().beginTransaction(),i instanceof Ce||(i=new Ce(i)),oh(i,S,D),r.dm().endTransaction()},getDataUIBounds:function(K){var $=this.getDataUI(K);return $?$._79o():s},drawData:function($,V,r){var u=this.getDataUI(V);if(u){var v=u._79o();(!r||qb(r,v))&&(u._42($),V instanceof I.Block&&V.eachChild(function(_){this.drawData($,_,r)},this))}},getBoundsForGroup:function(X){return X.s(ed)?this.getDataUIBounds(X):s},isPixelPerfect:function(E){return E.s("pixelPerfect")},rectIntersects:function(Z,G){this.validate();var I=s;if(this._56I[Z._id]){var f=this._25I[Z._id];if(f){var e=f._79o();if(sp(G,e))I=!0;else if((G=jr(G,e))&&(f.rectIntersects&&(I=f.rectIntersects(G)),I==s)){if(!this.isPixelPerfect(Z))return!0;var r=G.x,A=G.y,D=G.width,V=G.height,t=this._zoom,v=l.hitMaxArea,z=D*V*t*t;if(z>v){var _=Math.sqrt(v/z);t*=_}D*=t,V*=t,2>D&&(D=2),2>V&&(V=2),r*=t,A*=t;var K=Ac(D,V);Zd(K,-r,-A),K.scale(t,t),this._drawForChecking=!0,this.drawData(K,Z,G),this._drawForChecking=!1;try{for(var Y=0,$=K.getImageData(0,0,D,V).data;Y<$.length;Y+=4)if(0!==$[Y+3]){I=!0;break}K.restore()}catch(M){xl=s,I=!1}}}}return I?!0:!1},rectContains:function(q,M){if(this._56I[q._id]){var E=this._25I[q._id];if(E)return sp(M,E._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(I){if(!l.isInput(I.target)){var N=this,r=N._focusData,c=r&&N._25I[r._id],j=0,k=N._dataModel._datas;if(!(r&&r._enabled&&r._editable&&c&&c.onKeyDown&&c.onKeyDown(I)===!0))if(9===I.keyCode&&(r&&(j=k.indexOf(r),Fg(I)?-1===--j&&(j=0):++j===k.size()&&(j=0)),N._focusData=r=k.get(j),N.sm().setSelection(r)),Jc(I)?N.selectAll():Ln(I)&&N.isResettable()&&N.reset(),N.sm().isEmpty()){if(N._editing)return;var P=N.tx(),s=N.ty(),q=!1,f=Fg()?100:10;Dp(I)&&(P-=f,q=!0),ri(I)&&(s-=f,q=!0),Wc(I)&&(P+=f,q=!0),tr(I)&&(s+=f,q=!0),q&&N.setTranslate(P,s)}else{Wl(I)&&N.handleDelete(I);var _=Fg()?10:1;Dp(I)&&(N.moveSelection(-_,0),N.fi({kind:"moveLeft"})),ri(I)&&(N.moveSelection(0,-_),N.fi({kind:"moveUp"})),Wc(I)&&(N.moveSelection(_,0),N.fi({kind:"moveRight"})),tr(I)&&(N.moveSelection(0,_),N.fi({kind:"moveDown"}))}}},handleScroll:function(V,g){if(bn(V),this.isZoomable()){if(!this.getEditInteractor()){var A=this.getDataAt(V);if(A){var k=nb(this.getImage(A));if(k&&Ro(k.scrollable,A,this))return}}var X=this.lp(V);g>0?this.scrollZoomIn(X):0>g&&this.scrollZoomOut(X)}},handlePinch:function(D,f,H){this.isZoomable()&&(this._68I||(f>H?this.pinchZoomIn(D):this.pinchZoomOut(D)))},checkDoubleClickOnNote:function(c,d){var D=this,b=D.lp(c),P=D.getDataUI(d),L=P.note2Info;return L&&d.s("note2.toggleable")&&Li(L.clickRect,b)?(d.s(ob,!d.s(ob)),D.fi({kind:"toggleNote2",event:c,data:d}),!0):(L=P.noteInfo,L&&d.s("note.toggleable")&&Li(L.clickRect,b)?(d.s(Cc,!d.s(Cc)),D.fi({kind:"toggleNote",event:c,data:d}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(t,V){var n=this,a=n.getAutoScrollZone(),B=a/n.getZoom(),d=a/4,W=n._29I,Z=n.lp(t),P={x:n.tx(),y:n.ty()};return Z&&a>0&&W&&(Z.x-W.x<B?n.translate(d,0):W.x+W.width-Z.x<B&&n.translate(-d,0),Z.y-W.y<B?n.translate(0,d):W.y+W.height-Z.y<B&&n.translate(0,-d)),P.x=n.tx()-P.x,P.y=n.ty()-P.y,V&&(V.x+=P.x,V.y+=P.y),P},getMoveMode:function(B,U){var D=U.s("2d.move.mode");return D?D:wd["88"]?"x":wd["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(e,I,C){var O=this;return"currentSubGraph"===I?{__i:e.getId()}:C.serializeProperty(e,I,O)},deserializeProperty:function(l,F,X){var Z=this;if("currentSubGraph"===F){var I=Z.dm(),N=I.__idMap;return N[l.__i]}return X.deserializeProperty(l,F,Z)},setDefaultCursor:function(g,$){this._defaultCursor=g,$!==!1&&this.setCursor(g)},setCursor:function(b){"default"===b&&(b=this._defaultCursor||b);var a=this.getView().style;a.cursor=b,a.cursor="-webkit-"+b,a.cursor="-moz-"+b},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(G){return G===s||l.getConnectAction(null,G)?(this._currentActionType=G,this.redraw(),!0):!1},isConnectActionVisible:function(Z){var G=l.getConnectAction(this);if(!G)return!1;var h=G.visible;return Ym(h)&&(h=h(this,Z)),h},isInteractive:function(z){var E=nb(this.getImage(z));return E&&Ro(E.interactive,z,this)?!0:z.s("interactive")},appendHTML:function(V,t){var H=this.getView();if(!(t||V&&V.parentNode!==H))return!1;var y=V.getView&&V.getView();if(!t&&y&&y.parentNode===H)return!1;if(V.isSelfViewEvent)return V.addToDOM(H),!0;V.getView&&(V=V.getView());var w=this.getEditInteractor();return w&&w._canvas?H.insertBefore(V,w._canvas):this.isScrollBarVisible()?H.insertBefore(V,this.getView().lastChild):Xd(H,V),!0},_layoutHTMLImpl:function(J,x,l){if(arguments.length>1){var X,z=this,I=z._zoom;if(x.getView&&(X=x,x=x.getView()),x.style.position="absolute",l){var L=J.getRect();Kj(X||x,z.tx()+L.x*I,z.ty()+L.y*I,L.width*I,L.height*I)}else{var y=new Am,L=J.getAnchorRect(),P=J.getPosition(),N=J.getScale(),A=x.style;Kj(X||x,L),y.appendTranslate(z.tx(),z.ty()),y.appendScale(I,I),y.append(new Am(J.getRotation(),P.x,P.y,N.x,N.y)),pe(A,"transform","matrix("+y.a.toFixed(5)+", "+y.b.toFixed(5)+", "+y.c.toFixed(5)+",\n    "+y.d.toFixed(5)+", "+y.tx.toFixed(5)+", "+y.ty.toFixed(5)+")"),pe(A,"transformOrigin",(-L.x).toFixed(5)+"px "+(-L.y).toFixed(5)+"px"),x.maxtrixAppend=y.invert().translate(-L.x,-L.y)}}else this._layoutHTML&&this._layoutHTML()}}),H.defineProperties(pi.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(K){this._layoutHTML=K}}});var Dc=function(J,P){var e=this;e.gv=J,e.s=function(h){return P.getStyle(h)},e._data=P,e._87I=new Ce};Op(Dc,H,{_6I:s,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var Y=this,w=Y.gv.isSelected(Y._data);return!w||Y.isShadowed()?0:Y.gv.getSelectWidth(Y._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(o){var x=this._data,X=this.gv.getBodyColor(x);return X?X:o?x.getStyle(o):s},_2Q:function(g){return this.s(g)},_1Q:function(P,d,Y,Z){var z=this.s,g=z("2d.gray"),A=z(d+".dash.color");if(g&&(A=l.toGrayColor(A)),P.strokeStyle=A,P.lineWidth=Y,P.stroke(),z(d+".dash.3d")){var i=z(d+".dash.3d.color");Zi(P,A,g?l.toGrayColor(i):i,Y,this.gv._zoom,z(d+".dash.3d.accuracy"))}He(P,Z)},invalidate:function(){this._6I=s},_79o:function(){var T=this;if(!T._6I){var o=T._data,p=T.gv;T.labelInfo=T.label2Info=T.noteInfo=T.note2Info=T._38o=s,T._87I.clear(),T.interactiveInfo=p.isInteractive(o)?{}:s,T._3O(),T._55O=p.isEditable(o)?{_42O:p.isRectEditable(o),_43O:p.isPointEditable(o),_56O:p.isRotationEditable(o)}:s,T._6I=T._81o()}return T._6I},_3O:function(){},getPosition:function(){return vi},_68o:function(l,P){l&&this._87I.add(np(l,P))},_81o:function(){var N=this,t=N.s;N._24O(Le,"getLabel"),N._24O(cf,"getLabel2"),N._26O(Hl,"getNote"),N._26O(hc,"getNote2"),N._15O(),N._55O&&N._48O();var s;if(N._87I.each(function(i){s=Og(s,i)}),s&&N.isShadowed()){var n=kl(s);n.x+=t("shadow.offset.x"),n.y+=t("shadow.offset.y"),mf(n,t("shadow.blur")),s=Og(s,n)}return N._87I.clear(),s},_42:function(d){var A=this,X=A._data,P=A.gv,l=A.s,q=l("opacity"),r=this.isShadowed();if(r){var N=d.shadowOffsetX,o=d.shadowOffsetY,n=d.shadowBlur,v=d.shadowColor,K=P.getZoom();d.shadowOffsetX=l("shadow.offset.x")*K,d.shadowOffsetY=l("shadow.offset.y")*K,d.shadowBlur=l("shadow.blur")*K,d.shadowColor=A.getSelectColor()}if(q!=s){var I=d.globalAlpha;d.globalAlpha=q}A._80o(d),P.isLabelVisible(X)&&((!P._drawForChecking||l("label.selectable"))&&lg(d,A.labelInfo),(!P._drawForChecking||l("label2.selectable"))&&lg(d,A.label2Info)),P.isNoteVisible(X)&&(nr(d,A.noteInfo),nr(d,A.note2Info)),A._99O(d),q!=s&&(d.globalAlpha=I),r&&(d.shadowOffsetX=N,d.shadowOffsetY=o,d.shadowBlur=n,d.shadowColor=v)},_80o:function(){},_47O:function(){},_24O:function(N,x){var p=this,O=p._data,G=p.gv,M=p.s,J=G[x](O);if(J!=s){var f=M(N+".scale"),g=M(N+".max"),B=M(N+".position"),q=p[N+"Info"]={label:J,scale:f,color:G[x+"Color"](O),font:M(N+".font"),opacity:M(N+".opacity"),align:M(N+".align"),rotation:p.getRotation(M(N+".rotation"),!1,B),background:G[x+"Background"](O)},n=Kp(q,J);g>0&&g<n.width&&(q.labelWidth=n.width,n.width=g),1!==f&&(n.width*=f,n.height*=f);var F=p.getPosition(B,M(N+".offset.x"),M(N+".offset.y"),n,M(N+".position.fixed"));if(n.x=F.x-n.width/2,n.y=F.y-n.height/2,p._68o(q.rect=n,q.rotation),1!==f){var L=n.width/f,c=n.height/f;q.rect={x:F.x-L/2,y:F.y-c/2,width:L,height:c}}}},_26O:function(k,T){var d=this,l=d.gv,G=d._data,r=d.s,L=l[T](G);
        if(L!=s){var m,Z,B=r(k+".scale"),$=d[k+"Info"]={note:L,scale:B,data:G,view:l,expanded:r(k+".expanded"),font:r(k+".font"),color:r(k+".color"),opacity:r(k+".opacity"),align:r(k+".align"),icon:r(k+".icon"),backgroundImage:r(k+".backgroundImage"),borderWidth:r(k+".border.width"),borderColor:r(k+".border.color"),background:l[T+"Background"](G)},E=d.getPosition(r(k+".position"),r(k+".offset.x"),r(k+".offset.y")),y=E.x,A=E.y;if($.expanded){var O,i=r(k+".max"),U=r(k+".backgroundImage");U?(U=nb(U),O={width:El(U,G),height:tj(U,G)}):O=Kp($,L),O.width+=6,O.height+=2,i>0&&i<O.width&&($.labelWidth=O.width,O.width=i),m=O.width,Z=O.height+8,$.clickRect={x:y-m*B/2,y:A-Z*B,width:m*B,height:Z*B*O.height/Z}}else{var e=r(k+".icon");e?(e=nb(e),m=El(e,G),Z=tj(e,G)):(m=12,Z=18),$.clickRect={x:y-m*B/2,y:A-Z*B,width:m*B,height:Z*B}}$.rect={x:y-m/2,y:A-Z*B/2-Z/2,width:m,height:Z};var u=v($.borderWidth/2)*B;d._68o({x:y-m*B/2-u,y:A-Z*B-u,width:m*B+2*u,height:Z*B+2*u})}},_48O:function(){},_99O:function(J){var Y=this,r=Y._38o;if(r){var o=Y.gv,H=Y._data,P=r.icons,x=Y.interactiveInfo;x&&(x._38o={});for(var i in P){var y=P[i],U=r.rects[i];if(U){x&&(x._38o[i]=[]);var p=Ro(y.opacity,H,o),d=Ro(y.names,H,o),e=d?d.length:0,n=U.rotation;if(p!=s){var R=J.globalAlpha;J.globalAlpha*=p}for(var t=0;e>t;t++){var N=d[t],T=nb(N),D=U[t];if(n){var j=D.x+D.width/2,F=D.y+D.height/2;J.save(),Zd(J,j,F),jc(J,n),Zd(J,-j,-F)}x&&x._38o[i].push(J.interactiveInfo={compInfos:[],matrix:n?new Am(n,j,F).appendTranslate(-j,-F):new Am}),Bk(J,T,Ro(y.stretch,H,o),D.x,D.y,D.width,D.height,Y._data,Y.gv),J.interactiveInfo=s,n&&J.restore()}p!=s&&(J.globalAlpha=R)}}}}});var vr=function(S,R){jj(vr,this,[S,R])};Op(vr,Dc,{_checkEmptyRect:!0,_40O:function(H,R){var s=this,Q=s.s,X=H.rect;(H.borderColor=s.gv.getBorderColor(s._data))&&(H.borderType=Q("border.type"),H.borderWidth=Q("border.width"),H.borderPadding=Q("border.padding"),R=t(R,H.borderPadding+H.borderWidth/2));var o=s._data.getScale(),d=t(1,t(P(o.x),P(o.y)));if(H.selectWidth=s.getSelectWidth()){var U=s.gv._zoom;H.selectType=Q("select.type"),H._97o=s.getSelectColor(),H.selectPadding=Q("select.padding"),R=t(R,(H.selectPadding+H.selectWidth/2/U)/d)}R>0&&(R*=d,X=kl(X),mf(X,R)),s._68o(X)},_39O:function(A,r){var C,K=this,v=r.rect;if(r.borderWidth>0&&(C=r.borderPadding,A.strokeStyle=r.borderColor,A.lineWidth=r.borderWidth,Uk(A,r.borderType,{x:v.x-C,y:v.y-C,width:v.width+2*C,height:v.height+2*C}),A.stroke()),r.selectWidth>0){var M=K.gv._zoom;if(C=r.selectPadding,A.strokeStyle=r._97o,A.lineWidth=r.selectWidth/M,r.rotation!=s){A.save(),A.translate(r.position.x,r.position.y),A.rotate(r.rotation);var W=K._data,G=W.getWidth(),J=W.getHeight(),D=r.scale,j=r.anchor;v={x:D.x*-G*j.x,y:D.y*-J*j.y,width:D.x*G,height:D.y*J}}Uk(A,r.selectType,{x:v.x-C,y:v.y-C,width:v.width+2*C,height:v.height+2*C}),r.rotation!=s&&A.restore(),A.stroke()}},dispose:function(){var k=this,R=k._htmlView;vr.superClass._3O.call(k),R&&(R.onHTMLRemoved&&R.onHTMLRemoved(),kq(R))},_3O:function(){var f=this,$=f.s,q=f._data,T=f.gv,z=q.getStyle(jf),S=f.getBodyColor(),J=f._83o=z?{shape:z,_53o:f.getBodyColor("shape.background"),_27Q:nb($("shape.repeat.image"),S),shapeGradientPack:$("shape.gradient.pack"),_54o:$("shape.border.width"),_55o:$("shape.border.color"),_56o:$("shape.border.3d"),_57o:$("shape.border.3d.color"),_58o:$("shape.border.3d.accuracy"),shapeGradient:$("shape.gradient"),_59o:$("shape.gradient.color"),_60o:$("shape.border.pattern"),_61o:$("shape.border.cap"),_62o:$("shape.border.join"),shapeForeground:$("shape.foreground"),bodyColor:S,gray:$("2d.gray")}:{img:nb(T.getImage(q),S),bodyColor:S,gray:$("2d.gray"),stretch:$("image.stretch")};if(u&&!Y);else{var h,Z=J.img;Z&&Z.renderHTML?(f._htmlInfo&&f._htmlInfo.img!==Z&&(f._htmlInfo=s),f._htmlInfo||(f._htmlInfo={img:Z,cache:{}}),h=Z.renderHTML(q,T,f._htmlInfo.cache)):f._htmlInfo=s,f._htmlView&&f._htmlView!==h&&(f._htmlView.onHTMLRemoved&&f._htmlView.onHTMLRemoved(),kq(f._htmlView.getView?f._htmlView.getView():f._htmlView)),(f._htmlView=h)&&T.appendHTML(h)&&h.onHTMLAdded&&h.onHTMLAdded(),J.rect=q.getRect(),J.position=q.p(),J.scale=q.getScale(),J.anchor=q.getAnchor(),J.rotation=q.getRotation(),z===Dj&&(J._63o=$("shape.depth"));var w=0;if(z)w=cq(s,J._54o/2,J._62o),f.s("shape.dash")&&(w=t(w,(f.s("shape.dash.width")||J._54o)/2));else if(Z&&Z.boundExtend)if(w=Ro(Z.boundExtend,q,T),Z.boundExtendAbsolute){var g=q.getScale();w/=T._zoom*t(1,t(P(g.x),P(g.y)))}else if(!Ro(Z.fitSize,q,T)){var y=Ro(Z.width,q,T),D=Ro(Z.height,q,T);w*=t(q.getWidth()/y,q.getHeight()/D)}f._40O(J,w);var x=$("clip.percentage");if(1>x&&(0>x&&(x=0),J.clipRect=Cl(q.getAnchorRect(),$("clip.direction"),x)),z){var W=$("shape.fill.clip.percentage");1>W&&(0>W&&(W=0),J.shapeClipRect=Cl(q.getAnchorRect(),$("shape.fill.clip.direction"),W));var j=$("shape.foreground.clip.percentage");1>j&&(0>j&&(j=0),J.shapeForegroundClipRect=Cl(q.getAnchorRect(),$("shape.foreground.clip.direction"),j))}}},getPosition:function(V,F,d,z){var N=Rf(V,this._83o.rect,z);return N.x+=F,N.y+=d,N},_80o:function(Z){var B=this,L=B.s,d=B.gv,t=B._data,E=B._83o,q=E.rect,H=E.position,R=E.rotation,k=E.anchor,N=E.scale,F=E.shape,$=E.clipRect;if(!B._checkEmptyRect||q.width>0&&q.height>0){var j=t.getSize();if(j.x=-j.width*k.x,j.y=-j.height*k.y,Z.save(),Zd(Z,H.x,H.y),jc(Z,R),vp(Z,N.x,N.y),$&&(Z.beginPath(),Z.rect($.x,$.y,$.width,$.height),Z.clip()),d._drawForChecking&&E.img&&Ro(E.img.pixelPerfect,t,d)===!1)Yl(Z,j.x,j.y,j.width,j.height,"#888888");else if(B.freeDraw)B.freeDraw(Z,j,E);else if(F){var M,V,O,T,K=E._60o,n=Bj(Z,K),C=E._27Q,b=E._54o,y=E.shapeGradientPack,o=E.gray,X=Z.lineJoin,m=Z.lineCap,e=function(n){return o?l.toGrayColor(n):n};"roundRect"===F?M=L("shape.corner.radius"):"polygon"===F?M=L("shape.polygon.side"):"arc"===F&&(M=L("shape.arc.from"),V=L("shape.arc.to"),O=L("shape.arc.close"),T=L("shape.arc.oval")),Z.lineJoin=E._62o,Z.lineCap=E._61o;var u=e(E._53o);if(u||C||y){var c=E.shapeClipRect;c&&(Z.save(),Z.beginPath(),Z.rect(c.x,c.y,c.width,c.height),Z.clip()),Uk(Z,F,j,M,V,O,T),y?Np(Z,y):C?Od(Z,C,e(E.bodyColor),null,t,d):Jm(Z,u,E.shapeGradient,e(E._59o),j),Z.fill(),c&&Z.restore(),y&&Z.restore(),Z!==n&&Uk(n,F,j,M,V,O,T)}else Uk(n,F,j,M,V,O,T);var g=E.shapeForeground;if(g){Z.save();var D=E.shapeForegroundClipRect;D&&(Z.beginPath(),Z.rect(D.x,D.y,D.width,D.height),Z.clip()),Uk(Z,F,j,M,V,O,T),Jm(Z,g,L("shape.foreground.gradient"),e(L("shape.foreground.gradient.color")),j),Z.fill(),Z.restore()}if(b>0){var a=L("shape.border.width.absolute");a&&(Z.save(),Z.setTransform(1,0,0,1,0,0)),Z.lineWidth=b;var x=e(E._55o);Z.strokeStyle=x,Z.stroke(),a&&Z.restore(),E._56o&&Zi(Z,x,e(E._57o),b,d._zoom,E._58o)}if(He(Z,K),L("shape.dash")){var r=L("shape.dash.width")||b;if(r>0){K=L("shape.dash.pattern");var n=Bj(Z,K,B._2Q("shape.dash.offset"));n!==Z&&Uk(n,F,j,M,V,O,T),B._1Q(Z,"shape",r,K)}}db(Z,u,E._63o,j),Z.lineJoin=X,Z.lineCap=m}else{var i=B.interactiveInfo;i&&(Z.interactiveInfo=i.bodyInfo={compInfos:[],matrix:new Am(R,H.x,H.y,N.x,N.y)}),E.gray&&(Z.compGray=!0);var W=E.img;W&&W.cacheRule!=s&&(W=zq(Z,W,E.stretch,j.width,j.height,t,d,E.bodyColor)),Bk(Z,W,E.stretch,j.x,j.y,j.width,j.height,t,d,E.bodyColor),Z.compGray=!1,Z.interactiveInfo=s}Z.restore()}B._39O(Z,E)},_48O:function(){},_47O:function(){}});var Ck=function(H,X){jj(Ck,this,[H,X])},Gn=function(P,c,F,D){var y=Bg(P,c);return F=D?$(F,y):nk(F,y),y?F/=y:F=0,{x:P.x+(c.x-P.x)*F,y:P.y+(c.y-P.y)*F}};Op(Ck,Dc,{_3O:function(){var O,m=this,X=m._data,k=m.gv,z=m.s,G=z(Cp),_=X.isLooped(),E=z("edge.width"),u=z("edge.center"),J=z("edge.offset"),y=k.getBorderColor(X),A=y?z("border.width"):0,C=m.getSelectWidth(),K=X._40I,B=X._41I,I=m._78o=K&&B?{looped:_,type:G,width:E,center:u,color:m.getBodyColor("edge.color"),borderColor:y,borderWidth:A,_97o:C?m.getSelectColor():s,selectWidth:C,pattern:z("edge.pattern"),cap:z("edge.cap"),join:z("edge.join"),is3d:z("edge.3d"),_67o:z("edge.3d.color"),_66o:z("edge.3d.accuracy"),gray:z("2d.gray")}:s;if(I){var R=l.getEdgeType(G);if(R){var $=R(X,Db(m,k,X,_,G),k,m._19Q);$.points&&$.points.size()>1?(I.edgeTypeInfo=$,O=Bq(I.edgeTypeInfo.points)):$[br]&&$.rect&&(I.edgeTypeInfo=$,O=$.rect)}else{var T=z("edge.source.anchor.x"),W=z("edge.source.anchor.y"),U=z("edge.target.anchor.x"),j=z("edge.target.anchor.y"),i=zs(k,K,z("edge.source.position"),z("edge.source.offset.x"),z("edge.source.offset.y"),T,W),S=zs(k,B,z("edge.target.position"),z("edge.target.offset.x"),z("edge.target.offset.y"),U,j);if(G===Gp){var V=I.points=z(mi)||nl,Q=V.size();I.segments=z("edge.segments");var x=T!==r||W!==r,F=U!==r||j!==r;if(!u)if(J)x||(i=Gn(i,Q?V.get(0):S,J,Q)),F||(S=Gn(S,Q?V.get(Q-1):i,J,Q));else{var p;x||(p=Dn(i,Q?V.get(0):S,wq(k,K)),p&&(i={x:p[0],y:p[1]})),F||(p=Dn(Q?V.get(Q-1):i,S,wq(k,B)),p&&(S={x:p[0],y:p[1]}))}O=Og(Bq(I.points),Bq(i,S))}else{var Y=Db(m,k,X,_,G);if(m._19Q||(Y=-Y),_)i=kl(i),i.x=k.getNodeRect(K).x,I.radius=Y,O={x:i.x-Y,y:i.y-Y,width:2*Y,height:2*Y};else{var e=Bg(i,S),h=nk(J,e),f={x:h,y:Y},H={x:e-h,y:Y},g=Z(S.y-i.y,S.x-i.x),b=I.mat=new Tk(g);if(I.orienAngle=g,I.angle=S.x<i.x?g+M:g,I.rect={x:f.x,y:f.y,width:H.x-f.x,height:0},I.origin=i,f=b.tf(f),f.x+=i.x,f.y+=i.y,H=b.tf(H),H.x+=i.x,H.y+=i.y,u){var P={x:e,y:0};P=b.tf(P),P.x+=i.x,P.y+=i.y,O=Bq([i,f,H,P]),I.c1=i,I.c2=P}else O=Bq(f,H);i=f,S=H}}I.sourcePoint=i,I.targetPoint=S,X._lastSourcePoint=i,X._lastTargetPoint=S}var q=0;z("edge.dash")&&(q=z("edge.dash.width")||E);var v="square"===I.cap?.71:.5;cq(O,t(q*v,E*v+A+C),I.join),m._68o(O)}},getRotation:function(m,H,E){m=m||0;var e=this._78o;if(e){var N,Q=e.angle,p=e.points,W=e.edgeTypeInfo;if(Q!=s)return H?e.orienAngle+m:Q+m;if(W&&W[br])return W.getRotation?W.getRotation(this,m,H,E):0;if(W&&W.points){var b=W.points;return N=b.size(),ql[E]?N&&0===N%2?qc(b.get(N/2-1),b.get(N/2),H,m):m:bq[E]?qc(b.get(0),b.get(1),H,m):qc(b.get(N-2),b.get(N-1),H,m)}if(p)return N=p.size(),ql[E]?N&&0===N%2?qc(p.get(N/2-1),p.get(N/2),H,m):m:bq[E]?qc(e.sourcePoint,N?p.get(0):e.targetPoint,H,m):qc(N?p.get(N-1):e.sourcePoint,e.targetPoint,H,m)}return m},getPosition:function(L,f,g,J,H){var n=this._78o;if(n){var m,d=n.type,T=n.points,t=n.edgeTypeInfo,Z=n.sourcePoint,o=n.targetPoint;if(!d)return n.looped?{x:Z.x-n.radius+f,y:Z.y+g}:(H&&Z&&o&&(Z.x>o.x||Z.x===o.x&&Z.y>o.y)&&(L=Nk[L],g=-g),m=Rf(L,n.rect,J),m.x+=f,m.y+=g,m=n.mat.tf(m),m.x+=n.origin.x,m.y+=n.origin.y,m);if(t&&t[br])return t.getPosition?t.getPosition(this,L,f,g,J,H):{x:(Z.x+o.x)/2,y:(Z.y+o.y)/2};if(T){var m,G=T.size();if(ql[L]){if(G){var X=G%2;if(0===X)return _r(T.get(G/2-1),T.get(G/2),L,f,g,J,H);m=T.get((G-X)/2)}else m={x:(Z.x+o.x)/2,y:(Z.y+o.y)/2};return m=Rf(L,{x:m.x,y:m.y,width:0,height:0},J),m.x+=f,m.y+=g,m}return bq[L]?_r(Z,G?T.get(0):o,L,f,g,J,H):_r(G?T.get(G-1):Z,o,L,f,g,J,H)}if(t){var z=t.points,G=z.size();if(ql[L]){var X=G%2;return 0===X?_r(z.get(G/2-1),z.get(G/2),L,f,g,J,H):(m=z.get((G-X)/2),m=Rf(L,{x:m.x,y:m.y,width:0,height:0},J),m.x+=f,m.y+=g,m)}return bq[L]?_r(z.get(0),z.get(1),L,f,g,J,H):_r(z.get(G-2),z.get(G-1),L,f,g,J,H)}}return vi},_42:function(s){this._78o&&Ck.superClass._42.call(this,s)},drawPath:function(P,B){P.beginPath();var H=B.type,J=B.points,I=B.segments,U=B.edgeTypeInfo;if(!H||J){var w=B.sourcePoint,g=w.x,M=w.y,c=B.targetPoint,K=c.x,i=c.y;if(H)if(I){var A=new Ce({x:g,y:M});A.addAll(J),A.add({x:K,y:i}),wk(P,A,I)}else P.moveTo(g,M),J.each(function(M){P.lineTo(M.x,M.y)}),P.lineTo(K,i);else B.looped?P.arc(g,M,B.radius,0,p,!0):B.center?(P.moveTo(B.c1.x,B.c1.y),P.lineTo(g,M),P.lineTo(K,i),P.lineTo(B.c2.x,B.c2.y)):(P.moveTo(g,M),P.lineTo(K,i))}else U&&(U.points?wk(P,U.points,U.segments):U[br]&&U[br](P,U))},_80o:function(M){var F=this,d=F.s,$=F._78o,f=$.width,i=$.selectWidth,w=$.borderWidth,g=M.lineJoin,v=M.lineCap,R=$.gray,x=$.pattern;M.lineJoin=$.join,M.lineCap=$.cap,F.drawPath(Bj(M,x),$);var b=d("edge.width.absolute");b&&(M.save(),M.setTransform(1,0,0,1,0,0)),i&&(M.strokeStyle=$._97o,M.lineWidth=f+2*(w+i),M.stroke()),w&&(M.strokeStyle=R?l.toGrayColor($.borderColor):$.borderColor,M.lineWidth=f+2*w,M.stroke());var C=R?l.toGrayColor($.color):$.color,Q=R?l.toGrayColor($._67o):$._67o;if(M.strokeStyle=C,M.lineWidth=f,M.stroke(),$.is3d&&Zi(M,C,Q,f,F.gv._zoom,$._66o),b&&M.restore(),He(M,x),d("edge.dash")){x=d("edge.dash.pattern");var c=Bj(M,x,F._2Q("edge.dash.offset"));c!==M&&F.drawPath(c,$),F._1Q(M,"edge",d("edge.dash.width")||f,x)}M.lineJoin=g,M.lineCap=v},_48O:function(){},_47O:function(){},_71o:function(u,h){var L=this,$=L._data;if(L._19Q=!0,!$.getEdgeGroup())return u?$.s("edge.gap"):0;var b,P=0,X=0,d=0;if($.getEdgeGroup().getSiblings().each(function(r){r.each(function(W){if(L.gv.isVisible(W)&&W.s(Cp)==h){var D=W.s("edge.gap");b?(X+=d/2+D/2,d=D):(b=W,d=D),W===$&&(P=X)}})}),u)return X-P+d;var k=P-X/2;return b&&$._40I!==b._40I&&(L._19Q=!1),k}});var rq=function(M,B){jj(rq,this,[M,B])};Op(rq,vr,{_3O:function(){var P,o,t=this,S=t.s,X=t._data,H=t.gv;if(t._88I=s,X.isExpanded()&&X.eachChild(function(w){if(lb(w)){var d=H.getBoundsForGroup(w);d&&(o||(o=[]),o.push(d),P=Og(P,d))}}),P){var v=H.getLabel(X),D=S("group.type");P=Uo(D,o,P),xj(P,X,"group.padding",1);var g=t._88I={type:D,rect:P,_64o:P};if(!D&&v!=s){var y,L=t.labelInfo={label:v,color:S("group.title.color"),font:S("group.title.font"),align:S("group.title.align")},r=Kp(L,v),e=r.width,p=r.height,z=S("group.title.align"),j=S("group.title.orientation");if((j===ns||j===cj)&&e>P.width?P.width=e:(j===Ih||j===Go)&&e>P.height&&(P.height=e),L.rect={y:P.y-p,width:r.width,height:p},y=z===Ih?P.x:z===Go?P.x+P.width-e:P.x+P.width/2-e/2,L.rect.x=y,j===cj)g.titleRect={x:P.x,y:P.y+P.height,width:P.width,height:p},g.rect={x:P.x,y:P.y,width:P.width,height:P.height+p},L.rect={x:y,y:P.y+P.height,width:e,height:p};else if(j===Ih){var h=g.titleRect={x:P.x-p,y:P.y,width:p,height:P.height};g.rect={x:P.x-p,y:P.y,width:P.width+p,height:P.height},L.rect={x:h.x+p/2-P.height/2,y:h.y+P.height/2-p/2,width:P.height,height:p},L.rotation=-Math.PI/2}else if(j===Go){var h=g.titleRect={x:P.x+P.width,y:P.y,width:p,height:P.height};g.rect={x:P.x,y:P.y,width:P.width+p,height:P.height},L.rect={x:h.x+p/2-P.height/2,y:h.y+P.height/2-p/2,width:P.height,height:p},L.rotation=Math.PI/2}else g.titleRect={x:P.x,y:P.y-p,width:P.width,height:p+1},g.rect={x:P.x,y:P.y-p,width:P.width,height:P.height+p}}t._40O(g,S("group.border.width")/2)}else rq.superClass._3O.call(t)},getPosition:function(d,C,b,D){var B=this._88I;if(B){var h=Rf(d,B.rect,D);return h.x+=C,h.y+=b,h}return rq.superClass.getPosition.apply(this,arguments)},_24O:function(L,S){var d=this._88I;(!d||d.type||"label2"===L)&&rq.superClass._24O.call(this,L,S)},_80o:function(G){var N=this,Q=N._88I;if(Q){var I=N._data,f=N.s,L=N.gv,d=Q.type,o=Q.rect,b=Q._64o,R=Q.titleRect,U=N.getBodyColor(),k=nb(f("group.image"),U),M=f("group.image.stretch"),S=N.getBodyColor("group.background"),y=nb(f("group.repeat.image"),U),t=f("group.gradient.pack"),g=f("group.gradient"),H=f("group.gradient.color"),C=f("group.border.width"),i=f("group.border.color"),Z=f("group.border.pattern"),l=f("group.title.orientation"),p=f("group.depth");if(d){var E=G.lineJoin,W=G.lineCap;if(G.lineJoin=f("group.border.join"),G.lineCap=f("group.border.cap"),k){if(G.save(),Uk(G,d,o),G.clip(),Bk(G,k,M,o.x,o.y,o.width,o.height,I,L,U),G.restore(),C>0){var P=Bj(G,Z);Uk(P,d,o),G.lineWidth=C,G.strokeStyle=i,G.stroke(),He(G,Z)}}else{var P=Bj(G,Z);S||y||t?(Uk(G,d,o),t?Np(G,t):y?Od(G,y,U,null,I,L):Jm(G,S,g,H,o),G.fill(),t&&G.restore(),G!==P&&Uk(P,d,o)):Uk(P,d,o),C>0&&(G.lineWidth=C,G.strokeStyle=f("group.border.color"),G.stroke()),He(G,Z),d===Dj&&db(G,S,p,o)}G.lineJoin=E,G.lineCap=W}else{var Y=f("group.title.background"),m=f("group.border.radius");if(k)Bk(G,k,M,b.x,b.y,b.width,b.height,I,L,N.getBodyColor());else if(S||y)if(y?Od(G,y,U,null,I,L):Jm(G,S,g,H,b),0===C)Uk(G,Dj,b),G.fill(),db(G,S,p,b);else{switch(G.beginPath(),l){case cj:tb(G,b.x,b.y,b.width,b.height,m,m,0,0);break;case Ih:tb(G,b.x,b.y,b.width,b.height,0,m,0,m);break;case Go:tb(G,b.x,b.y,b.width,b.height,m,0,m,0);break;case ns:tb(G,b.x,b.y,b.width,b.height,0,0,m,m)}G.fill()}if(R&&Y)if(0===C)Yl(G,R.x,R.y,R.width,R.height,Y),db(G,Y,p,R);else{switch(G.beginPath(),G.fillStyle=Y,l){case cj:tb(G,R.x,R.y,R.width,R.height,0,0,m,m);break;case Ih:tb(G,R.x,R.y,R.width,R.height,m,0,m,0);break;case Go:tb(G,R.x,R.y,R.width,R.height,0,m,0,m);break;case ns:tb(G,R.x,R.y,R.width,R.height,m,m,0,0)}G.fill()}if(C>0){var P=Bj(G,Z);if(Uk(P,"roundRect",o,m),G.lineWidth=C,G.strokeStyle=i,R&&f("group.splitLine")){var r=R.x,O=R.y,h=R.width,w=R.height;l===cj?(G.moveTo(r,O),G.lineTo(r+h,O)):l===Ih?(G.moveTo(r+h,O),G.lineTo(r+h,O+w)):l===Go?(G.moveTo(r,O),G.lineTo(r,O+w)):(G.moveTo(r,O+w),G.lineTo(r+h,O+w))}G.stroke(),He(G,Z)}}N._39O(G,Q)}else rq.superClass._80o.call(N,G)}});var Jj=function(O,R){jj(Jj,this,[O,R])};Op(Jj,vr,{_80o:function(Z){this._39O(Z,this._83o)}});var rr=function(H,Z){jj(rr,this,[H,Z])};Op(rr,vr,{_3O:function(){var B=this,V=B._data,D=B.s,W=B.gv,R=V.getPoints(),y=W.getBorderColor(V),z=y?D("border.width"):0,i=B.getSelectWidth(),g=D("shape.border.width"),E=V.getRect(),Q=W.getBodyColor(V),_=B._99o=R.isEmpty()?s:{rect:E,rotation:V.getRotation(),fillRule:D("shape.fill.rule"),scale:V.getScale(),position:V.p(),points:R,segments:V.getSegments(),bodyColor:Q,borderColor:y,borderWidth:z,_94o:D("shape.border.3d"),_95o:D("shape.border.3d.color"),_96o:D("shape.border.3d.accuracy"),_97o:i?B.getSelectColor():s,selectWidth:i,_53o:D("shape.background"),_27Q:nb(D("shape.repeat.image"),Q),shapeGradientPack:D("shape.gradient.pack"),_54o:g,_55o:D("shape.border.color"),shapeGradient:D("shape.gradient"),_59o:D("shape.gradient.color"),_60o:D("shape.border.pattern"),_61o:D("shape.border.cap"),_62o:D("shape.border.join"),shapeForeground:D("shape.foreground"),gray:D("2d.gray")};if(_){var x=V.getScale(),Z=t(1,t(P(x.x),P(x.y)));D("shape.dash")&&D("shape.dash.width")>g&&(g=D("shape.dash.width"));var U=g*("square"===_._61o?.71:.5)+z+i/B.gv._zoom/Z;U&&(U*=Z,E=kl(E),cq(E,U,_._62o)),B._68o(E);var Y=D("clip.percentage");1>Y&&(0>Y&&(Y=0),_.clipRect=Cl(V.getAnchorRect(),D("clip.direction"),Y));var H=D("shape.fill.clip.percentage");1>H&&(0>H&&(H=0),_.shapeClipRect=Cl(V.getAnchorRect(),D("shape.fill.clip.direction"),H));var e=D("shape.foreground.clip.percentage");1>e&&(0>e&&(e=0),_.shapeForegroundClipRect=Cl(V.getAnchorRect(),D("shape.foreground.clip.direction"),e))}},getPosition:function(P,X,U,m){var p=this._99o;if(p){var L=Rf(P,p.rect,m);return L.x+=X,L.y+=U,L}return vi},_42:function(h){this._99o&&rr.superClass._42.call(this,h)},_80o:function(d){var D,h=this,A=h.s,o=h._99o,w=o.position,f=o.scale,c=o.rotation,q=o.borderWidth,e=o.selectWidth/h.gv._zoom,x=o._27Q,H=o.shapeGradientPack,O=o._54o,V=o.clipRect,X=o.shapeClipRect,t=o.points,i=o.segments,Z=h._data.isClosePath(),k=o.fillRule,s=o.gray,U=function(B){return s?l.toGrayColor(B):B},Q=U(o._53o),r=Q||x||H;d.save(),Zd(d,w.x,w.y),jc(d,c),vp(d,f.x,f.y),V&&(d.beginPath(),d.rect(V.x,V.y,V.width,V.height),d.clip()),r&&X&&(d.save(),d.beginPath(),d.rect(X.x,X.y,X.width,X.height),d.clip()),Zd(d,-w.x,-w.y);var F=o._60o,E=Bj(d,F),R=d.lineJoin,K=d.lineCap;d.lineJoin=o._62o,d.lineCap=o._61o;var u=U(o.bodyColor);r?(wk(d,t,i,Z),H?Np(d,H):x?Od(d,x,u,null,h._data,h.gv):(D=u?u:Q,Jm(d,D,o.shapeGradient,U(o._59o),o.rect)),d.fill(k),X&&(d.restore(),Zd(d,-w.x,-w.y)),H&&d.restore(),E!==d&&wk(E,t,i,Z)):wk(E,t,i,Z);var p=o.shapeForeground;if(p){d.save();var J=o.shapeForegroundClipRect;J&&(Zd(d,w.x,w.y),d.beginPath(),d.rect(J.x,J.y,J.width,J.height),d.clip(),Zd(d,-w.x,-w.y)),wk(d,t,i,Z),Jm(d,p,A("shape.foreground.gradient"),U(A("shape.foreground.gradient.color")),o.rect),d.fill(k),d.restore()}var I=A("shape.border.width.absolute");if(I&&(d.save(),d.setTransform(1,0,0,1,0,0)),e&&(d.strokeStyle=o._97o,d.lineWidth=O+2*(q+e),d.stroke()),q&&(d.strokeStyle=U(o.borderColor),d.lineWidth=O+2*q,d.stroke()),O&&(D=U(o._55o),!Q&&u&&(D=u),d.strokeStyle=D,d.lineWidth=O,d.stroke(),o._94o&&Zi(d,D,U(o._95o),O,h.gv._zoom,o._96o)),I&&d.restore(),He(d,F),A("shape.dash")){var S=A("shape.dash.width")||O;if(S>0){F=A("shape.dash.pattern");var E=Bj(d,F,h._2Q("shape.dash.offset"));E!==d&&wk(E,t,i,Z),h._1Q(d,"shape",S,F)}}d.lineJoin=R,d.lineCap=K,d.restore()},_48O:function(){},_47O:function(){}});var eh=function(f,q){jj(eh,this,[f,q])};Op(eh,rr,{getRotation:function(v,e,i){v=v||0;var z=this._data.getPoints(),w=z.size();return w>1?ql[i]?w&&0===w%2?qc(z.get(w/2-1),z.get(w/2),e,v):v:bq[i]?qc(z.get(0),z.get(1),e,v):qc(z.get(w-2),z.get(w-1),e,v):v},getPosition:function(L,I,C,h,N){var D=this._data.getPoints(),z=D.size();if(z>1){if(ql[L]){var M=z%2;if(0===M)return _r(D.get(z/2-1),D.get(z/2),L,I,C,h,N);var P=D.get((z-M)/2),_={x:P.x,y:P.y,width:0,height:0};return P=Rf(L,_,h),P.x+=I,P.y+=C,P}return bq[L]?_r(D.get(0),D.get(1),L,I,C,h,N):_r(D.get(z-2),D.get(z-1),L,I,C,h,N)}return vi}});var _p=function(V,_){jj(_p,this,[V,_])};Op(_p,vr,{_3O:function(){var V=this;_p.superClass._3O.call(V);var k=V.s,T=V._83o;V._82o=T.img||T.shape?s:{background:V.getBodyColor("grid.background"),depth:k("grid.depth"),rect:T.rect,_88o:k("grid.cell.depth"),cellBorderColor:k("grid.cell.border.color"),_89o:k("grid.row.count"),_90o:k("grid.column.count"),block:k("grid.block"),_91o:k("grid.block.color"),_92o:k("grid.block.padding"),_93o:k("grid.block.width")}},_80o:function(K){var y=this,Y=y._82o;if(!Y)return _p.superClass._80o.call(y,K),void 0;var B,Z,A=y._data,l=Y.background,C=Y.rect,Q=Y.block,N=Y._91o,O=Y._92o,T=Y._93o,j=Y._88o,i=Y.cellBorderColor,E=Y._89o,H=Y._90o;if(l)if(Yl(K,C.x,C.y,C.width,C.height,l),db(K,l,Y.depth,C),j)for(B=0;E>B;B++)for(Z=0;H>Z;Z++)C=A.getCellRect(B,Z),C&&db(K,l,j,C);else if(i){for(K.beginPath(),B=0;E>B;B++)for(Z=0;H>Z;Z++)C=A.getCellRect(B,Z),C&&K.rect(C.x,C.y,C.width,C.height);K.strokeStyle=i,K.lineWidth=1,K.stroke()}if("h"===Q)for(B=0;E>B;B++)C=Og(A.getCellRect(B,0),A.getCellRect(B,H-1)),mf(C,O),Gq(K,N,C.x,C.y,C.width,C.height,T);else if("v"===Q)for(Z=0;H>Z;Z++)C=Og(A.getCellRect(0,Z),A.getCellRect(E-1,Z)),mf(C,O),Gq(K,N,C.x,C.y,C.width,C.height,T);y._39O(K,y._83o)}});var Jk=function(z,V){jj(Jk,this,[z,V])};Op(Jk,vr,{_checkEmptyRect:!1,_81o:function(){var c=this._data,N=Jk.superClass._81o.call(this),t=c.s("text");if(t!=s){var H,w,d=c.s("text.font"),g=c.s("text.align"),B=c.s("text.vAlign"),D=sq(d,t),W=D.width,o=D.height,m=c.getAnchor(),X=c.getWidth(),T=c.getHeight();"left"===g?H=-X*m.x:"center"===g?H=-X*m.x+(X-W)/2:"right"===g&&(H=X*(1-m.x)-D.width),"top"===B?w=-T*m.y:"middle"===B?w=-T*m.y+(T-o)/2:"bottom"===B&&(w=T*(1-m.y)-D.height);var L,U=c.getMatrix();if(L=Bq([U.tf(H,w),U.tf(H+W,w),U.tf(H+W,w+o),U.tf(H,w+o)]),N=Og(N,L),N&&c.s("text.shadow")){var $=kl(N);$.x+=c.s("text.shadow.offset.x"),$.y+=c.s("text.shadow.offset.y"),mf($,c.s("text.shadow.blur")),N=Og(N,$)}}return N}});var Me=pi.Interactor=function(x){this.gv=this._graphView=x};vl("Interactor",H,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(v){this.gv.fi(v)},setCursor:function(S){Ch||this.gv.setCursor(S)},startDragging:function(b){var U=this;U._lastClientPoint=Il(b),U._lastLogicalPoint=U.gv.lp(b),De(U,b)},clearDragging:function(){var X=this;X._lastClientPoint=X._lastLogicalPoint=X._logicalPoint=s},autoScroll:function(H){return this.gv.autoScroll(H,this._lastClientPoint)}});var rh=s,Hc=function(U){rh.handleWindowTouchMove(U)},qj=function(g){rh.handleWindowTouchEnd(g),R.removeEventListener(No,Hc,i),R.removeEventListener(zf,qj,i),rh=s},Qh=function(W){rh.handleWindowMouseMove(W)},wl=function(j){rh.handleWindowMouseUp(j),R.removeEventListener(Ek,Qh,i),R.removeEventListener(sl,wl,i),rh=s},Ld=function(a,C){a!==rh&&(rh?Ch?rh.handleWindowTouchEnd(C):rh.handleWindowMouseUp(C):Ch?(R.addEventListener(No,Hc,i),R.addEventListener(zf,qj,i)):(R.addEventListener(Ek,Qh,i),R.addEventListener(sl,wl,i)),rh=a)},yr=function(q){var m=this;m.gv=q,m._is2d=q instanceof pi.GraphView,m._is2d&&(m.filter=function(j){return q.isSelectable(j)&&q.isInteractive(j)}),q.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",qr].forEach(function(c){m.addListener(c)}),m.initImageResource()};Op(yr,Me,{enableVR:function(R){var w=this;if(!!w._vrEnable!==R)if(w._vrEnable=R,R)w.gv.vr.mp(w.onVRControllerChange,w);else if(w.gv.vr.ump(w.onVRControllerChange,w),w._vrRayPolyline){var v=w.gv.dm();v.remove(w._vrRayPolyline),v.remove(w._vrRayHitPoint),w._vrRayPolyline=r,w._vrRayHitPoint=r}},onVRControllerChange:function(A){var Z=this,u=A.property,y=A.newValue,T=Z.gv.vr.getController(y.id),e=T.getRay();e&&("gamepad.button.trigger"===u?"down"===y._62O?Z.handle_mousedown(e):Z.handleWindowMouseUp(e):"gamepad.pose"===u&&(Z.handle_mousemove(e),Z.handleWindowMouseMove(e)))},drawVRRay:function(V,P,B){var c,H=this,X=H.gv,g=H._vrRayPolyline,v=!1;if(g)c=H._vrRayHitPoint;else{var E=X.dm();H._vrRayPolyline=g=new I.Polyline,H._vrRayHitPoint=c=new I.Node,c.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),c.setAnchor3d(.5,.5,.499);var T=.2/X.vr.measureOflength;c.s3(T,T,T),g.s("intersect",!1),c.s("intersect",!1),E.add(g),E.add(c),v=!0}if(P){var C=B.world,Y=B.worldNormal,U=C.x,n=C.y,h=C.z;g.s("shape.border.color","red"),g.setPoints([{x:V.origin.x,y:V.origin.z,e:V.origin.y},{x:U,y:h,e:n}]),c.s("3d.visible",!0),c.p3(U,n,h),c.lookAtDirection([Y.x,Y.y,Y.z],"front")}else{g.s("shape.border.color","blue");var s=new I.Math.Vector3;s.copy(V.direction).setLength(1e3/H.gv.vr.measureOflength).add(V.origin),g.setPoints([{x:V.origin.x,y:V.origin.z,e:V.origin.y},{x:s.x,y:s.z,e:s.y}]),c.s("3d.visible",!1)}X.fi({kind:"vrRayIntersect",ray:V,data:P,intersect:B,polyline:g,hitNode:c,begin:v})},addListener:function(p){var w=this;w.gv.getView().addEventListener(p,function(X){l.preventDefault(X),w.disabled||w["handle_"+p](X)},i)},handleWindowTouchMove:function(V){this.handleWindowMouseMove(V)},handleWindowMouseMove:function(i){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",i):(this.handleDownInfo("onBeginDrag",i),this.isDragging=!0))},handleWindowTouchEnd:function(l){this.handleWindowMouseUp(l)},handleWindowMouseUp:function(H){if(this.isDragging&&(this.handleDownInfo("onEndDrag",H),this.isDragging=!1),this.downInfo){var m=this.handle("onUp",H);m&&m.data===this.downInfo.data?this.handleMissingUp(H):this.handleDownInfo("onUp",H),this.downInfo=s}},handle_mouseleave:function(r){var E=this,v=E.gv,M=E.currentInfo?E.currentInfo.data:s;if(M){M.s("onLeave")&&M.s("onLeave")(r,M,v),E.fire("data","onLeave",r,M);var h=E.currentInfo?E.currentInfo.hits:s;if(h)for(var k in h)E.handleLeave(r,k);E.currentInfo=s}},handle_mousewheel:function(r){r.scrollDelta=r.wheelDelta/40,this.handle("onScroll",r)},handle_DOMMouseScroll:function(Q){Q.scrollDelta=2===Q.axis?-Q.detail:0,this.handle("onScroll",Q)},handle_touchstart:function(m){this.handle_mousedown(m)},handle_touchmove:function(y){this.handle("onMove",y)},handle_mousedown:function(v){this.isDragging&&(this.handleDownInfo("onEndDrag",v),this.isDragging=!1),this.downInfo=this.handle("onDown",v),this.downInfo&&Ld(this,v)},handle_mousemove:function(j){var S=this,O=S.gv;S._hoverTimer&&(U(S._hoverTimer),delete S._hoverTimer);var y,Q,T,h=S.handle("onMove",j),z=this.currentInfo?this.currentInfo.data:s,V=this.currentInfo?this.currentInfo.hits:s;if(h&&(Q=h.data,T=h.hits,S._hoverTimer=q(function(){U(S._hoverTimer),delete S._hoverTimer,S.handle("onHover",j,h)},O.getHoverDelay()||l.hoverDelay)),Q!==z){if(z&&(z.s("onLeave")&&z.s("onLeave")(j,z,O),this.fire("data","onLeave",j,z)),Q&&(Q.s("onEnter")&&Q.s("onEnter")(j,Q,O),this.fire("data","onEnter",j,Q)),V)for(y in V)this.handleLeave(j,y);if(T)for(y in T){var i=T[y];i.target.onEnter&&i.target.onEnter(j,Q,O,i.point,i.width,i.height),this.fire(i.type,"onEnter",i.event,i.data,i.image,i.comp,i.point,i)}}else{if(V)for(y in V)T&&T[y]||this.handleLeave(j,y);if(T)for(y in T)if(!V||!V[y]){var i=T[y];i.target.onEnter&&i.target.onEnter(j,Q,O,i.point,i.width,i.height),this.fire(i.type,"onEnter",i.event,i.data,i.image,i.comp,i.point,i)}}this.currentInfo=h},handle:function(c,X,b){var n,C=this,E=C.gv;if(C._is2d){if(b=b||E.getDataInfoAt(X,this.filter),!b)return;if(n=b.ui.interactiveInfo){var D,s=b.data;if(s.s(c)&&s.s(c)(X,s,E),this.fire("data",c,X,s),"body"===b.part&&n.bodyInfo)D="body",b.hits=this.handleImage(D,E.getImage(s),c,X,s,b.point,n.bodyInfo);else if("icons"===b.part&&n._38o){var z=n._38o[b.name];z&&z[b.index]&&(D="icons|"+b.name+"|"+b.index,b.hits=this.handleImage(D,b.icon,c,X,s,b.point,z[b.index]))}}return b}var s,o;if(!b)if(X&&X instanceof I.Math.Ray){var U=E.vr.intersectWorld(X);if(s=U.data,o=U.intersect,C.drawVRRay(X,s,o),!s)return;var W=E.getData3dUI(s);if(n=W.interactiveInfo,!n)return;b={data:s,part:o.part,ui:W}}else{if(b=E.getDataInfoAt(X),!b)return;b&&(b={data:b.data,part:b.part})}if(!o){s=b.data;var W=E.getData3dUI(s);if(b.ui=W,n=W.interactiveInfo,!n)return b;if(o=E.intersectObject(X,s),!o)return}s.s(c)&&s.s(c)(X,s,E),this.fire("data",c,X,s);var S,e=o.part;return"body"!==e&&(S=s.s(e+".image")||s.s("shape3d."+e+".image")),S||(S=s.s("all.image")||s.s("shape3d.image")),n="object"==typeof S?n[S.uuid]:n[S],n&&n.bodyInfo?(b.part="body",b.interactiveInfo=n,b.point=o.uv.multiply({x:n.bodyInfo.rect.width,y:n.bodyInfo.rect.height}),b.image=S,b.hits=this.handleImage("body",S,c,X,s,b.point,n.bodyInfo),b):b},_handleLeaveOrMissing:function($,C,O){var B="leave"===$?this.currentInfo:this.downInfo;if(B){var k=B.interactiveInfo||B.ui.interactiveInfo;if(k){var W,Q,o=B.data;if(this._is2d){if(Q=this.gv.lp(C),"body"===B.part&&k.bodyInfo)W="body","leave"===$?this.handleLeaveImage(O,W,this.gv.getImage(o),C,o,Q,k.bodyInfo):this.handleMissingUpImage(W,this.gv.getImage(o),C,o,Q,k.bodyInfo);else if("icons"===B.part&&k._38o){var D=k._38o[B.name];D&&D[B.index]&&(W="icons|"+B.name+"|"+B.index,"leave"===$?this.handleLeaveImage(O,W,B.icon,C,o,Q,D[B.index]):this.handleMissingUpImage(W,B.icon,C,o,Q,D[B.index]))}}else{if(!k.bodyInfo)return;var p=this.gv.intersectObject(C,o);Q=p?p.uv.multiply({x:k.bodyInfo.rect.width,y:k.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===$?this.handleLeaveImage(O,"body",B.image,C,o,Q,k.bodyInfo):this.handleMissingUpImage("body",B.image,C,o,Q,k.bodyInfo)}}}},handleDownInfo:function(y,v){if(this.downInfo){var W=this.downInfo,u=this.gv,Y=W.interactiveInfo||W.ui.interactiveInfo;if(Y){var C,i=W.data;if(i.s(y)&&i.s(y)(v,i,u),this.fire("data",y,v,i),this._is2d){var c=u.lp(v);if("body"===W.part&&Y.bodyInfo)C="body",this.handleDownInfoImage(C,u.getImage(i),y,v,i,c,Y.bodyInfo);else if("icons"===W.part&&Y._38o){var E=Y._38o[W.name];E&&E[W.index]&&(C="icons|"+W.name+"|"+W.index,this.handleDownInfoImage(C,W.icon,y,v,i,c,E[W.index]))}}else{if(!Y.bodyInfo)return;var R=u.intersectObject(v,i);if(!R)return;c=R.uv.multiply({x:Y.bodyInfo.rect.width,y:Y.bodyInfo.rect.height}),this.handleDownInfoImage("body",W.image,y,v,i,c,Y.bodyInfo)}}}},fire:function(V,D,C,J,q,k,W,I){this.gv.fi({kind:D,type:V,event:C,data:J,image:q,comp:k,view:this.gv,point:W,width:I?I.width:r,height:I?I.height:r})},handleImage:function(b,N,Z,H,J,p,e){var D={};if(N&&(N=nb(N))){var Q=this.gv,l=e.rect,s=this.convertPoint(p,e);s.inRect&&(N[Z]&&N[Z](H,J,Q,s,l.width,l.height),this.fire("image",Z,H,J,N,r,s,l),D[b+"|image"]={target:N,type:"image",image:N,data:J,event:H,point:s,width:l.width,height:l.height});for(var v=e.compInfos,T=N,_=v.length-1;_>=0;_--){var K=v[_],w=K.comp;s=this.convertPoint(p,K,T,w,Q,J),s.inRect&&(l=K.rect,w[Z]&&w[Z](H,J,Q,s,l.width,l.height),this.fire("comp",Z,H,J,N,w,s,l),(N=l.image)&&(N[Z]&&N[Z](H,J,Q,s,l.width,l.height),this.fire("image",Z,H,J,N,r,s,l)),D[b+"|"+_]={target:w,type:"comp",comp:w,image:N,data:J,event:H,point:s,width:l.width,height:l.height},N&&(D[b+"|"+_+"|image"]={target:N,type:"image",image:N,data:J,event:H,point:s,width:l.width,height:l.height}))}}return D},handleLeave:function(W,s){return this._handleLeaveOrMissing("leave",W,s)},handleMissingUp:function(d){return this._handleLeaveOrMissing("missing",d)},handleLeaveImage:function(T,$,j,S,e,f,y){if(j&&(j=nb(j))){var b=this.gv,K=y.rect,J=this.convertPoint(f,y);T===$+"|image"&&(j.onLeave&&j.onLeave(S,e,b,J,K.width,K.height),this.fire("image","onLeave",S,e,j,r,J,K));
        for(var L=y.compInfos,B=j,z=L.length-1;z>=0;z--){var l=L[z],R=l.comp;J=this.convertPoint(f,l,B,R,b,e),K=l.rect,T===$+"|"+z&&(R.onLeave&&R.onLeave(S,e,b,J,K.width,K.height),this.fire("comp","onLeave",S,e,j,R,J,K)),(j=K.image)&&T===$+"|"+z+"|image"&&(j.onLeave&&j.onLeave(S,e,b,J,K.width,K.height),this.fire("image","onLeave",S,e,j,r,J,K))}}},handleMissingUpImage:function(R,T,k,z,j,Y){var $="onUp",h=this.downInfo.hits;if(h&&T&&(T=nb(T))){var s=this.gv,M=Y.rect,A=this.convertPoint(j,Y);!A.inRect&&h[R+"|image"]&&(T[$]&&T[$](k,z,s,A,M.width,M.height),this.fire("image",$,k,z,T,r,A,M));for(var c=Y.compInfos,Z=T,B=c.length-1;B>=0;B--){var G=c[B],t=G.comp;A=this.convertPoint(j,G,Z,t,s,z),A.inRect||(M=G.rect,h[R+"|"+B]&&(t[$]&&t[$](k,z,s,A,M.width,M.height),this.fire("comp",$,k,z,T,t,A,M)),(T=M.image)&&h[R+"|"+B+"|image"]&&(T[$]&&T[$](k,z,s,A,M.width,M.height),this.fire("image",$,k,z,T,r,A,M)))}}},handleDownInfoImage:function(A,M,k,_,T,n,V){var o=this.downInfo.hits;if(o&&M&&(M=nb(M))){var m=this.gv,z=V.rect,J=this.convertPoint(n,V);o[A+"|image"]&&(M[k]&&M[k](_,T,m,J,z.width,z.height),this.fire("image",k,_,T,M,r,J,z));for(var W=V.compInfos,h=M,Z=W.length-1;Z>=0;Z--){var p=W[Z],Q=p.comp;J=this.convertPoint(n,p,h,Q,m,T),z=p.rect,o[A+"|"+Z]&&(Q[k]&&Q[k](_,T,m,J,z.width,z.height),this.fire("comp",k,_,T,M,Q,J,z)),(M=z.image)&&o[A+"|"+Z+"|image"]&&(M[k]&&M[k](_,T,m,J,z.width,z.height),this.fire("image",k,_,T,M,r,J,z))}}},initImageResource:function(){l.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(W,I,K,y,B,m){var $=I.rect,j=I.matrix.applyInverse(W).sub($),P=j.x>=0&&j.y>=0&&j.x<=$.width&&j.y<=$.height;if(!P)return j;if(y&&Ro(y.pixelPerfect,m,B)){var $,C=1;this._is2d?(C=B.getZoom(),$=ne(W.x,W.y,r,C)):$=ne(W.x,W.y);var v=!1,J=$.x,w=$.y,V=$.width,Q=$.height,t=l.hitMaxArea,i=V*Q*C*C;if(i>t){var Y=Math.sqrt(t/i);C*=Y}V*=C,Q*=C,2>V&&(V=2),2>Q&&(Q=2),J*=C,w*=C;var H=Ac(V,Q),d=new Am(0,-J,-w,C,C);d.append(I.matrix),B._drawForChecking=!0,y.transform=d;var x=K.comps;K.comps=[y],rm(H,K,0,0,V,Q,m,self),K.comps=x,delete y.transform,B._drawForChecking=!1;try{for(var U=0,z=H.getImageData(0,0,V,Q).data;U<z.length;U+=4)if(0!==z[U+3]){v=!0;break}H.restore()}catch(_){xl=s,v=!1}j.inRect=v}else j.inRect=!0;return j}});var Xn=pi.DefaultInteractor=function(C){jj(Xn,this,[C])};vl("DefaultInteractor",Me,{handle_mousedown:function(C){bn(C);var k=this,E=k.gv,W=E.getDataAt(C);!E.setFocus(C)||E._editing||E._scrolling||(ui(C)?E.handleDoubleClick(C,W):E.handleClick(C,W),!Ln()&&W&&(E.isMovable(W)||E.isInteractive(W))||!E.isPannable()||!Zb(C)||Ei(C)||(k._tx=E.tx(),k._ty=E.ty(),k.startDragging(C)))},handleWindowMouseUp:function(J){var k=this,t=k.gv;t._panning&&(delete t._panning,t.onPanEnded(),k.fi({kind:"endPan",event:J})),delete k._tx,delete k._ty,k.clearDragging()},handle_mousemove:function(o){var n=this,m=n.gv;n._hoverTimer&&(U(n._hoverTimer),delete n._hoverTimer),n._hoverTimer=q(function(){n.fi({kind:"hover",event:o}),U(n._hoverTimer),delete n._hoverTimer},m.getHoverDelay()||l.hoverDelay)},handle_touchmove:function(h){this.handle_mousemove(h)},handleWindowMouseMove:function(r){var Y=this,q=Y.gv,p=Y._lastClientPoint;Y.fi({kind:q._panning?"betweenPan":"beginPan",event:r}),q._panning=1,q.setTranslate(Y._tx+r.clientX-p.x,Y._ty+r.clientY-p.y)},handle_mousewheel:function(l){this.gv.handleScroll(l,l.wheelDelta)},handle_DOMMouseScroll:function(T){2===T.axis&&this.gv.handleScroll(T,-T.detail)},handle_keydown:function(x){this.gv.handleKeyDown(x)}});var Fc=pi.SelectInteractor=function(A){jj(Fc,this,[A])};vl("SelectInteractor",Me,{_42:function(){var y=this,Z=y.gv,n=Z.getZoom(),o=y.mark,T=y.div;T||(T=y.div=$b(),Xd(y.getView(),T));var e={};e.x=o.x*n+Z.tx(),e.y=o.y*n+Z.ty(),e.width=o.width*n,e.height=o.height*n,Kj(T,e),this.intersects()?(T.style.border="",T.style.background=Z.getRectSelectBackground()):(T.style.background="",T.style.border="1px solid "+Z.getRectSelectBorderColor())},handle_mousedown:function(r){var Y=this,S=Y.gv;if(Y._57I=s,Y.pendingClickThrough=s,!(S._editing||S._scrolling||Ln())){var H=S.getDataAt(r),i=S.sm();H?Ei(r)?i.co(H)?i.rs(H):i.as(H):i.co(H)?H instanceof Ud&&H.isClickThroughEnabled()&&Zb(r)&&(Y.pendingClickThrough=Il(r)):i.ss(H):Ei(r)||!S.isPannable()?Zb(r)&&(Ei(r)||i.cs(),S.isRectSelectable()&&(Y.startDragging(r),S._77O=1)):Zb(r)&&(Y._57I=Il(r))}},handle_mouseup:function(r){var K=this,l=K.gv,D=K._57I;if(D&&(Bg(D,Il(r))<=1&&l.sm().cs(),K._57I=s),K.pendingClickThrough){if(Bg(K.pendingClickThrough,Il(r))<=1){var t=l.getDataAt(r);if(t instanceof Ud&&t.isClickThroughEnabled()){var f=l.getDataAt(r,function(K){var n=K.getParent()===t&&l.isSelectable(K,!0);return n});f&&(r.clickThrough=!0,l.sm().ss(f))}}K.pendingClickThrough=s}},handleWindowMouseUp:function(y){this.clear(y)},handleWindowMouseMove:function(t){var v=this,s=v.gv;v._logicalPoint=s.lp(t),v.mark?(v.fi({kind:"betweenRectSelect",event:t}),s.isPannable()&&v.autoScroll(t),v.redraw()):v.fi({kind:"beginRectSelect",event:t}),v.mark=Bq(v._lastLogicalPoint,v._logicalPoint),v.redraw()},intersects:function(){var F=this,C=F._lastLogicalPoint,o=F._logicalPoint;return C.x>o.x||C.y>o.y},clear:function(x){var p=this,n=p.gv,X=p.mark;if(p._57I=s,p.pendingClickThrough=s,p._lastLogicalPoint){if(X){if(0!==X.width&&0!==X.height){var c=n.getDatasInRect(X,p.intersects());if(!c.isEmpty()){var j=n.sm(),w=j.toSelection();c.each(function(q){j.co(q)?w.remove(q):w.add(q)}),j.ss(w)}}kq(p.div),delete p.div,delete p.mark,p.redraw(),p.fi({kind:"endRectSelect",event:x}),n.onRectSelectEnded()}p.clearDragging(),delete n._77O}},redraw:function(){var k=this;k._draw||(k._draw=1,q(function(){k.mark&&k._42(),delete k._draw},16))}});var jh=pi.MoveInteractor=function(w){jj(jh,this,[w])};vl("MoveInteractor",Me,{handle_mousedown:function(o){var F=this,b=F.gv;if(Zb(o)&&!b._editing&&!b._scrolling&&!Ln()){var S=b.getSelectedDataAt(o);!S||b.isInteractive(S)&&!b.isMovable(S)?b._focusData=s:(F._data=S,b.handleMouseDown&&b.handleMouseDown(o,S),F.startDragging(o),b.isMovable(S)&&(b._moving=1))}},handleWindowMouseUp:function(H){var $=this,p=$.gv;p.handleMouseUp&&p.handleMouseUp(H,$._data),$.clear(H)},handleWindowMouseMove:function(C){var n=this,u=n._data,Q=n.gv;if((!Q._93O||!Q._93O(C,u))&&Q._moving){n._logicalPoint||n.fi({kind:"prepareMove",event:C});var e=n._logicalPoint?"betweenMove":"beginMove",Y={kind:e,event:C},B=n._logicalPoint=Q.lp(C);"beginMove"!==e||n._alreadyBeginTransaction||(n._alreadyBeginTransaction=!0,Q.getDataModel().beginTransaction());var v=n._calcShift(e,C),t=v.x,w=v.y,g=n.gv.getMoveMode(C,u);g&&("x"===g?w=0:"y"===g?t=0:"xy"!==g&&(t=w=0)),Q.moveSelection(t,w),n._lastLogicalPoint=B,n.autoScroll(C),n.fi(Y)}},_calcShift:function(){var h=this,I=h._logicalPoint,x=h._lastLogicalPoint,m=I.x-x.x,s=I.y-x.y;return{x:m,y:s}},clear:function(l){var O=this,A=O.gv;O._lastLogicalPoint&&(O._lastLogicalPoint=O._data=A._moving=s,O._logicalPoint&&(O.fi({kind:"endMove",event:l}),A.onMoveEnded()),O.clearDragging()),O._alreadyBeginTransaction&&(O._alreadyBeginTransaction=!1,A.getDataModel().endTransaction())}});var Ol=pi.ScrollBarInteractor=function(W){jj(Ol,this,[W])};vl("ScrollBarInteractor",Me,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(A){var z=this.gv.getViewRect();return this._41o()&&(z.x+z.width-this.gv.lp(A).x)*this.gv.getZoom()<Fo},isH:function(d){var n=this.gv.getViewRect();return this._40o()&&(n.y+n.height-this.gv.lp(d).y)*this.gv.getZoom()<Fo},handle_mousemove:function(f){this.handle_touchmove(f)},handle_touchmove:function(n){if(!Rn&&Zb(n)&&this.gv.isScrollBarVisible()){var $=this,u=$.isV(n),Z=$.isH(n);(u||Z)&&$.gv.showScrollBar(),$.gv._scrolling=u||Z}},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(W){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=s,this.fi({kind:"endScroll",event:W})},handle_mousedown:function(P){this.handle_touchstart(P)},handle_touchstart:function(t){var N=this;if(N.gv.setFocus(t),bn(t),N.handle_touchmove(t),!(Xf(t)>1)&&N.gv._scrolling&&N.gv.isScrollBarVisible()){N._cp=Il(t),N._tx=N.gv.tx(),N._ty=N.gv.ty();var z=N.isV(t);N._state=z?"vScroll":"hScroll",De(N,t),N.fi({kind:"beginScroll",event:t})}},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(d){var A=Il(d),R=this.gv.getViewRect(),J=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-A.y)*J.height/R.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-A.x)*J.width/R.width),this.fi({kind:"betweenScroll",event:d})}});var Hj=pi.TouchInteractor=function(k,Z){Z=Z||{},Z.selectable===r&&(Z.selectable=!0),Z.movable===r&&(Z.movable=!0),Z.pannable===r&&(Z.pannable=!0),Z.pinchable===r&&(Z.pinchable=!0),Z.editable===r&&(Z.editable=!0),this.params=Z,jj(Hj,this,[k])};vl("TouchInteractor",Me,{ms_edit:1,setUp:function(){var L=this;Hj.superClass.setUp.call(L),Ch&&L.params.editable&&L.gv.setEditInteractor(L)},tearDown:function(){var R=this;Hj.superClass.tearDown.call(R),Ch&&R.params.editable&&R.gv.setEditInteractor(s)},clear:function(g){var l=this,N=l.gv;N._moving&&(l.fi({kind:"endMove",event:g}),delete N._moving,N.onMoveEnded(),N.dm().endTransaction()),N._panning&&(l.fi({kind:"endPan",event:g}),delete N._panning,N.onPanEnded()),N._pinching&&(l.fi({kind:"endPinch",event:g}),delete N._pinching,N.onPinchEnded()),N._editing&&(l._46O(g),l._77I=l._node=l._edge=l._shape=l._rect=l._89I=l._index=N._editing=s),l._moving=l._panning=l._pinching=l._editing=l._57I=l._data=l._beginHistory=s,l.clearDragging()},handle_touchstart:function(T){var t=this;if(!t.gv._editing){bn(T),t._57I=s;var N=t.params,L=t.gv,O=L.sm(),m=L.getDataAt(T),z=Xf(T);if(1===z){if(ui(T))return L.handleDoubleClick(T,m),void 0;L.handleClick(T,m),m&&(L.handleMouseDown&&L.handleMouseDown(T,m),t._data=m),N.selectable||(m=s),m?(O.co(m)||O.ss(m),N.editable&&L.isEditable(m)&&t._79I(T,m,!0)?(t._editing=1,t.startDragging(T)):N.movable&&L.isMovable(m)&&(t._moving=1,t.startDragging(T))):(t._57I=Il(T),N.pannable&&L.isPannable()&&(t._panning=1,t.startDragging(T),t._translate={x:L.tx(),y:L.ty()}))}else if(N.pinchable&&2===z){t._pinching=1,t.startDragging(T);var X=L.getView(),F=L.getZoom(),P=X.getBoundingClientRect(),f=T.touches[0],E=T.touches[1],l={x:(f.clientX+E.clientX)/2-P.left,y:(f.clientY+E.clientY)/2-P.top};l.x-=L.tx(),l.y-=L.ty(),l.x/=F,l.y/=F,t._p=l,t._d=Lr(T)}}},handle_touchend:function(u){var G=this,m=G.gv,T=G._57I,B=G._data;T&&(Bg(T,Il(u))<=1&&m.sm().cs(),G._57I=s),B&&m.handleMouseUp&&m.handleMouseUp(u,B)},handleWindowTouchEnd:function(m){this.clear(m)},handleWindowTouchMove:function(w){var q=this,x=q.gv,I=Xf(w);if(1===I){if(q._editing&&(q._beginHistory||(q._beginHistory=1,x.dm().beginTransaction()),x._editing=1,q._78I(w)),q._moving)q._beginHistory||(q._beginHistory=1,x.dm().beginTransaction()),q.handleMove(w);else if(q._panning){var f=Il(w);x.setTranslate(q._translate.x+f.x-q._lastClientPoint.x,q._translate.y+f.y-q._lastClientPoint.y),q.fi({kind:x._panning?"betweenPan":"beginPan",event:w}),x._panning=1}}else if(2===I&&q._pinching){var c=Lr(w);x.handlePinch(q._p,c,q._d),q._d=c,q.fi({kind:x._pinching?"betweenPinch":"beginPinch",event:w}),x._pinching=1}},handleMove:function(A){var d=this,u=d.gv,G=u.lp(A);u._93O&&u._93O(A,d._data)||(u.moveSelection(G.x-d._lastLogicalPoint.x,G.y-d._lastLogicalPoint.y),d._lastLogicalPoint=G,d.autoScroll(A),d.fi({kind:u._moving?"betweenMove":"beginMove",event:A}),u._moving=1)}});var I=R.ht,Bd=I.graph._editor={Math:I.Math,Guide:{}};Bd.getStyle=function(P){var Q,y=Bd.StyleMap;return y&&(Q=y[P],Q!==r)?Q:Bd.DefaultStyleMap[P]},Bd.setStyle=function(c,C){var y=Bd.StyleMap;y||(y=Bd.StyleMap={}),y[c]=C},Bd.inEdit=function(W){return W._inXEdit===!0},Bd.startEdit=function(P){P._inXEdit=!0,Bd.Inject.doInject(P)},Bd._46O=function(H){H._inXEdit=!1,Bd.Inject.undoInject(H)},Bd.toScreenPosition=function(T,V){var l=T.tx(),c=T.ty(),L=T._zoom;return new Bd.Math.Vector2(V.x*L+l,V.y*L+c)},Bd.checkHit=function(S,d,W){return S.distanceTo(d)<W?!0:!1},Bd.toWorldPosition=function(D,P){var j=D.tx(),A=D.ty(),Z=D._zoom;return{x:(P.x-j)/Z,y:(P.y-A)/Z}},Bd.setAntialias=function(i,K){for(var j,B=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],D=0,R=B.length;R>D&&(j=B[D],!(j in i));D++);i[j],i[j]=K},Bd.getTargetCornersOnScreen=function(u,_){if(!_)return null;var W,h=[];if(Rm(_,u)){var d=wq(u,_);W=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}]}else{if(!_.getCorners)return null;W=_.getCorners()}return W.forEach(function(e){var J=Bd.toScreenPosition(u,e);h.push(J.x,J.y)}),h},Bd.log=function(){};var si=Bd.Inject={_modules:[]};si.registAsModule=function(w,H){var o={},v={};for(var Z in w){var a=H.prototype[Z];o[Z]=a}w.getBackup=function(d){return o[d]},w.getBackups=function(){return o},v.doInject=function(){for(var q in w)"getBackup"!==q&&(H.prototype[q]=w[q])},v.undoInject=function(){for(var g in w)"getBackup"!==g&&(H.prototype[g]=o[g])},si._modules.push(v)},si.doInject=function($){for(var I,X=si._modules,Y=0,f=X.length;f>Y;Y++)I=X[Y],I.doInject($)},si.undoInject=function(O){for(var U,D=si._modules,F=0,J=D.length;J>F;F++)U=D[F],U.undoInject(O)};var Me=I.graph.EditInteractor=function(O){var D=this,d=k.createElement("canvas");d.className="editCanvas",d.style.position="absolute",D._styleMap={},D._canvas=d,D._context=d.getContext("2d"),Me.superClass.constructor.call(D,O),Bd.setAntialias(D._context,!1),D._subModules=[new Bd.Anchor(D),new Bd.RotateX(D),new Bd.Rect(D),new Bd.Curve(D),new Bd.MoveHelper(D)],D._gridGuide=new Bd.Guide.Grid(D),D._rectGuide=new Bd.Guide.Rect(D)},jb=Me;I.Default.def(Me,I.graph.Interactor,{ms_edit:1,ms_fire:1}),H.defineProperties(Me.prototype,{editDetail:{get:function(){var j=!!this._editDetail;return j},set:function(u){var O=this,x=O._editDetail;x!==u&&(O._editDetail=u,O.gv._editing=u,O.fp("editDetail",x,u),O.fp("pointsEditingMode",x,u),O.fi({kind:u?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(U){(!this._editDetail||U)&&(this.gv._editing=U,U||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(k){this._editing=k,this.gvEditing=k}},pointsEditingMode:{get:function(){return this.editDetail},set:function(X){var y=this;y.editDetail!==X&&(X?y._tryEnterEditDetailMode():y._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var X=this._gridEnabled;if(!X)return!1;var c=this.gv;return c?!0:!0},set:function(y){y!==this._gridEnabled&&(this._gridEnabled=y,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(S){S!==this._agEnabled&&(this._agEnabled=S,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Me.prototype.getSubModule=function(s){var o,N,X,Y=this._subModules;for(N=0,X=Y.length;X>N;N++)if(o=Y[N],o.catalog===s)return o},Me.prototype.invokeSubModule=function(x,Q){var t=this,s=t._subModules;if(s)for(var a,S,B,m=Array.prototype.slice.call(arguments,2),I=0,P=s.length;P>I;I++)if(a=s[I],S=a[x],S&&(B=S.apply(a,m),B!=r&&Q))return a},Me.prototype.invokeSubModuleInverse=function(f,X){var U=this,S=U._subModules;if(S)for(var O,R,q,H=Array.prototype.slice.call(arguments,2),G=S.length-1;G>=0;G--)if(O=S[G],R=O[f],R&&(q=R.apply(O,H),q!=r&&X))return O},Me.prototype.setUp=function(){Bd.log("setUp");var D=this,U=D.gv,T=U.getView(),W=D._canvas;Me.superClass.setUp.call(D),U.setEditInteractor(D),U._79O?T.insertBefore(W,U._79O):T.appendChild(W),Bd.startEdit(U),D.invokeSubModule("setUp"),U.dm().mm(D._onDataModelChanged,D),U.dm().md(D._onDataPropertyChanged,D)},Me.prototype.tearDown=function(){Bd.log("tearDown");var x=this,j=x.gv,B=j.getView();x._resetCustomCursorStyle(),Me.superClass.tearDown.call(x),j.dm().umm(x._onDataModelChanged,x),j.dm().umd(x._onDataPropertyChanged,x),j.setEditInteractor(null),B.removeChild(x._canvas),x._drawTimer&&(U(x._drawTimer),x._drawTimer=null),Bd._46O(j),x.invokeSubModule("tearDown")},Me.prototype._onDataModelChanged=function(i){var G=this;("clear"===i.kind||"remove"===i.kind&&G.editDetail&&i.data===G.getSubModule("Curve").target)&&(G.editDetail=!1,G._42())},Me.prototype._onDataPropertyChanged=function(G){var c=this;if(c.editDetail){var h=c.getSubModule("Curve"),s=G.data;s===h.target&&(s._writing||h._handleDataChanged(G))}},Me.prototype.clear=function(){Bd.log("clear")},Me.prototype.redraw=function(){this._42()},Me.prototype._42=function(){var C=this;C._drawTimer||(C._drawTimer=q(function(){C._drawTimer=null,C.drawImpl()},0))},Me.prototype.drawImpl=function(){var g;for(g in{_42:!0})break;return function(){var o=this,R=o._canvas,d=o.gv,M=d.getWidth(),r=d.getHeight(),y=o._context,O=I.Default.getInternal();(R.width!==M||R.height!==r)&&O.setCanvas(R,M,r),y.clearRect(0,0,R.width,R.height);var v=o._getValidSelection();y.save();var V=I.Default.devicePixelRatio;y.scale(V,V),o._gridGuide._42(),o.invokeSubModuleInverse(g,!1,y,d,v),o._rectGuide._42(),y.restore()}}(),Me.prototype._getValidSelection=function(){var m=this,R=m.gv,f=R.sm().getSelection(),I=[];return f.each(function(x){R.isVisible(x)&&R.isEditable(x)&&I.push(x)}),I},Me.prototype.handle_touchmove=function(L){return this.handle_mousemove(L)},Me.prototype.handle_mousemove=function(e){if(!I.Default.isDragging()){var S=this;(S.editDetail||!Ln())&&(S.gvEditing=!1,S._checkEdit(e)&&(S.gvEditing=!0))}},Me.prototype.handle_touchstart=function(F){return this.handle_mousedown(F)},Me.prototype.handle_mousedown=function(l){bn(l);var q=this;if(q.editDetail||!Ln()){if(ui(l)&&!l.clickThrough){if(q.editDetail){if(q._tryQuitEditDetailMode(l))return}else if(q._tryEnterEditDetailMode())return;q.gv.dm().beginTransaction();var M=q.invokeSubModule("handleDoubleClick",!0,l);if(q.gv.dm().endTransaction(),M)return}var x=q._checkEdit(l);x&&(q._downPosition=q._getLogicalPoint(l),q.gv.dm().beginTransaction(),x.startEdit(q,l),q.editing=!0)}},Me.prototype._checkEdit=function(Z){var P=this,u=P.gv,E=P._getLogicalPoint(Z),w=P.invokeSubModule("check",!0,u,Z,E)||null;return P._editMod=w,w},Me.prototype.handleWindowTouchMove=function(m){return this.handleWindowMouseMove(m)},Me.prototype.handleWindowMouseMove=function(t){var X=this,C=X._downPosition;if(C){var h=X._getLogicalPoint(t);if(h.distanceTo(C)<X.getStyle("moveSensitivity"))return;delete X._downPosition}var F=X._editMod;F&&F.handleEdit(X.gv,t)},Me.prototype._getLogicalPoint=function(j){var J=this,l=I.Default.getLogicalPoint(j,J._canvas);return new Bd.Math.Vector2(l)},Me.prototype.handleWindowTouchEnd=function(Q){return this.handleWindowMouseUp(Q)},Me.prototype.handleWindowMouseUp=function(){var i;for(i in{_46O:!0})break;return function(B){var L=this;L.editing=!1,L.setCursor("default"),L.invokeSubModule(i,!1,B),L._42(),L.gv.dm().endTransaction()}}(),Me.prototype.handle_mousewheel=function(C){var M=this;bn(C),M.invokeSubModule("preHandleScroll",!0)||M.gv.handleScroll(C,C.wheelDelta)},Me.prototype.handleDelete=function(){var K=this;if(!K.editDetail){K.gv.dm().beginTransaction();var i=K.invokeSubModule("handleNormalStateDelete",!0);return K.gv.dm().endTransaction(),i||K.gv.removeSelection(),void 0}K.gv.dm().beginTransaction(),K.invokeSubModule("handleDelete",!0),K.gv.dm().endTransaction(),K._42()},Me.prototype.handle_keydown=function(n){var c=this;if((n.metaKey||n.ctrlKey)&&c._42(),Ln(n)&&!c.editing)return c.gvEditing=!1,c.setCursor("default"),c._42(),void 0;var Q=$k(n);return c.editDetail?((Q||vq(n))&&(c.editDetail=!1,c._42()),c.gv.dm().beginTransaction(),c.invokeSubModule("handle_keydown",!0,n),c.gv.dm().endTransaction(),void 0):(c.gv.dm().beginTransaction(),c.invokeSubModule("handleNormalStateKeyDown",!0,n),c.gv.dm().endTransaction(),Q&&c._tryEnterEditDetailMode(),void 0)},Me.prototype.handle_keyup=function(F){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,F),this.gv.dm().endTransaction()},Me.prototype._tryEnterEditDetailMode=function(){var y=this;return!y.editDetail&&y.invokeSubModule("canEnterEditDetailMode",!0)&&1===y._getValidSelection().length?(y.editDetail=!0,y._42(),!0):void 0},Me.prototype._tryQuitEditDetailMode=function(I){var i=this;return i.editDetail?!I||i.invokeSubModule("canQuitEditDetailMode",!0,I)?(i.editDetail=!1,i._42(),!0):!1:!1},Me.prototype.setStyle=function(U,A,P){var Y=this;P?Bd.setStyle(U,A):Y._styleMap[U]=A,Y.fp("styleChanged",null,{key:U,value:A,base:P}),Y._42()},Me.prototype.getStyle=function(h){var e=this,O=e._styleMap[h];return O!==r?O:Bd.getStyle(h)},Me.prototype.setCursor=function(G){this._resetCustomCursorStyle(),I.graph.EditInteractor.superClass.setCursor.call(this,G)},Me.prototype._resetCustomCursorStyle=function(){var y=this;if(y._customStyle){var D=this.gv.getView();D.classList&&D.classList.remove&&D.classList.remove(y._customStyle),y._customStyle=null}},Me.prototype._setRotateCursor=function(Z){var c=this,v=c._cursorFactory;v||(v=c._cursorFactory=new Bd.CursorFactory(c));var T=v.getRotateCursor(Z),D=c.gv.getView();c._resetCustomCursorStyle(),c._customStyle=T,D.classList&&D.classList.add&&D.classList.add(T)};var gh=Bd.Group=function(B){var S=this;S._entities=B,S._64O=0,S._position={x:0,y:0},S._scale={x:1,y:1},S._anchor={x:.5,y:.5},S._anchor2={x:.5,y:.5}};gh.prototype={},gh.prototype.constructor=gh;var Fk=null;gh.findOrCreateGroup=function(N){if(Fk&&Fk.checkIsMe(N))return Fk;var p=new Bd.Group(N);return p.getKeyOb()?(Fk=p,p):void 0},gh.prototype.checkIsMe=function(K){var d=this._entities;if(d.length!==K.length)return!1;var v,z={},U=K.length;for(v=0;U>v;v++)z[K[v]._id]=!0;for(v=0;U>v;v++)if(!z[d[v]._id])return!1;return!0},gh.prototype.getRotation=function(){return this._64O},gh.prototype.getPosition=function(){return this._position},gh.prototype.getAnchor=function(){return this._anchor},gh.prototype.getWidth=function(){return this._width},gh.prototype.getScale=function(){return this._scale},gh.prototype.getSize=function(){return{width:this._width,height:this._height}},gh.prototype.getHeight=function(){return this._height},gh.prototype.getKeyOb=function(){for(var Z=this._entities,H=Z.length-1;H>=0;H--){var w=Z[H];if(this.isNode(w))return w}},gh.prototype.getAnchor2=function(){var K=this,f=K.rotateCenter;if(f)return f;var v=K.getKeyOb();if(!v)return K._anchor;var z=K._anchor2,u=v.getMatrix();return u.tf({x:v.getWidth()*(z.x-v.getAnchor().x),y:v.getHeight()*(z.y-v.getAnchor().y)})},gh.prototype.setAnchor2=function(k,T){var R=this,i=R.getKeyOb();if(i){var f,C=i.getMatrix();f="number"==typeof k?{x:k,y:T}:k;var h=C.tfi(f);R._anchor2={x:i.getAnchor().x+h.x/i.getWidth(),y:i.getAnchor().y+h.y/i.getHeight()}}},gh.prototype.setRotation=function(){},gh.prototype.beginRotate=function(s){this.rotateCenter=s.pos,this.rotateMode=s.groupRotateMode},gh.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},gh.prototype.addRotation=function(V,e){return"batch"===e?this._addRotationInBatchMode(V):"block"===e?this._addRotationInBlockMode(V):void 0},gh.prototype._addRotationInBlockMode=function(A){var l=this,z=l.rotateCenter||l.getPosition();l._entities.forEach(function(N){if(l.isNode(N)){var c=N.getMatrix();c.translate(-z.x,-z.y),c.rotate(A),c.translate(z.x,z.y);var $=Math.sign(N.getScale().x);N.setRotation(Z(c.b*$,c.a*$)),N.setPosition(c.tx,c.ty)}})},gh.prototype._addRotationInBatchMode=function(M){var Y=this,b=Y._anchor2;Y._entities.forEach(function(X){if(Y.isNode(X)){var K=X.getAnchor(),c=X.getMatrix(),f=c.tf({x:X.getWidth()*(b.x-K.x),y:X.getHeight()*(b.y-K.y)}),N=new Bd.Math.Matrix2d;N.set(c.a,c.b,c.c,c.d,c.tx,c.ty),N.translate(-f.x,-f.y),N.rotate(M),N.translate(f.x,f.y);var m=Math.sign(X.getScale().x);X.setRotation(Z(N.b*m,N.a*m)),X.setPosition(N.tx,N.ty)}})},gh.prototype.setPosition=function(D){var c,z,S,J,l=this,P=l._position,G=D.x-P.x,Q=D.y-P.y,W=l._entities;for(z=0,S=W.length;S>z;z++)c=W[z],lb(c)&&(J=c.getPosition(),c.setPosition(J.x+G,J.y+Q));l._position=D},gh.prototype.setScale=function(S,P){var p=this,a=S/p._scale.x,M=P/p._scale.y;p._adjustChildScaleOrSize(a,M,"size"),p._scale={x:S,y:P}},gh.prototype.getRect=function(){var V=this,Z=V._position,o=V._width,O=V._height;return{x:Z.x-o/2,y:Z.y-O/2,width:o,height:O}},gh.prototype.setSize=function(c,e){var D=this,c=Math.max(1,c),e=Math.max(1,e),h=c/D._width,t=e/D._height;D._adjustChildScaleOrSize(h,t,"size"),D._width=c,D._height=e},gh.prototype._adjustChildScaleOrSize=function(s,V,S){var G,c,w,M,g,t,k,O,p,K,J,b,R,f,N=this,W=N._position,o=N._entities,Y=new Bd.Math.Matrix2d;for(c=0,w=o.length;w>c;c++)if(G=o[c],N.isNode(G)){if(M=G.getPosition(),g=G.getRotation(),t=G.getWidth(),k=G.getHeight(),O=G.getScale(),J=O.x*t,b=O.y*k,Y.identity().scale(J,b).rotate(g).translate(M.x,M.y).translate(-W.x,-W.y).rotate(-N._64O),g=Z(Y.b*Math.sign(J),Y.a*Math.sign(J)),Y.scale(s,V),p=Math.cos(g),K=Math.sin(g),Math.abs(p)<.001?(R=Y.b/K,f=-Y.c/K):(R=Y.a/p,f=Y.d/p),"scale"===S)G.setScale(R/t,f/k);else if("size"===S){var F=R/O.x,y=f/O.y;G.setScale(gr(R)*Math.abs(O.x),gr(f)*Math.abs(O.y)),G.setSize(Math.max(.1,Math.abs(F)),Math.max(.1,Math.abs(y)))}Y.rotate(N._64O).translate(W.x,W.y),G.setPosition(Y.tx,Y.ty)}},gh.prototype.getMatrix=function(){var _=this,f=_._position,q=I.Default.getInternal(),U=_._scale;return new q.Mat(_._64O,f.x,f.y,U.x,U.y)},gh.prototype.toGlobal=function(L){return this.getMatrix().tf(L)},gh.prototype.getCorners=function(){var N=this,D=N._width,p=N._height,W=N._anchor,i=-D*W.x,t=-p*W.y,B=N.getMatrix();return[B.tf(i,t),B.tf(i,t+p),B.tf(i+D,t+p),B.tf(i+D,t)]},gh.prototype.calcInfo=function(){var E,V,Q,l,N,I,M=this,U=[],P=M._entities,r=M._64O;for(l=0,N=P.length;N>l;l++)I=P[l],M.isNode(I)&&I.getCorners&&U.push.apply(U,I.getCorners());if(U.length){var A=Math.cos(-r),f=Math.sin(-r),Z=1/0,T=-1/0,k=1/0,X=-1/0;for(l=0,N=U.length;N>l;l++)Q=U[l],E=Q.x,V=Q.y,Q.x=A*E-f*V,Q.y=f*E+A*V,Z=Math.min(Z,Q.x),T=Math.max(T,Q.x),k=Math.min(k,Q.y),X=Math.max(X,Q.y);M._width=(T-Z)/M._scale.x,M._height=(X-k)/M._scale.y,A=Math.cos(r),f=Math.sin(r);var S=M._anchor;E=Z+(T-Z)*S.x,V=k+(X-k)*S.y,M._position={x:A*E-f*V,y:f*E+A*V}}},gh.prototype.isNode=function(y){return lb(y)?Rm(y)?!1:!0:!1},gh.prototype._42=function(r,m,Z){var c,k,b,n,_,R,V,s,e=this,I=e._entities,Y=e.rotateMode;for("batch"===Y&&(s=e.getKeyOb()),c=0,k=I.length;k>c;c++)b=I[c],e.isNode(b)&&(R=b.getRect(),n=Bd.toScreenPosition(Z,{x:R.x,y:R.y}),_=Bd.toScreenPosition(Z,{x:R.x+R.width,y:R.y+R.height}),V={min:n,max:_},b===s&&(V.isKeyOb=!0),Bd.Icons.DrawIcon(r,m,Bd.Icons.GroupSubEntityRect,V))};var ck=Bd.CurveActiving=function(z,j){this._curve=z,this._interactor=z._interactor;for(var n in j)this[n]=j[n]};ck.prototype={},ck.prototype.constructor=ck,H.defineProperties(ck.prototype,{point:{get:function(){return this._point},set:function(k){var I=this;I._point=k,I.editingCtrl||I._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(J){var V=this;V._pairs=J,V.editingCtrl&&V._firePointChange()}}}),ck.prototype._firePointChange=function(){var V=this,H=V.getCurrentEditingPoint();if(!H)return D.fi({kind:"selectPoint"}),void 0;var D=V._interactor,a=this._curve.target;if(a){var M=Bd.getDataMatrix(a).invert(),C=H.e;H=M.apply(Bd.toWorldPosition(D.gv,H)),H.e=C;var A=V._lastFirePoint;A&&Math.abs(H.x-A.x)<1e-5&&Math.abs(H.y-A.y)<1e-5&&(H.e==r&&A.e==r||Math.abs(H.e-A.e)<1e-5)||(V._lastFirePoint=H,D.fi({kind:"selectPoint",x:H.x,y:H.y,e:H.e}))}},ck.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ck.prototype.getCurrentEditingPoint=function(){var C=this,v=C.editingCtrl;if(v){var U=C.pairs;if(U){var A=U[v.pairId],$=A[v.type];if($)return $}}return C._point};var so=Bd.CursorFactory=function(p){var d=this;d._interactor=p,d._rotateCursorStyles={}};so.prototype={},so.prototype.constructor=so,so.prototype.getRotateCursor=function(A){var _=this;0>A&&(A+=2*Math.PI);var R=_._interactor,N=R.getStyle("rotateCursorSize"),I=R.getStyle("rotateCursorRound"),m=Math.round(180*(A/Math.PI)/I);m*I>=360&&(m=0);var h=_._rotateCursorStyles,e="htCustomRotateStyle_"+N+"_"+I+"_"+m;return h[e]||(_._produceRotateCursor(e,N,I,m),h[e]=!0),e},so.prototype._produceRotateCursor=function(U,$,P,z){var v=this;v._interactor;var x=v._canvas;x||(x=v._canvas=k.createElement("canvas")),x.width=x.height=$*devicePixelRatio,x.style.width=x.style.height=$+" px";var E=x.getContext("2d");Bd.setAntialias(E,!1),E.scale(devicePixelRatio,devicePixelRatio);var V,p,i,J,K,y=Math.round($/2),m=""+y+" "+y+",auto !important;";V=Math.PI/180*z*P,E.clearRect(0,0,$,$),E.save(),E.scale($/32,$/32),E.translate(16,16),E.rotate(V+Math.PI/2),E.beginPath(),E.moveTo(-8,0),E.lineTo(-8,3),E.lineTo(-5,3),E.moveTo(8,0),E.lineTo(8,3),E.lineTo(5,3),E.moveTo(-8,3),E.quadraticCurveTo(0,-6,8,3),E.restore(),E.strokeStyle="white",E.lineWidth=4,E.stroke(),E.strokeStyle="black",E.lineWidth=2,E.stroke(),p=JSON.stringify(x.toDataURL()),J="cursor:url("+p+")"+m,1!==devicePixelRatio&&(i='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+$+'px" height="'+$+'px"><image xlink:href='+p+' width="'+$+'" height="'+$+'"/></svg>',J+="cursor:url(data:image/svg+xml;base64,"+btoa(i)+")"+m,J+="cursor:-webkit-image-set(url("+p+")"+devicePixelRatio+"x,url("+p+")1x)"+m),K=k.createElement("style"),K.textContent="body."+U+" *, ."+U+"{"+J+"}",k.head.appendChild(K)};var cg=Bd.Guide.Grid=function(y){var X=this;X._interactor=y,X._alignmentGuideId=0,X._xAlignmentGuide=[],X._yAlignmentGuide=[]};cg.prototype={},cg.prototype.constructor=cg,H.defineProperties(cg.prototype,{gridBlockSize:{get:function(){var L=this;return L._gridBlockSize||L._interactor.getStyle("gridBlockSize")},set:function(p){this._gridBlockSize=p,this._interactor._42()}},gridThickLinesEvery:{get:function(){var N=this;return N._gridThickLinesEvery||N._interactor.getStyle("gridThickLinesEvery")},set:function(p){this._gridThickLinesEvery=p,this._interactor._42()}},gridEnabled:{get:function(){var O=this,l=O._interactor;return l.gridEnabled&&O.isValidGrid()}}}),cg.prototype._42=function(){var M=this,U=M._interactor;M.gridEnabled&&M.drawGrid(),U.alignmentGuideEnabled&&M.drawAlignmentGuide()},cg.prototype.makeMatrix=function(){var D=this,r=D._interactor.getStyle("gridAngle"),L=D._interactor.getStyle("gridRotation"),o=new Bd.Math.Matrix2d,s=Math.sin(r),V=Math.cos(r);return o.set(1,0,V,s,0,0),o.rotate(L),o},cg.prototype.isValidGrid=function(){var h=this,e=Math.PI,Z=h._interactor,F=Z.gv;if(F._zoom<Z.getStyle("gridZoomThreshold"))return!1;var Y=Z.getStyle("gridAngle"),P=Math.abs(180*(Y%e/e)),L=1-1e-8;return L>P||P>180-L?!1:!0},cg.prototype.drawAlignmentGuide=function(){var J=this,o=J._interactor,Q=o.gv,A=o._canvas,X=o._context,t=A.width,z=A.height,b=Q.tx(),x=Q.ty(),j=Q._zoom;X.beginPath(),X.strokeStyle=o.getStyle("gridAlignmentGuideColor"),X.lineWidth=1,J._xAlignmentGuide.forEach(function(o){var P=o.p*j+b;X.moveTo(P,0),X.lineTo(P,z)}),J._yAlignmentGuide.forEach(function(V){var y=V.p*j+x;X.moveTo(0,y),X.lineTo(t,y)}),X.stroke()},cg.prototype.drawGrid=function(){function y(o,F,P,d){var M=Bd.toScreenPosition(h,f.apply({x:o,y:F})),J=Bd.toScreenPosition(h,f.apply({x:P,y:d}));l.moveTo(M.x,M.y),l.lineTo(J.x,J.y)}var b=this,H=b._interactor,N=b.gridBlockSize,g=b.gridThickLinesEvery,n=H.getStyle("gridThickColor"),B=H.getStyle("gridLightColor"),h=H.gv,Z=H._canvas,l=H._context,w=Z.width,r=Z.height,f=b.makeMatrix(),$=f.applyInverse(Bd.toWorldPosition(h,{x:0,y:0})),u=f.applyInverse(Bd.toWorldPosition(h,{x:w,y:0})),X=f.applyInverse(Bd.toWorldPosition(h,{x:0,y:r})),k=f.applyInverse(Bd.toWorldPosition(h,{x:w,y:r})),v=Math.min($.x,u.x,X.x,k.x),d=Math.max($.x,u.x,X.x,k.x),D=Math.min($.y,u.y,X.y,k.y),K=Math.max($.y,u.y,X.y,k.y);w=d-v,r=K-D;var e=Math.ceil(v/N),j=Math.floor(d/N),G=Math.ceil(D/N),c=Math.floor(K/N);
    h.tx(),h.ty(),h._zoom;var W,E,i;for(l.save(),l.lineWidth=1,l.beginPath(),l.strokeStyle=n,i=Math.ceil(e/g)*g;j>=i;i+=g)W=i*N,y(W,D,W,K);for(i=Math.ceil(G/g)*g;c>=i;i+=g)E=i*N,y(v,E,d,E);for(l.stroke(),l.beginPath(),l.strokeStyle=B,i=e;j>=i;i++)0!==i%g&&(W=i*N,y(W,D,W,K));for(i=G;c>=i;i++)0!==i%g&&(E=i*N,y(v,E,d,E));l.stroke(),l.restore()},cg.prototype.getAlignmentGuides=function(){var f=this;return{x:f._xAlignmentGuide,y:f._yAlignmentGuide}},cg.prototype.addAlignmentGuide=function(L,b,i){var R=this,y="x"===L?R._xAlignmentGuide:R._yAlignmentGuide,i=i?i:++R._alignmentGuideId,M={p:b,id:i};if(y.length){var Y=R._findClosestAlignmentGuide(M.p,y);Y.dis<0?y.splice(Y.index+1,0,M):y.splice(Y.index,0,M)}else y.push(M);return R._interactor._42(),i},cg.prototype.findClosest=function(A,t,j){var S=this,U=S._interactor,r=U.gv;j&&(A=Bd.toWorldPosition(r,A));var b,L,J,x=1/0,g=1/0,f=A.x,Q=A.y;if(S.gridEnabled){var $=S.gridBlockSize,D=S.makeMatrix(),Y=D.applyInverse(A);Y=D.apply({x:Math.round(Y.x/$)*$,y:Math.round(Y.y/$)*$}),x=Y.x-f,g=Y.y-Q,J=!0}if(U.alignmentGuideEnabled&&(b=S._findClosestAlignmentGuide(f,S._xAlignmentGuide).dis,L=S._findClosestAlignmentGuide(Q,S._yAlignmentGuide).dis,Math.abs(b)<Math.abs(x)&&(x=b,J=!0),Math.abs(L)<Math.abs(g)&&(g=L,J=!0)),J){J=!1;var s=r._zoom,p=U.getStyle("smartGuideSensitivity")/s,I={};if(Math.abs(x)<p&&"y"!==t&&(I.x=j?x*s:x,J=!0),Math.abs(g)<p&&"x"!==t&&(I.y=j?g*s:g,J=!0),J)return I}},cg.prototype._findClosestAlignmentGuide=function(J,G){if(!G.length)return{dis:1/0};for(var k,P=0,r=G.length-1;r-P>1;)k=Math.floor((P+r)/2),G[k].p<J?P=k:r=k;var U=G[P].p-J,K=G[r].p-J;return Math.abs(U)<=Math.abs(K)?{line:G[P],dis:U,index:P}:{line:G[r],dis:K,index:r}},cg.prototype.removeAllAlignmentGuide=function(W){var $=this;"y"!==W&&($._xAlignmentGuide=[]),"x"!==W&&($._yAlignmentGuide=[]),$._interactor._42()},cg.prototype.removeAlignmentGuide=function(Q){for(var E,x,p,s=this,P=s._xAlignmentGuide,U=0;2>U;U++)for(P=0===U?s._xAlignmentGuide:s._yAlignmentGuide,E=0,x=P.length;x>E;E++)if(p=P[E],p.id===Q)return P.splice(E,1),s._interactor._42(),{axis:0===U?"x":"y",position:p.p};return!1},cg.prototype.adjustAlignmentGuide=function(d,C){var L=this,y=L.removeAlignmentGuide(d);return y?(L.addAlignmentGuide(y.axis,C,d),!0):!1};var Ve=Bd.Guide.Rect=function(l){var Z=this;Z._interactor=l};Ve.prototype={},Ve.prototype.constructor=Ve,Ve.prototype.gatherRects=function(){var L,N,r,u,V=this,v=V._interactor.gv,q=[],K=[],Q={x:q,y:K},T={},C=v.getDataModel(),X=C.a("width"),I=C.a("height");X&&I&&(L=0,N=0,r=X,u=I,q.push({node:C,type:0,p:L},{node:C,type:1,p:L+r/2},{node:C,type:2,p:L+r}),K.push({node:C,type:0,p:N},{node:C,type:1,p:N+u/2},{node:C,type:2,p:N+u}),T[C._id||0]={x:L,y:N,width:r,height:u}),C.each(function(d){if(lb(d)&&!v.isSelected(d)&&v.isVisible(d)){var _=!1;if(v.sm().getSelection().each(function(u){_||(d.isHostOn(u)?_=!0:d.isDescendantOf(u)&&(_=!0))}),!_){var X=d.getRect();L=X.x,N=X.y,r=X.width,u=X.height,q.push({node:d,type:0,p:L},{node:d,type:1,p:L+r/2},{node:d,type:2,p:L+r}),K.push({node:d,type:0,p:N},{node:d,type:1,p:N+u/2},{node:d,type:2,p:N+u}),T[d._id]=X}}}),q.sort(function(T,m){return T.p-m.p}),K.sort(function(x,S){return x.p-S.p}),V._grid=Q,V._87I=T},Ve.prototype.gatherLines=function(f,c,E){var T,G,y,N,u,h,C,m,r,$,U,n,L=this,D=[L.findClosest({x:f.x,y:f.y},c),L.findClosest({x:f.x+f.w/2,y:f.y+f.h/2},c),L.findClosest({x:f.x+f.w,y:f.y+f.h},c)],i={},S=L._87I;E=E||255;var q,w;for(L._guideLine=[],T=0;2>T;T++)for(i={},0===T?(N="y",m=f.x,r=m+f.w):(N="x",m=f.y,r=m+f.h),G=0;3>G;G++)u=D[G],u&&isFinite(u[N])&&(q=1<<3*T+G,E&q&&(h=u[N+"Line"],C=h.node,w=C._id||0,i[w]||(i[w]=!0,n=S[w],"y"===N?($=n.x,U=n.x+n.width):($=n.y,U=n.y+n.height),y=h.p,L._guideLine.push({type:N,a:m,b:r,c:$,d:U,p:y,center:1===h.type}))))},Ve.prototype._binarySearchClosest=function(P,Q){if(!Q.length)return{dis:1/0};for(var f,I=0,R=Q.length-1;R-I>1;)f=Math.floor((I+R)/2),Q[f].p<P?I=f:R=f;var $=Q[I].p-P,y=Q[R].p-P;return Math.abs($)<=Math.abs(y)?{line:Q[I],dis:$}:{line:Q[R],dis:y}},Ve.prototype.findClosest=function(z,T,O){var t=this,X=t._interactor,s=X.gv,x=t._grid;O&&(z=Bd.toWorldPosition(s,z));var v,i=t._binarySearchClosest(z.x,x.x),y=t._binarySearchClosest(z.y,x.y),d=i.dis,Q=y.dis,o=s._zoom,V=X.getStyle("smartGuideSensitivity")/o,j={};return Math.abs(d)<V&&"y"!==T&&(j.x=O?d*o:d,j.xLine=i.line,v=!0),Math.abs(Q)<V&&"x"!==T&&(j.y=O?Q*o:Q,j.yLine=y.line,v=!0),v?j:void 0},Ve.prototype._42=function(){var X=this,O=X._guideLine;if(O&&!I.Default.isCtrlDown()){var S,i,D,Y,d,e,J,E,$,s,f,B,V,F,r,R,H,h=X._interactor,m=h.gv,W=h._context,j=m.tx(),u=m.ty(),L=m._zoom,K=h.getStyle("guideLineTextSpacing");for(S=0,i=O.length;i>S;S++)D=O[S],E=D.type,$=D.p,s=D.a,f=D.b,B=D.c,V=D.d,F=Math.min(s,B),r=Math.max(f,V),"x"===E?(Y=$*L+j,d=F*L+u,e=Y,J=r*L+u):(Y=F*L+j,d=$*L+u,e=r*L+j,J=d),Bd.Icons.DrawIcon(h,W,Bd.Icons.MoveLineGuide,{rect:[Y,d,e,J],center:D.center}),V>=s&&f>=B||(F=s>V?V:f,r=s>V?s:B,H=r-F,"x"===E?(D.center2center||(Y-=K,e=Y),d=F*L+u,J=r*L+u,R=Bd.Icons.MoveLineGuideDistanceV):"y"===E&&(D.center2center||(d-=K,J=d),Y=F*L+j,e=r*L+j,R=Bd.Icons.MoveLineGuideDistanceH),Bd.Icons.DrawIcon(h,W,R,{x0:Y,y0:d,x1:e,y1:J,dis:H}))}},Ve.prototype.clear=function(){this._guideLine=null},Bd.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var bh=Bd.Icons={},fn=1e4,Gf=null,wj="rgb(51,153,255)",Qc="rgb(183,232,135)",ae="rgb(255,204,153)",Jp=6;I.Default.setImage("Icons.RectPoint",{width:Jp,height:Jp,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:wj,rect:[0,0,Jp,Jp]}]});var fi="#e000e0";bh.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var l=bh.GroupSubEntityRect.data;if(!l)return[];var k=l.min,_=l.max;return[k.x,k.y,k.x,_.y,_.x,_.y,_.x,k.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return bh.GroupSubEntityRect.data.isKeyOb?fi:"#666666"}}}]},bh.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[bh.Line.data.P1.x,bh.Line.data.P1.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[bh.Line.data.P2.x,bh.Line.data.P2.y],Jp,Jp]}}}]},bh.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return bh.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},bh.Rect={comps:[{type:"shape",points:{func:function(){var h=bh.Rect.data;if(!h)return[];var e=h.LT,L=h.LB,Q=h.RB,n=h.RT;return[e.x,e.y,L.x,L.y,Q.x,Q.y,n.x,n.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:wj},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.LT.x,bh.Rect.data.LT.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.LB.x,bh.Rect.data.LB.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.RB.x,bh.Rect.data.RB.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.RT.x,bh.Rect.data.RT.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.L?!0:!1}},rect:{func:function(){return[[bh.Rect.data.L.x,bh.Rect.data.L.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.R?!0:!1}},rect:{func:function(){return[[bh.Rect.data.R.x,bh.Rect.data.R.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.T?!0:!1}},rect:{func:function(){return[[bh.Rect.data.T.x,bh.Rect.data.T.y],Jp,Jp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.B?!0:!1}},rect:{func:function(){return[[bh.Rect.data.B.x,bh.Rect.data.B.y],Jp,Jp]}}}]};var Ic=16;I.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:wj,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:wj,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),bh.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[bh.Anchor.data.POS.x,bh.Anchor.data.POS.y],Ic,Ic]}}}]},bh.TipShiftX=12,bh.TipShiftY=12;var Rc=[8,28];bh.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[bh.TipHelper.data.helperPos.x,bh.TipHelper.data.helperPos.y,Rc[0]*bh.TipHelper.data.size,Rc[1]]}},background:{func:function(){return Gf.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return bh.TipHelper.data.text}},rect:{func:function(){return[bh.TipHelper.data.helperPos.x,bh.TipHelper.data.helperPos.y,Rc[0]*bh.TipHelper.data.size,Rc[1]]}},color:{func:function(){return Gf.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Un=7;bh.ShapePoint={comps:[{type:"circle",rect:{func:function(){var x=bh.ShapePoint.data.point;return[x,Un,Un]}},background:{func:function(){var r=bh.ShapePoint.data.isEnd;return r?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:wj}]},bh.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return bh.ShapeBgCurve.data.P}},segments:{func:function(){return bh.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:wj}]};var Eq=8;bh.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var u=bh.ShapeHighlighPoint.data;return[[u.x,u.y],Eq,Eq]}},background:{func:function(){return Gf.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Ti=10;bh.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var R=bh.ShapeHighlighRealPoint.data;return[[R.x,R.y],Ti,Ti]}},background:"#ffffff",borderWidth:2,borderColor:wj}]};var ng=8;bh.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var I=bh.ShapeHighlighCtrlPoint.data,k=I.x,e=I.y,a=ng/2;return[k-a,e-a,k-a,e+a,k+a,e+a,k+a,e-a]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Gf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Gf.getStyle("shapeCtrlPointBorderColor")||wj}}}]};var el=3;bh.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return bh.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:el,borderColor:{func:function(){return Gf.getStyle("curveHighlightColor")}}}]},bh.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return bh.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},bh.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return bh.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return bh.MoveLineGuide.data.center?Qc:ae}}}]};var ep=5;bh.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var v=bh.MoveLineGuideDistanceH.data,$=v.x0,U=v.y0;return[$,U-ep,$,U+ep]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ae},{type:"shape",points:{func:function(){var T=bh.MoveLineGuideDistanceH.data,e=T.x1,N=T.y1;return[e,N-ep,e,N+ep]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ae},{type:"text",text:{func:function(){return Math.round(bh.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var S=bh.MoveLineGuideDistanceH.data;return[[(S.x0+S.x1)/2,S.y0-10],20,20]}},color:ae,font:"12px Arial",align:"center"}]},bh.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var S=bh.MoveLineGuideDistanceV.data,O=S.x0,q=S.y0;return[O-ep,q,O+ep,q]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ae},{type:"shape",points:{func:function(){var j=bh.MoveLineGuideDistanceV.data,i=j.x1,c=j.y1;return[i-ep,c,i+ep,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ae},{type:"text",text:{func:function(){return Math.round(bh.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var z=bh.MoveLineGuideDistanceV.data;return[[z.x0-10,(z.y0+z.y1)/2],20,20]}},color:ae,font:"12px Arial",align:"center"}]},I.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),bh.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var b=bh.EdgeElevationGuide.data,A=b.x,m=b.y,L=Gf.getStyle("curveElevationIntersectSize"),s=Gf.getStyle("curveElevationGuideShift");return A+=s[0],m+=s[1],[A-L,m-L,2*L,2*L]}}}]},I.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),I.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),bh.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return bh.ConnectGuide.data.rotation}},rect:{func:function(){var K=bh.ConnectGuide.data.connect;K.x,K.y;var G=Gf.getStyle("connectGuideIntersectSize");return[[K.x,K.y],2*G,2*G]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var f=bh.ConnectGuide.data.cursorPos||bh.ConnectGuide.data.connect,H=Gf.getStyle("connectGuideIntersectSize");return[[f.x,f.y],2*H-2,2*H-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var s=bh.ConnectGuide.data.connect,y=bh.ConnectGuide.data.cursorPos||s;return[s.x,s.y,s.x+.5*(y.x-s.x),s.y,y.x+.5*(s.x-y.x),y.y,y.x,y.y]}}}]},I.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),I.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),bh.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var Y=bh.ConnectGuideGarbage.data.hover;return Y?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var e=bh.ConnectGuideGarbage.data,r=Gf.getStyle("connectGuideGarbageIntersectsize");return e.hover&&(r+=5),[[e.x,e.y],2*r,2*r]}}}]};var Kd=6;bh.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var H=bh.ShapeActivingCtrl.data;return[H.point.x,H.point.y,H.c1.x,H.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:wj},{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var _=bh.ShapeActivingCtrl.data;return[_.point.x,_.point.y,_.c2.x,_.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:wj},{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var t=bh.ShapeActivingCtrl.data.c1,O=t.x,s=t.y,i=Kd/2;return"c1"===bh.ShapeActivingCtrl.data.hl&&(i+=.5),[O-i,s-i,O-i,s+i,O+i,s+i,O+i,s-i]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Gf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===bh.ShapeActivingCtrl.data.hl?Gf.getStyle("shapeCtrlPointHighlightBorder")||wj:Gf.getStyle("shapeCtrlPointBorderColor")||wj}}},{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var i=bh.ShapeActivingCtrl.data.c2,h=i.x,n=i.y,M=Kd/2;return"c2"===bh.ShapeActivingCtrl.data.hl&&(M+=.5),[h-M,n-M,h-M,n+M,h+M,n+M,h+M,n-M]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Gf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===bh.ShapeActivingCtrl.data.hl?Gf.getStyle("shapeCtrlPointHighlightBorder")||wj:Gf.getStyle("shapeCtrlPointBorderColor")||wj}}}]},bh.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:wj,rect:{func:function(){return[[bh.RoundPoint.data.x,bh.RoundPoint.data.y],Jp,Jp]}}}]},bh.AttachPoint={comps:[{type:"rect",background:{func:function(){return bh.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:wj,rect:{func:function(){var L=bh.AttachPoint.data.isAttach?Jp+4:Jp;return[[bh.AttachPoint.data.x,bh.AttachPoint.data.y],L,L]}}}]},Bd.Icons.DrawIcon=function(W,b,d,v){d.width=d.height=fn,d.data=v,Gf=W,I.Default.drawImage(b,d,0,0,fn,fn)},Bd.Icons.MapPoints=function(K,$){for(var o=0,O=K.length;O>o;o++)K[o]/=$},Bd.roundTo=function(w,n,X){var l=Math.abs(w%n);return X>l||X>n-l?n*Math.round(w/n):w},Bd.toFixed=function(G){return Math.round(100*G)/100},Bd.getDataMatrix=function(P){if(P instanceof I.Shape){var H=new I.Math.Matrix2d,f=P.getPosition();return H.translate(-f.x,-f.y).scale(P.getScale().x,P.getScale().y).rotate(P.getRotation()).translate(f.x,f.y),H}return P.getMatrix?P.getMatrix():new I.Math.Matrix2d};var Wq=Bd.Math.Curve=function(){this._curves=[]};Wq.prototype={},Wq.prototype.constructor=Wq,Wq.prototype.createFromHtShape=function(D,Y,y){Y instanceof I.List&&(Y=Y.toArray());var z,M,X,h,L,V,f,R=this,$=null,u=null,K=0,U=Bd.Math.Vector2,t=Bd.Math.CubicBezier,T=function($){return new U(D[$],D[$+1],y?y[$/2]:r)};for(M=0,X=Y.length;X>M;M++){switch(h=Y[M],L=null,h){case 1:u=T(K),$=u,K+=2;break;case 2:z=T(K),K+=2,L=new t(u,u.clone(),z.clone(),z),u=z;break;case 3:V=T(K),z=T(K+2),K+=4,L=new t(u,V.clone().sub(u).multiplyScalar(2/3).add(u),V.clone().sub(z).multiplyScalar(2/3).add(z),z),u=z;break;case 4:V=T(K),f=T(K+2),z=T(K+4),K+=6,L=new t(u,V,f,z),u=z;break;case 5:if(!$)break;L=new t(u,u.clone(),$.clone(),$),u=null,$=null}L&&(L._index=R._curves.length,R._curves.push(L))}},Wq.prototype.checkPoint=function(V,H){var P,Z,J,b,c,g=this,s=g._curves;for(P=0,Z=s.length;Z>P;P++)if(b=s[P],c=b.intersectRect(V,H,H),c.length)return J=0,c.forEach(function(f){J+=f.t}),J/=c.length,V=b.getPointAt(J),V.t=J,{bezier:b,intersection:V}},Wq.prototype.insertKnot=function(w,X){var H=w.insertKnot(X),y=this,S=y._curves;S.splice(w._index,1,H[0],H[1])},Wq.prototype._isCloseEnough=function(f,W){return Math.abs(f.x-W.x)<1e-6&&Math.abs(f.y-W.y)<1e-6},Wq.prototype._isSamePoint=function(P,s){return P===s},Wq.prototype.moveRealPoint=function(K,T){var v=this,S=v._curves,G=T.clone().sub(K);S.forEach(function(J){var i=J._p1;J._p2,J._p3;var l=J._p4;v._isSamePoint(i,K)&&(J._p2.add(G),J._p1=T),v._isSamePoint(l,K)&&(J._p3.add(G),J._p4=T)})},Wq.prototype.moveCtrlDueToRealPointMovement=function(f,I){var W=this,d=W._curves,$=function(Z){Z.add(I),Z.e&&I.e&&(Z.e+=I.e)};d.forEach(function(p){var K=p._p1;p._p2,p._p3;var o=p._p4;W._isSamePoint(K,f)&&$(p._p2),W._isSamePoint(o,f)&&$(p._p3)})},Wq.prototype.moveCtrlPoint=function(q,n,U){var h=q[U];if(h){h.e!==r&&(n.e=h.e);var l=this,e=l._curves;n.clone().sub(h),e.forEach(function(D){var r;"c2"===U?r="_p2":"c1"===U&&(r="_p3"),l._isSamePoint(D[r],h)&&(D[r]=n)}),q[U]=n}},Wq.prototype.deleteRealPoint=function(g,U){var h,O,A,D,V,H,e,R=this,l=R._curves,M={},y=[],S=Bd.Math.CubicBezier;for(O=0,A=l.length;A>O;O++)h=l[O],D=h._p1,V=h._p2,H=h._p3,e=h._p4,(M[O]||!R._isSamePoint(D,g))&&(R._isSamePoint(e,g)?A>O+1&&R._isSamePoint(l[O+1]._p1,g)&&(U||y.push(new S(D,V,l[O+1]._p3,l[O+1]._p4))):y.push(h));R._curves=y},Wq.prototype.findPairs=function(z,H){var A,k,v,V,d,t,n,g,S=this,R=S._curves,M={},Z=[];for(k=0,v=R.length;v>k;k++)A=R[k],V=A._p1,d=A._p2,t=A._p3,n=A._p4,!M[k]&&S._isSamePoint(V,z)&&(H?Z.push({point:V,r2:n}):Z.push({point:V,c2:d})),S._isSamePoint(n,z)&&(g=H?{point:n,r1:V}:{point:n,c1:t},v>k+1&&S._isSamePoint(R[k+1]._p1,z)&&(H?g.r2=R[k+1]._p4:g.c2=R[k+1]._p2,M[k+1]=!0),Z.push(g));return Z},Wq.prototype.toHtShape=function(){var b=this,Q=b._curves,p=[],j=[],$={x:1/0,y:1/0};return Q.forEach(function(H){var D=H._p1,S=H._p2,y=H._p3,w=H._p4;return b._isCloseEnough(D,$)||(p.push(1),j.push(D.clone())),$=w,b._isCloseEnough(D,S)&&b._isCloseEnough(y,w)?(p.push(2),j.push(w.clone()),void 0):(p.push(4),j.push(S.clone(),y.clone(),w.clone()),void 0)}),{segments:p,points:j}};var Oe=Bd.Math.CubicBezier=function(z,c,k,Q){var W=this;W._id=Bd.Math.CubicBezier._globalId++,W._p1=z,W._p2=c,W._p3=k,W._p4=Q};Oe._globalId=1,Oe.prototype={},Oe.prototype.constructor=Oe,Oe.prototype.toString=function(){return this._id},Oe.prototype.intersectRect=function(L,Z,U){var g=Z/2,N=U/2,s=L.x,d=L.y,y=Bd.Math.Vector2,v=new y(-g+s,-N+d),A=new y(g+s,N+d),z=new y(A.x,v.y),j=new y(v.x,A.y),Y=this,t=Y.intersectLine(v,z),O=Y.intersectLine(z,A),$=Y.intersectLine(A,j),R=Y.intersectLine(j,v),e=t.concat(O).concat($).concat(R);return e},Oe.prototype.intersectLine=function(Q,A){var i,X,H,w,D,d,n,C,e,N,a,s,G,r=this,t=Q.clone().min(A),R=Q.clone().max(A);w=r._p1,D=r._p2,d=r._p3,n=r._p4,i=w.clone().multiplyScalar(-1),X=D.clone().multiplyScalar(3),H=d.clone().multiplyScalar(-3),a=i.add(X).add(H).add(n),i=w.clone().multiplyScalar(3),X=D.clone().multiplyScalar(-6),H=d.clone().multiplyScalar(3),N=i.add(X).add(H),i=w.clone().multiplyScalar(-3),X=D.clone().multiplyScalar(3),e=i.add(X),C=w.clone(),G=new Bd.Math.Vector2(Q.y-A.y,A.x-Q.x),s=Q.x*A.y-A.x*Q.y;for(var h=r.getRoots(G.dot(a),G.dot(N),G.dot(e),G.dot(C)+s),m=new Array,M=0,o=h.length;o>M;M++){var j=h[M];if(!(0>j||j>1)){var y=w.clone().lerp(D,j),$=D.clone().lerp(d,j),z=d.clone().lerp(n,j),U=y.lerp($,j),W=$.lerp(z,j),Z=U.lerp(W,j);Z.t=j,Q.x==A.x?t.y<=Z.y&&Z.y<=R.y&&m.push(Z):Q.y==A.y?t.x<=Z.x&&Z.x<=R.x&&m.push(Z):Z.x>=t.x&&Z.y>=t.y&&Z.x<=R.x&&Z.y<=R.y&&m.push(Z)}}return m},Oe.prototype.solveTForPoint=function(g){var D,d,F,p,k=this;D=k._p1.x-g.x,d=k._p2.x-g.x,F=k._p3.x-g.x,p=k._p4.x-g.x;for(var n=k.getRoots(p-3*F+3*d-D,3*F-6*d+3*D,3*d-3*D,D),P=r,K=1/0,E=0,V=n.length;V>E;E++){var m=n[E];if(!(0>m||m>1)){var R=k._p1.clone().lerp(k._p2,m),J=k._p2.clone().lerp(k._p3,m),q=k._p3.clone().lerp(k._p4,m),W=R.lerp(J,m),l=J.lerp(q,m),Z=W.lerp(l,m);Z.t=m;var f=Math.abs(Z.y-g.y);K>f&&(K=f,P=Z)}}return P},Oe.prototype.getPointAt=function(n){var I=this,P=I._p1,j=I._p2,O=I._p3,v=I._p4,b=P.clone().lerp(j,n),e=j.clone().lerp(O,n),u=O.clone().lerp(v,n),k=b.lerp(e,n),J=e.lerp(u,n);return k.lerp(J,n)},Oe.prototype.getRoots=function(k,s,A,a){var b,P,D,t,M,R=new Array;if(Math.abs(k)<1e-6){var b=s,P=A/b,D=a/b,t=P*P-4*D;if(t>0){var M=Math.sqrt(t);R.push(.5*(-P+M)),R.push(.5*(-P-M))}else 0==t&&R.push(.5*-P)}s/=k,A/=k,a/=k,b=(3*A-s*s)/3,P=(2*s*s*s-9*A*s+27*a)/27;var r=s/3,g=P*P/4+b*b*b/27,B=P/2;if(Math.abs(g)<=1e-6&&(g=0),g>0){var K,i,M=Math.sqrt(g);K=-B+M,i=K>=0?Math.pow(K,1/3):-Math.pow(-K,1/3),K=-B-M,K>=0?i+=Math.pow(K,1/3):i-=Math.pow(-K,1/3),R.push(i-r)}else if(0>g){var h=Math.sqrt(-b/3),v=Math.atan2(Math.sqrt(-g),-B)/3,G=Math.cos(v),X=Math.sin(v),F=Math.sqrt(3);R.push(2*h*G-r),R.push(-h*(G+F*X)-r),R.push(-h*(G-F*X)-r)}else{var K;K=B>=0?-Math.pow(B,1/3):Math.pow(-B,1/3),R.push(2*K-r),R.push(-K-r)}return R},Oe.prototype._70I=function(){var j=this;return j._p1.distanceToSquared(j._p2)<1e-10&&j._p3.distanceToSquared(j._p4)<1e-10},Oe.prototype.insertKnot=function(l){var q=this,W=q._p1,Y=q._p2,J=q._p3,V=q._p4,O=W.clone().lerp(Y,l),K=Y.clone().lerp(J,l),s=J.clone().lerp(V,l),Q=O.clone().lerp(K,l),Z=K.clone().lerp(s,l),M=Q.clone().lerp(Z,l);return q._70I()?(W.clone().lerp(V,l),[new Bd.Math.CubicBezier(W,W.clone(),M.clone(),M),new Bd.Math.CubicBezier(M,M.clone(),V.clone(),V)]):[new Bd.Math.CubicBezier(W,O,Q,M),new Bd.Math.CubicBezier(M,Z,s,V)]};var Ck=I.Default.getInternal().ui().EdgeUI,Qo={_47O:function(c){var X=this,z=Qo.getBackups()._47O;Bd.inEdit(X.gv)||z.call(X,c)}};Bd.Inject.registAsModule(Qo,Ck);var vr=I.Default.getInternal().ui().NodeUI,Cd={_47O:function(y){var H=this,i=Cd.getBackups()._47O;Bd.inEdit(H.gv)||i.call(H,y)},getSelectWidth:function(){var c=this,t=c.gv,l=c._data;if(t.isEditable(l)&&Bd.inEdit(t))return 0;var T=Cd.getBackup("getSelectWidth");return T.call(c)}};Bd.Inject.registAsModule(Cd,vr);var wc=I.graph.GraphView,Md={_editPointSize:function(){var t=I.Default.isTouchable,X=Bd.getStyle("pointSize");return X[t?0:1]}(),isPointEditable:function(H){var V=this;if(Bd.inEdit(V))return V._pointEditableFunc?V._pointEditableFunc(H):!0;var e=Md.getBackup("isPointEditable");e.call(V,H)},isEditable:function(h){var U,d=this,x=Md.getBackup("isEditable");if(U=h instanceof Bd.Group?!0:x.call(d,h),!Bd.inEdit(d))return U;if(!(h instanceof I.Edge))return U;if(!h.s("2d.editable"))return!1;var X=d.getEditableFunc();return X?X(h):!0},_42:function(a,z){var g=this,Q=Md.getBackups()._42;if(Q.call(g,a,z),Bd.inEdit(g)){var n=g.getEditInteractor();n.drawImpl()}}};Bd.Inject.registAsModule(Md,wc);var rr=I.Default.getInternal().ui().ShapeUI,cp={_47O:function(F){var K=this,Q=cp.getBackups()._47O;Bd.inEdit(K.gv)||Q.call(K,F)}};Bd.Inject.registAsModule(cp,rr);var Xn=I.graph.DefaultInteractor,dd={handle_mousewheel:function(z){var u=this,k=dd.getBackup("handle_mousewheel");Bd.inEdit(u.gv)||k.call(u,z)}};Bd.Inject.registAsModule(dd,Xn);var jh=I.graph.MoveInteractor,Aj={_calcShift:function(s,M){var N=this,F=Aj.getBackup("_calcShift"),n=N.gv;if(!Bd.inEdit(n))return F.call(N,s,M);var B=n.getEditInteractor(),c=B.getSubModule("Move").calcShift(s,M,N);return c||F.call(N,s,M)},clear:function(o){var X=this,V=Aj.getBackup("clear");V.call(X,o);var C=X.gv;if(Bd.inEdit(C)){var n=C.getEditInteractor();n.getSubModule("Move").clear(o)}}};Bd.Inject.registAsModule(Aj,jh);var Ve=Bd.Rect=function(s){this.catalog="Rect",this._interactor=s};Ve.prototype={},Ve.prototype.constructor=Ve,Ve.prototype.gatherInfo=function(X,y){var v=this;if(1===y.length){var C=y[0];return C instanceof I.Shape&&C._70I()?v.gatherLine(X,C):Rm(C,X)?!1:v.gatherSingleTarget(X,C)}return y.length>1?v.gatherMultiTargets(X,y):!1},Ve.prototype.gatherSingleTarget=function(w,p){if(p.getCorners){var d,B=this,X=B.info;B.target=p,d=B.screenInfo={};var F=p.getCorners();X.LT=new Bd.Math.Vector2(F[0]),X.LB=new Bd.Math.Vector2(F[1]),X.RB=new Bd.Math.Vector2(F[2]),X.RT=new Bd.Math.Vector2(F[3]),X.T=X.LT.clone().add(X.RT).divideScalar(2),X.B=X.LB.clone().add(X.RB).divideScalar(2),X.L=X.LT.clone().add(X.LB).divideScalar(2),X.R=X.RT.clone().add(X.RB).divideScalar(2);for(var z in X)d[z]=Bd.toScreenPosition(w,X[z]);var o=B._interactor,b=o.getStyle("checkSize"),W=function(d,v,M){var w=v.clone().sub(d).setLength(-b),e=M.clone().sub(d).setLength(-b),f=w.add(e).add(d);return f};return d.rotLT=W(d.LT,d.RT,d.LB),d.rotLB=W(d.LB,d.LT,d.RB),d.rotRB=W(d.RB,d.LB,d.RT),d.rotRT=W(d.RT,d.LT,d.RB),d.rotT=d.rotLT.clone().add(d.rotRT).divideScalar(2),d.rotB=d.rotLB.clone().add(d.rotRB).divideScalar(2),d.rotL=d.rotLT.clone().add(d.rotLB).divideScalar(2),d.rotR=d.rotRT.clone().add(d.rotRB).divideScalar(2),d.rotation=p.getRotation(),B.gatherConnectInfo(),!0}},Ve.prototype.gatherConnectInfo=function(){var A=this,i=A.target,U=A._interactor,S=A.screenInfo,C=U.gv;if(C.isConnectActionVisible(i)&&U.getStyle("connectGuideVisible")){var v;i.s&&(v=i.s("connectGuideShift")),v||(v=U.getStyle("connectGuideShift"));var q=i.getAnchor(),c=i.getSize(),s=i.toGlobal({x:c.width*(v[0]-q.x),y:c.height*(v[1]-q.y)});s=Bd.toScreenPosition(C,s),S.P1?s.add(S.P2.clone().sub(S.P1).setLength(v[2])):(s.add(S.RT.clone().sub(S.LT).setLength(v[2])),s.add(S.LB.clone().sub(S.LT).setLength(v[3]))),S.connect=s}},Ve.prototype.gatherMultiTargets=function(u,n){var i=Bd.Group.findOrCreateGroup(n);if(!i)return!1;var c=this;return c.editing&&"rotate"!==c.editing.mode||i.calcInfo(),c.gatherSingleTarget(u,i)},Ve.prototype.gatherLine=function(n,U){this.target=U;var T=this.screenInfo={},O=U.getPoints(),H=Bd.getDataMatrix(U);return T.P1=Bd.toScreenPosition(n,H.apply(O.get(0))),T.P2=Bd.toScreenPosition(n,H.apply(O.get(1))),this.gatherConnectInfo(),!0},Ve.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ve.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ve.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ve.prototype.check=function(V,g,y){if(I.Default.isLeftButton(g)){var b=this;if(b.editing=null,b.tipInfo=null,b.screenInfo){var D=b.target,j=V.isEditable(D),U=b.screenInfo;if(j&&U.connect){var E=b._checkConnect(y);if(E)return E}if(U.P1)return b._checkLine(y);var i,q,S,C=null,u=b._interactor,A=u.getStyle("checkSize");if(j&&V.isRectEditable(D))for(q=0;q<Bd.Rect.ResizeKeys.length;q++)if(S=Bd.Rect.ResizeKeys[q],Bd.checkHit(y,U[S],A)){C=S,i="resize";break}if(!C&&j&&V.isRotationEditable(D)&&!u.getStyle("rotateAsClock")){var X=u.getStyle("rotateCheckSize");for(q=0;q<Bd.Rect.RotateKeys.length;q++)if(S=Bd.Rect.RotateKeys[q],Bd.checkHit(y,U[S],X)){C=S,i="rotate";
    break}}if(!C)return u.setCursor("default"),void 0;if("rotate"===i){var n,f=V.lp(g);if(D instanceof Bd.Group){var x=u.getStyle("groupRotateModeKey");"string"==typeof x&&(x=[x]);for(var _=!1,l=0,T=x.length;T>l;l++)if(g[x[l]]){_=!0;break}var z=u.getStyle("groupRotateModeDefault");n=_?"batch"===z?"block":"batch":z}var J="batch"===n?D.getAnchor2():D.getPosition(),F=Math.atan2(f.y-J.y,f.x-J.x);u._setRotateCursor(F),b.editing={mode:i,key:C,pos:J,flipY:D.getScale().y<0,rotation:D.getRotation(),hitRot:F},n&&(b.editing.groupRotateMode=n)}else{var m=Bd.Rect.ResizeKeys.indexOf(C),B=Bd.Rect.ResizeDirection[m],Q=Math.cos(D.getRotation()),s=Math.sin(D.getRotation()),H=B.x*Math.sign(D.getScale().x),p=B.y*Math.sign(D.getScale().y),w=Math.atan2(-s*H-Q*p,Q*H-s*p),o=(Math.round(w/(Math.PI/4))+8)%8,Z=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][o];this._interactor.setCursor(Z);var N=D.getWidth(),K=D.getHeight(),R=D.getAnchor();b.editing={mode:i,key:C,rect:{x:-N*R.x,y:-K*R.y,width:N,height:K},anchor:R,matrix:D.getMatrix()}}return C}}},Ve.prototype._checkLine=function(K){var h=this;h.screenInfo;var w,T=h._interactor.getStyle("checkSize");if(Bd.checkHit(K,h.screenInfo.P1,T))w="P1";else{if(!Bd.checkHit(K,h.screenInfo.P2,T))return this._interactor.setCursor("default"),void 0;w="P2"}return h.editing={mode:"line",key:w},w},Ve.prototype._checkConnect=function(k){var Q=this,A=Q.screenInfo,b=Q._interactor,z=b.getStyle("connectGuideIntersectSize"),T=A.connect,j=k.x,m=T.x;if(m>j&&z>m-j&&Math.abs(T.y-k.y)<z||j>=m&&Bd.checkHit(k,T,z)){var d="connect",G=l.getConnectAction(b.gv);if(Q.editing={mode:d},G&&G.delete)if(Q.target instanceof Bd.Group){var X=!0;b.gv.sm().getSelection().each(function(Q){G.delete.visible.call(null,b.gv,Q)||(X=!1)}),Q.editing.hasDeleteAction=X}else G.delete.visible.call(null,b.gv,Q.target)&&(Q.editing.hasDeleteAction=!0);return b.setCursor("default"),d}},Ve.prototype._fireEditEvent=function(K,V){var O=this._interactor,D=this.editing;if(D){var z=D.mode;z="rotate"===z?"Rotation":"connect"===z?"Connection":z[0].toUpperCase()+z.slice(1),O.fi({kind:K+"Edit"+z,event:V})}},Ve.prototype.startEdit=function(z,C){z.startDragging(C);var d=this;d._interactor.fi({kind:"prepareEdit",event:C});var X=d.editing,O=d.target;if(X){if(d._fireEditEvent("begin",C),"rotate"===X.mode)return X.groupRotateMode&&O.beginRotate(X),void 0;if("connect"!==X.mode)("line"===X.mode||O&&0===O.getRotation())&&(d._inSmartGuide=!0,d._interactor.rectGuide.gatherRects());else if(X.hasDeleteAction){var D=z.gv,R=d._interactor.getStyle("connectGuideGarbageShift");X.garbageInfo={x:D.getWidth()*R[0]+R[2],y:D.getHeight()*R[1]+R[3],size:d._interactor.getStyle("connectGuideGarbageIntersectsize")},z._42()}}},Ve.prototype._46O=function(J){var h,L,v=this,j=v.editing,z=v.target;if(j){if("connect"===j.mode&&!j.canceled&&!j.deleted)try{j.garbageInfo&&j.garbageInfo.hover?l.doDeleteConnectionAction(v._interactor.gv,z):l.doConnectAction(v._interactor.gv,z,j.target)}catch(b){console.error(b)}L=j.freezeFlag,h=v.editing.groupRotateMode,v._fireEditEvent("end",J),v.editing=null}v.tipInfo=null,v._inSmartGuide&&(v._interactor.rectGuide.clear(),v._inSmartGuide=!1),h&&z&&z.endRotate(),z instanceof I.Block&&(L===r?delete z._freezeSyncFromChildren:z._freezeSyncFromChildren=L,z.updateFromChildren())},Ve.prototype.handleNormalStateDelete=function(){var z=this,X=z.editing;if(X&&"connect"===X.mode&&!X.canceled&&!X.deleted){if(X.garbageInfo){try{l.doDeleteConnectionAction(z._interactor.gv,z.target)}catch(e){console.error(e)}X.garbageInfo=null}return X.cursorPos=null,X.targetCorners=null,X.deleted=!0,z._interactor._42(),!0}},Ve.prototype.handleNormalStateKeyDown=function(g){var e=this,V=e.editing;return!V||"connect"!==V.mode||V.canceled||V.deleted?void 0:I.Default.isEsc(g)?(V.cursorPos=null,V.targetCorners=null,V.canceled=!0,e._interactor._42(),!0):void 0},Ve.prototype.handleEdit=function(O,C){var Y=this,V=Y.editing;if(V){var i,S,D,o,f,Z=Y.target,T=V.key,s=V.mode,$=O.lp(C),R=Y._interactor;if("connect"===s){if(V.canceled)return;if(V.deleted)return;V.cursorPos=R._getLogicalPoint(C);var a=V.garbageInfo;return a&&Bd.checkHit(V.cursorPos,a,a.size)?(a.hover=!0,V.target=null,V.targetCorners=null):(a&&(a.hover=!1),V.target=O.getDataAt($,function(m){return O.isSelectable(m)?lb(m)?!0:!1:!1})||null,V.targetCorners=Bd.getTargetCornersOnScreen(O,V.target)),R._42(),void 0}if("rotate"===s){var F,z,v=V.pos,A=Math.atan2($.y-v.y,$.x-v.x);if(V.groupRotateMode?z=A-V.hitRot:(F=A-V.hitRot,z=V.rotation+F),z%=2*Math.PI,0>z&&(z+=2*Math.PI),!I.Default.isCtrlDown(C)){var h,p;Fg(C)?(h=R.getStyle("shiftRotateRound"),p=h/2):(h=R.getStyle("rotateRound"),p=R.getStyle("rotateSensitivity")),z=Bd.roundTo(z,h,p)}V.groupRotateMode?(F=z-(V.lastRotation||0),0!==F&&(Z.addRotation(F,V.groupRotateMode),V.lastRotation=z)):Z.setRotation(z),R._setRotateCursor(A),z>Math.PI&&(z-=2*Math.PI);var j=180*(z/Math.PI);j=j.toFixed(2),i=""+j+""}else if("resize"===s){var e=V.rect;D=e.x,o=e.y;var g,M=e.width,U=e.height,u=V.anchor,P=V.matrix,X=Z.s&&Z.s("keepAspectRatio")||R.getStyle("keepAspectRatio");Fg(C)&&(X=!X);var m=Y._unionPointMode1,l=Y._unionPointMode2;if(Y._inSmartGuide&&!I.Default.isCtrlDown(C)&&!X){var k;"L"===T||"R"===T?k="x":("T"===T||"B"===T)&&(k="y"),Y._adsorbedToClosest($,k),f=!0}g=P.tfi($);var W;"LT"===T?(e=m(g,{x:D+M,y:o+U},M,U,X),W=9):"T"===T?(e=l({x:D,y:g.y},{x:D+M,y:o+U},M,U,X,"v"),W=1):"RT"===T?(e=m(g,{x:D,y:o+U},M,U,X),W=33):"L"===T?(e=l({x:g.x,y:o},{x:D+M,y:o+U},M,U,X,"h"),W=8):"R"===T?(e=l({x:D,y:o},{x:g.x,y:o+U},M,U,X,"h"),W=32):"LB"===T?(e=m(g,{x:D+M,y:o},M,U,X),W=12):"B"===T?(e=l({x:D,y:o},{x:D+M,y:g.y},M,U,X,"v"),W=4):"RB"===T&&(e=m(g,{x:D,y:o},M,U,X),W=36);var K=P.tf(e.x+e.width*u.x,e.y+e.height*u.y);Z instanceof I.Block&&(V.hasOwnProperty("freezeFlag")||(V.freezeFlag=Z._freezeSyncFromChildren,Z._freezeSyncFromChildren=!0)),Z.setPosition(K),Z.setSize(e.width,e.height),f&&(S=Z.getRect(),R.rectGuide.gatherLines({node:Z,x:S.x,y:S.y,w:S.width,h:S.height},k,W)),i=""+Math.round(e.width)+" * "+Math.round(e.height)}else if("line"===s){if(Fg(C)){var x=Z.getPoints(),c="P1"===T?x.get(1):x.get(0),q={x:$.x-c.x,y:$.y-c.y},_=R.getStyle("shiftLineRotateRound"),r=Y._shiftDirList;if(!r||Y._shiftRotateRound!==_){Y._shiftRotateRound=_,Y._shiftDirList=r=[];for(var y=0;y<Math.PI;y+=_)r.push({x:w(y),y:b(y)})}for(var H,t=0,B=0,G=r.length;G>B;B++){var n=r[B],L=n.x*q.x+n.y*q.y;Math.abs(L)>Math.abs(t)&&(t=L,H=n)}$={x:c.x+H.x*t,y:c.y+H.y*t},R.rectGuide.clear()}else Y._inSmartGuide&&!I.Default.isCtrlDown(C)&&(Y._adsorbedToClosest($),f=!0);var J=Bd.getDataMatrix(Z).applyInverse($);Z.setPoint("P1"===T?0:1,J,!0);var N=Z.getPoints(),E=N.get(0),d=N.get(1);D=E.x-d.x,o=E.y-d.y,i=" "+Math.round(Math.sqrt(D*D+o*o))+" ",f&&(S=Z.getRect(),R.rectGuide.gatherLines({node:Z,x:S.x,y:S.y,w:S.width,h:S.height}))}if(i){var Q=I.Default.getLogicalPoint(C,R._canvas);Q.x+=Bd.Icons.TipShiftX,Q.y+=Bd.Icons.TipShiftY,Y.tipInfo={helperPos:Q,text:i,size:i.length}}Y._fireEditEvent("between",C)}},Ve.prototype._unionPointMode1=function(i,c,$,R,t){if(t&&$&&R){var B=i.x-c.x,q=i.y-c.y;Math.abs(B*R)<Math.abs(q*$)?(q=Math.sign(q)*Math.abs(B*R/$),i.y=c.y+q):(B=Math.sign(B)*Math.abs(q*$/R),i.x=c.x+B)}return I.Default.unionPoint(i,c)},Ve.prototype._unionPointMode2=function(G,P,S,Y,u,A){var j=I.Default.unionPoint(G,P);if(u&&S&&Y){var D;"v"===A?(D=j.x+j.width/2,j.width=S*j.height/Y,j.x=D-j.width/2):(D=j.y+j.height/2,j.height=Y*j.width/S,j.y=D-j.height/2)}return j},Ve.prototype._adsorbedToClosest=function(V,g){var D=this,A=D._interactor,R=A.rectGuide.findClosest(V,g),w=A.gridGuide.findClosest(V,g),y=1/0,Q=1/0;R&&(isFinite(R.x)&&(y=R.x),isFinite(R.y)&&(Q=R.y)),w&&(isFinite(w.x)&&Math.abs(w.x)<Math.abs(y)&&(y=w.x),isFinite(w.y)&&Math.abs(w.y)<Math.abs(Q)&&(Q=w.y)),isFinite(y)&&(V.x+=y),isFinite(Q)&&(V.y+=Q)},Ve.prototype._42=function(D,L,K){var m=this;m.info={},m.screenInfo=null;var U=m._interactor;if(!U.editDetail&&m.gatherInfo(L,K)){var $=m.editing,e=$?$.groupRotateMode:null,u=m.screenInfo;"block"!==e&&(u.P1?Bd.Icons.DrawIcon(U,D,Bd.Icons.Line,u):Bd.Icons.DrawIcon(U,D,Bd.Icons.Rect,u),u.connect&&(Bd.Icons.DrawIcon(U,D,Bd.Icons.ConnectGuide,{rotation:u.rotation,connect:u.connect,cursorPos:$?$.cursorPos:null}),$&&($.targetCorners&&Bd.Icons.DrawIcon(U,D,Bd.Icons.NodeHoverGuide,$.targetCorners),$.garbageInfo&&Bd.Icons.DrawIcon(U,D,Bd.Icons.ConnectGuideGarbage,$.garbageInfo))),m.tipInfo&&Bd.Icons.DrawIcon(U,D,Bd.Icons.TipHelper,m.tipInfo)),m.target instanceof Bd.Group&&m.target._42(U,D,L)}};var hp=Bd.Anchor=function(r){this.catalog="Anchor",this._interactor=r};hp.prototype={},hp.prototype.constructor=hp,hp.prototype.gatherInfo=function(W,_){var F=this;if(1===_.length){var U=_[0];if(!U.getAnchor)return;if(U instanceof I.Shape&&U._70I())return;if(Rm(U,W))return;return F.gatherSingleTarget(W,_[0])}return _.length>1?F.gatherMultiTargets(W,_):!1},hp.prototype.gatherSingleTarget=function(l,H){var j=this;return j.info.POS=H.getPosition(),j.screenInfo.POS=Bd.toScreenPosition(l,j.info.POS),j.target=H,!0},hp.prototype.gatherMultiTargets=function(z,i){var F=this,I=Bd.Group.findOrCreateGroup(i);return I?(F.screenInfo.POS=Bd.toScreenPosition(z,I.getAnchor2()),F.target=I,!0):!1},hp.prototype.isVisible=function(){var V=this,l=V._interactor;if(l.getStyle("anchorVisible")===!1)return!1;var R=V.target;if(R){if(this.editing)return!0;var T=R.getAnchor(),s=l.getStyle("anchorOutsideVisibleThreshold");if(T.x<-s||T.x>1+s||T.y<-s||T.y>1+s)return!0;var L=R.getSize(),q=R.getScale(),g=Math.min(Math.abs(L.width*q.x),Math.abs(L.height*q.y));if(g*l.gv._zoom<l.getStyle("anchorHideThreshold"))return!1}return!0},hp.prototype.check=function(L,Z,c){if(I.Default.isLeftButton(Z)){var u=this,E=u._interactor;if(u.isVisible()&&E.getStyle("anchorMovable")!==!1){u.editing=null,u.tipInfo=null;var S=u.target;if(S&&L.isAnchorEditable(S)&&L.isEditable(S)){var T;if(u.screenInfo&&(T=u.screenInfo.POS)&&Bd.checkHit(c,new Bd.Math.Vector2(T),E.getStyle("checkSize"))){if(S instanceof Bd.Group)return u.editing={},!0;var f=S.getWidth(),d=S.getHeight(),_=S.getAnchor();return u.editing={rect:{x:-f*_.x,y:-d*_.y,width:f,height:d},anchor:_,matrix:S.getMatrix()},!0}}}}},hp.prototype.startEdit=function(g,N){g.startDragging(N),g.fi({kind:"beginEditAnchor",event:N})},hp.prototype._46O=function(L){var z=this;z.editing&&(z.editing=null,z._interactor.fi({kind:"endEditAnchor",event:L})),z.tipInfo=null},hp.prototype.handleEdit=function(B,Q){var i=this,p=i.target;if(p){var n=i.editing;if(n){var l=B.lp(Q),y=i._interactor;if(p instanceof Bd.Group)return p.setAnchor2(l),y._42(),void 0;var e=n.matrix,o=e.tfi(l),f=n.rect,O=(o.x-f.x)/f.width,E=(o.y-f.y)/f.height;if(!I.Default.isCtrlDown(Q)){var c=y.getStyle("anchorRound"),F=y.getStyle("anchorSensitivity");O=Bd.roundTo(O,c,F),E=Bd.roundTo(E,c,F)}p.setAnchor(O,E,!0);var s=I.Default.getLogicalPoint(Q,y._canvas);s.x+=Bd.Icons.TipShiftX,s.y+=Bd.Icons.TipShiftY;var G=""+O.toFixed(2)+", "+E.toFixed(2);i.tipInfo={helperPos:s,text:G,size:G.length},y.fi({kind:"betweenEditAnchor",event:Q})}}},hp.prototype._42=function(x,Y,y){var r=this;r.info={},r.screenInfo={};var V=r._interactor;V.editDetail||r.gatherInfo(Y,y)&&r.isVisible()&&(Bd.Icons.DrawIcon(V,x,Bd.Icons.Anchor,r.screenInfo),r.tipInfo&&Bd.Icons.DrawIcon(V,x,Bd.Icons.TipHelper,r.tipInfo))};var ks=Bd.RotateX=function(E){this.catalog="RotateX",this._interactor=E};ks.prototype={},ks.prototype.constructor=ks,ks.prototype.gatherInfo=function(B,n){var U=this;if(1===n.length){var D=n[0];return D instanceof I.Shape&&D._70I()||Rm(D,B)?!1:U.gatherSingleTarget(B,D)}return n.length>1?U.gatherMultiTargets(B,n):!1},ks.prototype.gatherSingleTarget=function(){var E=new I.Math.Vector2,O=new I.Math.Vector2,b=new I.Math.Vector2,o=new I.Math.Vector2,V=function(Q,k){var P=Q.x-k.x,z=Q.y-k.y;return P*P+z*z};return function(x,F){if(F.getCorners){var Y=this,g=F.getCorners(),I=15,$=F.getPosition();E.copy(g[0]),b.copy(g[1]),o.copy(g[3]),O.copy(E).add(o).divideScalar(2).add(E.sub(b).setLength(I/x.getZoom()));var U=Math.max(V($,g[0]),V($,g[1]),V($,g[2]),V($,g[3]));return Y.info.POS=O.clone(),Y.screenInfo.POS=Bd.toScreenPosition(x,Y.info.POS),Y.screenInfo.LEN=Math.sqrt(U)*x.getZoom()+I,Y.screenInfo.CENTER=Bd.toScreenPosition(x,$),Y.target=F,!0}}}(),ks.prototype.gatherMultiTargets=function(V,v){var l=this,k=Bd.Group.findOrCreateGroup(v);if(!k)return!1;var l=this;return l.gatherSingleTarget(V,k)},ks.prototype.isVisible=function(){var Q=this._interactor;if(!Q.getStyle("rotateAsClock"))return!1;var N=this.target;if(!N)return!0;var s=Q.gv;return s.isEditable(N)&&s.isRotationEditable(N)?!0:!1},ks.prototype.check=function(u,H,K){var f=this,Y=f._checkImpl(u,H,K);return(Y||f._clockPainted)&&f._interactor._42(),Y},ks.prototype._checkImpl=function(N,J,Z){if(I.Default.isLeftButton(J)){var t=this;t.editing=null,t.tipInfo=null;var C;if(t.screenInfo&&(C=t.screenInfo.POS)&&t.isVisible()){var F=t._interactor;if(Bd.checkHit(Z,C,F.getStyle("checkSize"))){var V=t.target,j=N.lp(J),D=V.getPosition(),o=Math.atan2(j.y-D.y,j.x-D.x);return F._setRotateCursor(o),t.editing={pos:D,rotation:V.getRotation(),hitRot:o,groupRotateMode:"block",screenInfo:{CENTER:t.screenInfo.CENTER,LEN:t.screenInfo.LEN}},!0}}}},ks.prototype.startEdit=function(l,o){l.startDragging(o),l.fi({kind:"beginEditRotation",event:o}),this.target instanceof Bd.Group&&this.target.beginRotate(this.editing)},ks.prototype._46O=function(q){var F=this;F.editing&&(F.editing=null,F._interactor.fi({kind:"endEditRotation",event:q})),F.target instanceof Bd.Group&&F.target.endRotate(),F.tipInfo=null},ks.prototype.handleEdit=function(o,J){var R=this,v=R.editing;if(v){var U,z,V=R.target,y=o.lp(J),d=R._interactor,Z=v.pos,e=Math.atan2(y.y-Z.y,y.x-Z.x),m=V instanceof Bd.Group;if(m?z=e-v.hitRot:(U=e-v.hitRot,z=v.rotation+U),z%=2*Math.PI,0>z&&(z+=2*Math.PI),!I.Default.isCtrlDown(J)){var r,j;Fg(J)?(r=d.getStyle("shiftRotateRound"),j=r/2):(r=d.getStyle("rotateRound"),j=d.getStyle("rotateSensitivity")),z=Bd.roundTo(z,r,j)}m?(U=z-(v.lastRotation||0),0!==U&&(V.addRotation(U,v.groupRotateMode),v.lastRotation=z)):V.setRotation(z),d._setRotateCursor(e),z>Math.PI&&(z-=2*Math.PI);var w=180*(z/Math.PI),T=""+w.toFixed(2)+"",f=I.Default.getLogicalPoint(J,d._canvas);f.x+=Bd.Icons.TipShiftX,f.y+=Bd.Icons.TipShiftY,R.tipInfo={helperPos:f,text:T,size:T.length},d.fi({kind:"betweenEditRotation",event:J})}},ks.prototype._42=function(F,g,R){var X=this;X._clockPainted=!1,X.info={},X.screenInfo={};var U=X._interactor;U.editDetail||X.gatherInfo(g,R)&&X.isVisible()&&(Bd.Icons.DrawIcon(U,F,Bd.Icons.RoundPoint,X.screenInfo.POS),X.tipInfo&&Bd.Icons.DrawIcon(U,F,Bd.Icons.TipHelper,X.tipInfo),X.editing&&X.drawClock(F))},ks.prototype.drawClock=function(l){l.save();var Z=this;Z._clockPainted=!0;var Y=Z.editing||{},N=Y.screenInfo||Z.screenInfo,W=N.LEN,f=W+8,X=W+18;l.save(),l.translate(N.CENTER.x,N.CENTER.y),l.beginPath(),l.strokeStyle="rgb(150, 150, 150)";for(var C,h,Q,P,T,U=0;360>U;U++)C=U*Math.PI/180,0===U%5&&(h=b(C)*W,Q=w(C)*W,P=b(C)*f,T=w(C)*f,l.moveTo(h,Q),l.lineTo(P,T)),0===U%45&&(h=b(C)*W,Q=w(C)*W,P=b(C)*X,T=w(C)*X,l.moveTo(h,Q),l.lineTo(P,T));l.stroke(),l.rotate(-S);var m=Y.lastRotation||Z.target.getRotation();l.beginPath(),l.fillStyle="rgba(255, 0, 0, 0.1)",l.strokeStyle="rgb(157, 157, 157)",l.moveTo(0,0),l.arc(0,0,X,0,m,!1),l.fill(),l.beginPath(),l.moveTo(0+X,0),l.arc(0,0,X,0,m,!1),l.stroke(),l.restore()};var Wq=Bd.Curve=function(R){this.catalog="Curve",this._interactor=R};Wq.prototype={},Wq.prototype.constructor=Wq,H.defineProperties(Wq.prototype,{activing:{get:function(){return this._activing},set:function(t){var f=this;if(t)f._activing=new Bd.CurveActiving(this,t);else{var o=f._activing;o&&o.dispose(),f._activing=null}}}}),Wq.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Wq.prototype.setUp=function(){var q=this,z=q._interactor;z&&z.gv.mp(q._onGraphviewPropertyChanged,q)},Wq.prototype._onGraphviewPropertyChanged=function(g){("zoom"===g.property||"translateX"===g.property||"translateY"===g.property)&&this._handleDataChanged()},Wq.prototype.tearDown=function(){var g=this,r=g._interactor;r&&r.gv.ump(g._onGraphviewPropertyChanged,g)},Wq.prototype.canEnterEditDetailMode=function(){var D=this,B=D._interactor,j=B._getValidSelection();if(1===j.length){var p=j[0],U=p instanceof I.Edge;if(p instanceof I.Shape||U){if(U){var b=p.s("edge.type");if(b&&"points"!==b)return}var T=B.gv;if(T.isPointEditable(p)&&T.isEditable(p))return D.target=p,!0}}},Wq.prototype.canQuitEditDetailMode=function(i){var q=this,Y=q._interactor._getLogicalPoint(i);return q._checkEditRealPoint(Y)?void 0:q._interactor.gv.getDataAt(i)!==q.target?!0:void 0},Wq.prototype.preHandleScroll=function(){var l=this.editing;return l&&l.inEdit?!0:void 0},Wq.prototype.getCurrentSelectintStatus=function(){var B=this;if(B.activing&&!B.activing.selections){if(B.activing.status!=r)return B.activing.status;var V=function(u){var p=B.activing.status;B.activing.status=u,B._interactor.fp("shapePointStatus",p,u)},A=Bd.Curve.PointType,X=B.activing.point,s=B.activing.pairs;if(!s||1!==s.length)return V(A.Mirrored);var n=s[0],K=n.c1&&n.c1.isNearEnough(X),U=n.c2&&n.c2.isNearEnough(X);if(!n.c1||!n.c2)return K||U?V(A.Straight):V(A.Disconnected);if(K&&U)return V(A.Straight);if(K||U)return V(A.Asymmetric);var q=n.c1.clone().sub(X),L=n.c2.clone().sub(X);return Math.abs(q.x*L.y-q.y*L.x)>1e-5||q.x*L.x>0?V(A.Disconnected):Math.abs(q.length()-L.length())>1e-5?V(A.Asymmetric):V(A.Mirrored)}},Wq.prototype.handle_keydown=function(r){var w=this;if(w._interactor.editDetail){var i=Bd.Curve.PointType;"1"===r.key?w._setCurrentSelectionStatus(i.Straight):"2"===r.key?w._setCurrentSelectionStatus(i.Mirrored):"3"===r.key?w._setCurrentSelectionStatus(i.Disconnected):"4"===r.key&&w._setCurrentSelectionStatus(i.Asymmetric)}},Wq.prototype.setCurrentSelectionStatus=function(M){var Z=this,O=Z._interactor;if(O){var U=O.gv;U.dm().beginTransaction(),this._setCurrentSelectionStatus(M),U.dm().endTransaction()}},Wq.prototype._setCurrentSelectionStatus=function(Q){var q=this,W=q.activing;if(W){var b=q.getCurrentSelectintStatus();if(null!==b&&b!==Q){W.status=Q;var U=q.activing.point,O=q.activing.pairs;if(O&&1===O.length){var S=O[0],t=q.screenInfo.curve,M=Bd.Curve.PointType,K=function(){q._writeToHt(),q._interactor.fp("shapePointStatus",b,Q)};if(Q===M.Straight)return t.moveCtrlPoint(S,U,"c1"),t.moveCtrlPoint(S,U,"c2"),K(),void 0;if(b===M.Straight){var k=t.findPairs(U,!0),n=k[0],x=n.r1||U,C=n.r2||U,p=C.clone().sub(x).multiplyScalar(.25);return t.moveCtrlPoint(S,U.clone().sub(p),"c1"),t.moveCtrlPoint(S,U.clone().add(p),"c2"),K(),void 0}var z=S.c1,E=S.c2;if(z&&E){if(Q===M.Mirrored)return t.moveCtrlPoint(S,U.clone().multiplyScalar(2).sub(E),"c1"),K(),void 0;if(Q===M.Asymmetric&&b===M.Disconnected){var v=z.clone().sub(U).length(),p=U.clone().sub(E).setLength(v).add(U);return t.moveCtrlPoint(S,p,"c1"),K(),void 0}}W._firePointChange(),q._interactor.fp("shapePointStatus",b,Q)}}}},Wq.prototype._handleDataChanged=function(){var T="points,segments,shape,position,rotation,scale".split(",");return function(F){var D=this;if(D.screenInfo&&D.target){if(F&&T.indexOf(F.property)<0)return;var z=D._interactor;D.gatherSingleTarget(z.gv,D.target,!0),D.check(z.gv,null,new Bd.Math.Vector2(z._lastClientPoint)),z._42()}}}(),Wq.prototype.gatherSingleTarget=function(L,G,w){var T,A,p=this;p.screenInfo&&p.screenInfo.curve&&(A=p.screenInfo.curve._curves);var h=p.editing;T=h?p.screenInfo:p.screenInfo={};var x,S,R=G instanceof I.Edge;R?(x=G.s("edge.segments"),S=G.s("edge.points")||new I.List):(x=G._58O,S=G._59O),T.S=x;var l,_=T.P=[],q=Bd.getDataMatrix(G);if(G instanceof I.Polyline&&(l=G.getElevation()||0,T.E=[]),S.each(function(z){T.E&&T.E.push(z.e||l),z=q.apply(z);var Z=Bd.toScreenPosition(L,z);_.push(Z.x,Z.y)}),R){var W=Bd.toScreenPosition(L,G._lastSourcePoint),B=Bd.toScreenPosition(L,G._lastTargetPoint);_.splice(0,0,W.x,W.y),_.push(B.x,B.y)}if(!T.S||!T.S.size()){T.S=new I.List,T.S.add(1);for(var M=0;M<_.length/2-1;M++)T.S.add(2)}if((!h||w)&&p.convertToCubicBezier(A),p.activing&&(w||!p.editing||"realPoint"===p.editing.type)){var u=T.curve.findPairs(p.activing.point);p.activing.pairs=u}R&&"points"!==G.s("edge.type")&&p._writeToHt()},Wq.prototype._convertToNewPoint=function(E,$,s){var c,N,y;for(c=0,N=$.length;N>c;c++){if(y=$[c],y._p1.isNearEnough(E))return y._p1;if(y._p4.isNearEnough(E))return y._p4}if(s)for(c=0,N=Math.min(s.length,N);N>c;c++){if(y=s[c],y._p1===E)return $[c]._p1;if(y._p4===E)return $[c]._p4}},Wq.prototype.convertToCubicBezier=function(q){var Y,Q,i=this,n=new Bd.Math.Curve,$=i.screenInfo;if(n.createFromHtShape($.P,$.S,$.E),$.curve=n,i.activing){var A=n._curves;if(Y=i.activing.point,Q=i._convertToNewPoint(Y,A,q),Q&&(i.activing.point=Q),i.activing.selections){var y=-1,F=i.activing.selections;F.forEach(function(H){y++,Q=i._convertToNewPoint(H,A,q),Q&&(F[y]=Q)})}}},Wq.prototype.check=function(y,B,u){if(!B||I.Default.isLeftButton(B)){var v=this;if(v._interactor.setCursor("default"),v.editing=null,v.highlight=null,v.tipInfo=null,v.screenInfo){if(Ln())return v._interactor._42(),!0;if(v._checkEditCtrlPoint(u))return v._interactor._42(),!0;if(v._checkEditRealPoint(u))return v._interactor._42(),!0;if(v._checkEditElevation(u))return v._interactor._42(),!0;var S=v.screenInfo.curve,a=S.checkPoint(u,v._interactor.getStyle("curveIntersectSize"));if(a){var e=v.highlight={};e.type="insertKnot",e.bezier=a.bezier,e.point=a.intersection}return v._interactor._42(),!0}}},Wq.prototype._checkEditRealPoint=function(e){var B,n,K,p,H,f,W=this,d=W.screenInfo.curve._curves,o=W._interactor.getStyle("curvePointIntersectSize"),O=1/0;for(o*=o,K=0,p=d.length;p>K;K++)B=d[K],H=B._p1,f=e.distanceToSquared(H),O>f&&(O=f,n=H),H=B._p4,f=e.distanceToSquared(H),O>f&&(O=f,n=H);if(O>o)return!1;var _=W.highlight={};return _.type="changeRealPoint",_.point=n,W.editing={type:"realPoint",point:n,shiftGuide:{point:n.clone(),dir:"x",limit:0}},W._interactor.setCursor("crosshair"),!0},Wq.prototype._checkEditElevation=function(J){var Z=this;if(!Z._interactor.getStyle("curveElevationVisible"))return!1;var T=Z.activing;if(!T)return!1;var L=T.getCurrentEditingPoint();if(!L)return!1;var l=Z._interactor,N=l.getStyle("curveElevationGuideShift"),p=l.getStyle("curveElevationIntersectSize"),X=J.distanceToSquared({x:L.x+N[0],y:L.y+N[1]});if(!(X>p*p)){var C=Z.highlight={};C.type="elevation";var W=new Bd.Math.Vector2(J.x,J.y,L.e);return Z.editing={type:"elevation",startPoint:W},Z._interactor.setCursor("crosshair"),!0}},Wq.prototype._checkEditCtrlPoint=function(R){var T=this;if(T.activing&&!T.activing.selections){var N=T.getCurrentSelectintStatus();if(N!==Bd.Curve.PointType.Straight){var a=T.activing.pairs;if(a){var r=T._interactor.getStyle("curvePointIntersectSize");r*=r;var u,o,X,O,x,E,H,m,B,I=1/0;for(H=0,B=a.length;B>H;H++)for(O=a[H],m=0;2>m;m++)x=0===m?"c1":"c2",O[x]&&(E=R.distanceToSquared(O[x]),I>E&&(I=E,u=O,o=H,X=x));if(I>r)return!1;T.activing.hlpair=u,T.activing.hltype=X;var n=T.highlight={};return n.type="changeCtrlPoint",n.point=u[X],T.editing={type:"ctrlPoint",pair:u,pairId:o,ctrlType:X,direction:u[X].clone().sub(T.activing.point).normalize()},T._interactor.setCursor("crosshair"),!0}}}},Wq.prototype.startEdit=function(g,j){g.startDragging(j);var L=this;L.highlight&&"insertKnot"===L.highlight.type&&(L.insertKnot(),L.gatherSingleTarget(L._interactor.gv,L.target),L.activing=null,L._checkEditRealPoint(L._interactor._getLogicalPoint(j)));var D=L._activing;if(D){var R=L.editing?L.editing.type:null;"ctrlPoint"===R?D.editingCtrl={pairId:L.editing.pairId,type:D.hltype}:"realPoint"===R&&(D.editingCtrl=!1)}var K=L.highlight,F=I.Default.isCtrlDown(j);if(!K||Ln()){var b=L._interactor.gv;if(!b.setFocus(j)||b._scrolling)return;return b.isPannable()&&Zb(j)&&!F&&(L._pan={tx:b.tx(),ty:b.ty()},g.fi({kind:"beginPan",event:j})),void 0}if("changeRealPoint"===K.type){var N,r=L.activing?L.activing.point:null,n=L.activing?L.activing.selections:null;if(F&&L.activing)r===K.point?(n?(L.activing={point:n[0]},n.length>1&&(n.splice(0,1),L.activing.selections=n)):L.activing=null,L.editing=null):n&&(N=n.indexOf(K.point))>=0?(n.length>1?n.splice(N,1):delete L.activing.selections,L.editing=null):n?(n.push(r),L.activing={point:K.point,selections:n}):L.activing={point:K.point,selections:[r]};else if(n)r===K.point||((N=n.indexOf(K.point))>=0?(n.splice(N,1,r),L.activing={point:K.point,selections:n}):L.activing={point:K.point});else{var y;r===K.point&&(y=L.activing.status),L.activing={point:K.point},y&&(L.activing.status=y)}g.fi({kind:"beginEditPoint",event:j})}},Wq.prototype.insertKnot=function(){var P=this,Q=P.highlight,b=P.screenInfo.curve;b.insertKnot(Q.bezier,Q.point.t),P._writeToHt()},Wq.prototype._writeToHt=function(){var M,_,g,A,s=this,T=s.screenInfo.curve,o=T.toHtShape(),b=o.points,H=[],k=o.segments,C=s._interactor.gv,f=s.target,Q=f instanceof I.Edge,d=Bd.getDataMatrix(f).invert();A=f instanceof I.Polyline,A&&(g=f.getElevation());for(var R=0,N=b.length;N>R;R++)M=b[R],_=Bd.toWorldPosition(C,M),_=d.apply(_),M.e!=r&&M.e!==g&&(_.e=M.e),H.push(_);if(f._writing=!0,Q){f.s("edge.type","points"),f.setStyle("edge.segments",k),f.setStyle("edge.points",H.slice(1,H.length-1)),f.setStyle("edge.source.offset.x",0),f.setStyle("edge.source.offset.y",0),f.setStyle("edge.target.offset.x",0),f.setStyle("edge.target.offset.y",0);var v=s._nextChangeEdgeHost;delete s._nextChangeEdgeHost,v&&("source"===v.type?f.setSource(v.host):f.setTarget(v.host)),s._writeEdgeHostAnchor("source",H[0]),s._writeEdgeHostAnchor("target",H[H.length-1])}else H.length?(f.setSegments(k),f.setPoints(H,!0)):f.removeFromDataModel();delete f._writing},Wq.prototype._writeEdgeHostAnchor=function(Z,G){var Q=this,B=Q.target,H=Q._calcHostAnchor(B,Z,G);B.s("edge."+Z+".anchor.x",H.x),B.s("edge."+Z+".anchor.y",H.y),H.offsetX||H.offsetY?(B.s("edge."+Z+".offset.x",H.offsetX),B.s("edge."+Z+".offset.y",H.offsetY)):(B.s("edge."+Z+".offset.x",0),B.s("edge."+Z+".offset.y",0))},Wq.prototype._calcHostAnchor=function(t,g,x,w){w||(w="source"===g?t.getSource():t.getTarget());var X=this._interactor.gv,z=X.calculateAttachPoint(w,x);if(z)return z.info;var s=w.getRotation(),j=w.getAnchor();if(Rm(w,X)&&(s=0),s){var N=w.getMatrix(),S=N.tfi(x),f=w.getSize();return{x:S.x/f.width+j.x,y:S.y/f.height+j.y}}var Q=wq(X,w),J={x:(x.x-Q.x)/Q.width,y:(x.y-Q.y)/Q.height};return J},Wq.prototype._handlePanning=function(d){var h=this,S=h._pan;if(S){S.started=!0;var m=h._interactor,N=m.gv,R=m._lastClientPoint,D=Il(d);N.setTranslate(S.tx+D.x-R.x,S.ty+D.y-R.y),h.gatherSingleTarget(m.gv,h.target),m._42(),m.fi({kind:"betweenPan",event:d})}},Wq.prototype.handleEdit=function(X,K){var w=this,W=w.editing;if(w._pan)return w._handlePanning(K),void 0;if(W){W.inEdit=!0;var j,A,t,z=w._interactor._getLogicalPoint(K),C=I.Default.isCtrlDown(K),V=I.Default.isShiftDown(K),G=W.type,R=w.activing;if(w._guideInfo=null,"ctrlPoint"===G&&V){var F=w.editing.direction.clone();j=R.point;var p=F.dot(z.clone().sub(j));z=F.setLength(p).add(j)}else if("ctrlPoint"===G||"realPoint"===G){var F;if("realPoint"===G&&V){var y=w.editing.shiftGuide;A=y.point;var a=Math.abs(z.x-A.x),l=Math.abs(z.y-A.y);a>l&&a>y.limit&&"y"===y.dir&&(y.dir="x"),l>a&&l>y.limit&&"x"===y.dir&&(y.dir="y"),F=y.dir,"x"===F?(z.y=A.y,y.limit=Math.max(y.limit,a)):"y"===F&&(z.x=A.x,y.limit=Math.max(y.limit,l))}var S=w._isEditEdgeSourceTarget();if(S){var o=w._editEdgeSourceTarget(S,z,C);o&&(t=o.tipText)}else if(!C){var _=w._guidingToEdit(z,F),d="realPoint"===G?w._interactor.gridGuide.findClosest(z,F,!0):null,u=1/0,L=1/0;d&&(d.x&&(u=d.x),d.y&&(L=d.y));var Z=!1;_&&(_.xList&&(Math.abs(_.x)<=Math.abs(u)?(Z=!0,u=_.x):delete _.xList),_.yList&&(Math.abs(_.y)<=Math.abs(L)?(Z=!0,L=_.y):delete _.yList),Z&&(w._guideInfo=_)),isFinite(u)&&(z.x+=u),isFinite(L)&&(z.y+=L),Z&&(_.v=z)}}var P=w.screenInfo.curve;if("realPoint"===W.type){j=W.point,j.e!==r&&(z.e=j.e),P.moveRealPoint(j,z),W.point=z,w.highlight.point=z;var O=R.status,m=R.selections;if(w.activing={point:z,status:O},m){var N=z.clone().sub(j),q=0;m.forEach(function(D){var E=D.clone().add(N);P.moveRealPoint(D,E),m[q++]=E}),w.activing.selections=m}}else if("ctrlPoint"===W.type){var U=R.pairs,D=U[W.pairId];P.moveCtrlPoint(D,z,W.ctrlType);var f=R.status,E=Bd.Curve.PointType;if((f===E.Mirrored||f===E.Asymmetric)&&D.c1&&D.c2){var j=new Bd.Math.Vector2(R.point),J="c1"===W.ctrlType?"c2":"c1";if(f===Bd.Curve.PointType.Mirrored)P.moveCtrlPoint(D,j.clone().multiplyScalar(2).sub(z),J);else if(f===E.Asymmetric){var p=D[J].clone().sub(j).length(),Y=j.clone().sub(D[W.ctrlType]).setLength(p).add(j);isNaN(Y.x)||P.moveCtrlPoint(D,Y,J)}}R._firePointChange()}else if("elevation"===W.type){A=W.startPoint;var s=A.e+(A.y-z.y)/X._zoom;w._setCurrentPointImpl("e",s),R._firePointChange(),t="E: "+Bd.toFixed(s)}var $=I.Default.getLogicalPoint(K,w._interactor._canvas);if($.x+=Bd.Icons.TipShiftX,$.y+=Bd.Icons.TipShiftY,!t){var Q=Bd.toWorldPosition(X,z);t=""+Bd.toFixed(Q.x)+", "+Bd.toFixed(Q.y)}w.tipInfo={helperPos:$,text:t,size:t.length},w._writeToHt(),w._interactor.fi({kind:"betweenEditPoint",event:K})}},Wq.prototype._setCurrentPointImpl=function(V,B){var b=this,k=b._activing;if(!k)return!1;var S=b.target;if(!S)return!1;var s=k.getCurrentEditingPoint();if(!s)return!1;var _=k.editingCtrl;if(!_)var P=s.clone();if("e"===V)s.e=B;else{var A;if("x"===V||"y"===V){var I=k._lastFirePoint;A="x"===V?{x:B,y:I?I.y:0}:{x:I?I.x:0,y:B}}else"object"==typeof V?(A=V,V.e!==r&&(s.e=V.e)):(A={x:arguments[0],y:arguments[1]},arguments[2]!==r&&(s.e=arguments[2]));var E=Bd.getDataMatrix(S);A=Bd.toScreenPosition(b._interactor.gv,E.apply(A)),s.x=A.x,s.y=A.y}if(!_){var u=P.multiplyScalar(-1).add(s);s.e&&P.e&&(u.e=s.e-P.e),b.screenInfo.curve.moveCtrlDueToRealPointMovement(s,u)}return!0},Wq.prototype.setCurrentPoint=function(C,n){return this._setCurrentPointImpl(C,n)?(this._writeToHt(),!0):!1},Wq.prototype._isEditEdgeSourceTarget=function(){var H=this,m=H.target;if(!(m instanceof I.Edge))return!1;var A=H.editing.point,S=H.screenInfo.curve._curves;return A===S[0]._p1?"source":A===S[S.length-1]._p4?"target":!1},Wq.prototype._editEdgeSourceTarget=function(G,t,U){var $,L=this,N=L.target;if($="source"===G?N.getSource():N.getTarget()){var Y=L._interactor.gv,b=Bd.toWorldPosition(Y,t),I=L._calcHostAnchor(N,G,b,$);if(L._interactor.getStyle("edgeHostDetectPerFrame")||I.x<0||I.x>1||I.y<0||I.y>1){var a=Y.getDataAt(b,function(x){return Y.isSelectable(x)?lb(x)?!0:!1:!1});if(a){var e=L._calcHostAnchor(N,G,b,a);$=a,L._nextChangeEdgeHost={type:G,host:a},I=e}}var y;if(!U){var E=L._interactor.getStyle("anchorRound"),T=L._interactor.getStyle("anchorSensitivity");y=Y.calculateAttachPoint($,b),y?I=y.info:(I.x=Bd.roundTo(I.x,E,T),I.y=Bd.roundTo(I.y,E,T))}if(!U){var H=$.getAttachPosition(I.x,I.y,I.offsetX,I.offsetY),B=Bd.toScreenPosition(Y,H);t.x=B.x,t.y=B.y}L._edgeHostGuideInfo={corners:Bd.getTargetCornersOnScreen(Y,$),attach:y?y.index:-1,host:$};var o=""+I.x.toFixed(2)+", "+I.y.toFixed(2);return(I.offsetX||I.offsetY)&&(o+=" offset: "+I.offsetX.toFixed(2)+", "+I.offsetY.toFixed(2)),{host:$,anchor:I,tipText:o}}},Wq.prototype._guidingToEdit=function(h,K){var Q,b,G=this;if(Q=G.screenInfo.curve){b=Q._curves;var g,j,r,w,$,z,q,H,O=1/0,S=1/0,v=[];for(G.editing&&"realPoint"===G.editing.type&&(H=G.editing.point),$=0,z=2*b.length;z>$;$++)q=b[Math.floor($/2)][$%2?"_p4":"_p1"],v.indexOf(q)>=0||(v.push(q),H&&H===q||(r=q.x-h.x,w=q.y-h.y,Math.abs(r)<Math.abs(O)?(O=r,g=[q]):r===O&&g.push(q),Math.abs(w)<Math.abs(S)?(S=w,j=[q]):w===S&&j.push(q)));var T=G._interactor.getStyle("smartGuideSensitivity");if((Math.abs(O)>T||"y"===K)&&(g=null),(Math.abs(S)>T||"x"===K)&&(j=null),g||j){var m=!1,C={};if(g&&(m=!0,C.xList=g,C.x=O),j&&(m=!0,C.yList=j,C.y=S),m)return C}}},Wq.prototype._46O=function(Q){var s=this;s.editing&&(s.editing=null,s._interactor.fi({kind:"endEditPoint",event:Q})),s._guideInfo=null,s._edgeHostGuideInfo=null,s._pan&&(s._pan=null,s._interactor.fi({kind:"endPan",event:Q})),s.tipInfo=null},Wq.prototype._canDeletePoint=function($,K){var A=this.target;if(!(A instanceof I.Edge))return!0;var u=$._curves[0],f=$._curves[$._curves.length-1];
    return u._p1===K||f._p4===K?!1:!0},Wq.prototype.handleDelete=function(){var e=this;if(e.activing&&e.screenInfo){var O=I.Default.isShiftDown(),x=e.screenInfo.curve;e._canDeletePoint(x,e.activing.point)&&x.deleteRealPoint(e.activing.point,O),e.activing.selections&&e.activing.selections.forEach(function(R){e._canDeletePoint(x,R)&&x.deleteRealPoint(R,O)}),e.activing=null,delete e.editing,delete e.tipInfo,delete e._pan,e._writeToHt(),e._interactor.fp("deleteShapePoint",!1,!0)}},Wq.prototype.handleDoubleClick=function(i){var O=this,p=O._interactor._getLogicalPoint(i);if(O.screenInfo&&O._checkEditRealPoint(p)){var U=O.getCurrentSelectintStatus(),y=Bd.Curve.PointType;return U=U===y.Mirrored?y.Straight:y.Mirrored,O._setCurrentSelectionStatus(U),O._interactor._42(),!0}},Wq.prototype._drawHighlight=function(p){var W=this,P=W.highlight;if(P){var q=P.bezier,i=W._interactor;q&&Bd.Icons.DrawIcon(i,p,Bd.Icons.ShapeHighlightCurve,[q._p1.x,q._p1.y,q._p2.x,q._p2.y,q._p3.x,q._p3.y,q._p4.x,q._p4.y]);var f=P.point;f&&"insertKnot"===P.type&&Bd.Icons.DrawIcon(i,p,Bd.Icons.ShapeHighlighPoint,f)}},Wq.prototype._drawGuide=function(n){var W=this,B=W._guideInfo;if(B){var f,o,N,G,A=B.v;for(f=0;2>f;f++)if(G=0===f?B.xList:B.yList)for(o=0,N=G.length;N>o;o++)Bd.Icons.DrawIcon(W._interactor,n,Bd.Icons.ShapeGuideLine,[A.x,A.y,G[o].x,G[o].y])}},Wq.prototype._drawCurrentPoint=function(h){var F=this;if(F.activing){var G=F.activing,l=F.getCurrentSelectintStatus(),C=F._interactor;if(l!==Bd.Curve.PointType.Straight){var U=G.pairs;G.hlpair,G.hltype;var R=G.selections,K=G.editingCtrl;if(U&&!R){var Q,a,x;for(a=0,x=U.length;x>a;a++)Q=U[a],K&&a===K.pairId&&Q[K.type]?Bd.Icons.DrawIcon(C,h,Bd.Icons.ShapeActivingCtrl,{point:Q.point,c1:Q.c1,c2:Q.c2,hl:K.type}):Bd.Icons.DrawIcon(C,h,Bd.Icons.ShapeActivingCtrl,Q)}}Bd.Icons.DrawIcon(C,h,Bd.Icons.ShapeHighlighRealPoint,F.activing.point),R&&R.forEach(function(s){Bd.Icons.DrawIcon(C,h,Bd.Icons.ShapeHighlighRealPoint,s)})}},Wq.prototype.clear=function(){var R=this;R.editing=null,R._guideInfo=null,R.activing=null,R.highlight=null},Wq.prototype._42=function(N){var V=this;V.info={},V.editing||(V.screenInfo=null);var w=V._interactor;if(!w.editDetail)return V.clear(),void 0;var J=w.gv;if(!V.target||!J.isSelected(V.target)||!J.isVisible(V.target))return w.editDetail=!1,V.clear(),void 0;if(V.gatherSingleTarget(J,V.target),Bd.Icons.DrawIcon(w,N,Bd.Icons.ShapeBgCurve,V.screenInfo),V._drawHighlight(N),V._drawCurrentPoint(N),V._getRealPoint().forEach(function(o){Bd.Icons.DrawIcon(w,N,Bd.Icons.ShapePoint,o)}),V._drawGuide(N),V.tipInfo&&Bd.Icons.DrawIcon(w,N,Bd.Icons.TipHelper,V.tipInfo),V._edgeHostGuideInfo){Bd.Icons.DrawIcon(w,N,Bd.Icons.NodeHoverGuide,V._edgeHostGuideInfo.corners);var u=V._edgeHostGuideInfo.host;if(u){var x=J.getAttachPoints(u);if(x&&x.length)for(var t=0,p=x.length;p>t;t++){var $=x[t],r=u.getAttachPosition($.x,$.y,$.offsetX,$.offsetY);r=Bd.toScreenPosition(J,r),r.isAttach=V._edgeHostGuideInfo.attach===t,Bd.Icons.DrawIcon(w,N,Bd.Icons.AttachPoint,r)}}}if(V._interactor.getStyle("curveElevationVisible")&&V.target instanceof I.Polyline&&V.activing){var j=V.activing.getCurrentEditingPoint();j&&Bd.Icons.DrawIcon(w,N,Bd.Icons.EdgeElevationGuide,j)}},Wq.prototype._getRealPoint=function(){var D,l=this.screenInfo,V=l.P,U=l.S,N=-1,e=[],m=-1,q=U.length;return U.each(function(K){m++;var i=1;if(3===K)i=2;else if(4===K)i=3;else if(5===K)return;N+=i,D=m+1>=q?!0:1===U.get(m+1)?!0:!1,e.push({point:{x:V[2*N],y:V[2*N+1]},segmentIndex:m,pointIndex:N,isEnd:D})}),e},Wq.prototype.getEditingPointsInfo=function(L){var b=this,t=b.activing;if(!t)return!1;var M=t.point;if(!M)return!1;var q=this._getRealPoint(),v=[{screen:M}];t.selections&&t.selections.forEach(function(J){v.push({screen:J})});var X,E,W=q.length;return v.forEach(function(A){for(X=0;W>X;X++)if(E=q[X],A.screen.isNearEnough(E.point)){A.segmentIndex=E.segmentIndex,A.pointIndex=E.pointIndex,A.point=b.target.getPoints().get(E.pointIndex);break}}),L&&v.sort(function(l,P){return l.segmentIndex-P.segmentIndex}),v};var Fn=Bd.MoveHelper=function(k){var G=this;G.catalog="Move",G._interactor=k};Fn.prototype={},Fn.prototype.constructor=Fn,Fn.prototype.calcShift=function(o,s,F){var h,Q,j=this,r=j._interactor.gv,K=r.lp(s);if("beginMove"===o&&j._gatherGridInfo(F._lastLogicalPoint||K),h=j._target){var i=h.downPosition;if(i){var O=j._interactor.getStyle("moveSensitivity")/r._zoom;if(i.distanceTo(K)<O)return{x:0,y:0};delete h.downPosition}var b;Q=I.Default.isShiftDown(s),Q&&(K=j._dealShiftDown(K),b=h.shiftGuide.dir);var z,X=h.rawPos={x:h.pos.x+K.x-h.lp.x,y:h.pos.y+K.y-h.lp.y};if(I.Default.isCtrlDown(s)){if(z=j._calcShiftByAddon(),j._target.node instanceof Bd.Group){var N=j._target.node;N._position.x+=z.x,N._position.y+=z.y}return z}for(var L,l=h.x+X.x,B=h.y+X.y,e={x:l,y:B},n={x:l+h.w/2,y:B+h.h/2},m={x:l+h.w,y:B+h.h},q=j._interactor.rectGuide,d=j._interactor.gridGuide,U=[q.findClosest(e,b),q.findClosest(n,b),q.findClosest(m,b),d.findClosest(e,b),d.findClosest(n,b),d.findClosest(m,b)],T=1/0,D=1/0,u=0,V=U.length;V>u;u++)L=U[u],L&&(l=L.x,B=L.y,isFinite(l)&&Math.abs(l)<Math.abs(T)&&(T=l),isFinite(B)&&Math.abs(B)<Math.abs(D)&&(D=B));if(isFinite(T)||(T=0),isFinite(D)||(D=0),z=j._calcShiftByAddon(T,D),j._target.node instanceof Bd.Group){var N=j._target.node;N._position.x+=z.x,N._position.y+=z.y}var M=h.node;if(!Rm(M,r)){var S=X.x+T,A=X.y+D;j._interactor.rectGuide.gatherLines({node:M,x:h.x+S,y:h.y+A,w:h.w,h:h.h},b)}return z}},Fn.prototype._calcShiftByAddon=function(V,y){var R=this._target,W=R.rawPos,t=R.node.getPosition();return V=V||0,y=y||0,{x:W.x-t.x+V,y:W.y-t.y+y}},Fn.prototype._dealShiftDown=function(e){var o=this,G=o._target.shiftGuide,g=o._target.lp,Z=Math.abs(e.x-g.x),k=Math.abs(e.y-g.y);Z>k&&Z>G.limit&&"y"===G.dir&&(G.dir="x"),k>Z&&k>G.limit&&"x"===G.dir&&(G.dir="y");var T=G.dir;return"x"===T?(e.y=g.y,G.limit=Math.max(G.limit,Z)):"y"===T&&(e.x=g.x,G.limit=Math.max(G.limit,k)),e},Fn.prototype._gatherGridInfo=function(Z){var h,R=this,m=R._interactor,Q=m._getValidSelection();if(Q.length){if(1===Q.length){if(h=Q[0],!h.getRect)return R._target=null,void 0}else if(h=Bd.Group.findOrCreateGroup(Q),!h)return R._target=null,void 0}else{var Q=m.gv.sm().getSelection();if(Q.length&&(h=Q.get(0),!h.getRect))return R._target=null,void 0}var z=h.getPosition(),n=h.getRect();R._target={node:h,x:n.x-z.x,y:n.y-z.y,w:n.width,h:n.height,lp:{x:Z.x,y:Z.y},pos:{x:z.x,y:z.y},shiftGuide:{dir:"x",limit:0},downPosition:new Bd.Math.Vector2(Z)},m.rectGuide.gatherRects()},Fn.prototype.clear=function(){var P=this;P._interactor.rectGuide.clear(),P._interactor._42()};var _m="directional",Wf="point",mg="spot",yp="light.color",of=function(J,V){Kl(V)&&Pd.test(V)?ie(J,V):sk(V)&&V.modelType?ci(J,V):Vc[J]=V},Jr=function(b){if(sk(b))return b.modelType?b.uuid?Vc[b.uuid]:(b.uuid=I.Math.generateUUID(),ci(b.uuid,b),r):b;var p=Vc[b];return b&&p===r&&Pd.test(b)&&(Co&&Co[b]||ie(b,b)),p},os=function(J,o){J.frameStack?J.frameStack.push(o):J.frameStack=[o],J.bindFramebuffer(J.FRAMEBUFFER,o)},Sk=function(f){var n=f.frameStack;if(n){if(n.pop(),n.length)return f.bindFramebuffer(f.FRAMEBUFFER,n[n.length-1]),void 0;f.frameStack=null}f.bindFramebuffer(f.FRAMEBUFFER,null)};Kk(l,{graph3dViewAttributes:s,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:M/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:di,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:M/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:of,getShape3dModel:Jr,createMatrix:function(T,o){xd(T)||(T=[T]);for(var I=T.length-1;I>=0;I--){var i=T[I];o=zc(i.mat,i.s3,i.r3,i.rotationMode,i.t3,o)}return o},transformVec:function(m,g){return Zk(m,g)},glBindFrame:os,glUnbindFrame:Sk,createBoxModel:function(){return{vs:zk,ns:Mj,uv:Sq,is:Kf}},createRoundRectModel:function(l,P){return Yd.roundRect(l,P)},createStarModel:function(C,W){return Yd.star(C,W)},createRectModel:function(n,v){return Yd.rect(n,v)},createTriangleModel:function(B,X){return Yd.triangle(B,X)},createRightTriangleModel:function(P,L){return Yd.rightTriangle(P,L)},createParallelogramModel:function(i,m){return Yd.parallelogram(i,m)},createTrapezoidModel:function(P,Z){return Yd.trapezoid(P,Z)},createSmoothSphereModel:function(D,Z,p,M,v,W,J){return Oi(new zn(D,Z,p,M,v,W,J))},createSphereModel:function(E,$,P,Y,L,g){return E?Zq(E,$,P,Y,L,g):l.createSmoothSphereModel()},createSmoothConeModel:function(A,R,V,G,N){return Ni(A,R,V,G,N)},createConeModel:function(z,u,j,H,L,E){return z?$l(z,u,j,H,L,E):Ni(E)},createSmoothCylinderModel:function(h,f,T,F,B,C,e,Y){return Oi(new gk(h,f,T,F,B,C,e,Y))},createCylinderModel:function(h,z,D,r,E,m,C){return h?Dr(h,z,D,r,E,m,C):ji(m,C)},createSmoothTorusModel:function(H,_,V,q,o,e){return Oi(new mn(H,_,V,q,o,e))},createTorusModel:function(s,C,T,H,k,E,t){return s?uf(s,C,T,H,k,E,t):Ko(E,t)},createExtrusionModel:function(O,X,J,H,g,b,z,Z){return Po(O,X,J,H,g,b,z,Z)},createSmoothRingModel:function(l,Y,E,M,V,q){for(var o=[],s=0;s<l.length-1;s+=2)o.push({x:l[s],y:l[s+1]});for(l=Wp(o,Y,E)[0],o=[],s=0;s<l.length;s++){var $=l[s];o.push(new Cs($.x,0,$.y))}return Oi(new tl(o,q,M,V))},createTextGeometry:function(y,m){return Oi(new Qi(y,m))},loadFontFace:function(W,B){l.xhrLoad(W,function(t){if(!t)return B();var k;try{k=JSON.parse(t)}catch(T){k=JSON.parse(t.substring(65,t.length-2))}Jh.loadFace(k),B&&B(k.familyName.toLowerCase())},B?null:{sync:!0})},createRingModel:function(B,Q,u,e,p,F,h,t,v,a){for(var M=[],y=0;y<B.length-1;y+=2)M.push({x:B[y],y:B[y+1]});F=F||l.shapeSide,h=h||0,t=t||F;var I,U,g,q,Z,d,N,S,W,r,y,k,i,G,$,z,C,o,V=[],A=[],f=v?[]:s,P=v?[]:s,c=a?[]:s,m=a?[]:s,X=e?[]:s,T=e?[]:s,J=p?[]:s,D=p?[]:s,B=Wp(M,Q,u),L=Rl(B),H=0,O=2*Math.PI/F;return B.forEach(function(_){if(g=_.length,g>1){if(q=_[0],e)for(d=q.x,S=q.y,y=h;t>y;y++)k=y+1,i=y*O,G=k*O,$=b(i),z=w(i),C=b(G),o=w(G),X.push($*d,S,-z*d,C*d,S,-o*d,0,S,0),T.push(.5-.5*$,.5-.5*z,.5-.5*C,.5-.5*o,.5,.5);for(r=0;g>r;r++){for(Z=_[r],d=q.x,N=Z.x,S=q.y,W=Z.y,I=H/L,H+=Bg(q,Z),U=H/L,y=h;t>y;y++)k=y+1,i=y*O,G=k*O,$=b(i),z=w(i),C=b(G),o=w(G),V.push($*N,W,-z*N,C*N,W,-o*N,$*d,S,-z*d,C*N,W,-o*N,C*d,S,-o*d,$*d,S,-z*d),A.push(y/F,U,k/F,U,y/F,I,k/F,U,k/F,I,y/F,I),v&&y===h&&(f.push(0,S,0,0,W,0,$*N,W,-z*N,$*N,W,-z*N,$*d,S,-z*d,0,S,0),P.push(0,.5-S,0,.5-W,2*N,.5-W,2*N,.5-W,2*d,.5-S,0,.5-S)),a&&k===t&&(c.push(0,S,0,C*N,W,-o*N,0,W,0,C*N,W,-o*N,0,S,0,C*d,S,-o*d),m.push(1,.5-S,1-2*N,.5-W,1,.5-W,1-2*N,.5-W,1,.5-S,1-2*d,.5-S));q=Z}if(p)for(d=q.x,S=q.y,y=h;t>y;y++)k=y+1,i=y*O,G=k*O,$=b(i),z=w(i),C=b(G),o=w(G),J.push(C*d,S,-o*d,$*d,S,-z*d,0,S,0),D.push(.5-.5*C,.5+.5*o,.5-.5*$,.5+.5*z,.5,.5)}}),{vs:V,uv:A,bottom_vs:J,bottom_uv:D,top_vs:X,top_uv:T,from_vs:f,from_uv:P,to_vs:c,to_uv:m}}},!0),Kk(g,{"3d.move.mode":r,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":r,"edge.gradient.color":r,"edge.source.t3":r,"edge.target.t3":r,"light.type":Wf,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":M/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Rd,"wf.short":!1,"wf.mat":r,"wf.geometry":!1,batch:r,"transparent.mask":!1,brightness:r,"select.brightness":.7,"repeat.uv.length":r,alphaTest:.4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":pg,"label.t3":r,"label.r3":r,"label.texture.scale":2,"label.rotationMode":Wk,"label.light":!1,"label.blend":r,"label.reverse.flip":!1,"label.reverse.color":hh,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":pg,"label2.t3":r,"label2.r3":r,"label2.texture.scale":2,"label2.rotationMode":Wk,"label2.light":!1,"label2.blend":r,"label2.reverse.flip":!1,"label2.reverse.color":hh,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":pg,"note.t3":r,"note.r3":r,"note.texture.scale":2,"note.rotationMode":Wk,"note.light":!1,"note.blend":r,"note.reverse.flip":!1,"note.reverse.color":hh,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":pg,"note2.t3":r,"note2.r3":r,"note2.texture.scale":2,"note2.rotationMode":Wk,"note2.light":!1,"note2.blend":r,"note2.reverse.flip":!1,"note2.reverse.color":hh,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:r,"shape3d.color":$i,"shape3d.top.color":r,"shape3d.bottom.color":r,"shape3d.from.color":r,"shape3d.to.color":r,"shape3d.image":r,"shape3d.top.image":r,"shape3d.bottom.image":r,"shape3d.from.image":r,"shape3d.to.image":r,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":r,"shape3d.side.to":r,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":r,"shape3d.opacity":r,"shape3d.reverse.flip":!1,"shape3d.reverse.color":hh,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":r,"shape3d.uv.scale":r,"shape3d.top.uv.offset":r,"shape3d.top.uv.scale":r,"shape3d.bottom.uv.offset":r,"shape3d.bottom.uv.scale":r,"shape3d.from.uv.offset":r,"shape3d.from.uv.scale":r,"shape3d.to.uv.offset":r,"shape3d.to.uv.scale":r,"shape3d.top.cap":r,"shape3d.bottom.cap":r,"shape3d.start.angle":0,"shape3d.sweep.angle":p,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":r,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":$i,"all.image":r,"all.blend":r,"all.opacity":r,"all.reverse.flip":!1,"all.reverse.color":hh,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":r,"all.uv.offset":r,"all.uv.scale":r,"all.discard.selectable":!0,mat:r,"left.mat":r,"right.mat":r,"top.mat":r,"bottom.mat":r,"front.mat":r,"back.mat":r},!0);var Tl,On=!1,Bf=[0,0,0,0],Ep={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Ih,2:Go,3:ns,4:cj,5:pg,6:Pm}},Gm=function(d,g,X,H){if(g.getFaceVisible(d,X)){zm(g,yh(d,g.getFaceMat(d,X)||g.getMat(d)));var j=g._26I;g.getFaceReverseCull(d,X)?j.enable(j.CULL_FACE):j.disable(j.CULL_FACE),Xc(j,g._prg.uFixPickReverseColor,Ep[X]),Wd(j),Xo(j,H,6),Sr(j),ir(g)}},Mh=function(S){return S instanceof kr},hi=function(s){return[s.x,s.e||0,s.y]},ph=function(A,q,T){for(var q=oj(q),m=q[0],h=q[1],W=q[2];T--;)A.push(m,h,W)},yf=function(T,a,F){for(var a=oj(a),m=a[0],O=a[1],_=a[2],o=a[3];F--;)T.push(m,O,_,o)},jn=function(F,m,c){if(m)for(var S,O,A,L=m[0],$=m[1],C=m[2],n=m[4],w=m[5],u=m[6],D=m[8],V=m[9],_=m[10],X=m[12],g=m[13],K=m[14],Q=c.length,k=0,k=0;Q>k;k+=3)S=c[k],O=c[k+1],A=c[k+2],F.push(L*S+n*O+D*A+X,$*S+w*O+V*A+g,C*S+u*O+_*A+K);else ff(F,c)},Di=function(I,Y){var E=Y.s("light.intensity"),F=oj(Y.s(yp)),C=F[0],Q=F[1],b=F[2];1!==E&&(C*=E,Q*=E,b*=E),I.push(C,Q,b,Y.s("light.disabled")?1:0)},jo=function(v,F,f){Xc(F,f.uHeadlightRange,v._headlightRange);var $=v._headlightIntensity,J=oj(v._headlightColor);1!==$&&(J=[J[0]*$,J[1]*$,J[2]*$]),Xc(F,f.uHeadlightColor,[J[0],J[1],J[2],v._headlightDisabled?1:0]);var C=v._59O,G=v._spots,X=v._dirs;if(C.length){var d=[],g=[],e=[];C.forEach(function(F){Di(d,F),ff(g,v._transformPointToViewSpace(F.p3())),e.push(F.s("light.range"))}),F.uniform4fv(f.uPointColor,d),F.uniform1fv(f.uPointRange,e),F.uniform3fv(f.uPointPosition,g)}if(G.length){var z=[],U=[],R=[],V=[],H=[],t=[];G.forEach(function(n){Di(z,n),ff(U,v._transformPointToViewSpace(n.p3())),ff(H,v._transformDirectionToViewSpace(n.p3(),n.s("light.center"))),R.push(n.s("light.range")),V.push(b(n.s("light.angle")/2)),t.push(n.s("light.exponent"))}),F.uniform4fv(f.uSpotColor,z),F.uniform1fv(f.uSpotRange,R),F.uniform1fv(f.uSpotAngle,V),F.uniform1fv(f.uSpotExponent,t),F.uniform3fv(f.uSpotPosition,U),F.uniform3fv(f.uSpotDirection,H)}if(X.length){var T=[],I=[];X.forEach(function(N){Di(T,N),ff(I,v._transformDirectionToViewSpace(N.p3()))}),F.uniform4fv(f.uDirColor,T),F.uniform3fv(f.uDirDirection,I)}},Zn=function(r){return r>0&&0===(r-1&r)},Id=function(q){return q=t(0,$(M,q)),q=t(Bi,$(M-Bi,q))},xr=function(){return.05+_()/2},_h=function(g,n,J,U){var O,P=g.getEye();return g.isOrtho()?(O=tn(g.getCenter(),P),O[0]+=U[0],O[1]+=U[1],O[2]+=U[2]):O=P,Aq(n,J,U,O)},Aq=function(d,X,T,q){var L=pk(d,X),D=tn(q,T,!0),K=pk(D,X);if(P(K)<Bi)return s;var o=(L-pk(T,X))/K;return[T[0]+D[0]*o,T[1]+D[1]*o,T[2]+D[2]*o]},ts=function(s,H){return{x:2*s.x-H.x,y:2*s.y-H.y}},Jo=function(N,E,s,u){var $,H;if(!N)return $=Z(E.y-s.y,s.x-E.x),{x:E.x+u*w($),y:E.y+u*b($)};if(!s)return $=Z(N.y-E.y,E.x-N.x),{x:E.x+u*w($),y:E.y+u*b($)};var C=tn([N.x,N.y,0],[E.x,E.y,0],!0),o=tn([s.x,s.y,0],[E.x,E.y,0],!0),f=-(C[0]+o[0])/2,D=-(C[1]+o[1])/2,X=W(f*f+D*D);if(Bi>X)return $=Z(N.y-E.y,E.x-N.x),{x:E.x+u*w($),y:E.y+u*b($)};var m=N.x-E.x,p=N.y-E.y,G=s.x-E.x,K=s.y-E.y,U=W(m*m+p*p),j=W(G*G+K*K);$=T(pk(C,o))/2,H=C[1]*o[0]-C[0]*o[1]>0?-1:1,f/=X,D/=X;var h=u/w($),k=t(U,j)/b($);X=Math.min(h,k);var Q={x:E.x+H*X*f,y:E.y+H*X*D};return s.b&&h>j/b($)&&(Q.adjust=!0),Q},vf=function(R){var q=R[1],v=R[2],K=R[3],V=R[6],p=R[7],A=R[11];R[1]=R[4],R[2]=R[8],R[3]=R[12],R[4]=q,R[6]=R[9],R[7]=R[13],R[8]=v,R[9]=V,R[11]=R[14],R[12]=K,R[13]=p,R[14]=A},ls=function(O){var K=O[0],i=O[1],r=O[2],W=O[3],c=O[4],m=O[5],z=O[6],b=O[7],N=O[8],n=O[9],L=O[10],d=O[11],j=O[12],g=O[13],X=O[14],u=O[15],v=K*m-i*c,R=K*z-r*c,p=K*b-W*c,P=i*z-r*m,S=i*b-W*m,k=r*b-W*z,T=N*g-n*j,o=N*X-L*j,Z=N*u-d*j,A=n*X-L*g,f=n*u-d*g,x=L*u-d*X,Q=v*x-R*f+p*A+P*Z-S*o+k*T;return Q?(Q=1/Q,O[0]=(m*x-z*f+b*A)*Q,O[1]=(r*f-i*x-W*A)*Q,O[2]=(g*k-X*S+u*P)*Q,O[3]=(L*S-n*k-d*P)*Q,O[4]=(z*Z-c*x-b*o)*Q,O[5]=(K*x-r*Z+W*o)*Q,O[6]=(X*p-j*k-u*R)*Q,O[7]=(N*k-L*p+d*R)*Q,O[8]=(c*f-m*Z+b*T)*Q,O[9]=(i*Z-K*f-W*T)*Q,O[10]=(j*S-g*p+u*v)*Q,O[11]=(n*p-N*S-d*v)*Q,O[12]=(m*o-c*A-z*T)*Q,O[13]=(K*A-i*o+r*T)*Q,O[14]=(g*R-j*P-X*v)*Q,O[15]=(N*P-n*R+L*v)*Q,void 0):s},qi=function(U,q){if(q){var T=q[0],d=q[1],w=q[2];U[12]=U[0]*T+U[4]*d+U[8]*w+U[12],U[13]=U[1]*T+U[5]*d+U[9]*w+U[13],U[14]=U[2]*T+U[6]*d+U[10]*w+U[14],U[15]=U[3]*T+U[7]*d+U[11]*w+U[15]}},kf=function(w,v){if(v){var c=v[0],K=v[1],M=v[2];w[0]=w[0]*c,w[1]=w[1]*c,w[2]=w[2]*c,w[3]=w[3]*c,w[4]=w[4]*K,w[5]=w[5]*K,w[6]=w[6]*K,w[7]=w[7]*K,w[8]=w[8]*M,w[9]=w[9]*M,w[10]=w[10]*M,w[11]=w[11]*M}},fq=function(U,K,Q){var j=K[0],A=K[1],H=K[2],r=K[3],R=K[4],i=K[5],P=K[6],b=K[7],s=K[8],t=K[9],g=K[10],c=K[11],w=K[12],v=K[13],a=K[14],Z=K[15],f=Q[0],B=Q[1],e=Q[2],N=Q[3];return U[0]=f*j+B*R+e*s+N*w,U[1]=f*A+B*i+e*t+N*v,U[2]=f*H+B*P+e*g+N*a,U[3]=f*r+B*b+e*c+N*Z,f=Q[4],B=Q[5],e=Q[6],N=Q[7],U[4]=f*j+B*R+e*s+N*w,U[5]=f*A+B*i+e*t+N*v,U[6]=f*H+B*P+e*g+N*a,U[7]=f*r+B*b+e*c+N*Z,f=Q[8],B=Q[9],e=Q[10],N=Q[11],U[8]=f*j+B*R+e*s+N*w,U[9]=f*A+B*i+e*t+N*v,U[10]=f*H+B*P+e*g+N*a,U[11]=f*r+B*b+e*c+N*Z,f=Q[12],B=Q[13],e=Q[14],N=Q[15],U[12]=f*j+B*R+e*s+N*w,U[13]=f*A+B*i+e*t+N*v,U[14]=f*H+B*P+e*g+N*a,U[15]=f*r+B*b+e*c+N*Z,U},lk=function(B,k,r,J){var v,I,c,m,E,Q,A,N,U,u,w=k[0],h=k[1],e=k[2],Z=J[0],D=J[1],_=J[2],z=r[0],S=r[1],F=r[2];return P(w-z)<Bi&&P(h-S)<Bi&&P(e-F)<Bi?ro(B):(A=w-z,N=h-S,U=e-F,u=1/W(A*A+N*N+U*U),A*=u,N*=u,U*=u,v=D*U-_*N,I=_*A-Z*U,c=Z*N-D*A,u=W(v*v+I*I+c*c),u?(u=1/u,v*=u,I*=u,c*=u):(v=0,I=0,c=0),m=N*c-U*I,E=U*v-A*c,Q=A*I-N*v,u=W(m*m+E*E+Q*Q),u?(u=1/u,m*=u,E*=u,Q*=u):(m=0,E=0,Q=0),B[0]=v,B[1]=m,B[2]=A,B[3]=0,B[4]=I,B[5]=E,B[6]=N,B[7]=0,B[8]=c,B[9]=Q,B[10]=U,B[11]=0,B[12]=-(v*w+I*h+c*e),B[13]=-(m*w+E*h+Q*e),B[14]=-(A*w+N*h+U*e),B[15]=1,B)},Df=function(o,g,I,F,T){var A=1/x(g/2),h=1/(F-T);return o[0]=A/I,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=A,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(T+F)*h,o[11]=-1,o[12]=0,o[13]=0,o[14]=2*T*F*h,o[15]=0,o},Wm=function(S,s,o,W,j,z,m){var g=1/(s-o),T=1/(W-j),$=1/(z-m);return S[0]=-2*g,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=-2*T,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[10]=2*$,S[11]=0,S[12]=(s+o)*g,S[13]=(j+W)*T,S[14]=(m+z)*$,S[15]=1,S},Mf=function(R,d){var S=d[0],N=d[1],W=d[2],U=d[3],Z=S*S+N*N+W*W+U*U,G=Z?1/Z:0;return R[0]=-S*G,R[1]=-N*G,R[2]=-W*G,R[3]=U*G,R},df=function(z,A){var X=A[0]+A[5]+A[10],l=0;return X>0?(l=2*Math.sqrt(X+1),z[3]=.25*l,z[0]=(A[6]-A[9])/l,z[1]=(A[8]-A[2])/l,z[2]=(A[1]-A[4])/l):A[0]>A[5]&A[0]>A[10]?(l=2*Math.sqrt(1+A[0]-A[5]-A[10]),z[3]=(A[6]-A[9])/l,z[0]=.25*l,z[1]=(A[1]+A[4])/l,z[2]=(A[8]+A[2])/l):A[5]>A[10]?(l=2*Math.sqrt(1+A[5]-A[0]-A[10]),z[3]=(A[8]-A[2])/l,z[0]=(A[1]+A[4])/l,z[1]=.25*l,z[2]=(A[6]+A[9])/l):(l=2*Math.sqrt(1+A[10]-A[0]-A[5]),z[3]=(A[1]-A[4])/l,z[0]=(A[8]+A[2])/l,z[1]=(A[6]+A[9])/l,z[2]=.25*l),z},Zh=function($,C,s){var h=C[0],b=C[1],V=C[2],Y=C[3],F=h+h,N=b+b,Q=V+V,c=h*F,k=h*N,o=h*Q,U=b*N,Z=b*Q,E=V*Q,H=Y*F,v=Y*N,S=Y*Q;return $[0]=1-(U+E),$[1]=k+S,$[2]=o-v,$[3]=0,$[4]=k-S,$[5]=1-(c+E),$[6]=Z+H,$[7]=0,$[8]=o+v,$[9]=Z-H,$[10]=1-(c+U),$[11]=0,$[12]=s[0],$[13]=s[1],$[14]=s[2],$[15]=1,$},Jg=function(){var R=[0,0,0],i=[0,0,0],T=[0,0,0],p=function(P,R,Q){P[0]=R[1]*Q[2]-R[2]*Q[1],P[1]=R[2]*Q[0]-R[0]*Q[2],P[2]=R[0]*Q[1]-R[1]*Q[0]},s=function(C){return C[0]*C[0]+C[1]*C[1]+C[2]*C[2]},u=function(m){var K=Math.sqrt(s(m));m[0]/=K,m[1]/=K,m[2]/=K},H=function(z,u,o){z[0]=u[0]-o[0],z[1]=u[1]-o[1],z[2]=u[2]-o[2]};return function(F,W,j){var x=Rp();return H(T,F,W),0===s(T)&&(T[2]=1),u(T),p(R,j,T),0===s(R)&&(1===Math.abs(j[2])?T[0]+=1e-4:T[2]+=1e-4,u(T),p(R,j,T)),u(R),p(i,T,R),x[0]=R[0],x[4]=i[0],x[8]=T[0],x[1]=R[1],x[5]=i[1],x[9]=T[1],x[2]=R[2],x[6]=i[2],x[10]=T[2],x}}(),kc=function(T,U){if(T.vr.enable){var Z=T.vr.getViewMatrix(U);if(Z)return Z}return lk(U?U:Rp(),T._eye,T._center,T._up)},Pf=function(F){if(F.vr.enable){var $=F.vr.getProjectMatrix();if($)return $}var I=F.getAspect(),C=F._near,n=F._far,s=Rp();if(F._ortho){var Z=F._orthoWidth/2,U=Z/I;Wm(s,-Z,Z,-U,U,C,n)}else Df(s,F._fovy,I,C,n);return s},bg=function(D,U){if(!D)return s;var I=0,C=1,c=2,n=[],J=0,E=D.length,K=E/3;if(U){for(;E>J;J++)n[J]=0;for(J=0;J<U.length;J+=3){var h=[],o=[],O=[];h[I]=D[3*U[J+1]+I]-D[3*U[J]+I],h[C]=D[3*U[J+1]+C]-D[3*U[J]+C],h[c]=D[3*U[J+1]+c]-D[3*U[J]+c],o[I]=D[3*U[J+2]+I]-D[3*U[J+1]+I],o[C]=D[3*U[J+2]+C]-D[3*U[J+1]+C],o[c]=D[3*U[J+2]+c]-D[3*U[J+1]+c],O[I]=h[C]*o[c]-h[c]*o[C],O[C]=h[c]*o[I]-h[I]*o[c],O[c]=h[I]*o[C]-h[C]*o[I];for(var X=0;3>X;X++)n[3*U[J+X]+I]+=O[I],n[3*U[J+X]+C]+=O[C],n[3*U[J+X]+c]+=O[c]}}else for(J=0;K>J;J+=3){var h=[],o=[],O=[];h[I]=D[3*(J+1)+I]-D[3*J+I],h[C]=D[3*(J+1)+C]-D[3*J+C],h[c]=D[3*(J+1)+c]-D[3*J+c],o[I]=D[3*(J+2)+I]-D[3*(J+1)+I],o[C]=D[3*(J+2)+C]-D[3*(J+1)+C],o[c]=D[3*(J+2)+c]-D[3*(J+1)+c],O[I]=h[C]*o[c]-h[c]*o[C],O[C]=h[c]*o[I]-h[I]*o[c],O[c]=h[I]*o[C]-h[C]*o[I];for(var X=0;3>X;X++)n[3*(J+X)+I]=O[I],n[3*(J+X)+C]=O[C],n[3*(J+X)+c]=O[c]}for(J=0;E>J;J+=3){var Y=[];Y[I]=n[J+I],Y[C]=n[J+C],Y[c]=n[J+c];var T=W(Y[I]*Y[I]+Y[C]*Y[C]+Y[c]*Y[c]);0===T&&(T=Bi),Y[I]=Y[I]/T,Y[C]=Y[C]/T,Y[c]=Y[c]/T,n[J+I]=Y[I],n[J+C]=Y[C],n[J+c]=Y[c]}return new hk(n)},gi=function(z,M,$,V){if($||($=z.createTexture()),M){var W=z.TEXTURE_2D,q=z.REPEAT,x=z.CLAMP_TO_EDGE,h=z.TEXTURE_MIN_FILTER;V!==z.NEAREST&&(V=z.LINEAR),hr(z,$),z.texImage2D(W,0,z.RGBA,z.RGBA,z.UNSIGNED_BYTE,M),mc(z,z.TEXTURE_MAG_FILTER,V);var D=M.naturalWidth||M.width,g=M.naturalHeight||M.height;Zn(D)&&Zn(g)&&!M.clampToEdge?(mc(z,z.TEXTURE_WRAP_S,q),mc(z,z.TEXTURE_WRAP_T,q),mc(z,h,z.LINEAR_MIPMAP_LINEAR),z.generateMipmap(W)):(mc(z,z.TEXTURE_WRAP_S,x),mc(z,z.TEXTURE_WRAP_T,x),mc(z,h,V)),hr(z,s)}return $},fe=function(U,q){var V=new Uint8Array(4);return q=q||U.createTexture(),hr(U,q),mc(U,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texImage2D(U.TEXTURE_2D,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,V),q},eo=function(k){k._26I&&k._prg&&(k._26I.deleteProgram(k._prg),k._prg=s)},Mr=function(b,G,s,i){var g=b.createShader(s);return b.shaderSource(g,i),b.compileShader(g),b.attachShader(G,g),g},af=function(e){return e.createBuffer()},hr=function(k,z){k.bindTexture(k.TEXTURE_2D,z)},mc=function(O,o,p){O.texParameteri(O.TEXTURE_2D,o,p)},Pg=function(W,s){W.enable(W.POLYGON_OFFSET_FILL),W.polygonOffset(s[0],s[1])},yj=function(Z){Z.disable(Z.POLYGON_OFFSET_FILL)},cs=function(J,R){if(R){var R=oj(R);J.clearColor(R[0],R[1],R[2],R[3])}},Qq=function(d,m){Xc(d,m.uFix,!0),bf(d,m.aNormal)},Jn=function(j,v){Xc(j,v.uFix,!1),Cf(j,v.aNormal)},yi=function(M,V,b,I,q,N,Y,C){M._picking||(b?(Xc(M,V.uBlend,!0),Xc(M,V.uBlendColor,b)):Xc(M,V.uBlend,!1),Xc(M,V.uLight,I==s?!0:I),il(q)&&1!==q&&Xc(M,V.uPartOpacity,q),Xc(M,V.uReverseFlip,N==s?!1:N),Xc(M,V.uFixPickReverseColor,Y||hh)),C?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE)},Vi=function(G,V){G._picking||Xc(G,V.uPartOpacity,1)},Wd=function(){var d=[0,0,1,1];return function(v,h,E,w,B,r,X,_,c){return E?(Xc(v,h.uTexture,!0),Xc(v,h.uDiscardSelectable,Xp(w)?w:!0),Cf(v,h.aUv),Hi(v,B,r,h.aUv,2),c?(Xc(v,h.uBlendTexture,!0),v.activeTexture(v.TEXTURE1),hr(v,c),v.uniform1i(h.uBlendSampler,1)):(Xc(v,h.uBlendTexture,!1),v.activeTexture(v.TEXTURE1),hr(v,v._emptyBlendTexture)),v.activeTexture(v.TEXTURE0),hr(v,E),v.uniform1i(h.uSampler,0),X?(d[0]=X[0],d[1]=X[1]):(d[0]=0,d[1]=0),_?(d[2]=_[0],d[3]=_[1]):(d[2]=1,d[3]=1),Xc(v,h.uOffsetScale,d),void 0):(v.activeTexture(v.TEXTURE0),hr(v,v._emptyTexture),v.activeTexture(v.TEXTURE1),hr(v,v._emptyBlendTexture),void 0)}}(),Sr=function(B,z,w){B.activeTexture(B.TEXTURE0),hr(B,s),B.activeTexture(B.TEXTURE1),hr(B,s),w&&(bf(B,z.aUv),Xc(B,z.uTexture,!1),Xc(B,z.uBlendTexture,!1))},pr=function(I,k,m,G,Z,j){!m||N||tc||I.lineWidth(m),G&&!I._picking&&Xc(I,k.uFixPickReverseColor,G),Z&&Hi(I,Z,j,k.aPosition)},we=function(S,N,m,g){Tl&&(g=S[Tl]),S.drawArrays(g==s?S.TRIANGLES:g,N,m);var p=S._renderInfo;p&&(p.calls++,p.vertices+=m,(g==s||g===S.TRIANGLES)&&(p.faces+=m/3),g===S.LINES&&(p.lines+=m/2))},Xo=function(z,E,X,c){Tl&&(c=z[Tl]),z.drawElements(c==s?z.TRIANGLES:c,X,z.UNSIGNED_SHORT,E==s?0:2*E);var w=z._renderInfo;w&&(w.calls++,w.vertices+=X,(c==s||c===z.TRIANGLES)&&(w.faces+=X/3),c===z.LINES&&(w.lines+=X/2))},Hf=function(G,F,P,S,H){var W=G.ARRAY_BUFFER;G.bindBuffer(W,F),P&&G.bufferData(W,P,G.STATIC_DRAW),S!=s&&G.vertexAttribPointer(S,H?H:3,G.FLOAT,!1,0,0)},Hi=function(k,h,I,v,o){return I?(ur(k,k.ARRAY_BUFFER,h,I),v!=s&&k.vertexAttribPointer(v,o?o:3,k.FLOAT,!1,0,0),void 0):Hf(k,h,I,v,o)},Lm=function(m,H,q){var Q=m.ELEMENT_ARRAY_BUFFER;m.bindBuffer(Q,H),q&&m.bufferData(Q,q,m.STATIC_DRAW)},Nq=function(B,G,U){ur(B,B.ELEMENT_ARRAY_BUFFER,G,U)},ur=function(T,J,G,P){var S=P._bufId;S||(S=P._bufId=I.Math.generateIncreasingID());var G,K=T._bufPool;(G=K[S])&&G._buf?T.bindBuffer(J,G._buf):(G=K[S]={_buf:af(T)},T.bindBuffer(J,G._buf),T.bufferData(J,P,T.STATIC_DRAW)),G._fid=T._renderInfo.frame},Xc=function(z,m,Y){if(Y!=s&&m!=s){Y=oj(Y);var g=Y.length;3===g?z.uniform3fv(m,Y):4===g?z.uniform4fv(m,Y):16===g?z.uniformMatrix4fv(m,!1,Y):Xp(Y)?z.uniform1i(m,Y?1:0):2===g?z.uniform2fv(m,Y):z.uniform1f(m,Y)}},Cf=function(u,I){I!=s&&I>=0&&u.enableVertexAttribArray(I)},bf=function(C,w){w!=s&&w>=0&&C.disableVertexAttribArray(w)},ir=function(Q,s){var j=Q.getGL(),a=Q._prg;Q._7O=Q._8O.pop(),s&&(Xc(j,a.uMVMatrix,Q._7O),Q._6O=s,Xc(j,a.uNMatrix,s))},Ie=function(k,Y){return Y||(Y=Rp()),jq(Y,k),ls(Y),vf(Y),Y},zm=function(y,V){var c=y.getGL(),m=y._prg,d=y._7O;V&&(y._8O.push(uk(d)),Xc(c,m.uMMatrix,V),fq(d,d,V),y._7O=d),Xc(c,m.uMVMatrix,d),Xc(c,m.uNMatrix,Ie(d,y._6O))},er=function(S,H,M,D,T,P){if(M){if(D){var F=M.value++,b=2147483648|F,l=[(255&b>>16)/255,(255&b>>8)/255,(255&b)/255,(255&b>>24)/255];M[F]={data:T,part:P}}else l=Bf;return Xc(S,H.uFixPickReverseColor,l),l}},de=function(){var T={center:function(R,W,h,T,o){var O=-W[1]/2,w={x:-W[0]/2,y:O,width:W[0],height:W[1]},g=Rf(R,w,h);return[g.x+T,-g.y-o,xr()]},front:function($,N,H,S,q){var T=-N[1]/2,h={x:-N[0]/2,y:T,width:N[0],height:N[1]},u=Rf($,h,H);return[u.x+S,-u.y-q,N[2]/2+xr()]},back:function(C,S,P,$,V){var l=-S[0]/2,T=-S[1]/2,p={x:l,y:T,width:S[0],height:S[1]},o=Rf(C,p,P);return[-o.x-$,-o.y-V,-S[2]/2-xr()]},left:function(Q,S,b,X,q){var R=-S[1]/2,B={x:-S[2]/2,y:R,width:S[2],height:S[1]},D=Rf(Q,B,b);return[-S[0]/2-xr(),-D.y-q,D.x+X]},right:function(k,Y,d,n,q){var s=-Y[2]/2,$=-Y[1]/2,y={x:s,y:$,width:Y[2],height:Y[1]},F=Rf(k,y,d);return[Y[0]/2+xr(),-F.y-q,-F.x-n]},top:function(P,Y,p,$,R){var G={x:-Y[0]/2,y:-Y[2]/2,width:Y[0],height:Y[2]},B=Rf(P,G,p);return[B.x+$,Y[1]/2+xr(),B.y+R]},bottom:function(N,h,P,H,C){var g=-h[2]/2,c={x:-h[0]/2,y:g,width:h[0],height:h[2]},w=Rf(N,c,P);return[w.x+H,-h[1]/2-xr(),-w.y-C]}};return function(y,H,w,a,N,m){return T[a](y,H,w,N||0,m||0)}}(),ws=function(c,f,z,U,F,O,v,L,s,P){if(F&&(f[0]+=F[0],f[1]+=F[1],f[2]+=F[2]),qi(c,z),L){var y=Rp();if(ti(y,s,P),Zk(f,y),qi(c,f),c.auto=L,c.pos=Zk([0,0,0],c),O){var w=c.mat2=Rp();ti(w,O,v)}}else ti(c,s,P),qi(c,f),U===Ih?vc(c,-S):U===Go?vc(c,S):U===ns?ig(c,-S):U===cj?ig(c,S):U===Pm&&vc(c,M),ti(c,O,v);return c},Nj=function(t,E){var h=E.auto,R=E.mat2,q=t.gv;if(h){var m,C=Rp(),K=[0,0,0,0];m="string"==typeof h?[h.indexOf("x")<0?q._eye[0]:q._center[0],h.indexOf("y")<0?q._eye[1]:q._center[1],h.indexOf("z")<0?q._eye[2]:q._center[2]]:q._eye,df(K,lk(Rp(),m,q._center,q._up)),Zh(C,Mf(K,K),E.pos),R&&fq(C,C,R),zm(q,C)}else zm(q,E)},Pe=function(U,g,H,f,u){var t=U.s,x=U.gv,Q=x.getGL(),E=x._prg,C=x._buffer,h=x._1O;gi(Q,xl,h),Nj(U,H),yi(Q,E,t(g+".blend"),t(g+".light"),t(g+".opacity"),t(g+".reverse.flip"),t(g+".reverse.color"),t(g+".reverse.cull")),Wd(Q,E,h,u,C.uv,fr),Hi(Q,C.vs,f,E.aPosition),Hi(Q,C.ns,Mb,E.aNormal),Nq(Q,C.is,Pn),Xo(Q,0,Pn.length),Sr(Q,E,h),Vi(Q,E),ir(x)},$e=function(J,S,i){var P=J.gv,W=J.data,U=J[S]={blend:P.getBodyColor(W)||P.getFaceBlend(W,S),light:P.getFaceLight(W,S),color:P.getFaceColor(W,S),opacity:P.getFaceOpacity(W,S),transparent:P.getFaceTransparent(W,S),reverseFlip:P.getFaceReverseFlip(W,S),reverseColor:P.getFaceReverseColor(W,S),reverseCull:P.getFaceReverseCull(W,S),texture:P.getFaceImage(W,S),blendTexture:P.getFaceBlendImage(W,S),discardSelectable:P.getFaceDiscardSelectable(W,S)};if("csg"!==S){U.uv=P.getFaceUv(W,S)||i&&i[S+"Uv"],U.uvScale=P.getFaceUvScale(W,S)||i&&i[S+"UvScale"],U.uvOffset=P.getFaceUvOffset(W,S)||i&&i[S+"UvOffset"];var B=P.getFaceMat(W,S);B&&(U.mat=yh(W,B))}return U},vj=function(H,s,f,E,K){if(E){if(!K(E.transparent))return;var x=H.data,X=H.gv,r=X._buffer,v=X.getTexture(E.texture,x),y=X.getTexture(E.blendTexture,x);Wd(s,f,v,E.discardSelectable,r.uv,E.tuv,E.uvOffset,E.uvScale,y),yi(s,f,E.blend,E.light,E.opacity,E.reverseFlip,E.reverseColor,E.reverseCull),Xc(s,f.uDiffuse,E.color||g["color.empty"]),Hi(s,r.vs,E.vs,f.aPosition),Hi(s,r.ns,E.ns,f.aNormal),we(s,0,E.vs.length/3),Vi(s,f),Sr(s,f,v)}},Hp=function(H,$,R,o,h,s){var T,E,Q,i,f,V,r,B,y,M,C,P=[o-$,h-R],W=H?H.length:0;for(Q=0;W>Q;Q++){for(i=2,T=H[Q],f=T[0],V=T[1];i+1<T.length;){if(r=T[i],B=T[i+1],E=me($,R,o,h,f,V,r,B,!0)){y=[r-f,B-V],M=Bg(y),y[0]/=M,y[1]/=M,M=pk(P,y),M=M>0?s:-s,C=[y[0]*M,y[1]*M];break}f=r,V=B,i+=2}if(C)break}if(C)for(o=$+C[0],h=R+C[1],Q=0;W>Q;Q++)for(i=2,T=H[Q],f=T[0],V=T[1];i+1<T.length;){if(r=T[i],B=T[i+1],E=me($,R,o,h,f,V,r,B,!0))return[0,0];f=r,V=B,i+=2}return C?C:[o-$,h-R]},xn=I.graph3d={},Gr=function(e,I,k){Op(C+".graph3d."+e,I,k)},zb="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Pj="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
    Kk(l,{setBatchInfo:function(d,A){mm[d]=A},getBatchInfo:function(y){return mm[y]}},!0);var gd=[1,1,1],Om=[1,0,0,0,0,1,0,1,1,1,1,0],lh=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],$r=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Qe=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Wh=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],uh=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Gb=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],$g=function(n,U){nq(n,U,"_batchModelMap","_batchIndexMap"),ac(n,U,"_wireframeModelMap","_wireframeIndexMap"),ac(n,U,"_polylineModelMap","_polylineIndexMap"),ac(n,U,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),ac(n,U,"_polylineModelMapSwap","_polylineIndexMapSwap")},nq=function(l,P,r,n){if(!P)return l[r]={},l[n]={},void 0;var _=P._id,Y=l[n],H=Y[_];if(H){var F=l[r],k=H.batch,e=F[k],X=e.ds,z=H.index;if(e.invalidate=!0,delete Y[_],X.splice(z,1),ys(X))return delete F[k],void 0;for(var h=H.begin,q=H.size,m=3*h,Q=3*q,E=4*h,Z=4*q,T=e.vs,y=e.ps,v=e.uv,o=e.cs,G=e.bs,I=e.rs,K=e.ns,O=e.ls;z<X.length;z++)H=Y[X[z]._id],H.index--,H.begin-=q;T.splice(m,Q),y.splice(E,Z),v&&v.splice(2*h,2*q),o&&o.splice(E,Z),G&&G.splice(m,Q),I&&I.splice(h,q),K&&K.splice(m,Q),O&&O.splice(h,q)}},ac=nq,ul=function(F,J,w,x){if(!x)return s;var q=J[x];if(!q){var i=mm[x]||qs,l=i.image?[]:s;q=J[x]={vs:[],ns:[],uv:l,cs:l?s:i.color?s:[],bs:i.blend?[]:s,ps:[],rs:i.brightness?[]:s,ds:[]}}return q.invalidate=!0,F[w._id]={index:q.ds.length,begin:q.vs.length/3,batch:x},q.ds.push(w),q},Yq=function(S,A){return A!=s&&1!==A?[S[0]*A,S[1]*A,S[2]*A,S[3]]:S},Sl=function(d,J,X){var C=d.getBrightness(J),K=oj(X.color||"white"),Z=K[3]<1,T=Math.ceil(X.width)||1,M=(Z?"T":"O")+T,c=d._wireframeIndexMap,k=d._wireframeModelMap,t=k[M];t||(t=k[M]={vs:[],cs:[],ps:[],ds:[],T:Z,W:T});var R,m=d.getData3dUI(J),D=sr(m);if(X.geometry){if(!D)return;if(R=es(D),!R)return}else R=X.short?sc:Se;t.invalidate=!0;var n=t.vs,j=t.cs,O=t.ds,x=c[J._id]={index:O.length,begin:n.length/3,batch:M};O.push(J);var s=yh(J,X.mat),b=m._calcAnchorMat(J);b&&fq(s,s,b),jn(n,s,R);var p=x.size=n.length/3-x.begin;yf(j,Yq(K,C),p)},Yp=function(a,$,D,T,K,A,E,J,l){var I=a.getBrightness($);I==s&&(I=1);var M=Yq(oj(T),I),Z=M[3]<1;A=Math.ceil(A)||1;var p=(Z?"T":"O")+A;if(E){var c=E[0],R=(E[1]||c)+c;p+="-"+c+"-"+R,l&&(p+="-"+rp(l)+"-"+I,l=Yq(oj(l),I))}var P=a._polylineIndexMap,k=a._polylineModelMap,O=k[p];O||(O=k[p]={vs:[],cs:[],ps:[],ds:[],ls:E?[]:s,T:Z,W:A},E&&(O.D=c,O.G=R,O.A=l)),O.invalidate=!0;var L,t=O.vs,o=O.cs,u=O.ds,f=O.ls,X=P[$._id]={index:u.length,begin:t.length/3,batch:p};u.push($),ff(t,D);var Q,g=X.size=t.length/3-X.begin,m=D.length,i=0,d=[];if(E||K)for(L=0;m>L;L+=6)Q=Bg([D[L],D[L+1],D[L+2]],[D[L+3],D[L+4],D[L+5]]),d.push(Q),i+=Q;if(i&&K){var S,n=Yq(oj(K),I),F=[n[0]-M[0],n[1]-M[1],n[2]-M[2],n[3]-M[3]],H=0;for(L=0;m>L;L+=6)S=H/i,yf(o,[M[0]+F[0]*S,M[1]+F[1]*S,M[2]+F[2]*S,M[3]+F[3]*S],1),H+=d[L/6],S=H/i,yf(o,[M[0]+F[0]*S,M[1]+F[1]*S,M[2]+F[2]*S,M[3]+F[3]*S],1)}else yf(o,M,g);if(E)for(H=J||0,L=0;m>L;L+=6)f.push(H),H+=d[L/6],f.push(H)},ap=function(J,e,D){if(e)for(var B=4*e.begin,T=D[e.batch].ps,k=0;k<e.size;k++)T[B++]=J[0],T[B++]=J[1],T[B++]=J[2],T[B++]=J[3]},_g=function(Q,U){var t=U+["32"],Y=Q[U],f=Q[t];Y?f&&f.length===Y.length?(f.set(Y),f._bufId=null):Q[t]=new hk(Y):delete Q[t]},ad=function(p,E,m,J,Q,V,s,Z,D){if(xd(m))m.forEach(function(k){ad(p,E,k,J,Q,V,s,Z,D)});else if(Kl(m))ad(p,E,sr(J,m),J,Q,V,s,Z,D);else if(sk(m)){var h,c=Ro(m.mat,E,p),f=Ro(m.s3,E,p),z=Ro(m.t3,E,p),_=Ro(m.r3,E,p);if((f||_||z||c)&&(h=zc(c,f,_,Ro(m.rotationMode,E,p),z),V.push(h)),m.shape3d)ad(p,E,m.shape3d,J,Q,V,s,Z,m);else{var N=J.s;D=D||qs;var F=V[0],M=V.length,O=N("shape3d.color",m.color,D.color);if(Q||(Q=N("shape3d.blend",m.blend,D.blend)),M>1){F=uk(F);for(var R=1;M>R;R++)fq(F,F,V[R])}m.vs&&N(Th,m.visible,D.visible)&&qo(F,s,Z,m.vs,m.uv,m.is,Q,O),m.top_vs&&N(pq,m.topVisible,D.topVisible)&&qo(F,s,Z,m.top_vs,m.top_uv,m.top_is,Q,N("shape3d.top.color",m.topColor,D.topColor)||O),m.bottom_vs&&N(Al,m.bottomVisible,D.bottomVisible)&&qo(F,s,Z,m.bottom_vs,m.bottom_uv,m.bottom_is,Q,N("shape3d.bottom.color",m.bottomColor,D.bottomColor)||O),m.from_vs&&N(En,m.fromVisible,D.fromVisible)&&qo(F,s,Z,m.from_vs,m.from_uv,m.from_is,Q,N("shape3d.from.color",m.fromColor,D.fromColor)||O),m.to_vs&&N(vo,m.toVisible,D.toVisible)&&qo(F,s,Z,m.to_vs,m.to_uv,m.to_is,Q,N("shape3d.to.color",m.toColor,D.toColor)||O)}h&&V.pop()}},qo=function(w,N,G,p,n,S,m,l){var X,u=N.cs,E=N.uv,R=N.bs;if(S){X=S.length;for(var L=0;X>L;L++){var o=S[L];jn(G,w,[p[3*o],p[3*o+1],p[3*o+2]]),E&&ff(E,[n[2*o],n[2*o+1]])}}else X=p.length/3,jn(G,w,p),E&&ff(E,n);u&&yf(u,l,X),R&&(m?ph(R,m,X):ff(R,gd,X))},eq=function($,L,l,H){var b=[];H?ad($.gv,$.data,H,$,$.getBodyColor(),[L],l,b):(Vf($,Ih,L,l,b),Vf($,Go,L,l,b),Vf($,pg,L,l,b),Vf($,Pm,L,l,b),Vf($,ns,L,l,b),Vf($,cj,L,l,b),Vf($,"csg",L,l,b)),b.length&&(ff(l.vs,b),ff(l.ns,bg(b)))},Vf=function(X,w,F,h,Q){var o=X[w];if(o){var y=o.tuv;if(y){var D,K,A,I,G=o.uvScale,Y=o.uvOffset;if(G)for(D=y.length,K=G[0],A=G[1],I=0;D>I;I+=2)y[I]*=K,y[I+1]*=A;if(Y)for(D=y.length,K=Y[0],A=Y[1],I=0;D>I;I+=2)y[I]+=K,y[I+1]+=A}qo(F,h,Q,o.vs,y,s,o.blend,o.color)}},Hr=function(i,D,F,n,a,o,s,j){var m,p=F.cs,u=F.uv,l=F.bs;if(i.getFaceVisible(D,o)){var G=i.getFaceMat(D,o);if(G&&(a=yh(D,G)),jn(s,a,j),p&&yf(p,i.getFaceColor(D,o),6),u){var H=i.getFaceUv(D,o)||n[o+"Uv"],h=i.getFaceUvScale(D,o)||n[o+"UvScale"],M=i.getFaceUvOffset(D,o)||n[o+"UvOffset"];H=H?[H[6],H[7],H[0],H[1],H[2],H[3],H[2],H[3],H[4],H[5],H[6],H[7]]:Om;var E=H[0],Z=H[1],C=H[2],k=H[3],S=H[4],f=H[5],$=H[6],X=H[7],q=H[8],W=H[9],b=H[10],Q=H[11];if(h){var y=h[0],d=h[1];E*=y,Z*=d,C*=y,k*=d,S*=y,f*=d,$*=y,X*=d,q*=y,W*=d,b*=y,Q*=d}if(M){var c=M[0],U=M[1];E+=c,Z+=U,C+=c,k+=U,S+=c,f+=U,$+=c,X+=U,q+=c,W+=U,b+=c,Q+=U}u.push(E,Z,C,k,S,f,$,X,q,W,b,Q)}l&&(m=i.getBodyColor(D)||i.getFaceBlend(D,o),m?ph(l,m,6):ff(l,gd,6))}},Rr=function(f,w,P,J){var T=f.getGL(),N=f._prg,X=f._buffer;if(!f.drawFilter&&!rb(w)){zm(f),Qq(T,N);for(var m in w){var l=w[m];if(!(J&&!l.T||!J&&l.T)){l.invalidate?(l.invalidate=!1,_g(l,"vs"),_g(l,"cs"),_g(l,"ls"),_g(l,"ps")):P&&_g(l,"ps");var G=l.vs32,i=P?l.ps32:l.cs32;pr(T,N,l.W,s,X.vs,G);var M=l.D,C=!f._dashDisabled&&M;Xc(T,N.uAlphaTest,g.alphaTest),C&&(Xc(T,N.uDash,!0),Xc(T,N.uDashDistance,M),Xc(T,N.uDashGapDistance,l.G),Cf(T,N.aLineDistance),Hi(T,X.lineDistance,l.ls32,N.aLineDistance,1),Xc(T,N.uDiffuse,l.A||g["color.empty"]));var a=!f._batchColorDisabled;a&&(Xc(T,N.uBatchColor,!0),Cf(T,N.aBatchColor),Hi(T,X.batchColor,i,N.aBatchColor,4)),Wd(T),we(T,0,G.length/3,T.LINES),Sr(T),a&&(Xc(T,N.uBatchColor,!1),bf(T,N.aBatchColor)),C&&(Xc(T,N.uDash,!1),bf(T,N.aLineDistance))}}Jn(T,N)}},ue=function(c,w,x){var b,z,A,O,V,f,D,j,M,e,i,v=c.getGL(),u=c._prg,Q=c._buffer,Z=c._batchModelMap;if(!rb(Z)){zm(c);for(b in Z)if(z=mm[b]||qs,!(x&&!z.transparent||!x&&z.transparent)&&(A=Z[b],w||!z.transparentMask)){var t=x&&z.autoSort!==!1&&(c._33Q||A.invalidate);if(A.invalidate?(A.invalidate=!1,_g(A,"vs"),_g(A,"ns"),_g(A,"cs"),_g(A,"rs"),_g(A,"ps"),_g(A,"bs"),_g(A,"uv")):w&&_g(A,"ps"),V=A.vs32,f=w?A.ps32:A.cs32,M=A.uv32,D=A.bs32,j=A.rs32,i=V.length/3,t&&(A.is=Qp(V,c.getEye())),i){O=z.light,e=c.getTexture(z.image),yi(v,u,s,z.light,z.opacity,z.reverseFlip,z.reverseColor,z.reverseCull),f?c._batchColorDisabled||(Xc(v,u.uBatchColor,!0),Cf(v,u.aBatchColor),Hi(v,Q.batchColor,f,u.aBatchColor,4)):Xc(v,u.uDiffuse,z.color||g["color.empty"]);var J=z.alphaTest;Xc(v,u.uAlphaTest,J===r?g.alphaTest:J);var p=D&&!c._batchBlendDisabled;p&&(Xc(v,u.uBatchBlend,!0),Cf(v,u.aBatchBlend),Hi(v,Q.batchBlend,D,u.aBatchBlend));var h=j&&!c._batchBrightnessDisabled;h&&(Xc(v,u.uBatchBrightness,!0),Cf(v,u.aBatchBrightness),Hi(v,Q.batchBrightness,j,u.aBatchBrightness,1)),M?Wd(v,u,e,z.discardSelectable,Q.uv,M,z.uvOffset,z.uvScale):Wd(v),Hi(v,Q.vs,V,u.aPosition),Hi(v,Q.ns,A.ns32,u.aNormal),A.is?(Lm(v,Q.is,A.is),Xo(v,0,i)):we(v,0,i),M?Sr(v,u,e):Sr(v),f&&!c._batchColorDisabled&&(Xc(v,u.uBatchColor,!1),bf(v,u.aBatchColor)),p&&(Xc(v,u.uBatchBlend,!1),bf(v,u.aBatchBlend)),h&&(Xc(v,u.uBatchBrightness,!1),bf(v,u.aBatchBrightness)),Vi(v,u)}}}},Qp=function(N,T){for(var E=N.length/3,A=new Array(E),m=E/3,d=new Array(m),i=0;m>i;i++)d[i]=i;d.sort(function(F,A){var k=9*F,t=[(N[k]+N[k+3]+2*N[k+6])/4,(N[k+1]+N[k+4]+2*N[k+7])/4,(N[k+2]+N[k+5]+2*N[k+8])/4];k=9*A;var n=[(N[k]+N[k+3]+2*N[k+6])/4,(N[k+1]+N[k+4]+2*N[k+7])/4,(N[k+2]+N[k+5]+2*N[k+8])/4],U=Bg(T,t)-Bg(T,n);return U>0?-1:0>U?1:0});for(var i=0;m>i;i++){var D=3*i,V=3*d[i];A[D]=V,A[D+1]=V+1,A[D+2]=V+2}return new Wn(A)},Uf={obj:function(u,h){var G={mat:u.mat,s3:u.s3,r3:u.r3,rotationMode:u.rotationMode,t3:u.t3,cube:u.cube==s?!0:u.cube,center:u.center==s?!0:u.center,ignoreMtls:u.ignoreMtls,ignoreTransparent:u.ignoreTransparent,ignoreColor:u.ignoreColor,ignoreImage:u.ignoreImage,ignoreNormal:u.ignoreNormal,prefix:u.prefix,flipY:u.flipY,flipFace:u.flipFace,reverseFlipMtls:u.reverseFlipMtls,finishFunc:function(p,e){if(p){var e=[];for(var D in p){var v=p[D];e.rawS3=v.rawS3,e.push(v),u.eachModel&&u.eachModel(D,v)}e.json=u,h(e)}else h()}};l.loadObj(u.obj,u.mtl,G)}};l.getModelTypeHandlers=function(){return Uf},l.setModelTypeHandler=function(x,Y){Uf[x]=Y},l.getModelTypeHandler=function(W){return Uf[W]},l.handleModelLoaded=function(){},l.handleUnfoundModel=function(){};var Co=s,ah=s,nn=function(B){Co&&!B._loadingModelView_&&(ah||(ah={}),ah[B._loadingModelView_=to()]=B)},ie=function(Q,f){Co||(Co={});var I=Co[Q];if(I){if(I.url===f)return;I.request.onload=ve,I.request.onerror=ve}var t=new ib;if(Co[Q]={request:t,url:f},f=l.beforeLoadURL(f),f.data){var g=l.parse(f.data);ci(Q,g,f)}else{t.onload=function(o){if(200===this.status||0===this.status){delete Co[Q];var w=l.parse(o.target.response||o.target.responseText);ci(Q,w,f)}else Vo(Q,l.handleUnfoundModel(Q,f)||s)},t.onerror=function(){Vo(Q,l.handleUnfoundModel(Q,f)||s)};var o={};o.url=encodeURI(f),o.sync=!1,t.send(o)}},ci=function(e,g,k){var B=g.modelType;if(!B)return Vo(e,g),l.handleModelLoaded(e,g),void 0;var V=l.getModelTypeHandler(B);if(V){if(Co||(Co={}),Co[e])return;Co[e]=!0;var P=function(i){i?(Vo(e,i),l.handleModelLoaded(e,i)):Vo(e,l.handleUnfoundModel(e,k)||s)};V(g,P)}else Vo(e,l.handleUnfoundModel(e,k)||s)},Vo=function(v,H){if(Vc[v]=H,delete Co[v],rb(Co)&&(Co=s,ah)){for(var j in ah){var d=ah[j];d.invalidateAll&&d.invalidateAll(r,"modelLoaded",v),d.redraw&&d.redraw(),d.iv(),delete d._loadingModelView_}ah=s}if(H&&ah)for(var j in ah){var d=ah[j];d.invalidateAll&&d.invalidateAll(r,"modelLoading",v),d.redraw&&d.redraw(),d.iv()}},fr=new hk([0,0,0,1,1,1,1,0]),Mb=new hk([0,0,1,0,0,1,0,0,1,0,0,1]),Pn=new Wn([0,1,2,2,3,0]),zk=new hk([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Kf=new Wn([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Sq=new hk([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Mj=bg(zk,Kf),pl=(new hk([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Wn([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Ih,pg,Go,Pm,ns,cj]),Se=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],sc=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Zq=function(T,g,D,F,h,B){B=B||16,T=T||16,g=g||0,D=D||T;var l,C,U,a,G,Q,S,z,K=.5,n=[],H=[],Z=p/T,N=M/B;for(l=0;B>l;l++)for(G=l+1,a=l*N,z=G*N,C=g;D>C;C++)Q=C+1,U=C*Z,S=Q*Z,n.push(K*w(a)*b(U),K*b(a),-K*w(a)*w(U),K*w(z)*b(S),K*b(z),-K*w(z)*w(S),K*w(a)*b(S),K*b(a),-K*w(a)*w(S),K*w(a)*b(U),K*b(a),-K*w(a)*w(U),K*w(z)*b(U),K*b(z),-K*w(z)*w(U),K*w(z)*b(S),K*b(z),-K*w(z)*w(S)),H.push(C/T,l/B,Q/T,G/B,Q/T,l/B,C/T,l/B,C/T,G/B,Q/T,G/B);if(F){var m=[],O=[];for(U=g*Z,l=0;B>l;l++)G=l+1,a=l*N,z=G*N,m.push(0,0,0,K*w(z)*b(U),K*b(z),-K*w(z)*w(U),K*w(a)*b(U),K*b(a),-K*w(a)*w(U)),O.push(0,.5,g/T,G/B,g/T,l/B)}if(h){var j=[],E=[];for(U=D*Z,l=0;B>l;l++)G=l+1,a=l*N,z=G*N,j.push(0,0,0,K*w(a)*b(U),K*b(a),-K*w(a)*w(U),K*w(z)*b(U),K*b(z),-K*w(z)*w(U)),E.push(1,.5,D/T,l/B,D/T,G/B)}return{vs:n,uv:H,from_vs:m,from_uv:O,to_vs:j,to_uv:E}},Ko=function(G,y,P){G=G||.17,y=y||12,P=P||18,0>G?G=0:G>.25&&(G=.25);var K,z,j,d,R,Y,r,Q=.5,_=[],H=[],c=[],I=p/P,t=p/y,A=Q-G;for(z=0;y>=z;z++)for(d=-M+z*t,Y=b(d),R=w(d),K=0;P>=K;K++)j=K*I,r=A+G*Y,_.push(b(j)*r,R*G,-w(j)*r),H.push(K/P,1-z/y);for(z=0;y>z;z++){var h=z*(P+1),U=(z+1)*(P+1);for(K=0;P>K;K++)c.push(h+K,U+K+1,U+K,h+K,h+K+1,U+K+1)}return{vs:_,uv:H,is:c}},uf=function(e,c,m,C,x,f,A){A=A||12,e=e||18,c=c||0,m=m||e,f=f||.17,0>f?f=0:f>.25&&(f=.25);var $,k,i,R,d,W,S,H,u,N,T=.5,L=[],D=[],s=p/e,Y=p/A,I=T-f;for(i=0;A>i;i++)for(R=i+1,S=-M+i*Y,H=-M+R*Y,$=c;m>$;$++)k=$+1,d=$*s,W=k*s,u=I+f*b(S),N=I+f*b(H),L.push(b(d)*u,w(S)*f,-w(d)*u,b(W)*u,w(S)*f,-w(W)*u,b(W)*N,w(H)*f,-w(W)*N,b(d)*u,w(S)*f,-w(d)*u,b(W)*N,w(H)*f,-w(W)*N,b(d)*N,w(H)*f,-w(d)*N),D.push($/e,1-i/A,k/e,1-i/A,k/e,1-R/A,$/e,1-i/A,k/e,1-R/A,$/e,1-R/A);if(C){var q=[],o=[];for(i=0;A>i;i++)R=i+1,S=-M+i*Y,H=-M+R*Y,d=c*s,u=I+f*b(S),N=I+f*b(H),q.push(b(d)*u,w(S)*f,-w(d)*u,b(d)*N,w(H)*f,-w(d)*N,b(d)*I,0,-w(d)*I),o.push(.5+.5*b(S),.5-.5*w(S),.5+.5*b(H),.5-.5*w(H),.5,.5)}if(x){var K=[],O=[];for(i=0;A>i;i++)R=i+1,S=-M+i*Y,H=-M+R*Y,d=m*s,u=I+f*b(S),N=I+f*b(H),K.push(b(d)*u,w(S)*f,-w(d)*u,b(d)*I,0,-w(d)*I,b(d)*N,w(H)*f,-w(d)*N),O.push(.5-.5*b(S),.5-.5*w(S),.5,.5,.5-.5*b(H),.5-.5*w(H))}return{vs:L,uv:D,from_vs:q,from_uv:o,to_vs:K,to_uv:O}},ji=function(k,J){for(var e,G,L,P=.5,o=16,h=[],V=[],i=[],C=p/o,d=0;o>=d;d++)e=d*C,G=b(e)*P,L=w(e)*P,h.push(G,-P,L,G,P,L),V.push(1-d/o,1,1-d/o,0);for(d=0;o>d;d++)i.push(2*d,2*d+1,2*d+3,2*d,2*d+3,2*d+2);if(J){var r=[],Q=[],N=[];for(r.push(0,-P,0),Q.push(.5,.5),d=0;o>=d;d++)e=d*C,G=b(e),L=w(e),r.push(G*P,-P,-L*P),Q.push(.5+.5*G,.5+.5*L);for(d=0;o>d;d++)N.push(0,d+2,d+1)}if(k){var _=[],I=[],Z=[];for(_.push(0,P,0),I.push(.5,.5),d=0;o>=d;d++)e=d*C,G=b(e),L=w(e),_.push(G*P,P,-L*P),I.push(.5+.5*G,.5-.5*L);for(d=0;o>d;d++)Z.push(0,d+1,d+2)}return{vs:h,uv:V,is:i,bottom_vs:r,bottom_uv:Q,bottom_is:N,top_vs:_,top_uv:I,top_is:Z}},Dr=function(L,H,o,y,Q,v,q){L=L||12,H=H||0,o=o||L;for(var N,J,R,h,d,l,S,e,W=.5,U=[],r=[],k=p/L,K=H;o>K;K++)N=K+1,J=K*k,R=N*k,h=b(J)*W,d=w(J)*W,l=b(R)*W,S=w(R)*W,U.push(h,-W,-d,l,-W,-S,h,W,-d,l,-W,-S,l,W,-S,h,W,-d),r.push(K/L,1,N/L,1,K/L,0,N/L,1,N/L,0,K/L,0);if(q){var u=[],g=[];for(K=H;o>K;K++)J=k*K,R=k*(K+1),h=b(J),d=w(J),l=b(R),S=w(R),u.push(h*W,-W,-d*W,0,-W,0,l*W,-W,-S*W),g.push(.5+.5*h,.5+.5*d,.5,.5,.5+.5*l,.5+.5*S)}if(v){var s=[],Y=[];for(K=H;o>K;K++)J=k*K,R=k*(K+1),h=b(J),d=w(J),l=b(R),S=w(R),s.push(h*W,W,-d*W,l*W,W,-S*W,0,W,0),Y.push(.5+.5*h,.5-.5*d,.5+.5*l,.5-.5*S,.5,.5)}if(y){var Z=[],E=[];J=k*H,h=b(J)*W,d=w(J)*W,e=H/L,Z.push(0,W,0,0,-W,0,h,-W,-d,h,-W,-d,h,W,-d,0,W,0),E.push(0,0,0,1,e,1,e,1,e,0,0,0)}if(Q){var i=[],B=[];J=k*o,h=b(J)*W,d=w(J)*W,e=o/L,i.push(0,-W,0,0,W,0,h,W,-d,h,W,-d,h,-W,-d,0,-W,0),B.push(1,1,1,0,e,0,e,0,e,1,1,1)}return{vs:U,uv:r,bottom_vs:u,bottom_uv:g,top_vs:s,top_uv:Y,from_vs:Z,from_uv:E,to_vs:i,to_uv:B}},Ni=function(q,d,J,Y,X){d=d||18,J=J||0,Y=Y==s?p:Y,X=X==s?.5:X;for(var e,o,T,l,V,_,y=[0,.5,.75,.875,.9375],A=[],Q=[],E=[],C=Y/d,W=0;W<y.length;W++){var Z=0===W%2?0:.5;for(e=0;d>=e;e++)o=(e+Z)*C+J,T=1-y[W],A.push(b(o)*X*T,-X+2*y[W]*X,-w(o)*X*T),Q.push((e+Z)/d,T)}for(W=0;W<y.length-1;W++){var r=W*(d+1),U=(W+1)*(d+1);for(e=0;d>e;e++)E.push(r+e,U+e+1,U+e,r+e,r+e+1,U+e+1)}for(_=A.length/3-(d+1),e=0;d>e;e++)A.push(0,X,0),Q.push((e+.5)/d,0);for(e=0;d>e;e++)E.push(_+e,_+e+1,_+(d+1)+e);if(q){var P=[],m=[],B=[];for(P.push(0,-X,0),m.push(.5,.5),e=0;d>=e;e++)o=e*C+J,l=b(o),V=w(o),P.push(l*X,-X,-V*X),m.push(.5+.5*l,.5+.5*V);for(e=0;d>e;e++)B.push(0,e+2,e+1)}return{vs:A,uv:Q,is:E,bottom_vs:P,bottom_uv:m,bottom_is:B}},$l=function(a,F,E,A,R,W){a=a||16,F=F||0,E=E||a;for(var z=.5,k=[],i=[],X=p/a,U=F;E>U;U++){var h=U+1,B=X*U,O=X*h;k.push(b(B)*z,-z,-w(B)*z,b(O)*z,-z,-w(O)*z,0,z,0),i.push(U/a,1,h/a,1,(U+h)/2/a,0)}if(W){var T=[],C=[];for(U=F;E>U;U++){B=X*U,O=X*(U+1);var M=b(B),Z=w(B),D=b(O),m=w(O);T.push(M*z,-z,-Z*z,0,-z,0,D*z,-z,-m*z),C.push(.5+.5*M,.5+.5*Z,.5,.5,.5+.5*D,.5+.5*m)}}if(A){var s=[],$=[];B=X*F,s.push(0,z,0,0,-z,0,b(B)*z,-z,-w(B)*z),$.push(0,0,0,1,F/a,1)}if(R){var L=[],Q=[];B=X*E,L.push(0,-z,0,0,z,0,b(B)*z,-z,-w(B)*z),Q.push(1,1,1,0,E/a,1)}return{vs:k,uv:i,bottom_vs:T,bottom_uv:C,from_vs:s,from_uv:$,to_vs:L,to_uv:Q}},Po=function(C,O,B,s,D,R,J,M){for(var c=[],d=0;d<C.length-1;d+=2)c.push({x:C[d],y:C[d+1]});return ej(c,O,B,s,D,R,J,M,!1)},Yd={roundRect:function(L,O){return Po([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],L,O,3)},star:function(X,u){return Po([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],X,u)},rect:function(o,e){return Po([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],o,e)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Z,X){return Po([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Z,X)},rightTriangle:function(G,K){return Po([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],G,K)},parallelogram:function(w,p){return Po([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],w,p)},trapezoid:function(k,p){return Po([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],k,p)}},Mn={sphere:1,cylinder:1,cone:1,torus:1},ki={torus:1,sphere:1},Qj=Kk(kl(Yd),{cylinder:1}),xe=Kk(kl(Yd),{cylinder:1,cone:1}),Qn=function(O,l,k){var E,g=Ro(O.anchor3d,k,l),p=Ro(O.mat,k,l),j=Ro(O.s3,k,l),m=Ro(O.t3,k,l),Q=Ro(O.r3,k,l),I=j||Q||m||p;if(g||I){E=uk(l._6O);var M=I?zc(p,j,Q,Ro(O.rotationMode,k,l),m):Rp();g&&qi(M,[.5-g[0],.5-g[1],.5-g[2]]),zm(l,M)}return E},Eb=function(p,v,P,T,u,O,U){if(xd(P))P.forEach(function(e){Eb(p,v,e,T,u,O,U)});else if(Kl(P))Eb(p,v,sr(T,P),T,u,O,U);else if(sk(P))if(P.shape3d){var K=Qn(P,p,v);Eb(p,v,P.shape3d,T,u,O,P),K&&ir(p,K)}else Vd(p,v,P,T.s,u,O,U)},Vd=function(T,w,p,A,z,j,L){if(L=L||qs,!j||j(A("shape3d.transparent",p.transparent,L.transparent))){var b=Qn(p,T,w);Mg(p);var $=T._26I,M=T._prg,d=T._buffer,Z=A("shape3d.color",p.color,L.color);z||(z=A("shape3d.blend",p.blend,L.blend));var e,P=p.opacity==s?L.opacity:p.opacity,X=A("shape3d.opacity");e=X!=s&&P!=s?P*X:P!=s?P:X,yi($,M,z,A("shape3d.light",p.light,L.light),e,A("shape3d.reverse.flip",p.reverseFlip,L.reverseFlip),A("shape3d.reverse.color",p.reverseColor,L.reverseColor),A("shape3d.reverse.cull",p.reverseCull,L.reverseCull));var D=A("polygonOffset",p.polygonOffset,L.polygonOffset);p.vs&&A(Th,p.visible,L.visible)&&Fj($,M,d,Z,T.getTexture(A("shape3d.image",p.image,L.image),w),A("shape3d.discard.selectable",p.discardSelectable,L.discardSelectable),p.vs,p.uv,p.ns,p.is,A("shape3d.uv.offset",p.uvOffset,L.uvOffset),A("shape3d.uv.scale",p.uvScale,L.uvScale),D),p.top_vs&&A(pq,p.topVisible,L.topVisible)&&Fj($,M,d,A("shape3d.top.color",p.topColor,L.topColor)||Z,T.getTexture(A("shape3d.top.image",p.topImage,L.topImage),w),A("shape3d.top.discard.selectable",p.topDiscardSelectable,L.topDiscardSelectable),p.top_vs,p.top_uv,p.top_ns,p.top_is,A("shape3d.top.uv.offset",p.topUvOffset,L.topUvOffset),A("shape3d.top.uv.scale",p.topUvScale,L.topUvScale),D),p.bottom_vs&&A(Al,p.bottomVisible,L.bottomVisible)&&Fj($,M,d,A("shape3d.bottom.color",p.bottomColor,L.bottomColor)||Z,T.getTexture(A("shape3d.bottom.image",p.bottomImage,L.bottomImage),w),A("shape3d.bottom.discard.selectable",p.bottomDiscardSelectable,L.bottomDiscardSelectable),p.bottom_vs,p.bottom_uv,p.bottom_ns,p.bottom_is,A("shape3d.bottom.uv.offset",p.bottomUvOffset,L.bottomUvOffset),A("shape3d.bottom.uv.scale",p.bottomUvScale,L.bottomUvScale),D),p.from_vs&&A(En,p.fromVisible,L.fromVisible)&&Fj($,M,d,A("shape3d.from.color",p.fromColor,L.fromColor)||Z,T.getTexture(A("shape3d.from.image",p.fromImage,L.fromImage),w),A("shape3d.from.discard.selectable",p.fromDiscardSelectable,L.fromDiscardSelectable),p.from_vs,p.from_uv,p.from_ns,p.from_is,A("shape3d.from.uv.offset",p.fromUvOffset,L.fromUvOffset),A("shape3d.from.uv.scale",p.fromUvScale,L.fromUvScale),D),p.to_vs&&A(vo,p.toVisible,L.toVisible)&&Fj($,M,d,A("shape3d.to.color",p.toColor,L.toColor)||Z,T.getTexture(A("shape3d.to.image",p.toImage,L.toImage),w),A("shape3d.to.discard.selectable",p.toDiscardSelectable,L.toDiscardSelectable),p.to_vs,p.to_uv,p.to_ns,p.to_is,A("shape3d.to.uv.offset",p.toUvOffset,L.toUvOffset),A("shape3d.to.uv.scale",p.toUvScale,L.toUvScale),D),Vi($,M),b&&ir(T,b)}},Fj=function(Q,s,u,q,k,e,H,T,A,Z,G,$,z){H&&(z&&Pg(Q,z),Xc(Q,s.uDiffuse,q||g["color.empty"]),T?Wd(Q,s,k,e,u.uv,T,G,$):Wd(Q),Hi(Q,u.vs,H,s.aPosition),Hi(Q,u.ns,A,s.aNormal),Z?(Nq(Q,u.is,Z),Xo(Q,0,Z.length)):we(Q,0,H.length/3),T?Sr(Q,s,k):Sr(Q),z&&yj(Q))},sr=function(T,J){var S=T.s;if(J||(J=S(is)),!J)return s;var N=Jr(J);if(N)return N;if("text"===J){var K={amount:S("shape3d.text.amount"),size:S("shape3d.text.size"),font:S("shape3d.text.font"),style:S("shape3d.text.style"),weight:S("shape3d.text.weight"),fill:S("shape3d.text.fill"),curveSegments:S("shape3d.text.curveSegments"),spacing:S("shape3d.text.spacing")},y=T.gv.getShape3dText(T.data),H=y;for(var p in K)H+="_"+(K[p]===r?"U":K[p]);return T._cachedTextKey===H?T._cachedTextGeometry:(T._cachedTextKey=H,T._cachedTextGeometry=l.createTextGeometry(y,K))}var p=J;if(Mn[J]){var v=S("shape3d.side"),d=S("shape3d.side.from"),t=S("shape3d.side.to"),B=S(En),u=S(vo);3>v?(v=0,d=0,t=0,B=!1,u=!1):((d==s||0>d)&&(d=0),(t==s||t>v)&&(t=v),0===d&&t===v&&(B=!1,u=!1)),p+="-"+v+"-"+d+"-"+t+"-"+B+"-"+u}if(Qj[J]){var e=S(pq);p+="-"+e}if(xe[J]){var Y=S(Al);p+="-"+Y}if("torus"===J){var m=S("shape3d.torus.radius");0>m?m=0:m>.25&&(m=.25),p+="-"+m}if(ki[J]){var h=S(Ze);p+="-"+h}return N=ug[p],N||("box"===J?N=l.createBoxModel():Yd[J]?N=Yd[J](e,Y):"sphere"===J?N=l.createSphereModel(v,d,t,B,u,h):J===ag?N=l.createCylinderModel(v,d,t,B,u,e,Y):"cone"===J?N=l.createConeModel(v,d,t,B,u,Y):"torus"===J&&(N=l.createTorusModel(v,d,t,B,u,m,h)),ug[p]=N),N},Mg=function(){var f=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],Y=["is","top_is","bottom_is","from_is","to_is"];return E=fb(zb.substr(zb.indexOf("^#")+2)),Yg(l[Xk(qh+f[15]+"n"+f[16])]())&&rn()?function(U){U&&!U._complete_&&(U._complete_=!0,U.vs&&ys(U.ns)&&(U.ns=bg(U.vs,U.is)),U.top_vs&&ys(U.top_ns)&&(U.top_ns=bg(U.top_vs,U.top_is)),U.bottom_vs&&ys(U.bottom_ns)&&(U.bottom_ns=bg(U.bottom_vs,U.bottom_is)),U.from_vs&&ys(U.from_ns)&&(U.from_ns=bg(U.from_vs,U.from_is)),U.to_vs&&ys(U.to_ns)&&(U.to_ns=bg(U.to_vs,U.to_is)),f.forEach(function(Y){var P=U[Y];xd(P)&&(U[Y]=new hk(P))}),Y.forEach(function(v){var G=U[v];xd(G)&&(U[v]=new Wn(G))}))}:void 0}(),Vr=function(s,O){var G=s[O];xd(G)&&(s[O]=new hk(G))};Kk(Lq,{_25Q:function(V){V._16O=function(G,a,d,Q,t,W,I,H,r){var L=this.info;if(L){var X,O,x,f,F,$,i=Rp();if(ql[a]?(X=L.p3,O=L.c1,x=L.c2):bq[a]?(O=L.s1||L.c1,x=L.s2||L.c2):(O=L.t1||L.c1,x=L.t2||L.c2),X)$=de(a,wi,d,Q,H,r);else{var u=tn(x,O),p=Bg(O,x);f=[0,-Z(u[2],u[0]),J(u[1]/p)],F="zyx",X=[(O[0]+x[0])/2,(O[1]+x[1])/2,(O[2]+x[2])/2],$=de(a,[p,0,0],d,Q,H,r)}return ws(i,$,X,Q,t,W,I,G,f,F)}return zj},V._80o=function(A,r,J){var O=this,W=O.shapeModel;if(W){var z=O.gv;zm(z),Eb(z,O.data,W,O,O.getBodyColor(),J)}},V.createLineModel=function(w,x,i,o,X){for(var b=this,B=b.s,t=Ed(w,x,B(Ze)),G=[],j=0;j<t.length;j++){var H=t[j],d=H.length;if(d>1){var F=H[0];G.push(F.x,F.y,F.z);for(var W=1;d-1>W;W++)F=H[W],G.push(F.x,F.y,F.z),G.push(F.x,F.y,F.z);F=H[d-1],G.push(F.x,F.y,F.z)}}var v,q,g,p=B(o+".color"),C=B(X),J=0;return C&&(q=B(X+".color"),v=B(X+".pattern"),J=B(X+".offset"),g=p),Yp(b.gv,b.data,G,q||p,g?s:B(o+".gradient.color"),i,v||B(o+".pattern"),J,g),t},V.createTubeModel=function(N,S,X,g){for(var W=this,h=W.s,r=h("shape3d.side")||Sd,A=h("shape3d.start.angle"),V=h("shape3d.sweep.angle"),$=h(pq)?h("shape3d.top.cap"):s,c=h(Al)?h("shape3d.bottom.cap"):s,M="flat"===$,m="flat"===c,w=M&&(g?g.uv:h("shape3d.top.image")),R=m&&(g?g.uv:h("shape3d.bottom.image")),e=g?g.uv:h("shape3d.image"),U={vs:[],uv:e?[]:s,top_vs:M?[]:s,top_uv:w?[]:s,bottom_vs:m?[]:s,bottom_uv:R?[]:s},t=Ed(N,S,h(Ze),X),C=0,L=t.length;L>C;C++)nm(U,t[C],h(Pb),X,r,A,V,$,c);if(g){var D=[];ad(W.gv,W.data,U,W,W.getBodyColor(),[],g,D),D.length&&(ff(g.vs,D),ff(g.ns,bg(D)))}else W.shapeModel=U;return t},V.getCache=function(){var d=this.info;if(d){var l=d.list;if(l){var N=d.cache;return N||(N=d.cache=Be(l)),N}}return s}}});var Of=function(j,U){for(var y,d=0,X=j.length,w=0,o=X-1;o>=w;)if(d=c(w+(o-w)/2),y=j[d].length-U,0>y)w=d+1;else{if(!(y>0)){o=d;break}o=d-1}d=o;var R=j[d],T=R.point;return d===X-1||R.length===U||(T=(new Cs).subVectors(j[d+1].point,T).normalize().multiplyScalar(U-R.length).add(T)),{point:T,tangent:R.tangent}},Be=function(P){for(var w,X,U=[],$=0,l=0;l<P.length;l++){for(var s=P[l],p=0;p<s.length;p++){w=s[p],X&&($+=X.distanceTo(w));var h=new Cs,e=s[p+1];e?h.subVectors(e,w):X?h.subVectors(w,X):h.x=1,h.normalize(),U.push({point:w,length:$,tangent:h}),X=w}X=null}return U},Ed=function(X,j,D,d){D=D||Xe;for(var L=[],N=0,E=X.size();E>N;N++){var i=X.get(N);L.push(new Cs(i.x,i.e||0,i.y))}j&&(pn(j)&&(j=j._as),j.length||(j=null));for(var t,f,h,U,z,W=[],G=0,p=0,S=j?j.length:E;S>p;p++)if(z=j?j[p]:0===p?1:2,1===z)W.push(h=[]),h.push(L[G++]);else if(2===z||5===z)if(U=2===z?L[G++]:h[0],d){var o=j?j[p+1]:S>p+1?2:s;if(2===o||5===o){var n=h[h.length-1],H=2===o?L[G]:h[0],M=(new Cs).subVectors(n,U),x=(new Cs).subVectors(H,U),g=M.length(),v=x.length();if(g&&v)if(d>g/2&&d>v/2)h.push(U);else for(M.multiplyScalar($(d,g/2)/g).add(U),x.multiplyScalar($(d,v/2)/v).add(U),t=new sj(M,U,x).getPoints(D),f=0;D>=f;f++)h.push(t[f])}else h.push(U)}else h.push(U);else if(3===z)for(t=new sj(h[h.length-1],L[G++],L[G++]).getPoints(D),f=1;D>=f;f++)h.push(t[f]);else if(4===z)for(t=new Oq(h[h.length-1],L[G++],L[G++],L[G++]).getPoints(D),f=1;D>=f;f++)h.push(t[f]);return W},Fb=function(y){for(var N,X,B=new Cs,h=[],G=[],m=[],t=0,Q=y.length;Q>t;t++)N=y[t],X=y[t+1],X?B.subVectors(X,N):B.subVectors(N,y[t-1]),h.push(B.normalize().clone());var $,F,R,f,I=new Cs,W=new Cs,r=new og,S=1e-4,A=Number.MAX_VALUE,C=h[0],V=G[0]=new Cs,J=m[0]=new Cs;for(F=P(C.x),R=P(C.y),f=P(C.z),A>=F&&(A=F,I.set(1,0,0)),A>=R&&(A=R,I.set(0,1,0)),A>=f&&I.set(0,0,1),W.crossVectors(C,I).normalize(),V.crossVectors(C,W),J.crossVectors(C,V),t=1;Q>t;t++)G[t]=G[t-1].clone(),m[t]=m[t-1].clone(),W.crossVectors(h[t-1],h[t]),W.length()>S&&(W.normalize(),$=T(bm(h[t-1].dot(h[t]),-1,1)),G[t].applyMatrix4(r.makeRotationAxis(W,$))),m[t].crossVectors(h[t],G[t]);return{B:m,T:h,N:G}},nm=function(){var L=function(T){for(var P=1;P<arguments.length;P++){var o=arguments[P];T.push(o.x,o.y,o.z)}},O=function(N){for(var I=1;I<arguments.length;I++){var i=arguments[I].uv;N.push(i[0],i[1])}},_=function(B,G,S,g,n){var Z=-g*b(n),y=g*w(n);return new Cs(B.x+Z*S.x+y*G.x,B.y+Z*S.y+y*G.y,B.z+Z*S.z+y*G.z)},G=function(r,g,u,E,x,y,T,v){T=T||p;for(var m=[],q=T/x,S=0;x>=S;S++){var Z=_(r,g,u,E,S*q+y);m.push(Z),v!=s&&(Z.uv=[v,S/x])}return m},V=function(f,R,a,$,e,k,P,d,A){A=A||p;var G=R?f.top_vs:f.bottom_vs;if(G)for(var F=R?f.top_uv:f.bottom_uv,I=A/P,l=0;P>l;l++){var J,O;R?(J=l*I+d,O=(l+1)*I+d):(O=l*I+d,J=(l+1)*I+d),L(G,_(a,$,e,k,J),_(a,$,e,k,O),a),F&&F.push(.5-.5*b(J),.5-.5*w(J),.5-.5*b(O),.5-.5*w(O),.5,.5)}};return function(f,n,X,c,N,b,u,i,z){var m=n.length;if(m>1){var S,K,k,M,E,P,J,Y=Fb(n),h=Y.T,C=Y.N,Z=Y.B;"flat"===i&&V(f,!0,n[0],Z[0],C[0],c,N,b,u),"flat"===z&&V(f,!1,n[m-1],Z[m-1],C[m-1],c,N,b,u);var H,B,F=[],R=v(N/2),y="round"===i,I="round"===z,t=n[0],p=h[0],l=Z[0],T=C[0],q=n[m-1],D=h[m-1],o=Z[m-1],w=C[m-1];if(y){for(k=1;R>=k;k++)C.splice(0,0,T),Z.splice(0,0,l),h.splice(0,0,p),B=-k/R*c,n.splice(0,0,p.clone().multiplyScalar(B).add(t)),F[R-k]=W(c*c-B*B);m+=R}if(I){for(k=1;R>=k;k++)C.push(w),Z.push(o),h.push(D),B=k/R*c,n.push(D.clone().multiplyScalar(B).add(q)),F[n.length-1]=W(c*c-B*B);m+=R}if(f.uv){var g=0,j=0,x=[];for(X&&(g=X),E=n[0],x[0]=0,k=1;m>k;k++)M=n[k],x[k]=E.distanceTo(M),E=M,X||(g+=x[k]);for(H=[],k=0;m>k;k++)j+=x[k],H[k]=g?j/g:0}for(k=0;m>k;k++){if(M=n[k],P=Z[k],J=C[k],S=G(M,P,J,F[k]===r?c:F[k],N,b,u,H?H[k]:s),K)for(var A=0;N>A;A++){var d=K[A],Q=K[A+1]||K[0],U=S[A],e=S[A+1]||S[0];L(f.vs,Q,d,U,U,e,Q),f.uv&&O(f.uv,Q,d,U,U,e,Q)}K=S}}}}();Kk(l,{getLineLength:function(Z){return Z[Z.length-1].length},getLineOffset:function(U,t){return Of(U,t)},getLineCacheInfo:function(P,Z,M,T){return Be(Ed(P,Z,M,T))}});var Hm=I.graph3d.RenderLite={},th=new Array(0),fm=Hm.Buffer=function(g,d,Y,C){this.gl=g,this.buffer=g.createBuffer(),this.type=d||g.ARRAY_BUFFER,this.drawType=C||g.STATIC_DRAW,this.data=th,Y&&this.upload(Y)};fm.prototype.upload=function(N,b,e){e||this.bind();var g=this.gl;N=N||this.data,b=b||0,this.data.byteLength>=N.byteLength?g.bufferSubData(this.type,b,N):g.bufferData(this.type,N,this.drawType),this.data=N},fm.prototype.bind=function(){var w=this.gl;w.bindBuffer(this.type,this.buffer)},fm.createVertexBuffer=function(Z,w,q){return new fm(Z,Z.ARRAY_BUFFER,w,q)},fm.createIndexBuffer=function(q,F,A){return new fm(q,q.ELEMENT_ARRAY_BUFFER,F,A)},fm.create=function(M,C,B,L){return new fm(M,C,L)},fm.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Dm=Hm.Shader=function($,U,j){this.gl=$,this.program=cr($,U,j),this.attributes=rl($,this.program);var F=lp($,this.program);this.uniforms=Gk($,F)};Dm.prototype.bind=function(){this.gl.useProgram(this.program)},Dm.prototype.destroy=function(){this.gl};var cr=function(r,q,E){var O=Sn(r,r.VERTEX_SHADER,q),j=Sn(r,r.FRAGMENT_SHADER,E);r.getShaderParameter(j,r.COMPILE_STATUS)||console.error(r.getError());var m=r.createProgram();return r.attachShader(m,O),r.attachShader(m,j),r.linkProgram(m),r.getProgramParameter(m,r.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",r.getProgramParameter(m,r.VALIDATE_STATUS)),console.error("gl.getError()",r.getError()),""!==r.getProgramInfoLog(m)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(m)),r.deleteProgram(m),m=null),r.deleteShader(O),r.deleteShader(j),m},Sn=function(K,a,H){var b=K.createShader(a);return K.shaderSource(b,H),K.compileShader(b),K.getShaderParameter(b,K.COMPILE_STATUS)?b:(console.log(K.getShaderInfoLog(b)),null)},lp=function(b,V){for(var m={},Z=b.getProgramParameter(V,b.ACTIVE_UNIFORMS),i=0;Z>i;i++){var v=b.getActiveUniform(V,i),n=v.name.replace(/\[.*?\]/,""),X=qp(b,v.type);m[n]={type:X,size:v.size,location:b.getUniformLocation(V,n),value:Uh(X,v.size)}}return m},rl=function(b,r){for(var w={},q=b.getProgramParameter(r,b.ACTIVE_ATTRIBUTES),R=0;q>R;R++){var v=b.getActiveAttrib(r,R),Y=qp(b,v.type);w[v.name]={type:Y,size:bc(Y),gl:b,location:b.getAttribLocation(r,v.name),pointer:ek}}return w},ek=function(O,l,D,B,F){var S=this.gl;S.enableVertexAttribArray(this.location),S.bindBuffer(O.type,O.buffer),S.vertexAttribPointer(this.location,this.size,l||S.FLOAT,D||!1,B||0,F||0)},bc=function(z){return ef[z]},ef={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},qp=function(U,T){if(!mp){var q=H.keys(Rh);
        mp={};for(var s=0;s<q.length;++s){var D=q[s];mp[U[D]]=Rh[D]}}return mp[T]},mp=null,Rh={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Uh=function(J,y){switch(J){case"float":return 0;case"vec2":return new Float32Array(2*y);case"vec3":return new Float32Array(3*y);case"vec4":return new Float32Array(4*y);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*y);case"ivec3":return new Int32Array(3*y);case"ivec4":return new Int32Array(4*y);case"bool":return!1;case"bvec2":return vb(2*y);case"bvec3":return vb(3*y);case"bvec4":return vb(4*y);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},vb=function(d){for(var R=new Array(d),G=0;G<R.length;G++)R[G]=!1;return R},Gk=function(M,T){var J={data:{}};J.gl=M;for(var V=H.keys(T),x=0;x<V.length;x++){var g=V[x],i=g.split("."),w=i[i.length-1],j=bs(i,J),D=T[g];j.data[w]=D,j.gl=M,H.defineProperty(j,w,{get:Zl(w),set:Gg(w,D)})}return J},Zl=function(L){var z=xs.replace("%%",L);return new Function(z)},Gg=function(c,O){var M,s=rd.replace(/%%/g,c);return M=1===O.size?Sj[O.type]:cb[O.type],M&&(s+="\nthis.gl."+M+";"),new Function("value",s)},bs=function(k,R){for(var r=R,u=0;u<k.length-1;u++){var x=r[k[u]]||{data:{}};r[k[u]]=x,r=x}return r},xs=["return this.data.%%.value;"].join("\n"),rd=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Sj={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},cb={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},kr=I.Light=function(){jj(kr,this),this.s(yp,g[yp]),this.s(is,"sphere"),this.s3(20,20,20)};Lf("Light",Vb,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(s,E,p){kr.superClass.onStyleChanged.apply(this,arguments),s===yp&&this.s("shape3d.color",p)}});var en=xn.Graph3dView=function(Y,b){var N=this;N._attributes=b||l.graph3dViewAttributes,N._25I={},N._view=js(1,N);var W=N._canvas=Ub(N._view);W.addEventListener("webglcontextlost",function(p){p.preventDefault(),eo(N),N._26I&&N._doBufferGC(N._26I,!0),N._26I=s,N._1o.texture=s,N._35O=!0},i),W.addEventListener("webglcontextrestored",function(){N._35O=!1,N.iv()},i),N._batchIndexMap={},N._batchModelMap={},N._wireframeIndexMap={},N._wireframeModelMap={},N._wireframeIndexMapSwap={},N._wireframeModelMapSwap={},N._polylineIndexMap={},N._polylineIndexMap={},N._polylineIndexMapSwap={},N._polylineIndexMapSwap={},N._8O=[],N._7O=Rp(),N._6O=Rp(),N._1o=new _o(N),N._30O=new Sf(N),N._31O=new Tq(N),N._32O=new ab(N),N._raycaster=new wh(N),N._highlightHelper=new Af(N),N._postProcessing=new Ah(N),N.vr=new In(N),N._33Q=!0,N._eye=kl(l.graph3dViewEye),N._center=kl(l.graph3dViewCenter),N._up=kl(l.graph3dViewUp),N._lightChanged=!1,N._59O=[],N._spots=[],N._dirs=[],N._frameId=0,N.overlappingBox=new gl(N),N.dm(Y?Y:new hd),N._coreInteractor=new yr(this),N.setInteractors([new Ul(N)])},Nl={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},bp=0;Gr("Graph3dView",H,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Yr,Sg,"firstPersonMode",Tn,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Wg,Re,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:l.graph3dViewEditHelperDisabled,_devicePixelRatio:r,_boundaries:r,_moveStep:l.graph3dViewMoveStep,_rotateStep:l.graph3dViewRotateStep,_pannable:l.graph3dViewPannable,_rotatable:l.graph3dViewRotatable,_walkable:l.graph3dViewWalkable,_resettable:l.graph3dViewResettable,_zoomable:l.graph3dViewZoomable,_firstPersonMode:l.graph3dViewFirstPersonMode,_mouseRoamable:l.graph3dViewMouseRoamable,_gridVisible:l.graph3dViewGridVisible,_gridSize:l.graph3dViewGridSize,_gridGap:l.graph3dViewGridGap,_gridColor:l.graph3dViewGridColor,_originAxisVisible:l.graph3dViewOriginAxisVisible,_centerAxisVisible:l.graph3dViewCenterAxisVisible,_axisXColor:l.graph3dViewAxisXColor,_axisYColor:l.graph3dViewAxisYColor,_axisZColor:l.graph3dViewAxisZColor,_ortho:l.graph3dViewOrtho,_orthoWidth:l.graph3dViewOrthoWidth,_fovy:l.graph3dViewFovy,_near:l.graph3dViewNear,_far:l.graph3dViewFar,_headlightColor:l.graph3dViewHeadlightColor,_headlightIntensity:l.graph3dViewHeadlightIntensity,_headlightRange:l.graph3dViewHeadlightRange,_headlightDisabled:l.graph3dViewHeadlightDisabled,_rectSelectable:l.graph3dViewRectSelectable,_rectSelectBackground:l.graph3dViewRectSelectBackground,_editSizeColor:l.graph3dViewEditSizeColor,_autoMakeVisible:$o,_fogDisabled:l.graph3dViewFogDisabled,_fogColor:l.graph3dViewFogColor,_fogNear:l.graph3dViewFogNear,_fogFar:l.graph3dViewFogFar,_dashDisabled:l.graph3dViewDashDisabled,_batchColorDisabled:l.graph3dViewBatchColorDisabled,_batchBlendDisabled:l.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:l.graph3dViewBatchBrightnessDisabled,setEye:function(C,L,v){1===arguments.length&&(L=C[1],v=C[2],C=C[0]);var T=this._eye;T[0]=C,T[1]=L,T[2]=v,this.fp(Wg,s,T)},setCenter:function(M,R,C){1===arguments.length&&(R=M[1],C=M[2],M=M[0]);var H=this._center;H[0]=M,H[1]=R,H[2]=C,this.fp(Re,s,H)},setUp:function(b,H,m){1===arguments.length&&(H=b[1],m=b[2],b=b[0]);var A=this._up;A[0]=b,A[1]=H,A[2]=m,this.fp("up",s,A)},getDevicePixelRatio:function(){return this._devicePixelRatio||Rb},isTransparentMask:function(b){return b.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var P=this,J=P._aspect;return J?J:(J=P.getWidth()/P.getHeight(),J||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(p){var $=this,l=$._dataModel,E=$._selectionModel;l!==p&&(l&&(l.ump($.handleDataModelPropertyChange,$),l.umm($.handleDataModelChange,$),l.umd($.handleDataPropertyChange,$),E||l.sm().ums($.handleSelectionChange,$)),$._dataModel=p,p.mp($.handleDataModelPropertyChange,$),p.mm($.handleDataModelChange,$),p.md($.handleDataPropertyChange,$),E?E._21I(p):p.sm().ms($.handleSelectionChange,$),$._postProcessing.handleDataModleChange(l,p),$.invalidateAll(!0),$.invalidateLight(),$.fp(oo,l,p),$._canvas.style.background=p.getBackground()||"")},handleDataModelPropertyChange:function(I){if("background"===I.property){var J=this._canvas.style.background,w=I.newValue||"";this._canvas.style.background=w,this.fp("canvasBackground",J,w)}else"envmap"===I.property&&this.iv()},handleDataPropertyChange:function(r){var U=r.data;this.invalidateData(U),Mh(U)&&"s:light.type"===r.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(E){var A=this,k=E.property;A.iv(),A._18Q=s,"eye"===k?A._33Q=!0:"devicePixelRatio"===k?A._42(s,A.getDevicePixelRatio()):Nl[k]&&eo(A)},_5O:function(K){var W=K._22Q();return W?new W(this,K):s},getData3dUI:function(K){var S=this._25I[K._id];return S===r&&(S=this._5O(K),this._25I[K._id]=S),S},invalidateAll:function(r){var X=this;if(r){for(var P in X._25I){var W=X._25I[P];W&&W.dispose()}X._25I={},X.iv(),$g(X)}else $g(X),X.dm().each(function(I){X.invalidateData(I)})},invalidateSelection:function(){var x=this;x.sm().each(function(V){x.invalidateData(V)})},invalidateData:function(R){var y=this,O=y.getData3dUI(R);O&&(O.iv(),y.iv()),$g(y,R)},getShape3dText:function(d){return d.getStyle("shape3d.text")||this.getLabel(d)},invalidateBatch:function(R){var J=this,Z=J._batchModelMap,O=Z[R],e=[],p={};if(O){O.ds.forEach(function(G){var B=J.getData3dUI(G);B&&B.iv(),delete J._batchIndexMap[G._id],e.push(G._id)}),delete Z[R];for(var D,v,W,A,y,h,M,Y,S,I=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],t=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],i=0;i<I.length;i++){var $=J[I[i]],K=J[t[i]];for(p={},Y=0;Y<e.length;Y++){var X=K[e[Y]];if(X){delete K[e[Y]],S=X.batch,D=$[S];var u=X.begin,g=X.size,b=3*u,o=3*g,n=4*u,d=4*g;for(v=D.ds,W=D.vs,A=D.cs,y=D.ps,h=D.ls,M=X.index,D.invalidate=!0,v[M]=r,M=b;b+o>M;M++)W[M]=r;for(M=n;n+d>M;M++)A[M]=r;for(M=n;n+d>M;M++)y[M]=r;if(h)for(M=b;b+o>M;M++)h[M]=r;p[S]=!0}}for(S in p){D=$[S],v=D.ds,W=D.vs,A=D.cs,y=D.ps,h=D.ls;var q=[];for(M=0;M<v.length;M++)v[M]!==r&&q.push(v[M]);if(0===q.length)delete $[S];else{for(D.ds=q,q=[],M=0;M<W.length;M++)W[M]!==r&&q.push(W[M]);for(D.vs=q,q=[],M=0;M<A.length;M++)A[M]!==r&&q.push(A[M]);for(D.cs=q,q=[],M=0;M<y.length;M++)y[M]!==r&&q.push(y[M]);if(D.ps=q,h){for(q=[],M=0;M<h.length;M++)h[M]!==r&&q.push(h[M]);D.ls=q}}}}J.iv()}},handleDataModelChange:function(f){var X=this,J=f.kind,I=f.data;if("add"===J)X.invalidateData(I),Hb(I)&&I.getEdgeGroup()&&I.getEdgeGroup().eachSiblingEdge(X.invalidateData,X),Mh(I)&&X.invalidateLight();else if(J===fj){var o=I._id,C=X._25I[o];C&&(C.dispose(),delete X._25I[o],X.iv()),I===X._currentSubGraph&&X.setCurrentSubGraph(s),$g(X,I),Mh(I)&&X.invalidateLight()}else J===Xb&&(X.invalidateAll(!0),X.setCurrentSubGraph(s),$g(X),X.invalidateLight())},toCanvas:function(R,C,g){var L=this,k=L.getGL();if(L.validate(),R){var m=k.getParameter(k.COLOR_CLEAR_VALUE);cs(k,R)}L._42(s,1);var o=L.getWidth(),W=L.getHeight(),P=new Uint8Array(4*o*W),Q=Ub(),a=Q.getContext("2d");k.readPixels(0,0,o,W,k.RGBA,k.UNSIGNED_BYTE,P),sf(Q,o,W,1);for(var j=a.getImageData(0,0,o,W),F=j.data,T=0;T<F.length;T+=4){var i=T/4,E=c(i/o),I=i-E*o;i=4*((W-1-E)*o+I),F[i]=P[T],F[i+1]=P[T+1],F[i+2]=P[T+2],F[i+3]=P[T+3]}if(a.putImageData(j,0,0),R&&cs(k,m),L._42(s,L.getDevicePixelRatio()),C&&g){var Z=Ub(),S=Z.getContext("2d");return C=C,g=g,sf(Z,C,g,1),l.drawImage(S,Q,0,0,C,g),Z}return Q},toDataURL:function(c,C){var A=this,B=A.getGL();if(A.validate(),c){var N=B.getParameter(B.COLOR_CLEAR_VALUE);cs(B,c)}A._42(s,1);var g=A._canvas.toDataURL(C||"image/png",1);return c&&cs(B,N),A._42(s,A.getDevicePixelRatio()),g},getGL:function(){var o=this,P=o._26I;if(o._prg,!P)try{o._2O={},P=o._26I=o._canvas.getContext("webgl",o._attributes)||o._canvas.getContext("experimental-webgl",o._attributes),P._emptyTexture=fe(P),P._emptyBlendTexture=fe(P),P._bufPool={},P._id=++bp,o._buffer={vs:af(P),ns:af(P),is:af(P),uv:af(P),batchColor:af(P),batchBlend:af(P),batchBrightness:af(P),lineDistance:af(P)},o._1O=gi(P);var r=o._cube={vs:af(P),ns:af(P),is:af(P),uv:af(P)};Hf(P,r.vs,zk),Hf(P,r.ns,Mj),Hf(P,r.uv,Sq),Lm(P,r.is,Kf)}catch(c){}return o.acquireProgram(),P},acquireProgram:function(){var W=this,E=W._26I;if(E){var F=I.Default.getImage(W.dm().getEnvmap())?!0:!1,O=W._prg&&W._prg.envMapFlag?!0:!1;if(!W._prg||F!==O){var J=W._prg=E.createProgram();if(!J)return s;J.envMapFlag=F;var H=W._dirs.length,b=W._spots.length,Y=W._59O.length,z=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];H&&z.push("uDirColor","uDirDirection"),b&&z.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),Y&&z.push("uPointColor","uPointRange","uPointPosition"),cs(E,[0,0,0,0]),E.clearDepth(1),E.enable(E.DEPTH_TEST),E.depthFunc(E.LEQUAL),E.enable(E.BLEND),E.blendFuncSeparate(E.SRC_ALPHA,E.ONE_MINUS_SRC_ALPHA,E.ONE,E.ONE_MINUS_SRC_ALPHA),On||(zb=fb(zb.substring(0,zb.indexOf("^#"))),Pj=fb(Pj),On=!0);var T=["#define MAX_DIR "+H,"#define MAX_SPOT "+b,"#define MAX_POINT "+Y,W._fogDisabled?"":"#define FOG",W._dashDisabled?"":"#define DASH",F?"#define USE_ENVMAP":"",W._batchColorDisabled?"":"#define BATCHCOLOR",W._batchBlendDisabled?"":"#define BATCHBLEND",W._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),c=Mr(E,J,E.VERTEX_SHADER,zb.replace("PREFIX",T));E.getShaderParameter(c,E.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",E.getShaderInfoLog(c));var x=Mr(E,J,E.FRAGMENT_SHADER,Pj.replace("PREFIX",T));E.getShaderParameter(x,E.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",E.getShaderInfoLog(x)),N?z.push("aPosition"):(J.aPosition=0,E.bindAttribLocation(J,0,"aPosition")),E.linkProgram(J),z.forEach(function(j){J[j]=/^u/.test(j)?E.getUniformLocation(J,j):E.getAttribLocation(J,j)}),E.useProgram(J),E.deleteShader(c),E.deleteShader(x)}}},getBrightness:function(x){var d=x.s("brightness"),O=this.isSelected(x)?x.s("select.brightness"):s;return d==s?O:O==s?d:d*O},setHighlightMode:function(B){var n;n="selection"===B?Af.Mode.Selection:"mouseover"===B?Af.Mode.MouseOver:Af.Mode.Disable,this._highlightHelper.mode=n},getHighlightMode:function(){var W=this._highlightHelper.mode;return W===Af.Mode.Selection?"selection":W===Af.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(_){var A=this,x=A._prg,X=5,B=A.dm().getEnvmap(),c=I.Default.getImage(B);if(c){if(B!==A._lastEnvMap){A._envMapTexture&&_.deleteTexture(A._envMapTexture);var f=A._envMapTexture=_.createTexture();_.bindTexture(_.TEXTURE_CUBE_MAP,f),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,c),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,c),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,c),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,c),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,c),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,c),_.bindTexture(_.TEXTURE_CUBE_MAP,null),A._lastEnvMap=B}_.activeTexture(_.TEXTURE0+X),_.bindTexture(_.TEXTURE_CUBE_MAP,A._envMapTexture),_.uniform1i(x.uEnvMap,X)}},getWireframe:function(S){var B=S.s("wf.visible"),b=S.s("wf.width");return B===!0||b>0&&"selected"===B&&this.isSelected(S)?{color:S.s("wf.color"),width:b,"short":S.s("wf.short"),mat:S.s("wf.mat")}:void 0},_transformPointToViewSpace:function(X){var s=[X[0],X[1],X[2]];return Zk(s,this._viewMatrix),s},_transformDirectionToViewSpace:function(v,b){var f=[v[0],v[1],v[2]];Zk(f,this._viewMatrix);var K=b?[b[0],b[1],b[2]]:[0,0,0];Zk(K,this._viewMatrix);var Y=K[0]-f[0],Z=K[1]-f[1],N=K[2]-f[2],P=Math.sqrt(Y*Y+Z*Z+N*N);return P?[Y/P,Z/P,N/P]:[Y,Z,N]},getWireframeGeometry:function(r){return r.s("wf.geometry")?{color:r.s("wf.color"),width:r.s("wf.width"),mat:r.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(s){return s.s("body.color")},getMat:function(G){return G.getMat?G.getMat():G.s("mat")},getFaceMat:function(W,B){return W.getFaceMat?W.getFaceMat(B):W.s(B+".mat")},getFaceBlend:function(Y,x){return Y.s(x+".blend")||Y.s("all.blend")},getFaceColor:function(T,E){return T.s(E+".color")||T.s("all.color")},getFaceImage:function(N,z){return N.s(z+".image")||N.s("all.image")},getFaceBlendImage:function(f,G){return f.s(G+".blend.image")||f.s("all.blend.image")},getFaceDiscardSelectable:function(M,w){var O=M.s(w+".discard.selectable");return O==s?M.s("all.discard.selectable"):O},getFaceUv:function(c,X){return c.s(X+".uv")||c.s("all.uv")},getFaceUvOffset:function(s,f){return s.s(f+".uv.offset")||s.s("all.uv.offset")},getFaceUvScale:function(Q,e){return Q.s(e+".uv.scale")||Q.s("all.uv.scale")},getFaceLight:function(q,u){var A=q.s(u+".light");return A==s?q.s("all.light"):A},getFaceVisible:function(b,c){var h=b.s(c+".visible");return h==s?b.s("all.visible"):h},getFaceOpacity:function(Q,q){var w=Q.s(q+".opacity");return w==s?Q.s("all.opacity"):w},getFaceTransparent:function(I,i){var Y=I.s(i+".transparent");return Y==s?I.s("all.transparent"):Y},getFaceReverseColor:function(k,e){return k.s(e+".reverse.color")||k.s("all.reverse.color")},getFaceReverseFlip:function(t,j){var k=t.s(j+".reverse.flip");return k==s?t.s("all.reverse.flip"):k},getFaceReverseCull:function(l,D){var X=l.s(D+".reverse.cull");return X==s?l.s("all.reverse.cull"):X},getTextureMap:function(){return this._2O},deleteTexture:function(Z){var N=this,r=N._2O[Z];r&&(delete N._2O[Z],N.getGL().deleteTexture(r))},invalidateShape3dCachedImage:function(Y){var k=this.getData3dUI(Y);k.invalidateCachedTexture(this.getGL())},isInteractive:function(n){return n.s("interactive")},getTexture:function(b,y){if(!b)return s;var e=this,W=e.getGL(),m=e._2O[b];if(!m){var R=nb(b);if(!R)return W._emptyTexture;if(R.uuid||(R.uuid=I.Math.generateUUID()),R.tagName){if(R.dynamic)return gi(W,R,e._1O);m=e._2O[b]=gi(W,R)}else{var L,u=y&&y.s("shape3d.image.cache")&&!e.isInteractive(y),h=e.vr.isPresenting();if(h&&(y._textureUpdateFrame===W._renderInfo.frame?u=!0:y._textureUpdateFrame=W._renderInfo.frame),u&&(L=e.getData3dUI(y),m=L.getCachedTexture()),!m){if(u){if(W._renderInfo.cacheTimeCost>l.graph3dMaxVectorCacheTime)return e.redraw(),W._emptyTexture;if(!Qd(R,y))return W._emptyTexture}var w,H=y&&y.s("shape3d.fixSizeOnScreen"),n=H?W.NEAREST:W.LINEAR;H||y&&y.s("shape3d.vector.dynamic")&&(L||(L=e.getData3dUI(y)),H=L.getVectorDynamicSize(),H&&(w=e.getDevicePixelRatio(),H[0]*=w,H[1]*=w));var r,j,Y=y&&y.s("shape3d.texture.scale")||1;if(H?(w||(w=e.getDevicePixelRatio()),r=H[0]>0?H[0]:Y*El(R,y)*w,j=H[1]>0?H[1]:Y*tj(R,y)*w):(r=Y*El(R,y),j=Y*tj(R,y)),r>=1&&j>=1){var k=0;u&&(k=Date.now());var g=Ac(r,j);if(!L&&y&&(L=e.getData3dUI(y)),L&&L.interactiveInfo){var X=b;"object"==typeof X&&(X=X.uuid||(X.uuid=I.Math.generateUUID()));var q=L.interactiveInfo[X]={};g.interactiveInfo=q.bodyInfo={compInfos:[],matrix:new Am,rect:{x:0,y:0,width:r,height:j}}}rm(g,R,0,0,r,j,y,e),g.interactiveInfo&&(g.interactiveInfo=null),g.restore(),u||h?(m=gi(W,xl,null,n),L.setCachedTexture(m),W._renderInfo.cacheTimeCost+=Date.now()-k,xl=null):m=gi(W,xl,e._1O,n)}}}}return m},redraw:function(){this.iv()},validateImpl:function(){var o=this;if(o._lightChanged){o._lightChanged=!1;var y=[],t=[],K=[];o.dm().each(function(g){if(Mh(g)){var P=g.s("light.type");P===Wf?y.push(g):P===mg?t.push(g):P===_m&&K.push(g)}}),(y.length!==o._59O.length||t.length!==o._spots.length||K.length!==o._dirs.length)&&eo(o),o._59O=y,o._spots=t,o._dirs=K}o._42(),o._1o.iv()},getRenderInfo:function(){var B=this.getGL();return B?B._renderInfo:void 0},getDebugTip:function(){var S=this,Z=S.getRenderInfo();if(Z){var D=S.getGL()._validBufCount||0,r="Draw Calls: "+Z.calls+"<br/>"+"Vertices: "+Z.vertices+"<br/>"+"Faces: "+Z.faces+"<br/>"+"Lines: "+Z.lines+"<br/>"+"Buffer Count: "+D;return S.vr.isPresenting()&&(r+="<br/>VR fps: "+S.vr.getFps()),r}},_42:function(J,a){var z=this;if(!z._35O&&(!tp||wg(tp))){var p,r;J&&(J instanceof Vb?r=J:p=J);var A=z._canvas,P=z.getGL(),x=z._prg;if(P){var Q=z.getWidth(),U=z.getHeight();a?J||sf(A,Q,U,a):(a=z.getDevicePixelRatio(),J||Q===A.clientWidth&&U===A.clientHeight||sf(A,Q,U,a)),P.clear(P.COLOR_BUFFER_BIT),z.drawFilter||(P._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:J?z._frameId:++z._frameId,cacheTimeCost:0});var M=function(){if(z.overlappingBox.clear(),z._81O=s,P.clear(P.DEPTH_BUFFER_BIT),Xc(P,x.uBrightness,1),Xc(P,x.uOpacity,1),Xc(P,x.uPartOpacity,1),P._picking=!!J,Xc(P,x.uPick,!!J),Xc(P,x.uTexture,!1),Xc(P,x.uBlendTexture,!1),Xc(P,x.uAlphaTest,g.alphaTest),Xc(P,x.uTransparent,!1),Xc(P,x.uFix,!1),Xc(P,x.uBatchColor,!1),Xc(P,x.uBatchBlend,!1),Xc(P,x.uBatchBrightness,!1),Xc(P,x.uReflectivity,z._envmapReflectivity||.5),Xc(P,x.uCameraPosition,z.getEye()),Xc(P,x.uPMatrix,z._projectMatrix=Pf(z)),Xc(P,x.uViewMatrix,kc(z,z._7O)),z.bindEnvMap(P),z._viewMatrix=uk(z._7O),J||(jo(z,P,x),z._fogDisabled||(Xc(P,x.uFogColor,z._fogColor),Xc(P,x.uFogNear,z._fogNear),Xc(P,x.uFogFar,z._fogFar))),Cf(P,x.aPosition),Cf(P,x.aNormal),bf(P,x.aUv),bf(P,x.aBatchColor),bf(P,x.aBatchBlend),bf(P,x.aBatchBrightness),bf(P,x.aLineDistance),r){var F=P.getParameter(P.COLOR_CLEAR_VALUE);P.clearColor(0,0,0,0),P.disable(P.BLEND),bf(P,x.aNormal),Hf(P,z._cube.vs,s,x.aPosition),Lm(P,z._cube.is),Gm(r,z,Ih,0),Gm(r,z,pg,6),Gm(r,z,Go,12),Gm(r,z,Pm,18),Gm(r,z,ns,24),Gm(r,z,cj,30),Cf(P,x.aNormal),cs(P,F)}else if(p){p.value=2;var F=P.getParameter(P.COLOR_CLEAR_VALUE);P.clearColor(0,0,0,0),P.disable(P.BLEND),z._95I(P,x,p),ue(z,p),Rr(z,z._polylineModelMap,p),Rr(z,z._wireframeModelMap,p),Xc(P,x.uTransparent,!0),z._95I(P,x,p,!0),ue(z,p,!0),Rr(z,z._polylineModelMap,p,!0),Rr(z,z._wireframeModelMap,p,!0),Xc(P,x.uTransparent,!1),P.clear(P.DEPTH_BUFFER_BIT),z._swapLineMap(),z._95I(P,x,p,!1,!0),Rr(z,z._polylineModelMap,p),Rr(z,z._wireframeModelMap,p),z._swapLineMap(),z._swapLineMap(),z._95I(P,x,p,!1,!0),Rr(z,z._polylineModelMap,p),Rr(z,z._wireframeModelMap,p),Xc(P,x.uTransparent,!0),z._95I(P,x,p,!0,!0),Rr(z,z._polylineModelMap,p,!0),Rr(z,z._wireframeModelMap,p,!0),Xc(P,x.uTransparent,!1),z._swapLineMap(),P.disable(P.DEPTH_TEST),z.drawFilter||z._30O._42(P,x,p),P.enable(P.DEPTH_TEST),cs(P,F)}else P.disable(P.BLEND),z.drawSky(P,x),z._31O._42(P,x),z._95I(P,x),ue(z),Rr(z,z._polylineModelMap),Rr(z,z._wireframeModelMap),P.enable(P.BLEND),Xc(P,x.uTransparent,!0),P.depthMask(!1),z._95I(P,x,s,!0),ue(z,s,!0),Rr(z,z._polylineModelMap,s,!0),Rr(z,z._wireframeModelMap,s,!0),P.depthMask(!0),Xc(P,x.uTransparent,!1),P.clear(P.DEPTH_BUFFER_BIT),z._swapLineMap(),P.disable(P.BLEND),z._95I(P,x,s,!1,!0),Rr(z,z._polylineModelMap),Rr(z,z._wireframeModelMap),P.enable(P.BLEND),Xc(P,x.uTransparent,!0),P.depthMask(!1),z._95I(P,x,s,!0,!0),Rr(z,z._polylineModelMap,s,!0),Rr(z,z._wireframeModelMap,s,!0),P.depthMask(!0),Xc(P,x.uTransparent,!1),z._swapLineMap(),P.disable(P.DEPTH_TEST),P.disable(P.BLEND),z._32O._42(P,x),z._30O._42(P,x),z._highlightHelper._42(P,x),P.enable(P.DEPTH_TEST);Hf(P,s),Lm(P,s)},i=!1,t=Q*a,Y=U*a,d=z.vr;d.enable&&d._42(P,t,Y,M)&&(i=!0);var V=z.envRenderer;V&&V.enable&&V._42(P,t,Y,M)&&(i=!0);var B=z._postProcessing;B._42(P,t,Y,M,J)&&(i=!0),i||(z.setViewport(P,0,0,Q*a,U*a),M()),z._33Q=!1,z.drawFilter||z.countFrame(),z._doBufferGC(P)}}},enablePostProcessing:function(_,R){return this._postProcessing.enableModule(_,R)},getPostProcessingModule:function(G){return this._postProcessing.getModule(G)},setViewport:function(N,Y,A,w,y){this._viewport=[Y,A,w,y],N.viewport(Y,A,w,y)},getViewport:function(){return this._viewport},setBufferGCInterval:function(q){this._bufferGCInterval=q},_doBufferGC:function(y,d){var g,l,V=y._bufPool,N=0,J=0,B=y._renderInfo.frame,L=this._bufferGCInterval||10;for(g in V)N++,l=V[g],l&&(d||B-l._fid>L?(y.deleteBuffer(l._buf),l._buf=null,V[g]=null):J++);if(N/2>J&&N>128){var s={};for(g in V)V[g]&&(s[g]=V[g]);y._bufPool=s}y._validBufCount=J},_swapLineMap:function(){var T=this;O=T._polylineModelMap,T._polylineModelMap=T._polylineModelMapSwap,T._polylineModelMapSwap=O,O=T._wireframeModelMap,T._wireframeModelMap=T._wireframeModelMapSwap,T._wireframeModelMapSwap=O,O=T._polylineIndexMap,T._polylineIndexMap=T._polylineIndexMapSwap,T._polylineIndexMapSwap=O,O=T._wireframeIndexMap,T._wireframeIndexMap=T._wireframeIndexMapSwap,T._wireframeIndexMapSwap=O},_updateSkyBox:function(s){if(this._skyBox&&s){var k=s.property,q=!1,Y=this._skyBox;if("eye"===k||"forceUpdate"===k){var L=this._eye;Y.p3(L[0],L[1],L[2]),q=!0}if("near"===k||"far"===k||"forceUpdate"===k){var j=this._near,Z=this._far,g=Y.getFinalScale3d();if(g[0]/=2,g[1]/=2,g[2]/=2,g[0]<=j||g[0]>=Z||g[1]<=j||g[1]>=Z||g[2]<=j||g[2]>=Z){var _=2*j*Z/(j+Z),l=Math.min(g[0],g[1],g[2]),c=_/l,I=Y.getScale3d();Y.setScale3d(I[0]*c,I[1]*c,I[2]*c),q=!0}}q&&this.invalidateData(Y)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(o){var q=this._skyBox;q&&(this._skyBoxStyleMap&&q.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&q.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&q.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=o,this.ump(this._updateSkyBox,this),o&&(o.dm()&&o.dm().remove(o),this._skyBoxStyleMap=I.Default.clone(o.getStyleMap()),this._skyBoxAnchor3d=o.getAnchor3d(),o.setAnchor3d(.5,.5,.5),this._skyBoxP3=o.p3().slice(0),o.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",q,o)},drawSky:function(u,H,r){var y=this,O=y._skyBox;if(O){var W=y._headlightIntensity,Y=oj(y._headlightColor),H=y._prg;1!==W&&(Y=[Y[0]*W,Y[1]*W,Y[2]*W]),Xc(u,H.uHeadlightColor,[Y[0],Y[1],Y[2],1]);var A=y.getData3dUI(O);A&&A._42(u,H,r,function(){return!0}),u.clear(u.DEPTH_BUFFER_BIT),Xc(u,H.uHeadlightColor,[Y[0],Y[1],Y[2],y._headlightDisabled?1:0])}},_95I:function(o,Z,w,T,t){function c(E){if(!!E.s("shape3d.alwaysOnTop")==!!t&&W.isVisible(E)&&(!u||Y)){if(!w&&W.isTransparentMask(E))return;var A=W.getData3dUI(E);A&&A._42(o,Z,w,H)}}var W=this,H=function(m){return T?m:!m};W.sky&&o.clear(o.DEPTH_BUFFER_BIT);var $=W.drawFilter;$?W.dm().each(function(U){$(U)||c(U)}):W.dm().each(function(r){c(r)})},getLogicalPoint:function(D){return Xq(D,this._canvas)},isRectOverlapping:function(J){var g=this.getData3dUI(J);return g._rectOverlapping},getHitFaceInfo:function(B){B.target&&(B=this.lp(B));var U=this.getDataInfoAt(B);if(U){var $=this._1o.face(U.data,ne(B.x,B.y));if($)return{data:U.data,face:$}}return s},unproject:function(C,b){var M=this,r=M.getWidth(),H=M.getHeight(),n=C.target?M.lp(C):C,F=n.x-r/2,S=n.y-H/2,h=2*(F/r),f=2*(-1*S/H);b=b||0;var T=Rp(),Z=Pf(M),i=kc(M);fq(T,Z,i),ls(T);var $=qg([h,f,b,1],T);return[$[0]/$[3],$[1]/$[3],$[2]/$[3]]},getDataAt:function(d){var J=this.getDataInfoAt(d);return J?J.data:s},getDataInfoAt:function(A,w){return A.target&&(A=this.lp(A)),this._1o.get(ne(A.x,A.y,w),!0)},getDatasInRect:function(B){return this._1o.get(B)},setEditable:function(H){var P=this,N=P._editable;P._editable=H,this.fp(eb,N,H)},isEditable:function(w){var g=this;return g._editable?lb(w)?w.s("3d.editable")?g._editableFunc?g._editableFunc(w):!0:!1:!1:!1},isSelectable:function(n){return n.s("3d.selectable")&&this.sm().isSelectable(n)},isMovable:function(s){var q=this;return Hb(s)&&s.getStyle(Cp)!==Gp?!1:s.s("3d.movable")?q._movableFunc?q._movableFunc(s):!0:!1},isSizeEditable:function(V){return lb(V)?this._sizeEditableFunc?this._sizeEditableFunc(V):!0:!1},isRotationEditable:function(S){return lb(S)&&S.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(S):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(g){this.setZoom(Oh,g)},zoomOut:function(m){this.setZoom(1/Oh,m)},setZoom:function(l,p){if(1!==l){var d=this;if(d._ortho)return d.setOrthoZoom(l,p),void 0;d._14o&&d._14o.stop(!0);var N=1/l,t=d._eye,S=d._center,x=S[0]+(t[0]-S[0])*N-t[0],o=S[1]+(t[1]-S[1])*N-t[1],$=S[2]+(t[2]-S[2])*N-t[2];if(!(Bg(t,S)<d._moveStep&&1>N)){if(p=dg(p)){var y=kl(t);return p.action=function(j){d.fi({kind:d._zooming?"betweenZoom":"beginZoom"}),d._zooming=1,t[0]=y[0]+x*j,t[1]=y[1]+o*j,t[2]=y[2]+$*j,d.fp(Wg,s,t)},p._37o=function(){delete d._14o,delete d._zooming,d.fi({kind:"endZoom"}),d.onZoomEnded()},d._14o=xc(p)}t[0]+=x,t[1]+=o,t[2]+=$,d.fp(Wg,s,t)}}},setOrthoZoom:function(N,E){if(1!==N){var v=this;v._14o&&v._14o.stop(!0);var t=v._orthoWidth,S=t/N-t;if(!(t<v._moveStep&&N>1))return(E=dg(E))?(E.action=function(R){v.fi({kind:v._zooming?"betweenZoom":"beginZoom"}),v._zooming=1,v.setOrthoWidth(t+S*R)},E._37o=function(){delete v._14o,delete v._zooming,v.fi({kind:"endZoom"}),v.onZoomEnded()},v._14o=xc(E)):(v.setOrthoWidth(t/N),void 0)}},getPositionInfo:function(w){var J=this,t=J._eye,O=J._center,z=J.getAspect(),o=w?pk(tn(O,t,!0),tn(w,t)):Bg(t,O);if(J._ortho){var y=J._orthoWidth;return{length:o,height:y/z,width:y}}var C=2*x(J._fovy/2)*o;return{length:o,height:C,width:C*z}},getCenterInfo:function(){var F=this;return F._81O||(F._81O=F.getPositionInfo()),kl(F._81O)},rotate:function(e,z,g,N){var I=this;if(e||z){N==s&&(N=I._firstPersonMode),I._88O&&I._88O.stop(!0);var j=I._center,q=I._eye,u=I.getCenterInfo().length,U=N?j:q,G=N?q:j,i=tn(U,G),C=Z(i[0],i[2]),H=Z(W(i[0]*i[0]+i[2]*i[2]),i[1]),t=N?Re:Wg;return N&&(z=-z),(g=dg(g))?(g.action=function(V){I.fi({kind:I._rotating?"betweenRotate":"beginRotate"}),I._rotating=1;var W=C+e*V,M=H+z*V;M=Id(M),i[0]=u*w(M)*w(W),i[1]=u*b(M),i[2]=u*w(M)*b(W),U[0]=G[0]+i[0],U[1]=G[1]+i[1],U[2]=G[2]+i[2],I.fp(t,s,U)},g._37o=function(){delete I._88O,delete I._rotating,I.fi({kind:"endRotate"}),I.onRotateEnded()},I._88O=xc(g)):(C+=e,H+=z,H=Id(H),i[0]=u*w(H)*w(C),i[1]=u*b(H),i[2]=u*w(H)*b(C),U[0]=G[0]+i[0],U[1]=G[1]+i[1],U[2]=G[2]+i[2],I.fp(t,s,U),void 0)}},pan:function(g,P,D,u){if(g||P){var M=this;u==s&&(u=M._firstPersonMode),M._89O&&M._89O.stop(!0);var e=kc(M),i=[e[0]*g,e[4]*g,e[8]*g],z=[e[1]*P,e[5]*P,e[9]*P],B=i[0]+z[0],y=i[1]+z[1],c=i[2]+z[2],l=M._center,E=M._eye;if(u){var A=Hp(M.getBoundaries(),E[0],E[2],E[0]+B,E[2]+c,W(B*B+c*c));B=A[0],c=A[1]}if(D=dg(D)){var V=kl(E),b=kl(l);return D.action=function(H){M.fi({kind:M._panning?"betweenPan":"beginPan"}),M._panning=1,l[0]=b[0]+B*H,l[1]=b[1]+y*H,l[2]=b[2]+c*H,E[0]=V[0]+B*H,E[1]=V[1]+y*H,E[2]=V[2]+c*H,M.fp(Wg,s,E),M.fp(Re,s,l)},D._37o=function(){delete M._89O,delete M._panning,M.fi({kind:"endPan"}),M.onPanEnded()},M._89O=xc(D)}l[0]+=B,l[1]+=y,l[2]+=c,E[0]+=B,E[1]+=y,E[2]+=c,M.fp(Wg,s,E),M.fp(Re,s,l)}},walk:function(x,n,K){if(x){var J=this;K==s&&(K=J._firstPersonMode),J._90O&&J._90O.stop(!0);var o=J._center,m=J._eye,g=tn(o,m,!0);if(K){var E=Hp(J.getBoundaries(),m[0],m[2],m[0]+g[0]*x,m[2]+g[2]*x,P(x));if(x=Bg(E),!x)return;g=[E[0]/x,0,E[1]/x]}if(n=dg(n)){var R=kl(m),T=kl(o);return n.action=function(H){J.fi({kind:J._walking?"betweenWalk":"beginWalk"}),J._walking=1;var P=x*H;m[0]=R[0]+g[0]*P,m[1]=R[1]+g[1]*P,m[2]=R[2]+g[2]*P,o[0]=T[0]+g[0]*P,o[1]=T[1]+g[1]*P,o[2]=T[2]+g[2]*P,J.fp(Wg,s,m),J.fp(Re,s,o)},n._37o=function(){delete J._90O,delete J._walking,J.fi({kind:"endWalk"}),J.onWalkEnded()
        },J._90O=xc(n)}m[0]+=g[0]*x,m[1]+=g[1]*x,m[2]+=g[2]*x,o[0]+=g[0]*x,o[1]+=g[1]*x,o[2]+=g[2]*x,J.fp(Wg,s,m),J.fp(Re,s,o)}},handleScroll:function(O,h){O.preventDefault();var q=this,_=q._moveStep,u=q.getDataInfoAt(O);if(u){var b=u.data;if(b&&q.isInteractive(b)){var N=q.intersectObject(O,b);if(N){var v=N.part,H=nb(b.s(v+".image")||b.s("shape3d."+v+".image")||b.s("all.image")||b.s("shape3d.image"));if(H&&Ro(H.scrollable,b,q))return}}}q.isFirstPersonMode()?q.isPannable()&&q.pan(0,h>0?_:-_):q.isZoomable()&&q.setZoom(0>h?1/id:id)},handlePinch:function(k,w){this.isZoomable()&&this.setZoom(w>k?1/hq:hq)},reset:function(){this.setCenter(l.graph3dViewCenter),this.setEye(l.graph3dViewEye),this.setUp(l.graph3dViewUp)},moveSelection:function(p,v,n){var o=this;o.dm().beginTransaction(),oh(this.sm().toSelection(this.isMovable,this),p,v,n),o.dm().endTransaction()},getMoveMode:function(t,T){var v=T.s("3d.move.mode");if(v)return v;var b="88",j="89",n="90";return Fg(t)||wd[b]&&wd[j]&&wd[n]?"xyz":wd[b]&&wd[j]?"xy":wd[b]&&wd[n]?"xz":wd[j]&&wd[n]?"yz":wd[b]?"x":wd[j]?"y":wd[n]?"z":"xz"},handleTick:function(){var Y=this,d=!1,R=Y._moveStep,I=R,J=!1,Z=!0,U=Y._rotateStep*(Z?-1:1);if(Y.isWalkable()||(I=0),Y.isPannable()||(R=0),Y.isRotatable()||(U=0),Y._32Q){var p=(Ip()-Y._32Q)/50;I*=p,R*=p,U*=p}Y._31Q&&(Sh(Y._31Q),delete Y._31Q,delete Y._32Q),fh()&&(d=!0,Y.pan(-R,0,J,Z)),ik()&&(d=!0,Y.pan(R,0,J,Z)),iq()&&(d=!0,Fg()?Y.pan(0,R,J,Z):Y.walk(I,J,Z)),vs()&&(d=!0,Fg()?Y.pan(0,-R,J,Z):Y.walk(-I,J,Z)),Dp()&&(d=!0,Y.rotate(-U,0,J,Z)),Wc()&&(d=!0,Y.rotate(U,0,J,Z)),ri()&&(d=!0,Y.rotate(0,-U/2,J,Z)),tr()&&(d=!0,Y.rotate(0,U/2,J,Z)),d&&(Y._32Q=Ip(),Y._31Q=Ui(Y.handleTick,Y))},handleKeyDown:function(d){var B=this;!Ei(d)&&Ec[d.keyCode]?B.handleTick():Jc(d)?B.selectAll():Wl(d)?B.handleDelete(d):Ln(d)&&this.isResettable()&&B.reset()},checkDoubleClickOnNote:function(k,o,U){var H=this;if(U===Hl){if(o.s("note.toggleable"))return o.s(Cc,!o.s(Cc)),H.fi({kind:"toggleNote",event:k,data:o,part:U}),!0}else if(U===hc&&o.s("note2.toggleable"))return o.s(ob,!o.s(ob)),H.fi({kind:"toggleNote2",event:k,data:o,part:U}),!0;return!1},checkDoubleClickOnRotation:function(k,H,I){return I===Wr?(H.setRotationX(0),!0):I===al?(H.setRotationY(0),!0):I===oc?(H.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(U){var L=this;if(L.isOrtho())return L.getWidth()/L.getOrthoWidth();var I=L.getCenter(),f=L.getHeight(),T=L.getEye(),x=[I[0]-T[0],I[1]-T[1],I[2]-T[2]],C=[U[0]-T[0],U[1]-T[1],U[2]-T[2]],M=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]),g=1/Math.tan(L.getFovy()/2);return f*M*g/(C[0]*x[0]+C[1]*x[1]+C[2]*x[2])},inViewSpace:function(U){var A,d=this,F=d._transformPointToViewSpace(U),k=d.getAspect(),x=d.getNear(),c=d.getFar();return-F[2]<x||-F[2]>c?!1:d.isOrtho()?(A=d.getOrthoWidth()/2,Math.abs(F[0])<=A&&Math.abs(F[1]*k)<=A):(A=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2])*Math.tan(d.getFovy()/2),Math.abs(F[1]<=A)&&Math.abs(F[0])<=A*k)},toViewPosition:function(v){var B=this,i=B.getWidth()/2,E=B.getHeight()/2,f=B._18Q;return f&&f._wh===i/E||(f=Pf(B),B._18Q=fq(f,f,kc(B)),B._18Q._wh=i/E),v=qg([v[0],v[1],v[2],1],f),{x:i+i*v[0]/v[3],y:E-E*v[1]/v[3]}},getHitPosition:function(g,f,n){var a=this,J=a.getWidth(),X=a.getHeight(),C=g.target?a.lp(g):g,M=C.x-J/2,$=C.y-X/2,R=a.getCenterInfo(),Q=kc(a);f=f?f:[0,0,0],n=n?n:[0,1,0],M=M/J*R.width,$=-1*$/X*R.height;var t=[Q[0]*M,Q[4]*M,Q[8]*M],w=[Q[1]*$,Q[5]*$,Q[9]*$],H=[t[0]+w[0],t[1]+w[1],t[2]+w[2]],A=a.getCenter(),T=_h(a,f,n,[H[0]+A[0],H[1]+A[1],H[2]+A[2]]);return T?T:[0,0,0]},intersectObject:function(N,v){return this._raycaster.intersectObject(N,v)},intersectObjects:function(E,z,Z){return this._raycaster.intersectObjects(E,z,Z)},getLineLength:function(u){this.validate();var b=this.getData3dUI(u);if(b&&b.getCache){var f=b.getCache();if(f)return f[f.length-1].length}return 0},getLineOffset:function(Y,T){var B=this.getData3dUI(Y);if(B&&B.getCache){var X=B.getCache();if(X)return Of(X,T)}return s},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(W,j,g){var l=this,$=l.getEye();$=[$[0],$[1],$[2]];var S=l.getCenter();if(S=[S[0],S[1],S[2]],W||(W=$),j||(j=S),l._flyAnim&&l._flyAnim.stop(!0),g=dg(g),!g)return l.setEye(W[0],W[1],W[2]),l.setCenter(j[0],j[1],j[2]),delete l._flyAnim,!0;var x=[W[0]-$[0],W[1]-$[1],W[2]-$[2]],f=[j[0]-S[0],j[1]-S[1],j[2]-S[2]];return g.action=function(O){l.setCenter(S[0]+f[0]*O,S[1]+f[1]*O,S[2]+f[2]*O),l.setEye($[0]+x[0]*O,$[1]+x[1]*O,$[2]+x[2]*O)},g._37o=function(){delete l._flyAnim},l._flyAnim=xc(g)},flyTo:function(){function i(i,k,L){if(L instanceof I.Node){X.fromArray(yh(L,k.getMat(L)));var n=L.getAnchor3d();i.push((new Nd).set(0-n.x,0-n.y,0-n.z).applyMatrix4(X)),i.push((new Nd).set(0-n.x,0-n.y,1-n.z).applyMatrix4(X)),i.push((new Nd).set(0-n.x,1-n.y,0-n.z).applyMatrix4(X)),i.push((new Nd).set(0-n.x,1-n.y,1-n.z).applyMatrix4(X)),i.push((new Nd).set(1-n.x,0-n.y,0-n.z).applyMatrix4(X)),i.push((new Nd).set(1-n.x,0-n.y,1-n.z).applyMatrix4(X)),i.push((new Nd).set(1-n.x,1-n.y,0-n.z).applyMatrix4(X)),i.push((new Nd).set(1-n.x,1-n.y,1-n.z).applyMatrix4(X))}}var q=new Nd,P=new Nd,S=new Nd,D=new Nd,X=new rs,h=new I.Math.Quaternion,C=new pf;return function(j,k,e){var s=this;if(e!==r)k={animation:k,ratio:e};else{var A=typeof k;("boolean"===A||"object"===A&&k.duration)&&(k={animation:k})}k=k||{},q.fromArray(s.getEye()),P.fromArray(s.getCenter());var G,g,R=[],z=k.center,M=k.distance===r;if(z&&S.fromArray(z),j instanceof I.Node)z||S.fromArray(j.p3()),M&&(i(R,s,j),G=R.length);else{if(j||(j=s.dm().getDatas()),!j.length)return;if((M||!z)&&(R=[],j.forEach(function(S){i(R,s,S)}),G=R.length),!G)return;if(!z){for(S.set(0,0,0),g=0;G>g;g++)S.add(R[g]);S.multiplyScalar(1/G)}}if(s.setCenter(S.x,S.y,S.z),D.subVectors(q,P),k.direction||k.worldDirection){!k.worldDirection&&j instanceof I.Node?h.setFromEuler(C.set(j.r3(),j.getRotationMode(),!0)):h.set(0,0,0,1);var Y=D.length();D.fromArray(k.worldDirection||k.direction).applyQuaternion(h).setLength(Y)}if(M){for(var v,V,K,m,f,F=s.getNear(),n=10,e=k.ratio||.8;n--;){for(s._eye[0]=D.x+S.x,s._eye[1]=D.y+S.y,s._eye[2]=D.z+S.z,v=Pf(s),fq(v,v,kc(s)),m=!0,f=-1/0,g=0;G>g;g++){if(K=R[g],V=qg([K.x,K.y,K.z,1],v),V[3]<F&&n){D.multiplyScalar(2),m=!1;break}f=Math.max(f,Math.max(Math.abs(V[0]),Math.abs(V[1]))/e-V[3])}if(m)break}D.setLength(f+D.length()).add(S)}else D.setLength(k.distance).add(S);s._flyAnim&&s._flyAnim.stop(!0);var d=dg(k.animation);if(d){s.setEye(q.x,q.y,q.z),s.setCenter(P.x,P.y,P.z);var l=(new Nd).subVectors(D,q),y=(new Nd).subVectors(S,P),o=new Nd,x=new Nd;return d.action=function(A){o.copy(q).addScaledVector(l,A),x.copy(P).addScaledVector(y,A),s.setCenter(x.x,x.y,x.z),s.setEye(o.x,o.y,o.z)},d._37o=function(){delete s._flyAnim},{lastEye:q,lastCenter:P,eye:D,center:S,animation:s._flyAnim=xc(d)}}return s.setEye(D.x,D.y,D.z),delete s._flyAnim,{lastEye:q,lastCenter:P,eye:D,center:S}}}(),getBoundingBox:function(){function Z(q,u,b){S.fromArray(yh(b,u.getMat(b)));var J=b.getAnchor3d();q.push((new Nd).set(0-J.x,0-J.y,0-J.z).applyMatrix4(S)),q.push((new Nd).set(0-J.x,0-J.y,1-J.z).applyMatrix4(S)),q.push((new Nd).set(0-J.x,1-J.y,0-J.z).applyMatrix4(S)),q.push((new Nd).set(0-J.x,1-J.y,1-J.z).applyMatrix4(S)),q.push((new Nd).set(1-J.x,0-J.y,0-J.z).applyMatrix4(S)),q.push((new Nd).set(1-J.x,0-J.y,1-J.z).applyMatrix4(S)),q.push((new Nd).set(1-J.x,1-J.y,0-J.z).applyMatrix4(S)),q.push((new Nd).set(1-J.x,1-J.y,1-J.z).applyMatrix4(S))}var S=new rs;return function(J){if(J=J||this.sm().getSelection(),J instanceof I.Node&&(J=[J]),0===J.length)return s;var i=[];J.forEach(function(M){Z(i,this,M)},this);var P=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0];return i.forEach(function(J){P[0]=Math.min(J.x,P[0]),P[1]=Math.min(J.y,P[1]),P[2]=Math.min(J.z,P[2]),n[0]=Math.max(J.x,n[0]),n[1]=Math.max(J.y,n[1]),n[2]=Math.max(J.z,n[2])}),{min:P,max:n}}}()}),xn.RenderEnv=function(l){this.gv=l,this.enable=!1},H.defineProperties(xn.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(m){this._debugOn=m,this.capture&&this.capture()}}}),H.assign(xn.RenderEnv.prototype,{renderEnvToCube:function(G,g,a,E){var p=this,$=p.gv;if(!G||!g||!a)return p.enable=!1,p._42=null,void 0;p.enable=!0;var d=Math.floor(E/G*g),L=$.getGL(),j=p._renderTargets;j?j.length<a&&(j=p._renderTargets=j.concat(new Array(a-j.length))):j=p._renderTargets=new Array(a);for(var m=0;a>m;m++)j[m]?j[m].setSize(L,E,d):j[m]=new xn.RenderTarget($,L,E,d);var c=!1;p.capture=function(){c=!0,$._42(),c=!1};var u=new Nd,v=new Nd,H=new Nd,q=new Nd,B=(new Nd).setY(0),Y=2*Math.PI/a,I=G/2/Math.tan(Math.PI/a),l=2*Math.atan2(g/2,I),S=G/g;p._42=function(t,T,Q,R){var _=p._debugOn;if(!c&&!_)return!1;u.copy($.getEye()),q.copy($.getCenter()).sub(u);var m=Math.atan2(q.z,q.x),E=$.getNear(),A=$.getFovy(),F=$.getAspect();v.copy($.getCenter());for(var U,C=0;a>C;C++)if(U=j[C],B.setZ(Math.cos(m)).setX(Math.sin(m)).multiplyScalar(I),m-=Y,H.addVectors(u,B),$.setNear(I),$.setCenter([H.x,H.y,H.z]),$.setFovy(l),$.setAspect(S),_){var k=Math.round(T/a);t.viewport(k*C,0,k,Q),R()}else os(t,U.frame),t.viewport(0,0,U.width,U.height),t.clear(t.COLOR_BUFFER_BIT),R(),Sk(t),U.assureTexture();return $.setNear(E),$.setCenter([v.x,v.y,v.z]),$.setFovy(A),$.setAspect(F),!0},p.capture()},getTextureInfo:function(T){var r=this._renderTargets;if(!r)return null;var X=this._renderTargets[T];return X?{index:T,texture:X.texture,textureName:X.uuid}:null}}),H.assign(xn.Graph3dView.prototype,{renderEnvToCube:function(Z,q,k,b){var X=this;X.envRenderer||(X.envRenderer=new xn.RenderEnv(X)),X.envRenderer.renderEnvToCube(Z,q,k,b)}}),xn.RenderTarget=function(K,c,D,m,Z){var Q=this;Z=Z||{},Q.uuid=I.Math.generateUUID(),Q.gv=K,Q.init(K,c,Z),Q.setSize(c,D,m)},H.assign(xn.RenderTarget.prototype,{init:function(m,u,P){var F=this,r=F.texture=u.createTexture();u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,P.minFilter||u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,P.magFilter||u.LINEAR),u.bindTexture(u.TEXTURE_2D,null),F.render=u.createRenderbuffer(),F.frame=u.createFramebuffer(),m._2O[F.uuid]=r},assureTexture:function(){var Q=this,k=Q.uuid,s=Q.gv._2O;s[k]||(s[k]=Q.texture)},setSize:function(p,M,W){var b=this;if(b.width!==M||b.height!==W){var H=p.RGBA,k=p.TEXTURE_2D,S=p.RENDERBUFFER,I=p.FRAMEBUFFER;hr(p,b.texture),p.texImage2D(k,0,H,M,W,0,H,p.UNSIGNED_BYTE,s),p.bindRenderbuffer(S,b.render),p.renderbufferStorage(S,p.DEPTH_COMPONENT16,M,W),os(p,b.frame),p.framebufferTexture2D(I,p.COLOR_ATTACHMENT0,k,b.texture,0),p.framebufferRenderbuffer(I,p.DEPTH_ATTACHMENT,S,b.render),hr(p,s),p.bindRenderbuffer(S,s),Sk(p),b.width=M,b.height=W}},toCanvas:function(){var U=this,C=U.gv.getGL();os(C,U.frame);var Y=U.width,L=U.height,V=new Uint8Array(4*Y*L);C.readPixels(0,0,Y,L,C.RGBA,C.UNSIGNED_BYTE,V),Sk(C);var J=k.createElement("canvas");J.width=Y,J.height=L;var I=J.getContext("2d"),z=I.createImageData(Y,L);return z.data.set(V),I.putImageData(z,0,0),J}});var Ri=xn.Interactor=function(O){this.gv=O};Gr("Interactor",H,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Ul=xn.DefaultInteractor=function(s){jj(Ul,this,[s])};Gr("DefaultInteractor",Ri,{handle_contextmenu:function(E){bn(E)},handle_mousewheel:function(s){this.gv.handleScroll(s,s.wheelDelta/40)},handle_DOMMouseScroll:function(Z){2===Z.axis&&this.gv.handleScroll(Z,-Z.detail)},handle_keydown:function(f){this.gv.handleKeyDown(f)},handle_mousedown:function(V){this.handle_touchstart(V)},handle_touchstart:function(u){bn(u);var X=this,U=X.gv,E=Zb(u),G=U.getDataInfoAt(u),L=G?G.data:s,R=G?G.part:s,C=U.sm(),Y=xq(u),F=Xf(u);U.setFocus(u)&&(X._62O=s,X._57I=s,L?Ei(u)?C.co(L)?C.rs(L):C.as(L):C.co(L)||C.ss(L):E&&(Ei(u)?U.isRectSelectable()&&(X._62O=Kr):X._57I=Il(u)),X._31Q&&(Sh(X._31Q),delete X._31Q,delete X._32Q),X._62O||(U.isFirstPersonMode()&&(Fg(u)||F>2?X._62O="pan":U.isMouseRoamable()||Ch?(X._62O="roaming",X.foward=Y&&Zb(u),X._32Q=Ip(),X._31Q=Ui(X.tick,X)):E||(X._62O="roaming")),X._62O||(E&&Y&&Do[R]?(X._62O=R,X.p3=L.p3()):E&&Y&&lb(L)&&U.isSelected(L)?U.isMovable(L)?(X._62O="move",X.p3=L.p3(),X.movedata=L):U.isInteractive(L)&&(X._62O="none"):Ch&&(F>2?X._62O="pan":2===F&&(X.dist=Lr(u),X._62O="pinch")))),X.point=U.lp(u),De(X,u),ui(u)?U.handleDoubleClick(u,L,R):U.handleClick(u,L,R))},tick:function(){var T=this,i=T.gv,M=i._moveStep;T.point&&i.isWalkable()&&(T._32Q&&(M*=(Ip()-T._32Q)/50),i.walk(T.foward?M:-M),T._32Q=Ip(),T._31Q=Ui(T.tick,T))},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(J){var O=this._57I;O&&(Bg(O,Il(J))<=1&&this.gv.sm().cs(),this._57I=s)},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(M){var L,z,D=this,w=D.gv,K=D._62O,e=D.point,a=w.dm(),E=w.lp(M),F=E.x-e.x,C=E.y-e.y,J=w.getWidth(),A=w.getHeight();if(J&&A){var i=-p*F/J,m=-p*C/A;if("roaming"===K)D.rotate(M,i/2,m/2);else if(K===Wr||K===al||K===oc)w._86O||a.beginTransaction(),w.fi({kind:w._86O?"betweenEditRotation":"beginEditRotation",event:M}),w._86O=1,w.sm().each(function(G){if(lb(G)&&w.isRotationEditable(G)){var Z=P(i)>P(m)?i:m;K===Wr?G.setRotationX(G.getRotationX()+Z):K===al?G.setRotationY(G.getRotationY()+Z):K===oc&&G.setRotationZ(G.getRotationZ()+Z)}});else if("move"===K||Do[K]){K===zg||K===cm||K===xh?(w._87O||a.beginTransaction(),w.fi({kind:w._87O?"betweenEditScale":"beginEditScale",event:M}),w._87O=1):(w._moving||a.beginTransaction(),w.fi({kind:w._moving?"betweenMove":"beginMove",event:M}),w._moving=1);var s,O=D.p3,G=w.getPositionInfo(O),U=kc(w);s=K===$m?"x":K===cd?"y":K===Tj?"z":K===zg?"sx":K===cm?"sy":K===xh?"sz":w.getMoveMode(M,D.movedata),F=F/J*G.width,C=-1*C/A*G.height;var h,y,Z=[U[0]*F,U[4]*F,U[8]*F],X=[U[1]*C,U[5]*C,U[9]*C],c=Z[0]+X[0],W=Z[1]+X[1],r=Z[2]+X[2],$=[O[0]+c,O[1]+W,O[2]+r],u=tn(w.getEye(),$,!0);if("xyz"===s?(h=$,w.moveSelection(c,W,r)):"xz"===s?(h=_h(w,O,[0,1,0],$),h&&w.moveSelection(h[0]-O[0],0,h[2]-O[2])):"xy"===s?(h=_h(w,O,[0,0,1],$),h&&w.moveSelection(h[0]-O[0],h[1]-O[1],0)):"yz"===s?(h=_h(w,O,[1,0,0],$),h&&w.moveSelection(0,h[1]-O[1],h[2]-O[2])):"x"===s||"sx"===s?(u[0]=0,h=_h(w,O,u,$),h&&(y=h[0]-O[0],"x"===s?w.moveSelection(y,0,0):w.sm().each(function(p){lb(p)&&w.isSizeEditable(p)&&(L=p.getScaleX()+y/100,z=L/p.getScaleX(),p.setScaleX(L),Fg(M)&&(p.setScaleY(p.getScaleY()*z),p.setScaleTall(p.getScaleTall()*z)))}))):"y"===s||"sy"===s?(u[1]=0,h=_h(w,O,u,$),h&&(y=h[1]-O[1],"y"===s?w.moveSelection(0,y,0):w.sm().each(function(g){lb(g)&&w.isSizeEditable(g)&&(L=g.getScaleTall()+y/100,z=L/g.getScaleTall(),g.setScaleTall(L),Fg(M)&&(g.setScaleY(g.getScaleY()*z),g.setScaleX(g.getScaleX()*z)))}))):("z"===s||"sz"===s)&&(u[2]=0,h=_h(w,O,u,$),h&&(y=h[2]-O[2],"z"===s?w.moveSelection(0,0,y):w.sm().each(function(Z){lb(Z)&&w.isSizeEditable(Z)&&(L=Z.getScaleY()+y/100,z=L/Z.getScaleY(),Z.setScaleY(L),Fg(M)&&(Z.setScaleX(Z.getScaleX()*z),Z.setScaleTall(Z.getScaleTall()*z)))}))),!h)return;D.p3=h}else if(K===Kr){var R=D.div;R||(R=D.div=$b(),Xd(D.getView(),R),R.op=e,R.style.background=w.getRectSelectBackground()),w.fi({kind:w._rectSelecting?"betweenRectSelect":"beginRectSelect",event:M}),w._rectSelecting=1,R.rect=Bq(R.op,E),Kj(R,R.rect)}else if("pinch"===K&&2===Xf(M)){w.fi({kind:w._pinching?"betweenPinch":"beginPinch",event:M}),w._pinching=1;var y=Lr(M);w.handlePinch(y,D.dist),D.dist=y}else"pan"===K||Fg(M)?D.pan(M,F,C):"none"===K||w.isFirstPersonMode()||(Zb(M)?D.rotate(M,i,m):(D.pan(M,F,0),w.isWalkable()&&(w.fi({kind:w._walking?"betweenWalk":"beginWalk",event:M}),w._walking=1,w.walk(C/w.getHeight()*w.getCenterInfo().height))));D.point=E}},pan:function(M,F,g){var l=this.gv;if(l.isPannable()){var p=l.getWidth(),E=l.getHeight();if(!p||!E)return;var t=l.getCenterInfo(),o=F/p*t.width,m=-1*g/E*t.height;l.fi({kind:l._panning?"betweenPan":"beginPan",event:M}),l._panning=1,l.pan(-o,-m)}},rotate:function(y,Z,V){var A=this.gv;A.isRotatable()&&(A.fi({kind:A._rotating?"betweenRotate":"beginRotate",event:y}),A._rotating=1,A.rotate(Z,V))},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)},handleWindowTouchEnd:function(w){var T=this,m=T.gv,i=m.dm(),j=T.div;if(j){var N=m.getDatasInRect(j.rect);if(!N.isEmpty()){var W=m.sm(),v=W.toSelection();N.each(function(R){W.co(R)?v.remove(R):v.add(R)}),W.ss(v)}kq(j)}m._moving&&(delete m._moving,m.fi({kind:"endMove",event:w}),m.onMoveEnded(),i.endTransaction()),m._panning&&(delete m._panning,m.fi({kind:"endPan",event:w}),m.onPanEnded()),m._rotating&&(delete m._rotating,m.fi({kind:"endRotate",event:w}),m.onRotateEnded()),m._86O&&(delete m._86O,m.fi({kind:"endEditRotation",event:w}),i.endTransaction()),m._87O&&(delete m._87O,m.fi({kind:"endEditScale",event:w}),i.endTransaction()),m._pinching&&(delete m._pinching,m.fi({kind:"endPinch",event:w}),m.onPinchEnded()),m._rectSelecting&&(delete m._rectSelecting,m.fi({kind:"endRectSelect",event:w}),m.onRectSelectEnded()),m._walking&&(delete m._walking,m.fi({kind:"endWalk",event:w}),m.onWalkEnded()),T.dist=T.point=T._62O=T.p3=T.movedata=T.div=T._57I=T._32Q=T._31Q=T.foward=s}});var ym=xn.MapInteractor=function(N){jj(ym,this,[N]),this._minPhi=0,this._maxPhi=5*M/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};Gr("MapInteractor",Ri,{handle_contextmenu:function(i){bn(i)},handle_mousewheel:function(f){this.gv.handleScroll(f,f.wheelDelta/40)},handle_DOMMouseScroll:function(P){2===P.axis&&this.gv.handleScroll(P,-P.detail)},handle_keydown:function(o){this.gv.handleKeyDown(o)},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(W){bn(W);var n=this,T=n.gv;if(T.setFocus(W)){T.lp(W);var K=T.getDataInfoAt(W),g=K?K.data:s,G=K?K.part:s;if(!g||!T.isInteractive(g)){var h=n.editing={point:T.lp(W)};Ch?h.touch=!0:(h.touch=!1,h.pan="left"===this.panButton===Zb(W)),De(n,W)}ui(W)?T.handleDoubleClick(W,g,G):T.handleClick(W,g,G)}},handle_mouseup:function(Z){this.handle_touchend(Z)},handle_touchend:function(){},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(k){var z=this,O=z.gv,C=z.editing;if(C){var W=O.lp(k),x=C.point,G=W.x-x.x,B=W.y-x.y;if(!C.moved){if(Math.abs(G)<z.threshold&&Math.abs(B)<z.threshold&&!(k.touches&&k.touches.length>1))return;C.moved=!0}if(C.point=W,C.touch){var q=k.touches.length;if(2!==q)z.pan(k,G,B);else{if(1>=q)return;var R=k.touches,D={x:R[0].clientX,y:R[0].clientY},m={x:R[1].clientX,y:R[1].clientY},b={x:m.x-D.x,y:m.y-D.y},I=C.lastCenter,w=Math.atan2(b.y,b.x),H=C.theta,_=0;H==s?H=C.theta=w:(_=w-H,C.thetaStarted||Math.abs(_)>z.touchRotateThreshold?(C.thetaStarted=!0,C.theta=w):_=0);var F=M*(D.y+m.y)/2/O.getHeight(),J=C.phi,P=0;J==s?J=C.phi=F:(P=F-J,C.phiStarted||Math.abs(P)>z.touchRotateThreshold?(C.phiStarted=!0,C.phi=F):P=0);var g,v=Math.sqrt(b.x*b.x+b.y*b.y),S=C.vlen;if(S){var Q=D.x-I.x,e=D.y-I.y,E=m.x-I.x,Y=m.y-I.y,h=Math.sqrt(Q*Q+e*e),U=Math.sqrt(E*E+Y*Y),n=S/2,r=z._sign2(h-n),j=z._sign2(U-n);0>r*j||0===r&&0===j?(g=1,C.vlen=v):(g||(g=v/S),C.scaleStarted||Math.abs(g-1)>z.touchScaleThreshold?(C.vlen=v,C.scaleStarted=!0):g=1)}else S=C.vlen=v,g=1;1!==g&&O.setZoom(g),(P||_)&&z.rotate(k,_,-P),C.lastCenter={x:(m.x+D.x)/2,y:(m.y+D.y)/2}}}else if(C.pan)z.pan(k,G,B);else{var T=O.getWidth(),X=O.getHeight();if(!T||!X)return;var L=-p*G/T,d=-p*B/X;z.rotate(k,L,d)}}},_sign2:function(X){return Math.abs(X)<this._touchScaleCheckAccuracy?0:X>0?1:-1},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},handleWindowTouchEnd:function(o){var V=this,T=V.editing;if(V.editing=null,T){var G=V.gv;if(T.moved||T.pan!==("left"===this.panButton))G._panning=null,G._rotating=null,G.fi({kind:T.pan?"endPan":"endRotate",event:o});else{var s=G.getDataAt(o);s?G.sm().setSelection([s]):G.sm().clearSelection()}}},pan:function(U,t,p){var I=this,J=I.gv;if(J.isPannable()){var L=J.getWidth(),g=J.getHeight();if(L&&g){var i=J.getCenterInfo(),$=-t/L*i.width,q=1*p/g*i.height;J.fi({kind:J._panning?"betweenPan":"beginPan",event:U}),J._panning=1;var W=I.keepHorizon,E=I.editing.touch;if((E&&U.touches&&U.touches.length>1||!E&&Fg(U))&&(W=!W),!W)return J.pan($,q);if($||q){var K=kc(J),H=[K[0]*$,K[4]*$,K[8]*$],r=[K[1],0,K[9]],V=Math.sqrt(r[0]*r[0]+r[2]*r[2]);V&&(r=[r[0]/V*q,0,r[2]/V*q]);var o=H[0]+r[0],G=H[1]+r[1],x=H[2]+r[2],b=J._center,j=J._eye;b[0]+=o,b[1]+=G,b[2]+=x,j[0]+=o,j[1]+=G,j[2]+=x,J.fp(Wg,s,j),J.fp(Re,s,b)}}}},rotate:function(R,p,V){var u=this,j=u.gv;if(j.isRotatable()){var q=j._center,l=j._eye,L=tn(l,q),M=Z(W(L[0]*L[0]+L[2]*L[2]),L[1]),h=M+V;h=Math.max(u.minPhi,Math.min(u.maxPhi,h)),V=h-M,j.fi({kind:j._rotating?"betweenRotate":"beginRotate",event:R}),j._rotating=1,j.rotate(p,V)}}}),H.defineProperties(ym.prototype,{panButton:{get:function(){return this._panButton},set:function(W){this._panButton=W}},minPhi:{get:function(){return this._minPhi},set:function(v){this._minPhi=v}},maxPhi:{get:function(){return this._maxPhi},set:function(q){this._maxPhi=q}},keepHorizon:{get:function(){return this._keepHorizon},set:function(L){this._keepHorizon=L}},threshold:{get:function(){return this._threshold},set:function(A){this._threshold=A}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(v){this._touchScaleThreshold=v}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(h){this._touchRotateThreshold=h}}});var _o=function(h){this.gv=h};Op(_o,H,{_iv:!0,iv:function(){this._iv=!0},face:function(y,x){var v=this,L=v.gv.getGL();if(!L||!lb(y))return s;var W=x.x,B=x.width,g=x.height,d=v.height-x.y-g,X=c(B/2),m=new Uint8Array(4*B*g),F=0;for(v.iv(),v.validate(y),os(L,v.frame),L.readPixels(W,d,B,g,L.RGBA,L.UNSIGNED_BYTE,m),Sk(L),v.iv();X>=F;F++)for(var p=X-F,K=X+F,O=p;K>=O;O++)for(var D=p;K>=D;D++)if(O===p||O===K||D===p||D===K){var w=Ep.m[m[4*(O*B+D)]];if(w)return w}},get:function(o,I){this.validate();var e=this,W=e.gv.getGL();if(!W)return s;var x,g,J=o.x,w=o.width,O=o.height,M=e.height-o.y-O,T=c(w/2),k=new Uint8Array(4*w*O),j=0,q=k.length,a=I?s:new Ce,N=I?s:{};if(os(W,e.frame),W.readPixels(J,M,w,O,W.RGBA,W.UNSIGNED_BYTE,k),Sk(W),I){for(;T>=j;j++)for(var n=T-j,H=T+j,i=n;H>=i;i++)for(var X=n;H>=X;X++)if((i===n||i===H||X===n||X===H)&&(x=e.info(k,4*(i*w+X))))return x}else for(;q>j;j+=4)x=e.info(k,j),x&&(g=x.data,N[g._id]||(a.add(g),N[g._id]=g));return a},info:function(c,u){return this.colorMap[(c[u]<<16)+(c[u+1]<<8)+c[u+2]+((127&c[u+3])<<24)]},validate:function(i){var h=this,X=h.gv,p=X.getGL();if(p){var f=X.getWidth(),C=X.getHeight(),$=p.RGBA,k=p.TEXTURE_2D,W=p.RENDERBUFFER,t=p.FRAMEBUFFER;h.texture||(h.texture=gi(p),h.render=p.createRenderbuffer(),h.frame=p.createFramebuffer()),(h.width!==f||h.height!==C)&&(hr(p,h.texture),p.texImage2D(k,0,$,f,C,0,$,p.UNSIGNED_BYTE,s),mc(p,p.TEXTURE_MIN_FILTER,p.LINEAR),p.bindRenderbuffer(W,h.render),p.renderbufferStorage(W,p.DEPTH_COMPONENT16,f,C),os(p,h.frame),p.framebufferTexture2D(t,p.COLOR_ATTACHMENT0,k,h.texture,0),p.framebufferRenderbuffer(t,p.DEPTH_ATTACHMENT,W,h.render),hr(p,s),p.bindRenderbuffer(W,s),Sk(p),h.width=f,h.height=C),h._iv&&(h._iv=!1,os(p,h.frame),X._42(i||(h.colorMap={}),1),Sk(p))}}});var Tq=function(g){this.gv=g};Op(Tq,H,{gap:0,size:0,_42:function(O,o){var v=this,M=v.gv,p=M._gridGap,n=M._gridSize;if(M._gridVisible){if(v.gap!==p||v.size!==n){for(var c=[],J=M._gridSize/2,b=p*J,w=0;2*J+1>w;w++){var z=6*w,h=6*(2*J+1)+z;c[z]=-b,c[z+1]=0,c[z+2]=-b+w*p,c[z+3]=b,c[z+4]=0,c[z+5]=-b+w*p,c[h]=-b+w*p,c[h+1]=0,c[h+2]=-b,c[h+3]=-b+w*p,c[h+4]=0,c[h+5]=b}v.vs=new hk(c),v.gap=p,v.size=n}zm(M),Qq(O,o),Wd(O),pr(O,o,1,M._gridColor,M._buffer.vs,v.vs),we(O,0,v.vs.length/3,O.LINES),Sr(O),Jn(O,o)}else v.vs=v.gap=v.size=s}});var ab=function(e){this.gv=e};Op(ab,H,{_42:function(S,D){var q=this.gv,r=q._buffer.vs,Z=q._axisXColor,x=q._axisYColor,c=q._axisZColor,J=q._originAxisVisible,k=q._centerAxisVisible;if(J||k){var E=N?S.TRIANGLES:S.TRIANGLE_FAN,u=S.LINES;if(zm(q),Qq(S,D),Wd(S),J){var z=q.getCenterInfo(),L=$(z.width,z.height)/5,B=.8*L,F=.05*L;pr(S,D,1.5,Z,r,new hk([0,0,0,L,0,0,B,F,0,B,0,F,B,-F,0,B,0,-F,B,F,0,0,0,0,0,L,0,F,B,0,0,B,F,-F,B,0,0,B,-F,F,B,0,0,0,0,0,0,L,F,0,B,0,F,B,-F,0,B,0,-F,B,F,0,B])),we(S,0,2,u),we(S,1,6,E),pr(S,D,s,x),we(S,7,2,u),we(S,8,6,E),pr(S,D,s,c),we(S,14,2,u),we(S,15,6,E)}if(k){var P=q._center,K=P[0],n=P[1],e=P[2],z=q.getPositionInfo(P);L=$(z.width,z.height)/20,pr(S,D,1.5,Z,r,new hk([K,n,e,K+L,n,e,K,n,e,K,n+L,e,K,n,e,K,n,e+L])),we(S,0,2,u),pr(S,D,s,x),we(S,2,2,u),pr(S,D,s,c),we(S,4,2,u)}Sr(S),Jn(S,D)}}});var Af=function(g){this.gv=g,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Af.Mode.Disable};Af.Mode={Disable:0,Selection:1,MouseOver:2},Op(Af,H,{onMouseOver:function(Y){l.preventDefault(Y);var J=this.gv.getDataAt(Y);J!==this.mouseOverData&&(this.mouseOverData=J,this.gv.iv())},setFetchTargetFunc:function(l){this.fetchTargetFunc=l},_42:function(k,M){var Z,c=this,m=c._mode;if(m!==Af.Mode.Disable&&(m===Af.Mode.Selection?Z=c.gv.sm().getSelection().toArray(function(C){return C.s("highlight.visible")}):m===Af.Mode.MouseOver&&c.mouseOverData&&c.mouseOverData.s("highlight.visible")&&(Z=[c.mouseOverData]),c.fetchTargetFunc&&(Z=c.fetchTargetFunc(Z)),Z&&Z.length)){var w=c.gv,u=w.vr.isPresenting(),L=w.getWidth();if(u){var e=w.getWidth;L/=2,w.getWidth=function(){return L};var j=w.getViewport()}var D,s=w.getDevicePixelRatio(),t=L*s,a=w.getHeight()*s;(D=c._renderTarget)?D.setSize(k,t,a):c._renderTarget=D=new xn.RenderTarget(w,k,t,a),os(k,D.frame),w.drawFilter=function(M){return Z.indexOf(M)<0?!0:void 0},w._42({}),w.drawFilter=null,Sk(k),u&&(w.getWidth=e,w.setViewport(k,j[0],j[1],j[2],j[3])),c.shader||(c.shader=new Hm.Shader(k,kj.vs,kj.fs));var r=c.shader;if(c.shader.bind(),k.enable(k.BLEND),k.activeTexture(k.TEXTURE0+0),k.bindTexture(k.TEXTURE_2D,D.texture),r.uniforms.image=0,r.uniforms.textureSize=[t,a],r.uniforms.edgeWidth=g["highlight.width"],c.highlightColor!==g["highlight.color"]){var V=rp(c.highlightColor=g["highlight.color"]);c.highlightColorData=[V[0]/255,V[1]/255,V[2]/255,V[3]/255]}r.uniforms.edgeColor=c.highlightColorData,c.ibuffer?(c.ibuffer.upload(),c.vbuffer.upload()):(c.ibuffer=Hm.Buffer.createIndexBuffer(k,new Uint16Array([0,2,1,1,2,3])),c.vbuffer=Hm.Buffer.createVertexBuffer(k,new Float32Array([0,0,1,0,0,1,1,1]))),r.attributes.pos.pointer(c.vbuffer),k.drawElements(k.TRIANGLES,6,k.UNSIGNED_SHORT,0),k.disable(k.BLEND),k.bindTexture(k.TEXTURE_2D,null),k.useProgram(M)}}}),H.defineProperties(Af.prototype,{mode:{get:function(){return this._mode},set:function(x){var K=this._mode;x!==K&&(this._mode=x,x===Af.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):K===Af.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var kj={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Sf=function(g){this.gv=g},$m="edit_tx",cd="edit_ty",Tj="edit_tz",Wr="edit_rx",al="edit_ry",oc="edit_rz",zg="edit_sx",cm="edit_sy",xh="edit_sz",Do={};Do[$m]=1,Do[cd]=1,Do[Tj]=1,Do[Wr]=1,Do[al]=1,Do[oc]=1,Do[zg]=1,Do[cm]=1,Do[xh]=1,Op(Sf,H,{_42:function(f,r,I){var h=this,X=h.gv,p=X.sm().ld();if(p&&X.isEditable(p)&&!X.isEditHelperDisabled()&&lb(p)&&(!X.isFirstPersonMode()||!X.isMouseRoamable()&&!Ch)){zm(X);var q,u,t=X.isMovable(p),O=X.isRotationEditable(p),g=X.isSizeEditable(p),N=X._axisXColor,W=X._axisYColor,m=X._axisZColor,k=X._editSizeColor,J=p.p3(),D=Bg(X.getEye(),J)/10,M=D/(I?5:10),y=.7*D,C=.4*y,s=J[0],c=J[1],i=J[2];q=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],t&&h._17O(f,r,p,I,$m,N,q,[s,c-M,i,s+y,c-M,i,s+y,c,i,s+y,c,i,s,c,i,s,c-M,i,s,c-M,i+M,s+y,c-M,i+M,s+y,c-M,i,s+y,c-M,i,s,c-M,i,s,c-M,i+M]),u=s+y,g&&h._17O(f,r,p,I,zg,k,q,[u,c-M,i,u+C,c-M,i,u+C,c,i,u+C,c,i,u,c,i,u,c-M,i,u,c-M,i+M,u+C,c-M,i+M,u+C,c-M,i,u+C,c-M,i,u,c-M,i,u,c-M,i+M]),u+=C,O&&h._17O(f,r,p,I,Wr,N,q,[u,c-M,i,u+C,c-M,i,u+C,c,i,u+C,c,i,u,c,i,u,c-M,i,u,c-M,i+M,u+C,c-M,i+M,u+C,c-M,i,u+C,c-M,i,u,c-M,i,u,c-M,i+M]),q=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],t&&h._17O(f,r,p,I,cd,W,q,[s,c,i,s,c+y,i,s-M,c+y,i,s-M,c+y,i,s-M,c,i,s,c,i,s,c,i,s,c,i-M,s,c+y,i-M,s,c+y,i-M,s,c+y,i,s,c,i]),u=c+y,g&&h._17O(f,r,p,I,cm,k,q,[s,u,i,s,u+C,i,s-M,u+C,i,s-M,u+C,i,s-M,u,i,s,u,i,s,u,i,s,u,i-M,s,u+C,i-M,s,u+C,i-M,s,u+C,i,s,u,i]),u+=C,O&&h._17O(f,r,p,I,al,W,q,[s,u,i,s,u+C,i,s-M,u+C,i,s-M,u+C,i,s-M,u,i,s,u,i,s,u,i,s,u,i-M,s,u+C,i-M,s,u+C,i-M,s,u+C,i,s,u,i]),q=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],t&&h._17O(f,r,p,I,Tj,m,q,[s,c,i,s,c,i+y,s,c-M,i+y,s,c-M,i+y,s,c-M,i,s,c,i,s,c-M,i,s-M,c-M,i,s-M,c-M,i+y,s-M,c-M,i+y,s,c-M,i+y,s,c-M,i]),u=i+y,g&&h._17O(f,r,p,I,xh,k,q,[s,c,u,s,c,u+C,s,c-M,u+C,s,c-M,u+C,s,c-M,u,s,c,u,s,c-M,u,s-M,c-M,u,s-M,c-M,u+C,s-M,c-M,u+C,s,c-M,u+C,s,c-M,u]),u+=C,O&&h._17O(f,r,p,I,oc,m,q,[s,c,u,s,c,u+C,s,c-M,u+C,s,c-M,u+C,s,c-M,u,s,c,u,s,c-M,u,s-M,c-M,u,s-M,c-M,u+C,s-M,c-M,u+C,s,c-M,u+C,s,c-M,u])}},_17O:function(q,O,k,f,L,W,T,M){var j=this.gv._buffer;er(q,O,f,!0,k,L),yi(q,O,s,!0,s,!0,s,!1),Xc(q,O.uDiffuse,W),Hf(q,j.vs,new hk(M),O.aPosition),Hf(q,j.ns,new hk(T),O.aNormal),Wd(q),we(q,0,12),Sr(q),Vi(q,O)}});var wh=I.Raycaster=function(u){this.gv=u,this.maxTriangleTest=1/0};Lf("Raycaster",H,{intersect:function(A){var p=this,x=p.gv,Q=x.getDataAt(A);return Q?p.intersectObject(A,Q):null},intersectObjects:function(y,q,j){var v,T,P,Y,U=this,l=1/0,H=y.origin||(new Nd).fromArray(U.gv.getEye()),i=U.maxTriangleTest,d=[];return q.forEach(function(G){j&&j(G)===!1||G.s("intersect")!==!1&&d.push(G)}),d.sort(function(A,I){return H.distanceToSquared2(A.p3())-H.distanceToSquared2(I.p3())}),U.countTriangles=0,d.forEach(function(D){U.countTriangles>i||(v=U.intersectObject(y,D),v&&(T=H.distanceToSquared(v.world),l>T&&(P=D,Y=v,l=T)))}),U.countTriangles=0,{data:P,intersect:Y}},intersectObject:function(R,F){if(R instanceof jl)return this._intersectObjectImpl(R,F);var u,N,a=this,j=a.gv;N=j.unproject(R);var g=j.getEye();j.isOrtho()?(u=tn(j.getCenter(),g),u[0]+=u[0],u[1]+=u[1],u[2]+=u[2]):u=g,u=new Nd(u);var f=new Nd(N).sub(u).normalize(),Z=new I.Math.Ray(u,f);return a._intersectObjectImpl(Z,F)},_intersectObjectImpl:function(){function z(){var E=new Nd;return E.subVectors(e,M),C.subVectors(S,M),E.cross(C).normalize(),E}function H(i,d,y,J,U,F,w){return ch.barycoordFromPoint(i,d,y,J,u),U.multiplyScalar(u.x),F.multiplyScalar(u.y),w.multiplyScalar(u.z),U.add(F).add(w),U.clone()}var v=new rs,Y=new rs,t=new jl,j=new Nd,m=new Nd,A=new Nd,$=new Nd,J=new Nd,S=new Nd,M=new Nd,e=new Nd,E=new qq,Q=new qq,L=new qq,C=new Nd,i={vs:zk,is:Kf,uv:Sq},u=new Nd;return function(O,V){var R=this.gv.getData3dUI(V),U=V.mat||R.mat;if(U){v.fromArray(U),Y.getInverse(v),t.copy(O).applyMatrix4(Y);var b,P,k="body",F=R.shapeModel;if(F||(F=sr(R)),F||(V instanceof I.Node&&!(V instanceof I.Shape)?(b=!0,F=i):(P=!0,F=[R.left,R.front,R.right,R.back,R.top,R.bottom])),!F)return console.log("Can not find shape model."),null;
            xd(F)||(F=[F]);var s,N,p,n,g,_,h,K,W,u,c,x,q,l,X,f,Z=1/0,G=["","top_","bottom_"],d=!1;for(s=0,N=F.length;N>s;s++)if(q=F[s])for(p=0,n=G.length;n>p;p++)if(l=G[p],h=q[l+"vs"],K=q[l+"is"],W=q[l+"uv"]||q[l+"tuv"],h){if(X=q[l+"boundingBox"]){var c=t.intersectBox(X);if(!c)continue;if(t.origin.distanceTo(c)>Z)continue;f=!1}else q[l+"boundingBox"]=X=new I.Math.Box3,f=!0;for(g=0,_=K?K.length:h.length/3;_>g;g+=3)this.countTriangles++,K?(m.fromArray(h,3*K[g]),A.fromArray(h,3*K[g+1]),$.fromArray(h,3*K[g+2])):(m.fromArray(h,3*g),A.fromArray(h,3*(g+1)),$.fromArray(h,3*(g+2))),f&&(X.expandByPoint(m),X.expandByPoint(A),X.expandByPoint($)),u=t.intersectTriangle(m,A,$,!0,j),u&&(x=t.origin.distanceTo(u),Z>x&&(Z=x,J.copy(u),S.copy(m),M.copy(A),e.copy($),""!==l?k=l.slice(0,-1):b?k=pl[Math.floor(g/6)]:P&&(k=pl[s]),W&&(d=!0,K?(E.fromArray(W,2*K[g]),Q.fromArray(W,2*K[g+1]),L.fromArray(W,2*K[g+2])):(E.fromArray(W,2*g),Q.fromArray(W,2*(g+1)),L.fromArray(W,2*(g+2))))))}if(!isFinite(Z))return null;var r,y=J.clone().applyMatrix4(v);d&&(r=H(J,S,M,e,E,Q,L));var o=z(S,M,e),B=z(S.applyMatrix4(v),M.applyMatrix4(v),e.applyMatrix4(v)),w=t.direction.dot(o);return w>0&&(o.multiplyScalar(-1),B.multiplyScalar(-1)),{world:y,local:J.clone(),worldNormal:B,normal:o,uv:r,part:k}}}}()});var ip=function(Q,l){this.gv=Q,this.s=function(f,C,J){return C==s&&(C=J),C==s?l.getStyle(f):Ro(C,l,Q)},this.data=l};Op(ip,H,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(c,P,X,d){var V=this,w=V.data;if(!(w instanceof Ud)){var K,a,r,S,v,_,u,j=V.gv,m=w._id,B=V.s("shape3d.alwaysOnTop")?null:V.s("batch"),H=j._batchIndexMap,q=j._batchModelMap,$=j.isSelectable(w),p=j.getBrightness(w),G=p!=s&&1!==p;if(V.needValidate(c)){if(r=ul(H,q,w,B),V.validate(r,B?mm[B]||qs:s),r&&(S=H[m],v=S.size=r.vs.length/3-S.begin,u=r.rs))for(p=G?p:1,_=0;v>_;_++)u.push(p);if(lb(w)){var x=j.getWireframeGeometry(w);if(x)Sl(j,w,x);else{var J=j.getWireframe(w);J&&Sl(j,w,J)}}V.labelInfo=V.label2Info=V.noteInfo=V.note2Info=V._38o=s,V._24O(Le,"getLabel"),V._24O(cf,"getLabel2"),V._26O(Hl,"getNote"),V._26O(hc,"getNote2"),V._15O(),V.interactiveInfo=j.isInteractive(w)?{}:s,V._iv=!1}G&&Xc(c,P.uBrightness,p),Xc(c,P.uAlphaTest,V.s("alphaTest")),Xc(c,P.uUseEnvMap,w.s("envmap")?!0:!1),Xc(c,P.uReflectivity,w.s("envmap")||.01),a=er(c,P,X,$,w,wm),a&&(ap(a,H[m],q),ap(a,j._polylineIndexMap[m],j._polylineModelMap),ap(a,j._wireframeIndexMap[m],j._wireframeModelMap)),H[m]||V._80o(c,P,d),j.isLabelVisible(w)&&((K=V.labelInfo)&&(er(c,P,X,$,w,Le),V._28O(K,Le,d)),(K=V.label2Info)&&(er(c,P,X,$,w,cf),V._28O(K,cf,d))),j.isNoteVisible(w)&&((K=V.noteInfo)&&(er(c,P,X,$,w,Hl),V._29O(K,Hl,d)),(K=V.note2Info)&&(er(c,P,X,$,w,hc),V._29O(K,hc,d))),(K=V._38o)&&V._99O(c,P,K,X,$,d),G&&Xc(c,P.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return zj},_80o:function(){},dispose:function(){},_calcAnchorMat:function(F){if(F.hasOwnProperty("_anchor")||F.hasOwnProperty("_anchorElevation")){var E=F.getAnchor3d(),$={x:E.x-.5,y:E.y-.5,z:E.z-.5},_=Rp();return qi(_,[-$.x,-$.y,-$.z]),_}},getBodyColor:function(B){var K=this.data,$=this.gv.getBodyColor(K);return $?$:B?K.getStyle(B):s},_24O:function(V,U){var k=this,c=k.data,P=k.gv,o=k.s,j=P[U](c);if(j!=s){var f=o(V+".scale"),y=o(V+".max"),G=k[V+"Info"]={label:j,textureScale:o(V+".texture.scale"),color:P[U+"Color"](c),font:o(V+".font"),align:o(V+".align"),background:P[U+"Background"](c)},D=G.rect=Kp(G,j);y>0&&y<D.width&&(G.labelWidth=D.width,D.width=y),D.x=D.y=0,D.width*=f,D.height*=f,G.mat=k._16O(o(V+".autorotate"),o(V+".position"),D,o(V+".face"),o(V+".t3"),o(V+".r3"),o(V+".rotationMode"));var S=D.width/2,B=D.height/2;G.vs=new hk([-S,B,0,-S,-B,0,S,-B,0,S,B,0]),D.width/=f,D.height/=f}},_26O:function(A,M){var C=this,Y=C.data,b=C.gv,r=C.s,n=b[M](Y);if(n!=s){var a=r(A+".scale"),D=this[A+"Info"]={note:n,textureScale:r(A+".texture.scale"),expanded:r(A+".expanded"),font:r(A+".font"),color:r(A+".color"),align:r(A+".align"),borderWidth:r(A+".border.width"),borderColor:r(A+".border.color"),background:b[M+"Background"](Y)};if(D.expanded){var k=r(A+".max"),f=Kp(D,n);f.width+=6,f.height+=2,k>0&&k<f.width&&(D.labelWidth=f.width,f.width=k);var N={x:-f.width/2,y:-8-f.height,width:f.width,height:f.height+8}}else N={x:-6,y:-18,width:12,height:18};D.mat=C._16O(r(A+".autorotate"),r(A+".position"),s,r(A+".face"),r(A+".t3"),r(A+".r3"),r(A+".rotationMode")),D.rect=N,1!==a&&(N=kl(N),N.x*=a,N.height*=a,N.y=-N.height,N.width*=a);var z=N.x,m=N.y,O=N.width,v=N.height;D.vs=new hk([z,-m,0,z,-m-v,0,z+O,-m-v,0,z+O,-m,0])}},_28O:function(D,T,b){if(b(this.s(T+".transparent"))){var Z=D.rect,k=D.textureScale,L=Z.width*k,o=Z.height*k;if(L>=1&&o>=1){var W=Ac(L,o);1!==k&&(W.translate(W,Z.x,Z.y),W.scale(k,k),W.translate(W,-Z.x,-Z.y)),lg(W,D),W.restore(),Pe(this,T,D.mat,D.vs,!0)}}},_29O:function(O,s,t){if(t(this.s(s+".transparent"))){var k=O.rect,e=O.textureScale,$=k.x,K=k.y,U=k.width*e,C=k.height*e;if(U>=1&&C>=1){k.x=k.y=0;var N=Ac(U,C);1!==e&&N.scale(e,e),nr(N,O),N.restore(),k.x=$,k.y=K,Pe(this,s,O.mat,O.vs,!1)}}},_99O:function(D,w,x,z,H,l){if(x){var t=this,h=t.gv,v=t.data,K=h._buffer,$=h._1O,g=x.icons;for(var i in g){var r=g[i],X=x.rects[i];if(X&&l(Ro(r.transparent,v,h))){er(D,w,z,H,v,i);var y=Ro(r.shape3d,v,h),p=y?[y]:Ro(r.names,v,h),M=p?p.length:0,m=Ro(r.textureScale,v,h)||1,c=Ro(r.light,v,h);c==s&&(c=y?!0:!1),yi(D,w,Ro(r.blend,v,h),c,Ro(r.opacity,v,h),Ro(r.reverseFlip,v,h),Ro(r.reverseColor,v,h),Ro(r.reverseCull,v,h));for(var O=0;M>O;O++){var W=p[O],J=X[O];if(Nj(t,J.mat),y)Eb(h,v,sr(t,y),t);else{var L=nb(W);if(L){var R=J.width*m,T=J.height*m;if(R>=1&&T>=1){var o=Ac(R,T);Bk(o,L,Ro(r.stretch,v,h),0,0,R,T,v,h),o.restore(),gi(D,xl,$),Wd(D,w,$,Ro(r.discardSelectable,v,h),K.uv,fr),Hf(D,K.vs,J.vs,w.aPosition),Hi(D,K.ns,Mb,w.aNormal),Nq(D,K.is,Pn),Xo(D,0,Pn.length),Sr(D,w,$)}}}ir(h)}Vi(D,w)}}}}});var Bl=function(v,S){jj(Bl,this,[v,S])};Op(Bl,ip,{_16O:function(m,M,d,R,B,I,$,c,f){var J=this.data,O=J.getFinalScale3d(),y=de(M,O,d,R,c,f);if(J.hasOwnProperty("_anchor")||J.hasOwnProperty("_anchorElevation")){var s=J.getAnchor3d();y[0]-=(s.x-.5)*O[0],y[1]-=(s.y-.5)*O[1],y[2]-=(s.z-.5)*O[2]}return ws(Rp(),y,J.p3(),R,B,I,$,m,J.getFinalRotation3d(),J.getRotationMode())},clear:function(){var b=this;b.faceMat=b.mat=b.shapeModel=b.left=b.right=b.front=b.back=b.top=b.bottom=b.csg=s},needValidate:function(v){if(this._iv)return this._validateFrameId=v._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var r=v._renderInfo.frame;if(this._validateFrameId!==r)return this._validateFrameId=r,!0}return!1},validate:function(y,P){var $=this,X=$.gv,S=$.data,h=$.shapeName=$.s(is),s=sr($,h);$._updateAutoRotation(),$._updateFixSize2d(),$._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(ac(X,S,"_wireframeModelMap","_wireframeIndexMap"),ac(X,S,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var J=yh(S,X.getMat(S),s?$.s("shape3d.scaleable"):!0),Y=$._calcAnchorMat(S);if(Y&&fq(J,J,Y),S.mat=J,$.clear(),s||!h)if(y){var L=[];s?ad(X,S,s,$,$.getBodyColor(),[J],y,L):(Hr(X,S,y,P,J,Ih,L,lh),Hr(X,S,y,P,J,Go,L,$r),Hr(X,S,y,P,J,ns,L,Qe),Hr(X,S,y,P,J,cj,L,Wh),Hr(X,S,y,P,J,pg,L,uh),Hr(X,S,y,P,J,Pm,L,Gb)),L.length&&(ff(y.vs,L),ff(y.ns,bg(L)))}else $.mat=J,($.shapeModel=s)||($._cubeUvs=null,$.vf(Ih,0),$.vf(Go,16),$.vf(pg,8),$.vf(Pm,24),$.vf(ns,32),$.vf(cj,40))},_updateAutoRotation:function(){var s=new pf;return function(){var $=this,Y=$.data,e=$.s("shape3d.autorotate");if(!e)return Y._dynamicRotation&&delete Y._dynamicRotation,void 0;var k,X=$.gv;k="string"==typeof e?[e.indexOf("x")<0?X._eye[0]:X._center[0],e.indexOf("y")<0?X._eye[1]:X._center[1],e.indexOf("z")<0?X._eye[2]:X._center[2]]:X._eye;var E=X._center,V=Y.p3(),w=Jg([V[0]+k[0]-E[0],V[1]+k[1]-E[1],V[2]+k[2]-E[2]],V,X._up),c=Y.r3();s.set(0,0,0,Y.getRotationMode(),!0).setFromRotationMatrix(w),Math.abs(c[0]-s.x)<1e-5&&Math.abs(c[1]-s.y)<1e-5&&Math.abs(c[2]-s.z)<1e-5||(Y._dynamicRotation=[s.x,s.y,s.z])}}(),_updateFixSize2d:function(){var B=this,S=B.data,Y=B.s("shape3d.fixSizeOnScreen");if(!Y)return S._dynamicScale3d&&delete S._dynamicScale3d,void 0;var D=B.gv;S.getFinalScale3d();var K=yh(S,D.getMat(S)),i=Zk([0,0,0],K),M=D.toViewPosition(i);if(!isNaN(M.x)&&!isNaN(M.y)){var c=Zk([1,0,0],K),r=D.toViewPosition(c),Q=Zk([0,1,0],K),U=D.toViewPosition(Q),x=r.x-M.x,T=U.y-M.y;if(x&&T){var m=S._dynamicScale3d||[1,1,1],J=nb(S.s("shape3d.image")),z=Y[0]>0?Y[0]:J?El(J,S):20,O=Y[1]>0?Y[1]:J?tj(J,S):20,u=Math.abs(x/z),W=Math.abs(T/O);Math.abs(u-1)<.001&&Math.abs(W-1)<.001||(S._dynamicScale3d=[m[0]/u,m[1]/W,m[2]])}}},_updateOverlapping:function(){var R=this,H=R.s("hide.overlapping.group");if(!H)return R._rectOverlapping&&(R._rectOverlapping=r),void 0;var X,N,q,w=R.gv,c=R.data,y=yh(c,w.getMat(c)),h=1/0,S=1/0,I=-1/0,V=-1/0,K=c.getAnchor3d(),a=K.x,f=K.y,u=K.z;for(X=0;8>X;X++){if(N=Zk([(X>>2)-a,(1&X>>1)-f,(1&X)-u],y),q=w.toViewPosition(N),isNaN(q.x)||isNaN(q.y))return;h=Math.min(h,q.x),I=Math.max(I,q.x),S=Math.min(S,q.y),V=Math.max(V,q.y)}var E={x:h,y:S,w:I-h,h:V-S};R._rectOverlapping=w.overlappingBox.isOverlapping(H,E)},getVectorDynamicSize:function(){var F,v=this,K=v.s("shape3d"),m=v.data;if("billboard"===K||"plane"===K||(F=m._currentCubeElementId)!=s){var T,r,S=v.gv,b=yh(m,S.getMat(m)),c=m.getAnchor3d(),Y=.5-c.x,d=.5-c.y,Z=.5-c.z,O=v.s("shape3d.vector.dynamic.maxsize"),L=function(s,f){s[0]+=Y,s[1]+=d,s[2]+=Z,f[0]+=Y,f[1]+=d,f[2]+=Z;var g=S.toViewPosition(Zk(s,b)),y=S.toViewPosition(Zk(f,b)),T=g.x-y.x,i=g.y-y.y;return Math.min(O,Math.sqrt(T*T+i*i))};if("billboard"===K)T=L([-.5,0,0],[.5,0,0]),r=L([0,-.5,0],[0,.5,0]);else if("plane"===K)T=L([-.5,0,0],[.5,0,0]),r=L([0,0,-.5],[0,0,.5]);else if(m._currentCubeElementId!=s){var J=3*Kf[F+1],q=3*Kf[F],f=3*Kf[F+2];T=L([zk[J],zk[J+1],zk[J+2]],[zk[f],zk[f+1],zk[f+2]]),r=L([zk[J],zk[J+1],zk[J+2]],[zk[q],zk[q+1],zk[q+2]])}return[T,r]}},getCachedTexture:function(){var V=this,c=V.data,G=c._currentCubeElementId;return G!=s?V._cubeCachedImage?V._cubeCachedImage[G]:null:V._shape3dCachedImage},setCachedTexture:function(N){var o=this,z=o.data,e=z._currentCubeElementId;e!=s?(o._cubeCachedImage||(o._cubeCachedImage={}),o._cubeCachedImage[e]=N):o._shape3dCachedImage=N},invalidateCachedTexture:function(e){var N,g,f,y=this;if((f=y._shape3dCachedImage)&&(e.deleteTexture(f),y._shape3dCachedImage=null),g=y._cubeCachedImage){for(N in g)e.deleteTexture(g[N]);y._cubeCachedImage=null}},vf:function(Q,l){var z=this;if(z.gv.getFaceVisible(z.data,Q)){var K=$e(z,Q);K.mat&&(z.faceMat=!0);var H=K.uv;if(H){var F=z._cubeUvs;F||(F=z._cubeUvs=new hk([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var W=0;8>W;W++)F[l+W]=H[W]}return K}},_80o:function(Z,I,C){var N=this;if(N._rectOverlapping)return!0;var E=N.shapeModel;if(E||!N.shapeName){var O=N.gv,G=N.data,g=O._cube;zm(O,N.mat),E?Eb(O,G,E,N,N.getBodyColor(),C):(Hf(Z,g.vs,s,I.aPosition),Hf(Z,g.ns,s,I.aNormal),Lm(Z,g.is),N._18O(Z,I,N.left,0,C),N._18O(Z,I,N.front,6,C),N._18O(Z,I,N.right,12,C),N._18O(Z,I,N.back,18,C),N._18O(Z,I,N.top,24,C),N._18O(Z,I,N.bottom,30,C)),ir(O),N.faceMat&&(N._18O(Z,I,N.left,0,C,!0),N._18O(Z,I,N.front,6,C,!0),N._18O(Z,I,N.right,12,C,!0),N._18O(Z,I,N.back,18,C,!0),N._18O(Z,I,N.top,24,C,!0),N._18O(Z,I,N.bottom,30,C,!0))}},_18O:function(H,j,J,m,C,z){if(J){if(!C(J.transparent))return;if(z&&!J.mat||!z&&J.mat)return;var K=this.data.s("polygonOffset");K&&Pg(H,K),z&&zm(this.gv,J.mat);var n=this,N=n.data;N._currentCubeElementId=m;var M=n.gv,e=M.getTexture(J.texture,N),t=J.uv,k=J.uvScale,W=J.uvOffset,i=J.discardSelectable;e?t?Wd(H,j,e,i,M._buffer.uv,n._cubeUvs,W,k):Wd(H,j,e,i,M._cube.uv,s,W,k):Wd(H),yi(H,j,J.blend,J.light,J.opacity,J.reverseFlip,J.reverseColor,J.reverseCull),Xc(H,j.uDiffuse,J.color||g["color.empty"]),Xo(H,m,6),Vi(H,j),Sr(H,j,e),z&&ir(M),K&&yj(H),N._currentCubeElementId=null}}});var $p=function(w,$){jj($p,this,[w,$])};Op($p,ip,{_25Q:1,validate:function(p){var Q=this,T=Q.gv,G=Q.data,j=Q.s,I=j("edge.width"),o=G._40I,b=G._41I;if(Q.shapeModel=Q.info=s,o&&b){var W,X,z,c,L,D,e,d,h,E,H=G.isLooped(),r=j(Cp),N=l.getEdgeType(r);if(N){var S=N(G,Db(Q,T,G,H,r),T,Q._19Q);if(!S.points||S.points.isEmpty())return;D=Q.info={},e=S.segments,L=S.points,d=L.size();for(var q=o.getElevation(),K=b.getElevation(),P=0;d>P;P++){var B=L.get(P);B.e==s&&(B.e=q+(K-q)*P/(d-1))}h=hi(L.get(0)),E=hi(L.get(d-1));var M=d%2;0===M?(D.c1=hi(L.get(d/2-1)),D.c2=hi(L.get(d/2))):D.p3=hi(L.get((d-M)/2)),D.s1=h,D.s2=hi(L.get(1)),D.t1=hi(L.get(d-2)),D.t2=E}else{L=new Ce,D=Q.info={};var u=j("edge.offset"),g=j("edge.center"),Y=j("edge.source.t3"),t=j("edge.target.t3"),k=o.p3(),v=b.p3();if(Y&&(k[0]+=Y[0],k[1]+=Y[1],k[2]+=Y[2]),t&&(v[0]+=t[0],v[1]+=t[1],v[2]+=t[2]),r===Gp){e=j("edge.segments");var U=D.points=j(mi)||nl;if(d=U.size()){h=hi(U.get(0)),E=hi(U.get(d-1)),!g&&u&&(z=tn(h,k,!0),u=$(u,Bg(k,h)),k=[k[0]+z[0]*u,k[1]+z[1]*u,k[2]+z[2]*u],z=tn(v,E,!0),u=$(u,Bg(E,v)),v=[v[0]-z[0]*u,v[1]-z[1]*u,v[2]-z[2]*u]);var M=d%2;0===M?(W=hi(U.get(d/2-1)),X=hi(U.get(d/2))):D.p3=hi(U.get((d-M)/2)),D.s1=k,D.s2=h,D.t1=E,D.t2=v}else!g&&u&&(z=tn(v,k,!0),c=Bg(k,v),u=nk(u,c),k=[k[0]+z[0]*u,k[1]+z[1]*u,k[2]+z[2]*u],v=[v[0]-z[0]*u,v[1]-z[1]*u,v[2]-z[2]*u]),W=k,X=v;L.add({x:k[0],y:k[2],e:k[1]}),L.addAll(U),L.add({x:v[0],y:v[2],e:v[1]})}else{var V=Db(Q,T,G,H,r);if(Q._19Q||(V=-V),H){var y=k[0],Z=k[1],w=k[2],m=o.getTall()/2+V;W=[y-V,Z+m,w],X=[y+V,Z+m,w],L.add({x:y-V,y:w,e:Z}),L.add({x:y-V,y:w,e:Z+m}),L.add({x:y+V,y:w,e:Z+m}),L.add({x:y+V,y:w,e:Z})}else{z=tn(v,k,!0),c=Bg(k,v);var i={x:k[0],y:k[2]},F={x:v[0],y:v[2]},f=Jo(s,i,F,V),n=f.x-i.x,R=f.y-i.y;u=nk(u,c),z[0]*=u,z[1]*=u,z[2]*=u,W=[k[0]+z[0]+n,k[1]+z[1],k[2]+z[2]+R],X=[v[0]-z[0]+n,v[1]-z[1],v[2]-z[2]+R],g?(L.add({x:k[0],y:k[2],e:k[1]}),L.add({x:W[0],y:W[2],e:W[1]}),L.add({x:X[0],y:X[2],e:X[1]}),L.add({x:v[0],y:v[2],e:v[1]})):(L.add({x:W[0],y:W[2],e:W[1]}),L.add({x:X[0],y:X[2],e:X[1]}))}}D.c1=W,D.c2=X}D.list=j(is)===ag?Q.createTubeModel(L,e,I/2,p):Q.createLineModel(L,e,I,"edge","edge.dash")}}});var _l=function(A,B){jj(_l,this,[A,B])};Op(_l,Bl,{_80o:function(R,W,X){var k=this,z=k.gv,n=k.shapeModel;zm(z,k.mat),n?Eb(z,k.data,n,k,k.getBodyColor(),X):(vj(k,R,W,k.left,X),vj(k,R,W,k.front,X),vj(k,R,W,k.right,X),vj(k,R,W,k.back,X),vj(k,R,W,k.top,X),vj(k,R,W,k.bottom,X)),ir(z)},validate:function(n,v){var e,k,p=this,j=p.s,O=p.data,Y=O.p3(),P=O._thickness/2,m=O.isClosePath(),C=O.getPoints(),_=O.getSegments(),r=j(Ze),T=n&&n.uv;if(p.clear(),0>P)k=p.shapeModel=ej(C,_,j(pq),j(Al),r,j(Pb),O.getTall(),O.getShapeElevation(),m),j(Th)?j("shape3d.image")||delete k.uv:(delete k.vs,delete k.ns,delete k.uv),j("shape3d.top.image")||delete k.top_uv,j("shape3d.bottom.image")||delete k.bottom_uv;else if(j(is)===ag)e=Wp(C,_,r,m),k=p.shapeModel={vs:[]},j("shape3d.image")&&(k.uv=[],k.sum=j(Pb)||Rl(e)||1,k.len=0),j(pq)&&!m&&(k.top_vs=[],j("shape3d.top.image")&&(k.top_uv=[])),j(Al)&&!m&&(k.bottom_vs=[],j("shape3d.bottom.image")&&(k.bottom_uv=[])),p._12O(e,P);else{var w,u,f,A,H,y,d,L,z,X;if(e=Wp(C,_,r,m),H=p.vf(pg,T,!1,v),P&&(y=p.vf(Pm,T,!1,v),d=m?s:p.vf(Ih,T,!1,v),L=m?s:p.vf(Go,T,!1,v),z=p.vf(ns,T,!1,v),X=p.vf(cj,T,!1,v)),P){for(var g=0,J=e.length;J>g;g++)e[g]=p._tryRemoveBezierPoints(e[g],P);p._12O(e,P)}else H&&e.forEach(function(W){if(A=W.length,A>0)for(w=W[0],f=1;A>f;f++)u=W[f],p.addV(H.vs,w,u),w=u});p._20Q(e),n||(H&&(H.ns=bg(H.vs),Vr(H,"vs"),Vr(H,aj)),P&&(y&&(y.ns=bg(y.vs),Vr(y,"vs"),Vr(y,aj)),d&&(d.ns=bg(d.vs),Vr(d,"vs"),Vr(d,aj)),L&&(L.ns=bg(L.vs),Vr(L,"vs"),Vr(L,aj)),z&&(z.ns=bg(z.vs),Vr(z,"vs"),Vr(z,aj)),X&&(X.ns=bg(X.vs),Vr(X,"vs"),Vr(X,aj))))}var M=p.mat=Rp();qi(M,Y),ti(M,O.getFinalRotation3d(),O.getRotationMode());var a=O.getScale3d(),K=O._dynamicScale3d;K&&(a[0]*=K[0],a[1]*=K[1],a[2]*=K[2]),kf(M,a),qi(M,tf(Y)),n&&(eq(p,M,n,k),p.clear())},_20Q:function(G){var r,C,T,z,R,u,I,e=this,o=e.front,j=e.back,k=e.top,v=e.bottom,g=o?o.tuv:s,Q=j?j.tuv:s,p=k?k.tuv:s,P=v?v.tuv:s,A=0;(g||Q||p||P)&&(r=e.s(Pb)||Rl(G)||1,G.forEach(function(Z){if(C=Z.length,C>0)for(u=Z[0],T=1;C>T;T++)I=Z[T],z=A/r,A+=Bg(u,I),R=A/r,e._14O(o,z,R),e._14O(j,1-R,1-z),e._14O(k,z,R),e._14O(v,z,R),u=I}))},_14O:function(e,C,S){if(e){var l=e.uv,r=e.tuv;if(r){if(l)var p=l[0]+(l[6]-l[0])*C,A=l[1]+(l[7]-l[1])*C,o=l[2]+(l[4]-l[2])*C,Z=l[3]+(l[5]-l[3])*C,s=l[2]+(l[4]-l[2])*S,Q=l[3]+(l[5]-l[3])*S,i=l[0]+(l[6]-l[0])*S,D=l[1]+(l[7]-l[1])*S;else p=C,A=0,o=C,Z=1,s=S,Q=1,i=S,D=0;r.push(o,Z,s,Q,i,D,i,D,p,A,o,Z)}}},_13O:function(w){var C=w.uv,Y=w.tuv;Y&&(C?Y.push(C[2],C[3],C[4],C[5],C[6],C[7],C[6],C[7],C[0],C[1],C[2],C[3]):Y.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(r,B){var h=r.length;if(4>h)return r;var y,H,W,O,L,n,c=!1,g=function(D){return r[D]},F=function(Z){return r[h-1-Z]};for(L=0;1>=L;L++)for(n=L?F:g,H=n(0),W=n(1),y=2;h-1>y;y++)if(O=n(y),!O.remove)if(O.b){var N=Jo(H,W,O,B);N.adjust?(O.remove=!0,c=!0):(H=W,W=O)}else H=W,W=O;if(!c)return r;var x=[];for(y=0;h>y;y++)r[y].remove||x.push(r[y]);return x},_12O:function(I,r){var N,j,J,E,W,d=this;I.forEach(function(z){if(W=z.length,W>0)for(N={p:z[0],n:!0},E=1;W>E;E++)j=z[E],J=W-1>E?z[E+1]:s,d.addPoint(N,j,J,r,z)})},addPoint:function(O,I,v,l,E){var m,H,h,Q,A,Y,X,u,S,K=this,L=O.p,F=O.f,n=O.b,w=K.s("shape3d.side")||Sd,i=K.s("shape3d.start.angle"),e=K.s("shape3d.sweep.angle"),P=K.shapeModel,o=K.data.isClosePath();if(O.n&&(O.n=!1,F=o&&E.length>2?Jo(E[E.length-2],L,I,l):Jo(s,L,I,l),n=ts(L,F),P?P.top_vs&&K._10O(n,F,w,i,e,P.top_vs,P.top_uv):(m=K.left)&&(K.addV(m.vs,n,F),K._13O(m))),H=v?Jo(L,I,v,l):o&&E.length>2?Jo(L,I,E[1],l):Jo(L,I,s,l),h=ts(I,H),P){var B,Z,R=P.vs,U=P.uv,T=P.sum;for(U&&(B=P.len/T,P.len+=Bg(L,I),Z=P.len/T),Y=K._9O(n,F,w,i,e),X=K._9O(h,H,w,i,e),u=0;w>u;u++)S=u+1,ff(R,Y[S]),ff(R,X[u]),ff(R,Y[u]),ff(R,X[u]),ff(R,Y[S]),ff(R,X[S]),U&&(Q=u/w,A=S/w,U.push(B,A,Z,Q,B,Q,Z,Q,B,A,Z,A));!v&&P.bottom_vs&&K._10O(h,H,w,i,e,P.bottom_vs,P.bottom_uv,!0)}else!v&&(m=K.right)&&(K.addV(m.vs,H,h),K._13O(m)),(m=K.front)&&K.addV(m.vs,F,H),(m=K.back)&&K.addV(m.vs,h,n),(m=K.top)&&K.addH(m.vs,F,H,h,n,!0),(m=K.bottom)&&K.addH(m.vs,n,h,H,F);O.p=I,O.f=H,O.b=h},_10O:function(h,q,n,K,e,t,L,X){var Q,D,P=this,C=P.data,S=P._9O(h,q,n,K,e),x=(h.x+q.x)/2,A=(h.y+q.y)/2,$=C.getShapeElevation(),z=0;for(z=0;n>z;z++)X?(ff(t,S[z]),ff(t,S[z+1])):(ff(t,S[z+1]),ff(t,S[z])),ff(t,[x,$,A]),L&&(X?(Q=p*(z+1)/n+K,D=p*z/n+K):(Q=p*z/n+K,D=p*(z+1)/n+K),L.push(.5-.5*b(D),.5-.5*w(D),.5-.5*b(Q),.5-.5*w(Q),.5,.5))},_9O:function(M,s,U,g,x){var o,_,v=this,E=v.data,T=[],V=(M.x+s.x)/2,h=(M.y+s.y)/2,e=E.getTall()/2,Y=E.getShapeElevation(),W=0;for(x=x||p;U>=W;W++)o=x*W/U+g,_=b(o),T.push([V+(M.x-V)*_,Y+e*w(o),h+(M.y-h)*_]);return T},addV:function(V,g,C){var l=g.x,T=g.y,U=C.x,L=C.y,z=this.data,K=z.getShapeElevation(),x=z.getTall()/2;V.push(l,K-x,T,U,K-x,L,U,K+x,L,U,K+x,L,l,K+x,T,l,K-x,T)},addH:function(A,_,H,L,W,q){var j=this.data,n=j.getTall()/2,l=j.getShapeElevation()+(q?n:-n);A.push(_.x,l,_.y,H.x,l,H.y,L.x,l,L.y,L.x,l,L.y,W.x,l,W.y,_.x,l,_.y)},vf:function(k,w,_,E){var l,e=this,r=e.gv.getFaceVisible(e.data,k);return(_||r)&&(l=$e(e,k,E),l.vs=[],l.tuv=r&&(l.texture||w)?[]:s,l.visible=r),l}});var qf=function(l,m){jj(qf,this,[l,m])};Op(qf,ip,{_25Q:1,validate:function(N){var Y=this,T=Y.data,y=Y.s,O=T.getPoints(),C=O.size();if(Y.shapeModel=Y.info=s,C>1){var P=Y.info={},I=T.getSegments(),G=T.getThickness(),p=hi(O.get(0)),$=hi(O.get(C-1)),l=C%2;0===l?(P.c1=hi(O.get(C/2-1)),P.c2=hi(O.get(C/2))):P.p3=hi(O.get((C-l)/2)),P.s1=p,P.s2=hi(O.get(1)),P.t1=hi(O.get(C-2)),P.t2=$,P.list=y(is)===ag?Y.createTubeModel(O,I,G/2,N):Y.createLineModel(O,I,G,"shape.border","shape.dash")}var f=T.p3(),B=Y.mat=Rp();qi(B,f),ti(B,T.getFinalRotation3d(),T.getRotationMode());var x=T.getScale3d(),u=T._dynamicScale3d;u&&(x[0]*=u[0],x[1]*=u[1],x[2]*=u[2]),kf(B,x),qi(B,tf(f))},_80o:function(i,h,R){var c=this,z=c.shapeModel;if(z){var g=c.gv;zm(g,c.mat),Eb(g,c.data,z,c,c.getBodyColor(),R),ir(g)}}});var In=I.graph3d.VR=function($){var B=this;B.gv=$,B._controllers=[],B.switch=new Vp(B),B._enable=!1,B._defaultCallLater=I.Default.callLater,B._defaultCancelLater=Sh,"undefined"!=typeof R&&"VRFrameData"in R&&(B._frameData=new R.VRFrameData),B.measureOflength=1,B.eyesOffset=[0,0,0],B._orientation=new I.Math.Quaternion,B._lastHeadPose=[0,0,0],B._offsetToBeAdd=[0,0,0],B._fpsInfo={time:0,fps:0,frames:0}};Op(In,H,{ms_fire:!0,_42:function(v,i,N,R){var d=this,P=d.gv;if(!P.drawFilter&&d._deviceInAction){var t=d._device;if(t){var n=d._measureOflength;t.depthNear=P.getNear()*n,t.depthFar=P.getFar()*n;var F=d._offsetToBeAdd;if(d.eyesOffset[0]+=F[0],d.eyesOffset[1]+=F[1],d.eyesOffset[2]+=F[2],F[0]=0,F[1]=0,F[2]=0,t.isPresenting===!1)return d._controllers.forEach(function(u){u&&u.update()}),P.iv(),!1;var Z=d._frameData;t.getFrameData(Z);var O=Z.pose.position;if(O){var k=d.toViewPosition(O);P.setEye(k),d._orientation.fromArray(Z.pose.orientation);var y=new I.Math.Vector3(0,0,-10*d._scaleFactor);y.applyQuaternion(d._orientation),P.setCenter([k[0]+y.x,k[1]+y.y,k[2]+y.z])}d._controllers.forEach(function(t){t&&t.update()}),P.setViewport(v,0,0,i/2,N),d._viewMatrix=d._copyViewMatrix(Z.leftViewMatrix),d._projectMatrix=d._copyProjectMatrix(Z.leftProjectionMatrix),R(),P.setViewport(v,i/2,0,i/2,N),d._viewMatrix=d._copyViewMatrix(Z.rightViewMatrix),d._projectMatrix=d._copyProjectMatrix(Z.rightProjectionMatrix),R(),d._lastViewMatrix=d._viewMatrix,d._lastProjectMatrix=d._projectMatrix,d._viewMatrix=null,d._projectMatrix=null,d.submitFrame();var Y=Date.now(),j=d._fpsInfo;return Y-j.time>1e3?(j.fps=Math.round(1e3*(j.frames+1)/(Y-j.time)),j.time=Y,j.frames=0):j.frames++,!0}}},onVRDisplayPresentChange:function(){var y=this.isPresenting();this._injectGraphView(y),this.fp("present",!y,y)},getOrientation:function(){return this._orientation},addController:function(F){F=F||0;var f=this,y=f.getController(F);return y?y:(y=new ln(f,F),f._controllers.push(y),y)},getController:function(n){n=n||0;for(var g=this._controllers,M=0,q=g.length;q>M;M++)if(g[M]&&g[M].id===n)return g[M];return null},removeController:function(L){L=L||0;for(var A=this._controllers,W=0,j=A.length;j>W;W++)if(A[W]&&A[W].id===L)return A.splice(W,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(C,u){var X=this,z=X._scaleFactor,f=X._eyesOffset,A=X._lastHeadPose;return A[0]=C[0]*z,A[1]=C[1]*z,A[2]=C[2]*z,u?(u[0]=A[0]+f[0],u[1]=A[1]+f[1],u[2]=A[2]+f[2],u):[A[0]+f[0],A[1]+f[1],A[2]+f[2]]},addEyesOffset:function(T,r,V){var I=this._offsetToBeAdd;I[0]+=T,I[1]+=r,I[2]+=V},_copyViewMatrix:function(x){var f=this.dup(x),A=this._scaleFactor;f[12]*=A,f[13]*=A,f[14]*=A;var K=this._eyesOffset;if(K&&(K[0]||K[1]||K[2])){var p=K[0],V=K[1],N=K[2];f[12]-=f[0]*p+f[4]*V+f[8]*N,f[13]-=f[1]*p+f[5]*V+f[9]*N,f[14]-=f[2]*p+f[6]*V+f[10]*N}return f},shutdown:function(){var N=this._device;N&&N.isPresenting&&N.exitPresent()},isPresenting:function(){var v=this._device;return v&&v.isPresenting},_copyProjectMatrix:function(n){var i=this.dup(n),D=this._scaleFactor;return i[14]*=D,i},dup:function(r,b){for(var m=r.length,S=b||new Array(m);m--;)S[m]=r[m];return S},getViewMatrix:function(C){var $=this._viewMatrix;return $?this.dup($,C):void 0},getProjectMatrix:function(){var t=this._projectMatrix;return t?this.dup(t):void 0},submitFrame:function(){var S=this;if(S._enable&&S._deviceInAction){var Q=S._device;Q&&Q.isPresenting&&(Q.submitFrame(),S.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(y){var O=this.gv;return O.intersectObjects(y,O.dm().getDatas())},setDevice:function(O){var H=this;H._device=O},_injectGraphView:function(){var w,t,I;return function(n){var O=this.gv;if(!n)return w&&(O.getWidth=w,O.getHeight=t,O.getDevicePixelRatio=I),void 0;var X=this._device,T=X.getEyeParameters("left"),G=T.renderWidth,h=T.renderHeight;w=O.getWidth,t=O.getHeight,I=O.getDevicePixelRatio,O.getWidth=function(){return 2*G},O.getHeight=function(){return h},O.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(d){var S=this;if(!d)return Ui=I.Default.callLater=S._defaultCallLater,Sh=I.Default.cancelLater=S._defaultCancelLater,void 0;var S=this;Ui=I.Default.callLater=function(E,m,p,Q){var X=S._device;return X&&X.isPresenting?Q?q(function(){Ui(E,m,p)},Q):X.requestAnimationFrame(function(){S._deviceInAction=!0,E.apply(m,p),S._deviceInAction=!1}):S._defaultCallLater(E,m,p,Q)},Sh=I.Default.cancelLater=function(W,l){var V=S._device;return V&&V.isPresenting?l?U(W):V.cancelAnimationFrame(W):S._defaultCancelLater(W,l)}}}),H.defineProperties(In.prototype,{enable:{get:function(){return this._enable},set:function(l){var Q=this;Q._enable!==l&&(Q._enable=l,l?(Q.switch.showButton(),Q._injectCallLaterFunc(!0)):(Q.shutdown(),Q.switch.hideButton(),Q._injectCallLaterFunc(!1)),Q.fp("enable",!l,l))}},measureOflength:{get:function(){return this._measureOflength},set:function(t){this._measureOflength=t;var x=this._scaleFactor=1/t;this._controllers.forEach(function(w){w&&w._setScaleFactor(x)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(S){this._eyesOffset=S}},controllerModel:{get:function(){return this._controllerModel},set:function(K){var x;"object"==typeof K?(x=K.mtl,K=K.obj):(x=K+".mtl",K+=".obj");var F=this,X=F._controllerModel;X&&X.obj===K&&X.mtl===x||(X=F._controllerModel={obj:K,mtl:x},l.loadObj(K,x,{finishFunc:function(w,P){F._controllerModel===X&&l.setShape3dModel("vrControllerModel",P)}}))}},interactive:{get:function(){return!!this._interactive},set:function(O){!!O!=!!this._interactive&&(this._interactive=O,O&&this.addController(0),this.gv.getCoreInteractor().enableVR(O))}}});var ln=function(d,E){function V(g){var $=navigator.getGamepads&&navigator.getGamepads();if($)for(var u=0,k=0,_=$.length;_>u;u++){var y=$[u];if(y){var w=y.id;if("OpenVR Gamepad"===w||"OpenVR Controller"===w||0===w.indexOf("Oculus Touch")||0===w.indexOf("Spatial Controller")){if(k===g)return y;k++}}}}function n(G,P,B){return Math.abs(G[0]-P[0])<B&&Math.abs(G[1]-P[1])<B&&Math.abs(G[2]-P[2])<B?!0:!1}var J=this;J.vr=d,J.id=E;var c,y,N=[0,0],B=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],X=new Vb;X.s("shape3d","vrControllerModel"),X.isController=!0,X.s("intersect",!1),J.getGamepad=function(){return y},J.isButtonPressed=function(g){for(var z,H=0,M=B.length;M>H;H++)if(z=B[H],z.id===g)return z.pressed;return!1},J.getNode=function(){return X};var M=.003;J.setRotationEpsilon=function(Z){M=Z};var Z=5e-4,R=Z;J.setPositionEpsilon=function(I){Z=I,R=I*J.vr._scaleFactor},J._setScaleFactor=function(U){X.s3(U,U,U),R=Z*U},J._setScaleFactor(J.vr._scaleFactor);var u,T=new Er,$=new rs,w=[0,0,0],_=[0,0,0],i=new pf,o=new Nd,U=new jl;J.getRay=function(){return u?(U.origin.fromArray(w),U.direction.copy(o),u=!1,U):U},J.update=function(){if(c=y,y=V(E),c!=y&&console.log("gamepad changed",y),!y||y.pose===r)return y=null,X.s("3d.visible",!1),void 0;if(l.getShape3dModel("vrControllerModel")){X.dm()||d.gv.dm().add(X),X.s("3d.visible",!0);var f=y.pose;if(null!==f){f.position&&(J.vr.toViewPosition(f.position,w),n(X.p3(),w,R)||(u=!0,X.p3(w))),f.orientation&&(T.fromArray(f.orientation),o.set(0,0,-1).applyQuaternion(T).normalize(),$.makeRotationFromQuaternion(T),i.set(0,0,0,X.getRotationMode(),!0).setFromRotationMatrix($),_[0]=i.x,_[1]=i.y,_[2]=i.z,n(X.r3(),_,M)||(u=!0,X.r3(_))),u&&d.fp("gamepad.pose",null,{position:w,rotation:_,id:E});var Z=y.axes;(N[0]!==Z[0]||N[1]!==Z[1])&&(N=[Z[0],Z[1]],d.fp("gamepad.axes",null,{id:E,axes:N}));var x,s,q,K,z=y.buttons;for(x=0,s=z.length;s>x;x++)if(q=z[x],K=q.pressed,K!==B[x].pressed){B[x].pressed=K;var j={id:E},I="state";j[I]=j._62O=K?"down":"up",d.fp("gamepad.button."+B[x].id,null,j)}}}}},Vp=function(I){this.vr=I,this._button=null};Op(Vp,H,{showButton:function(){var M=this.assureButton();if(!M.parentNode){var U=this.vr.gv,N=U.getView();U._79O?N.insertBefore(M,U._79O):N.appendChild(M)}},hideButton:function(){var Q=this._button;Q&&Q.parentNode&&Q.parentNode.removeChild(Q)},assureButton:function(){var m=this._button;return m?m:this._button=this.createButton(this.vr.gv)},createButton:function(X){function I(V,z){V.textContent=z&&z.isPresenting?" VR ":" VR "}function q(V){Y.style.display="",Y.style.cursor="pointer",Y.style.left="calc(50% - 50px)",Y.style.width="100px",I(Y,V),Y.onmouseenter=function(){Y.style.opacity="1.0"},Y.onmouseleave=function(){Y.style.opacity="0.5"},Y.onclick=function(){V.isPresenting?V.exitPresent():V.requestPresent([{source:X.getCanvas()}])},X.vr.setDevice(V)}function L(){Y.style.display="",Y.style.cursor="auto",Y.style.left="calc(50% - 75px)",Y.style.width="150px",I(Y,null),Y.onmouseenter=null,Y.onmouseleave=null,Y.onclick=null,X.vr.setDevice(null)}function l(y){y.style.position="absolute",y.style.bottom="20px",y.style.padding="12px 6px",y.style.border="1px solid #fff",y.style.borderRadius="4px",y.style.color="#000",y.style.font="normal 13px sans-serif",y.style.textAlign="center",y.style.opacity="0.5",y.style.outline="none",y.style.zIndex="999"}if("getVRDisplays"in navigator){var Y=this._button=k.createElement("button");return Y.style.display="none",l(Y),R.addEventListener("vrdisplayconnect",function(p){q(p.display)},i),R.addEventListener("vrdisplaydisconnect",function(){L()},i),R.addEventListener("vrdisplaypresentchange",function(a){I(Y,a.display),X.vr.onVRDisplayPresentChange()},i),navigator.getVRDisplays().then(function(I){I.length>0?q(I[0]):L()}),Y}var G=k.createElement("a");return G.href="https://webvr.info",G.innerHTML=" webvr",G.style.left="calc(50% - 90px)",G.style.width="180px",G.style.textDecoration="none",l(G),G}}),H.defineProperties(Vp.prototype,{});var Ah=I.graph3d.PostProcessing=function(V){function k(){if(!v){var e=V.getGL();v=new xn.RenderTarget(V,e),J=new Hm.Shader(e,G.vs,G.fs),X=Hm.Buffer.createIndexBuffer(e,new Uint16Array([0,2,1,1,2,3])),A=Hm.Buffer.createVertexBuffer(e,new Float32Array([0,0,1,0,0,1,1,1]))}}var v,J,X,A,R=this,L={},x=!1;!function(){H.keys(Ah).forEach(function(x){L[x]=new Ah[x](V)})}(),R.getModule=function(X){return X?L[X]:R},R.getModuleList=function(){return H.keys(L)},R.handleDataModleChange=function(T,$){T&&(T.setPostProcessingData(R.serialize()),T.removeSerializeListener(R.onDataModelSerialize,R)),$&&($.addSerializeListener(R.onDataModelSerialize,R),R.deserialize($.getPostProcessingData()))},R.onDataModelSerialize=function(S){"serialize"===S.type?V.dm()._postProcessingData=R.serialize():"deserialize"===S.type&&R.deserialize(V.dm().getPostProcessingData())},R.serialize=function(){var f,I,Z,q={};for(f in L)I=L[f],q[f]={enable:I.enable},Z=I.serializeProperties,Z&&Z.forEach(function(J){q[f][J]=I[J]});return q},R.deserialize=function(P){if(P){var S,z,h,v;for(S in P)if(z=L[S]){h=P[S],R.enableModule(S,h.enable);for(v in h)"enable"!==v&&(z[v]=h[v])}}else{var S,z;for(S in L)z=L[S],z.enable=!1,z.resetProperties&&z.resetProperties()}},R.decodeShader=function(B){var D,P,F,b="",Q="";for(F=0;F<B.length;F++)D=B[F],"%"===D?D="'":"a"===D?D='"':"]"===D&&(D="\\"),P=String.fromCharCode(D.charCodeAt(0)-1),F%2?Q+=P:b=P+b;return Q+b},R.createShader=function(C,o,w){var f=o.indexOf("^#"),T=R.decodeShader(o.substr(0,f)),i=R.decodeShader(o.substr(f+2));if(w){var b=w(T,i);b&&b.vs&&(T=b.vs),b&&b.fs&&(i=b.fs)}return new Hm.Shader(C,T,i)},R.enableModule=function(n,W){var N,g,I,P=n.split(",");for(N=0,g=P.length;g>N;N++)I=P[N].trim(),L[I]&&(L[I].enable=W);x=!1;for(I in L)if(L[I].enable){x=!0;break}x&&k()};var G={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};R._42=function(k,D,m,O,i){if(x&&!i){v.setSize(k,D,m),os(k,v.frame),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),V.setViewport(k,0,0,D,m),O();var T,G=v;for(T in L)G=L[T]._42(k,G)||G;return Sk(k),V.setViewport(k,0,0,D,m),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),J.bind(),k.activeTexture(k.TEXTURE0+0),k.bindTexture(k.TEXTURE_2D,G.texture),J.uniforms.image=0,X.upload(),A.upload(),J.attributes.pos.pointer(A),k.drawElements(k.TRIANGLES,6,k.UNSIGNED_SHORT,0),k.bindTexture(k.TEXTURE_2D,null),k.useProgram(V._prg),!0
    }}},mj=I.graph3d.PostProcessing.Bloom=function(x){function C(){var o=x.getWidth(),B=x.getHeight();if(o&&B){I=[o,B],W=!0;var C,j=x.getGL(),y=Math.round(I[0]/2),T=Math.round(I[1]/2);for(A=new xn.RenderTarget(x,j,y,T),C=0;n>C;C++)O.push(new xn.RenderTarget(x,j,y,T)),G.push(new xn.RenderTarget(x,j,y,T)),y=Math.round(y/2),T=Math.round(T/2);var z=x._postProcessing;X=z.createShader(j,mj._34Q);for(var C=0;n>C;C++)N[C]=z.createShader(j,mj._35Q,function(v,$){return{fs:$.replace(/DEFINE_VALUE/g,m[C])}});$=z.createShader(j,mj._36Q,function(e,t){return{fs:t.replace(/NUM_MIPS/g,n)}}),Z=z.createShader(j,mj.finalShader),l=Hm.Buffer.createIndexBuffer(j,new Uint16Array([0,2,1,1,2,3])),s=Hm.Buffer.createVertexBuffer(j,new Float32Array([0,0,1,0,0,1,1,1]))}}var F,y,v,l,s,B=this,b=!1,W=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){F=1.5,y=.55,v=.4},H.defineProperties(B,{enable:{get:function(){return b},set:function(q){!!b!=!!q&&(b=q,q&&!W&&C())}},strength:{get:function(){return F},set:function(b){F=b}},threshold:{get:function(){return y},set:function(C){y=C}},radius:{get:function(){return v},set:function(_){v=_}}}),this.resetProperties();var A,X,$,Z,I=[256,256],O=[],G=[],n=5,m=[3,5,7,9,11],N=[];B._42=function(E,_){function H(N,z,A,_){os(E,z.frame),x.setViewport(E,0,0,z.width,z.height),_?_(E):E.clear(E.COLOR_BUFFER_BIT|E.DEPTH_BUFFER_BIT),j!==N&&N.bind();var w=0;for(var y in A){var Q=A[y];Q instanceof WebGLTexture&&(E.activeTexture(E.TEXTURE0+w),E.bindTexture(E.TEXTURE_2D,Q),Q=w,w++),N.uniforms[y]=Q}for(j!==N&&(l.upload(),s.upload(),N.attributes.pos.pointer(s),j=N),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0);w--;)E.activeTexture(E.TEXTURE0+w),E.bindTexture(E.TEXTURE_2D,null);Sk(E)}if(b){W||C();var j;H(X,A,{smoothWidth:.01,luminosityThreshold:y,tDiffuse:_.texture});var p,u=A,T=Math.round(I[0]/2),S=Math.round(I[1]/2);for(p=0;n>p;p++)H(N[p],O[p],{colorTexture:u.texture,direction:[1,0],texSize:[T,S]}),H(N[p],G[p],{colorTexture:O[p].texture,direction:[0,1],texSize:[T,S]}),T=Math.round(T/2),S=Math.round(S/2),u=G[p];return H($,O[0],{blurTexture1:G[0].texture,blurTexture2:G[1].texture,blurTexture3:G[2].texture,blurTexture4:G[3].texture,blurTexture5:G[4].texture,bloomStrength:F,bloomRadius:v,bloomTintColor:[1,1,1]}),H(Z,_,{image:O[0].texture},function(C){C.enable(C.BLEND),C.blendEquation(C.FUNC_ADD),C.blendFunc(C.SRC_ALPHA,C.ONE)}),E.blendEquationSeparate(E.FUNC_ADD,E.FUNC_ADD),E.blendFuncSeparate(E.SRC_ALPHA,E.ONE_MINUS_SRC_ALPHA,E.ONE,E.ONE_MINUS_SRC_ALPHA),_}}};mj._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",mj._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d1j/t2j!p-on!viTjuhiihqj!fgxm0pnbvuT<ftwvbgsgzjjeo)h5!dwffwd!3>!!wsVpwm<pDvhobjsgGp`smnh!t~bn<qxm!f+s!31E/!3d!p>m,p!snUvfTyuuivhsjff<xv<oxj!g+p!s*n3!fwmfqdn3b!tu!f,y!T2jf{mfq<nbvto)j!g>p,s!nn!vwTffdt3v!gegjjsefd<ucjhpso/<*u$fetfgggjPowfv!!L.F!SwOVFwM!`-SfBsEvJuVyTf!UEsFpGmJpOdF!`)WEB3MfVsFvu$yeffug!j>o!f3!fTmJqHnNbBt!!E4FdGfJwOF<`cWhBsM/V*FufgtmgpgbPuw!vh!b,v!twtVjwb!o-Qfesgv)ujyof!Ugsmppmbpud!!y)-E!3jfos!vgumypfbuu!!>t!j2hfnmbq*n!b|t!s4fdufvwso<!y1!/+4!:f9{:j5T!w+o!jf!y+q!)o!p.j1u/d6f!s+j!ey!!>+!!uyf0t)g!gtPjwhvn!b3!d+f!wtj<h*nbbn*h*j0Ttgj!h-nyb)<ge~Qowbpjjtet!vnbbhj!o>)!*x!!|ubwpfmdg3!<j*ojw)Tujb{pfm!g>!!>2!/y1!!u0b!pumfgyT|j!{*f!<,,g!mjp!b<uT!VgJTEjBhSn`bM!F>O!SgFmLp!b=u!)jT!J<H2N!B>*!<j!gumopjb!u)!sxpfgjh<inuvTTvuni!h>j!fhxb!v+t!tcjhbso/Q*ewgV)w1!/-1f-s!vguTyjfhUnsbp*m<pdw!f)dE43!fesjvgugyvftuf!T>v!n",mj._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",mj.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Ng=I.graph3d.PostProcessing.Dof=function(s){function n(){x=!0;var q=s.getGL();c=new xn.RenderTarget(s,q),m=s._postProcessing.createShader(q,Ng._38Q),z=Hm.Buffer.createIndexBuffer(q,new Uint16Array([0,2,1,1,2,3])),h=Hm.Buffer.createVertexBuffer(q,new Float32Array([0,0,1,0,0,1,1,1]))}var c,m,z,h,O,v,j,r,k=this,_=!1,x=!1;this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},H.defineProperties(k,{enable:{get:function(){return _},set:function(R){!!_!=!!R&&(_=R,R&&!x&&n())}},image:{get:function(){return v},set:function(G){v!==G&&(v=G,O&&(s.getGL().deleteTexture(O),O=null),s.iv())}},maxblur:{get:function(){return j},set:function(R){j!==R&&(j=R,s.iv())}},aperture:{get:function(){return r},set:function(o){r!==o&&(r=o,s.iv())}}}),this.resetProperties(),k._42=function(I,F){function b(N,g,T,A){os(I,g.frame),s.setViewport(I,0,0,g.width,g.height),A?A(I):I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT),E!==N&&N.bind();var O=0;for(var j in T){var k=T[j];k instanceof WebGLTexture&&(I.activeTexture(I.TEXTURE0+O),I.bindTexture(I.TEXTURE_2D,k),k=O,O++),N.uniforms[j]=k}for(E!==N&&(z.upload(),h.upload(),N.attributes.pos.pointer(h),E=N),I.drawElements(I.TRIANGLES,6,I.UNSIGNED_SHORT,0);O--;)I.activeTexture(I.TEXTURE0+O),I.bindTexture(I.TEXTURE_2D,null);Sk(I)}if(_){x||n();var E;if(!O){var X=nb(this.image);if(!X)return F;O=gi(I,X)}var C=F.width,l=F.height;return c.setSize(I,C,l),b(m,c,{tColor:F.texture,tDepth:O,aspect:C/l,aperture:this.aperture,maxblur:this.maxblur}),c}}};Ng._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Kk(l,{accordionViewExpandIcon:Hh(Gh),accordionViewCollapseIcon:Hh(Gh,!0),accordionViewLabelColor:Ir,accordionViewLabelFont:bo,accordionViewTitleBackground:Uj,accordionViewSelectBackground:Rd,accordionViewSelectWidth:3,accordionViewSeparatorColor:r,splitViewDividerSize:1,splitViewDividerBackground:Uj,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:fd,rect:[2,2,12,12],background:Gh}]},propertyViewLabelColor:Xj,propertyViewLabelSelectColor:Ir,propertyViewLabelFont:bo,propertyViewExpandIcon:Hh(Ff),propertyViewCollapseIcon:Hh(Ff,!0),propertyViewBackground:gn,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Hq,propertyViewColumnLineColor:Hq,propertyViewSelectBackground:Rd,listViewLabelColor:Xj,listViewLabelSelectColor:Ir,listViewLabelFont:bo,listViewRowLineVisible:!1,listViewRowLineColor:Hq,listViewSelectBackground:Rd,treeViewLabelColor:Xj,treeViewLabelSelectColor:Ir,treeViewLabelFont:bo,treeViewExpandIcon:Hh(Bm),treeViewCollapseIcon:Hh(Bm,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Hq,treeViewSelectBackground:Rd,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Xj,tableViewLabelSelectColor:Ir,tableViewLabelFont:bo,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Hq,tableViewColumnLineColor:Hq,tableViewSelectBackground:Rd,treeTableViewLabelColor:Xj,treeTableViewLabelSelectColor:Ir,treeTableViewLabelFont:bo,treeTableViewExpandIcon:Hh(Bm),treeTableViewCollapseIcon:Hh(Bm,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Hq,treeTableViewColumnLineColor:Hq,treeTableViewSelectBackground:Rd,tableHeaderLabelColor:Xj,tableHeaderLabelFont:bo,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Qk,tableHeaderBackground:gn,tableHeaderMoveBackground:Xh,tableHeaderInsertColor:Rd,tableHeaderSortDescIcon:Jl(Ff,!0),tableHeaderSortAscIcon:Jl(Ff),tabViewTabGap:1,tabViewLabelColor:Ir,tabViewLabelFont:bo,tabViewTabBackground:Uj,tabViewSelectWidth:3,tabViewSelectBackground:Rd,tabViewMoveBackground:Xh,tabViewInsertColor:Rd,toolbarLabelColor:Xj,toolbarLabelSelectColor:Ir,toolbarLabelFont:bo,toolbarBackground:gn,toolbarSelectBackground:Rd,toolbarItemGap:8,toolbarSeparatorColor:vm},!0);var Te={translateX:1,sortColumn:1},Vm={sortable:1,sortOrder:1,sortFunc:1},Lc={focusData:1},Cr={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},vk={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Zr=function(U,y){y.add(U),U.hasChildren()&&U.eachChild(function(m){Zr(m,y)})},Qm=function(b,q,V,c,D,g,r,F,w,e,d){var $,Q=V.getValueType(e),J=V.getAlign(e);if(V.getEnumValues(e)){var N=V.toEnumLabel(q,e),A=Pc||0,E=0,k=g,M=l.getTextSize(c,N).width;return $=nb(V.toEnumIcon(q,e)),$&&(E=g+Pc/2,"center"===J?E+=(F-(A+M))/2:"right"===J&&(E=E+F-(A+M)),on(b,$,E,r+w/2,e,d),k=E+Pc/2),N!=s&&($?li(b,N,c,D,k,r,F-(k-g),w):li(b,N,c,D,g,r,F,w,J)),void 0}return q=V.formatValue(q),q!=s?Q===fk?(Yl(b,g,r,F,w,q),void 0):Q===Fe||!Q&&Xp(q)?($=nb(q?Ii:Fi),on(b,$,g+F/2,r+w/2,e,d),void 0):(li(b,q,c,D,g,r,F,w,J),void 0):void 0},Ad=function(p,y){var x=y.view,l=Yf(p),k=y.column||y.property;x.getDataModel().beginTransaction(),y.editor=p,p.info=y,x.setCurrentEditor(p),x.getView().insertBefore(l,x._79O),Kj(p,y.editorRect),p.setFocus?p.setFocus():an(p),p.commitValue=function(u,h){p._17Q&&(p=p._17Q),h||x.setValue(y.data,k,p.getValue?p.getValue():p.value),p.close&&p.close(),kq(l)},k.onEditorCreated&&k.onEditorCreated(y)},cl=function(n,Z,Q,e,I){var U=lc(n,Q),W=Z.value,O=Z.view,v=I.getValueType(Z.data);return U.onblur=U.onchange=function(){O.endEditing()},"input"===n?(W=I.formatValue(W),W!=s&&(U.value=W),U.onkeydown=function($){$k($)?O.endEditing():vq($)&&O.endEditing(!0)},(v===qh||v===Zf)&&U.addEventListener(Ug,l.numberListener,i)):n===Kr&&e.forEach(function(O){var o=k.createElement("option");o.innerHTML=I.toEnumLabel(O),o.value=O,I.isEnumEqual(W,O)&&(o.selected=!0),Xd(U,o)}),Ad(U,Z),U},yc=I.widget={},qd=function(j,v,H){Op(C+".widget."+j,v,H)};Kk(Lq,{ms_value:function(b){b.getValue=function(G){var g=this.getItemById(G),Y=g.element;return Kl(Y)?Y:Y?Y.getValue?Y.getValue():Y.value:g.selected},b.setValue=function(G,h){var y=this.getItemById(G);if(y){var t=y.element;t&&!Kl(t)?t.setValue?t.setValue(h):t.value=h:Xp(h)?(y.selected=h,this.iv()):(y.element=h,this.iv())}},b.v=function(r,I){var y=this;if(2===arguments.length)y.setValue(r,I);else{if(!sk(r))return y.getValue(r);for(var x in r)y.setValue(x,r[x])}return y}},_46o:function(N){N._icon=s,N._accessType=s,N._valueType=s,N._editable=!1,N._batchEditable=!0,N._align=Ih,N._nullable=!0,N._emptiable=!1,N.setParent=ak,N.formatValue=function(Q){var x=this,y=x._valueType;return x.getEnumValues()?x.toEnumLabel(Q):y===Fe?!!Q:Q!=s&&y===qh?d(Q):Q},N.setEnum=function($,i,j,u,l,e,C){var Y=this;$&&!xd($)&&$.values&&(u=$.editable,j=$.icons,i=$.labels,l=$.strict,e=$.maxHeight,C=$.dropDownWidth,$=$.values),pn($)&&($=$._as),pn(i)&&(i=i._as),pn(j)&&(j=j._as),Y._enumValues=$,Y._enumLabels=i,Y._enumIcons=j,Y._enumEditable=u,Y._enumStrict=l==s?!0:l,Y._enumMaxHeight=e,Y._enumDropDownWidth=C,$&&$.length&&il($[0])&&(Y._valueType=Zf),Y.fp("enum",!1,!0)},N.getEnumDropDownWidth=function(){return this._enumDropDownWidth},N.getEnumMaxHeight=function(){return this._enumMaxHeight},N.isEnumEditable=function(){return this._enumEditable},N.getEnumValues=function(){return this._enumValues},N.getEnumLabels=function(){return this._enumLabels},N.getEnumIcons=function(){return this._enumIcons},N.isEnumStrict=function(){return this._enumStrict},N.isEnumEqual=function(K,d){return this._enumStrict?K===d:K==d},N.toEnumLabel=function(O,I){var C=this,s=C.getEnumValues(I),B=C.getEnumLabels(I);if(s&&B)for(var X=0;X<s.length;X++)if(C.isEnumEqual(O,s[X]))return B[X];return O},N.toEnumIcon=function(G,d){var m=this,N=m.getEnumValues(d),v=m.getEnumIcons(d);if(N&&v)for(var g=0;g<N.length;g++)if(m.isEnumEqual(G,N[g]))return v[g];return r}},_45o:function(s){s._87o=function(B,s,w,A,Q,c){if(B){var F=this,U=F._90I,q=$b(1);F._columnLineVisible&&(Q-=1),F._rowLineVisible&&(c-=1),0>=Q||0>=c||(F._90I||(U=F._90I={}),U[s]||(U[s]=new Ce),Kj(q,F.tx()+w,F.ty()+A,Q,c),Xd(q,B),F._view.insertBefore(q,F._79O),B.onParentAdded&&B.onParentAdded(q),U[s].add(q))}},s._76o=function(){var N=this,p=N._90I;if(p){for(var P in p)p[P].each(function(O){kq(O)});delete N._90I}},s._77o=function(G){var B=this;if(B._90I){var u=B._90I[G];u&&(u.each(function(L){kq(L)}),delete B._90I[G])}}},_47o:function(K){K.getValue=function(B,Y){return Y.getValue?Y.getValue(B,Y,this):Tm(B,Y.getAccessType(),Y.getName())},K.setValue=function(l,t,g){if(t.isEmptiable(l)||""!==g||(g=r),t.isNullable(l)||g!=s){var m=this,a=t.getName(l),G=t.getAccessType(l),w=t.getValueType(l);w===qh&&Kl(g)?g=o(g):w===Zf&&Kl(g)?g=parseFloat(g):w===Fe&&Kl(g)&&(g="true"===g),m._batchEditable&&t._batchEditable&&m.isSelected(l)?m.sm().each(function(I){t.setValue?t.setValue(I,t,g,m):gf(I,G,a,g)}):t.setValue?t.setValue(l,t,g,m):gf(l,G,a,g)}},K.setCurrentEditor=function(d){this.endEditing(),this._currentEditor=d,this.redraw()},K.isEditing=function(t,J){var W=this,r=W._currentEditor;if(!r)return!1;if(J){var $=r.info;return $?($.column||$.property)===J&&$.data===t:!1}return!0},K.endEditing=function(h){var Z=this,i=Z._currentEditor;i&&(delete Z._currentEditor,i.commitValue&&i.commitValue(i.info,h),Z.redraw(),Z.getDataModel().endTransaction())},K.beginEditing=function(o){this.endEditing();var X=this,P=o.column||o.property;if(P.beginEditing)P.beginEditing(o);else{var L=o.data,R=o.value,S=X.getSelectBackground(L),K=P.getEnumValues(L),I=P.getSlider(L),l=P.getColorPicker(L);if(I){var Y=sh(yc.Slider,I);return Y.setValue(R),Y.getView().onblur=function(){X.endEditing()},Y.isInstant()&&(Y.onValueChanged=function(){X.setValue(L,P,Y.getValue())}),Ad(Y,o),void 0}if(l||P.getValueType(L)===fk){var r=sh(yc.ColorPicker,l);return r.setValue(R),r.onClosed=function(){X.endEditing()},r.isInstant()&&(r.onValueChanged=function(a,M){X.setValue(L,P,M)}),Ad(r,o),r.open(),void 0}if(K){if(yc.ComboBox){var w=new yc.ComboBox;w.setValue(R),w.setValues(K),w.setLabels(P.getEnumLabels(L)),w.setIcons(P.getEnumIcons(L)),w.setEditable(P.isEnumEditable(L)),w.setStrict(P.isEnumStrict(L)),w.setMaxHeight(P.getEnumMaxHeight(L)),w.setDropDownWidth(P.getEnumDropDownWidth(L)),w.onClosed=function(){X.endEditing()},Ad(w,o),w.open()}else cl(Kr,o,S,K,P);return}var b=P.getValueType(L);if(b===Fe||Xp(R))return X.setValue(L,P,!R),void 0;if(P.getItemEditor(L)){var J=um(P.getItemEditor(L)),c=new J(L,P,X,o),E=c.getView();return E._17Q=c,c.setValue(R),Ql(E),Ad(E,o),c.editBeginning&&c.editBeginning(),void 0}cl("input",o,S,s,P)}}},_44o:function(x){x.init=function(m){var T=this,y=T.th=new rk(m),k=T._view=js(1,T);T.tv=T._tableView=m,Xd(k,y.getView()),Xd(k,m.getView()),y.mp(function(J){J.property===cc&&T.iv()}),T.iv()},x.getTableView=function(){return this.tv},x.getTableHeader=function(){return this.th},x.getDataModel=function(){return this.tv.dm()},x.getColumnModel=function(){return this.tv.getColumnModel()},x.setColumns=function(l){this.tv.setColumns(l)},x.addColumns=function(z){this.tv.addColumns(z)},x.endEditing=function(){this.tv.endEditing()},x.validateImpl=function(){var n=this,d=n.th,R=ec(d),w={x:0,y:0,width:n.getWidth(),height:R};Kj(d,w),w.y=R,w.height=t(0,n.getHeight()-R),Kj(n.tv,w)}},ms_vs:function(t){t._41o=function(){return this._29I.height<this._59I},t._43o=function(){var p=this;p._41o()&&(p._58I||(q(function(){p._94O()},vh),p.iv()),p._58I=new Date)},t._94O=function(){var K=this;if(K._58I){var f=new Date;f.getTime()-K._58I.getTime()>=vh?(delete K._58I,K.iv()):q(function(){K._94O()},vh)}},t._93I=function(){var J=this,j=J._27I;if(J._58I||!J._autoHideScrollBar){j||Xd(J._79O,j=J._27I=$b());var u=J._29I,M=u.height,h=J._59I,K=J.getScrollBarSize(),X=u.width-K-2,k=M*(-J.ty()/h),t=M*(M/h),P=j.style;h>M?(Ae>t&&(k=k+t/2-Ae/2,0>k&&(k=0),k+Ae>M&&(k=M-Ae),t=Ae),P.visibility=Gj,P.background=J.getScrollBarColor(),P.borderRadius=K/2+pp,Kj(j,X,k,K,t)):P.visibility=mq}else j&&(j.style.visibility=mq)}},ms_hs:function(Q){Q._40o=function(){return this._29I.width<this._91I},Q._42o=function(){var B=this;B._40o()&&(B._95O||(q(function(){B._94I()},vh),B.iv()),B._95O=new Date)},Q._94I=function(){var G=this;if(G._95O){var E=new Date;E.getTime()-G._95O.getTime()>=vh?(delete G._95O,G.iv()):q(function(){G._94I()},vh)}},Q._92I=function(){var i=this,y=i._28I;if(i._95O||!i._autoHideScrollBar){y||Xd(i._79O,y=i._28I=$b());var n=i._29I,f=n.width,O=i._91I,a=i.getScrollBarSize(),U=n.height-a-2,Y=f*(-i.tx()/O),s=f*(f/O),u=y.style;O>f?(Ae>s&&(Y=Y+s/2-Ae/2,0>Y&&(Y=0),Y+Ae>f&&(Y=f-Ae),s=Ae),u.visibility=Gj,u.background=i.getScrollBarColor(),u.borderRadius=a/2+pp,Kj(y,Y,U,s,a)):u.visibility=mq}else y&&(y.style.visibility=mq)}}}),Zc(Ii,wf(16,16,[{type:Dj,rect:[1,1,14,14],background:Rd},{type:Ke,rect:[1,1,14,14],width:1,color:Sc},{type:jf,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Zc(Fi,wf(16,16,{type:Ke,rect:[1,1,14,14],width:1,color:Sc})),Zc(aq,wf(16,16,[{type:Bp,rect:[2,2,12,12],borderWidth:1,borderColor:Sc,background:"#FFF"},{type:Bp,rect:[4,4,8,8],background:Rd}])),Zc(Yn,wf(16,16,{type:Bp,rect:[2,2,12,12],borderWidth:1,borderColor:Sc})),Lq._15Q=function(h){h._29I=vi,h._59I=0,h._91I=0,h._5o=function(m){var j=this;j._30I=new Ce,j._rows=new Ce,j._rowMap={},j._31I=0,j._14I=0,j._view=js(1,j),j._canvas=Ub(j._view),Xd(j._view,j._79O=$b()),j.dm(m?m:new hd)},h.getCheckIcon=function(g){var B=this.sm(),v=B.co(g);return B.sg()?nb(v?aq:Yn):nb(v?Ii:Fi)},h.checkData=function(G){var D=this.sm(),K=D.co(G);D.sg()&&K||(this._32o=1,K?D.rs(G):D.as(G),delete this._32o)},h.getDataAt=function(G){G.target&&(G=this.lp(G));var i=c(G.y/this._rowHeight),Y=this._rows;return 0>i||i>=Y.size()?s:Y.get(i)},h.onDataDoubleClicked=function(){},h.onDataClicked=function(){},h.adjustTranslateX=function(){return 0},h.adjustTranslateY=function(A){var v=this.getHeight()-this._59I;return v>A&&(A=v),A>0?0:d(A)},h.onPropertyChanged=function($){var w=this,P=$.property;Cr[P]?w.ivm():Lc[P]||w.redraw(),P===dj?w._42o():P===_n&&w._43o()},h.getLabel=function(D){return D.toLabel()},h.getLabelFont=function(){return this._labelFont},h.getLabelColor=function(b){var p=this;if(p.isCheckMode()){if(p._focusData===b)return p._labelSelectColor}else if(p.isSelected(b))return p._labelSelectColor;return p._labelColor},h.getStartRowIndex=function(){return this._31I},h.getEndRowIndex=function(){return this._14I},h.getRowDatas=function(){return this._rows},h.getRowIndex=function(Z){return this._rowMap[Z._id]},h.getRowSize=function(){return this._rows.size()},h.getViewRect=function(){return kl(this._29I)},h.isVisible=function(n){return this._visibleFunc?this._visibleFunc(n):!0},h.getCurrentSortFunc=function(){return this._sortFunc},h.setDataModel=function(K){var m=this,P=m._dataModel,r=m._selectionModel;P!==K&&(P&&(P.umm(m.handleDataModelChange,m),P.umd(m.handleDataPropertyChange,m),P.umh(m.handleHierarchyChange,m),r||P.sm().ums(m.handleSelectionChange,m)),m._dataModel=K,K.mm(m.handleDataModelChange,m),K.md(m.handleDataPropertyChange,m),K.mh(m.handleHierarchyChange,m),r?r._21I(K):K.sm().ms(m.handleSelectionChange,m),m.fp("dataModel",P,K))},h.validateModel=function(){var i=this;i._rows.clear(),i._rowMap={},i.buildChildren(i._dataModel._roots);var U=i._rows=i._rows.toList(i.isVisible,i),A=0,y=i.getCurrentSortFunc(),O=U.size();for(y&&U.sort(y);O>A;A++)i._rowMap[U.get(A)._id]=A},h.buildChildren=function(K){var U=this;K.each(function(L){U._rows.add(L),U.buildChildren(L._children)})},h.handleDataModelChange=function(){this.ivm()},h.handleDataPropertyChange=function(h){"parent"===h.property?this.ivm():this.invalidateData(h.data)},h.handleHierarchyChange=function(){this.ivm()},h.handleSelectionChange=function(l){l.datas.each(this.invalidateData,this),this.onSelectionChanged(l)},h.onSelectionChanged=function(z){var W=this,g=W.sm();!W.isAutoMakeVisible()||1!==g.size()||"set"!==z.kind&&"append"!==z.kind||W._32o||W.makeVisible(g.ld())},h.handleBackgroundClick=function(J){Zb(J)&&!this.isCheckMode()&&this.sm().cs()},h.makeVisible=function(r){r&&(this._23I=r,this.iv())},h.scrollToIndex=function(N){var t=this,G=t._29I,c=G.height,d=t._rowHeight,l=d*N;N>=0&&N<t._rows.size()&&c>0&&(l+d>G.y+c?t.ty(-l+c-d):l<G.y&&t.ty(-l))},h.autoScroll=function(Z,F){var b=this,m=b._rowHeight,w=m,g=m/4,o=b._29I,f=b.lp(Z),S={x:b.tx(),y:b.ty()};return m>0&&o&&(f.x-o.x<w?b.translate(g,0):o.x+o.width-f.x<w&&b.translate(-g,0),f.y-o.y<w?b.translate(0,g):o.y+o.height-f.y<w&&b.translate(0,-g)),S.x=b.tx()-S.x,S.y=b.ty()-S.y,F&&(F.x+=S.x,F.y+=S.y),S},h.getTopRowOrderSelection=function(){var M=this.sm().getTopSelection(),z={},f=new Ce;return M.each(function(Y){z[Y._id]=Y}),this._rows.each(function(W){z[W._id]&&f.add(W)}),f},h.getRowOrderSelection=function(){var f=new Ce;return this._rows.each(function(c){this.isSelected(c)&&f.add(c)},this),f},h.ivm=function(){this.invalidateModel()},h.invalidateModel=function(){var n=this;n._96I||(n._96I=1,n._32I=1,delete n._24I),n.iv()},h.redraw=function(){var a=this;a._32I||(a._32I=1,delete a._24I,a.iv())},h.invalidateData=function(D){var o=this;a?o.redraw():o._32I||(o._24I||(o._24I={}),o._24I[D._id]=D,o.iv())},h.getFocusData=function(){return this._focusData},h.setFocusDataById=function(U){this.setFocusData(this.dm().getDataById(U))},h.setFocusData=function(s){var k=this,f=k._focusData;f!==s&&(k._focusData=s,k.fp("focusData",f,s),f&&k.invalidateData(f),s&&(k.invalidateData(s),k.isAutoMakeVisible()&&k.makeVisible(s)))},h.drawRowBackground=function(U,H,r,Q,u,G,j){var m=this,p=m.isCheckMode();(H===m._focusData&&p||r&&!p)&&Yl(U,Q,u,G,j,m.getSelectBackground(H))},h.drawData=function(x,Y,i){var G=this,A=G._rowHeight,B=A*i,F=G._29I,h=F.x,Z=F.width;x.save(),x.beginPath(),x.rect(h,B,Z,A),x.clip(),G._87o(G.drawRow(x,Y,G.isSelected(Y),h,B,Z,A),i,h,B,Z,A),x.restore(),G._rowLineVisible&&Yl(x,h,B+A-1,Z,1,G._rowLineColor)},h._12I=function(r){var b=this,D=b._31I,Z=b._29I,l=Z.x,k=Z.y,P=Z.width,C=Z.height;for(r.beginPath(),r.rect(l,k,P,C),r.clip(),r.clearRect(l,k,P,C),b._76o(),b._93db(r);D<b._14I;D++)b.drawData(r,b._rows.get(D),D);b._92db(r)},h._13I=function(O){for(var W,i=this,f=i._rowHeight,x=i._29I,P=x.x,z=x.width,d=i._31I,o=i._30I;d<i._14I;d++)W=i._rows.get(d),i._24I[W._id]&&o.add({data:W,index:d});o.isEmpty()||(O.beginPath(),o.each(function(t){O.rect(P,t.index*f,z,f)}),O.clip(),o.each(function(I){O.clearRect(P,I.index*f,z,f)}),o.each(function(q){i._77o(q.index)}),i._93db(O),o.each(function(d){i.drawData(O,d.data,d.index)}),i._92db(O),o.clear())},h.preValidateModel=function(){this.endEditing&&this.endEditing()},h.validateImpl=function(){var p=this,S=p._canvas,x=p.getWidth(),e=p.getHeight(),L=p._rowHeight,H=p._32I;(x!==S.clientWidth||e!==S.clientHeight)&&(sf(S,x,e),H=1);var A=u&&!Y;p._96I&&!A&&(p.preValidateModel(),p.validateModel());var Q=p._29I,K={x:-p.tx(),y:-p.ty(),width:x,height:e},J=p._rows.size(),I=An(S),j=p._23I;H||Kq(K,Q)||(H=1),p._29I=K,p._59I=J*L+p.getScrollBarSize(),p._31I=c(K.y/L),p._14I=v((K.y+K.height)/L),p._31I<0&&(p._31I=0),p._14I>J&&(p._14I=J),p._99I&&H&&p._99I(),ze(I,p.tx(),p.ty(),1),H?p._12I(I):p._24I&&p._13I(I),p._93I(),p._92I(),I.restore(),p._32I=p._24I=p._96I=s,j&&(p.scrollToIndex(p.getRowIndex(j)),delete p._23I),p.tx(p.tx()),p.ty(p.ty())}},Lq._48o=function(t){t._rootVisible=!0,t._rootData=s,t._35o=function(){this._expandMap={},this._levelMap={}},t.validateModel=function(){var J=this,K=J._rootData;J._rows.clear(),J._levelMap={},J._rowMap={},J._currentLevel=0,K?J._rootVisible?J.isVisible(K)&&J.buildData(K):J.buildChildren(K):J.buildChildren(),delete J._currentLevel},t.buildData=function(n){var S=this,b=n._id,I=S._rows;S._rowMap[b]=I.size(),I.add(n),S._levelMap[b]=S._currentLevel,S.isExpanded(n)&&(S._currentLevel++,S.buildChildren(n),S._currentLevel--)},t.buildChildren=function(e){var q=this,A=e?e._children:q._dataModel._roots,u=q.getCurrentSortFunc();u&&q.isChildrenSortable(e)?A.toList(q.isVisible,q).sort(u).each(q.buildData,q):A.each(function(Y){q.isVisible(Y)&&q.buildData(Y)})},t.getLevel=function(C){return this._levelMap[C._id]},t.getToggleIcon=function(Q){var N=this,H=N._loader,m=N._collapseIcon;return H&&!H.isLoaded(Q)?m:Q.hasChildren()?N.isExpanded(Q)?N._expandIcon:m:s},t.isCheckMode=function(){return this._checkMode!=s},t.isChildrenSortable=function(){return!0},t.handleDataModelChange=function(z){var e=this;z.kind===fj?delete e._expandMap[z.data._id]:z.kind===Xb&&(e._expandMap={}),e.ivm()},t.toggle=function(U){var g=this;g.isExpanded(U)?g.collapse(U):g.expand(U)},t.isExpanded=function(m){return 1===this._expandMap[m._id]},t.expand=function(K){var y=this,I=y._loader;y.isExpanded(K)||(I&&!I.isLoaded(K)&&I.load(K),y._expandMap[K._id]=1,y.ivm(),y.onExpanded(K))},t.onExpanded=function(){},t.collapse=function(h){var d=this;d.isExpanded(h)&&(delete d._expandMap[h._id],d.ivm(),d.onCollapsed(h))},t.onCollapsed=function(){},t.expandAll=function(R){if(R)this.expand(R),R.eachChild(function(U){this.expandAll(U)},this);else{var x=this;x._dataModel.each(function(z){z.hasChildren()&&(x._expandMap[z._id]=1)}),x.ivm()}},t.collapseAll=function(){this._expandMap={},this.ivm()},t.makeVisible=function(a){if(a){var Z=this;if(!Z._rootData||a.isDescendantOf(Z._rootData)){for(var l=a._parent;l;)Z.expand(l),l=l._parent;Z._23I=a,Z.iv()}}},t.checkData=function(j){var U,A=this,X=A._checkMode,D=A.sm(),N=D.co(j);if(!D.sg()||!N){if(A._32o=1,X===uj)N?D.rs(j):D.as(j);else if(X===Mi)U=new Ce(j),U.addAll(j._children);else if("descendant"===X)U=new Ce,Zr(j,U);else if("all"===X&&(U=new Ce,Zr(j,U),!N))for(var z=j._parent;z;)U.add(z),z=z._parent;U&&(N?D.rs(U):D.as(U)),delete A._32o}},t._97I=function(j,Y,p,X,o,P,H){var n=this,E=n._indent,x=n._levelMap[Y._id],S=n.getIconWidth(Y),J=nb(n.getToggleIcon(Y));J?(X+=E*x,on(j,J,X+E/2,o+H/2,Y,n),X+=E):X+=E*(x+1),n._checkMode&&(on(j,n.getCheckIcon(Y),X+E/2,o+H/2,Y,n),X+=E),n.drawIcon(j,Y,X,o,S,H),n.drawLabel(j,Y,X+S,o,H)
    }},Lq._14Q=function(b){b.getIcon=function(Z){return Z.getIcon()},b.getIconWidth=function(x){return this.getIcon(x)?this._indent:0},b.drawIcon=function(H,r,K,Z,o,i){if(o){var O=this,W=O.getBodyColor(r),I=nb(O.getIcon(r),W);I&&(i-=O.isRowLineVisible()?1:0,Bk(H,I,yk,K,Z,o,i,r,O,W),Gq(H,O.getBorderColor(r),K,Z,o,i))}},b.drawLabel=function(c,S,y,d,M){var A=this;li(c,A.getLabel(S),A.getLabelFont(S),A.getLabelColor(S),y,d,0,M)}},Lq._50o=function(y){y._98I=function(){var H=this,L=H._39o=new hd;H._60I=new Ce,L.mm(H._17o,H),L.md(H._18o,H),L.mh(H._19o,H)},y.setColumns=function(v){this._39o.clear(),this.addColumns(v)},y.addColumns=function(p){var f=this._39o;p.forEach(function(d){if(!(d instanceof am)){var z=um(d.className);d=sh(z?z:am,d)}f.add(d)})},y.onColumnClicked=function(){},y.onCheckColumnClicked=function(){},y._3Q=function(p){for(var W,o=0,d=this._60I,M=d.size();M>o;o++)if(W=d.get(o),W.column===p)return W;return s},y.getColumnAt=function(U){var a=this._4Q(U);return a?a.column:s},y._4Q=function($){for(var k=this,D=$.target?k.lp($).x:$.x,L=k._60I,C=0;C<L.size();C++){var e=L.get(C),i=e.startX;if(D>=i&&D<i+e.column.getWidth())return e}return s},y.getToolTip=function(Z){var W=this,h=W.getDataAt(Z),u=W.getColumnAt(Z);return h&&u?u.getToolTip(h,W):s},y.adjustTranslateX=function(g){var x=this.getWidth()-this._91I;return x>g&&(g=x),g>0?0:d(g)},y._99I=function(){var I=this,M=I._29I,m=I._60I;m.clear(),I._91I=0,I._39o._roots.each(function(g){if(g.isVisible()){var S=I._91I+g.getWidth();I._91I<=M.x+M.width&&S>=M.x&&m.add({column:g,startX:I._91I}),I._91I=S}}),I._91I+=I.getScrollBarSize()},y.drawData=function(G,Y,U){var x=this,n=x._rowHeight,y=n*U,N=x.isSelected(Y),Z=x._29I,I=Z.x,J=Z.width;x.drawRowBackground(G,Y,N,I,y,J,n),x._60I.each(function(R){var L=R.column,t=R.startX,i=L.getWidth();i>0&&!x.isEditing(Y,L)&&(G.save(),G.beginPath(),G.rect(t,y,i,n),G.clip(),x._87o(x.drawCell(G,Y,N,L,t,y,i,n),U,t,y,i,n),x._columnLineVisible&&Yl(G,t+i-1,y,1,n,x._columnLineColor),G.restore())}),x._rowLineVisible&&Yl(G,I,y+n-1,J,1,x._rowLineColor)},y.drawCell=function(d,R,N,n,Z,V,F,K){var r=this;if(n.drawCell)return n.drawCell(d,R,N,n,Z,V,F,K,r);var S=r.getValue(R,n);Qm(d,S,n,r.getLabelFont(R,n,S),r.getLabelColor(R,n,S),Z,V,F,K,R,r)},y.getColumnModel=function(){return this._39o},y._17o=function(){this.redraw()},y._18o=function(C){var r=this;C.data===r._sortColumn&&Vm[C.property]?r.ivm():(r._42o(),r.redraw())},y._19o=function(){this.redraw()},y.getCurrentSortFunc=function(){var R=this,Q=R._sortColumn;if(Q&&Q.isSortable()){var V=Q.getSortFunc(),x=lj===Q.getSortOrder()?1:-1;return V||(V=Hg),function(B,W){return V.call(R,R.getValue(B,Q),R.getValue(W,Q),B,W)*x}}return R._sortFunc},y.isCellEditable=function(c,$,m){return $.isEditable()&&this.isEditable()?$.isCellEditable?$.isCellEditable(c,$,m,this):!0:!1},y._37O=function(a,F){if(Zb(F))for(var V=this,O=V.lp(F),j=V._60I,i=V._rowHeight,y=V._29I,m=y.x,r=y.y,e=y.width,R=y.height,x=0;x<j.size();x++){var h=j.get(x),A=h.startX,J=h.column,I=J.getWidth();if(J!==V._31o&&J!==V._4o&&O.x>=A&&O.x<A+I&&V.isCellEditable(a,J,F)){var W={x:A,y:V.getRowIndex(a)*i,width:I,height:i},p={x:W.x+V.tx(),y:W.y+V.ty(),width:W.width,height:W.height},g=0,f=0;return W.x<m?g=W.x-m:W.x+W.width>m+e&&(g=W.x+W.width-m-e),g&&(V.tx(V.tx()-g),p.x-=g),W.y<r?f=W.y-r:W.y+i>r+R&&(f=W.y+i-r-R),f&&(V.ty(V.ty()-f),p.y-=f),V.beginEditing({data:a,column:J,value:V.getValue(a,J),event:F,rect:W,editorRect:p,view:V}),void 0}}}},yc.BaseItemEditor=function(M,k,K,g){this._data=M,this._column=k,this._master=K,this._editInfo=g},qd("BaseItemEditor",H,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var be=I.Tab=function(){jj(be,this)};Lf("Tab",re,{ms_ac:["view","closable","disabled"],_icon:s,_closable:!1,_disabled:!1,setParent:ak});var am=I.Column=function(){jj(am,this)};Lf("Column",re,{_46o:1,ms_ac:["accessType","valueType",Gj,eb,Lp,Lg,"align",fk,"sortOrder",ij,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:lj,_sortFunc:s,_sortable:!0,_clickable:!0,setWidth:function(B){16>B&&(B=16);var u=this._width;this._width=B,this.fp(Lg,u,B)},getToolTip:function(V,P){return this.formatValue(P.getValue(V,this))}});var Je=I.Property=function(){jj(Je,this)};Lf("Property",re,{_46o:1,ms_ac:["accessType","valueType",eb,Lp,"categoryName",fk,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:s,getToolTip:function(z,B,F){var Q=this;return B?Q.formatValue(F.getValue(z,Q)):F.getPropertyName(Q)}}),yc.AccordionView=function(){var O=this;O._20o={},O._21o=new Ce,O._10o=s,O._9o=s,O._11o=s,O._view=js(0,O),O.iv()},qd("AccordionView",H,{ms_v:1,ms_fire:1,ms_ac:[Vh,nh,"titleHeight",Nb,wo,"titleBackground","selectWidth",xm,"orientation","separatorColor"],_expandIcon:l.accordionViewExpandIcon,_collapseIcon:l.accordionViewCollapseIcon,_titleHeight:lf,_labelColor:l.accordionViewLabelColor,_labelFont:l.accordionViewLabelFont,_titleBackground:l.accordionViewTitleBackground,_selectBackground:l.accordionViewSelectBackground,_selectWidth:l.accordionViewSelectWidth,_orientation:"v",_separatorColor:l.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(w,t,q,m){var x=this,W=$b();if(x._20o[w])throw w+" already exists";W.onmousedown=bn,W.style.cursor=Ne,W.addEventListener(Ch?jm:jk,function(p){bn(p)},i),W.addEventListener(Ch?zf:sl,function(j){bn(j),Zb(j)&&(x._10o===w?x.collapse():x.expand(w))},i),Xd(x._view,W),x._20o[w]={content:t,div:W,canvas:Ub(W),icon:m},x._21o.add(w),q&&x.expand(w),x.iv()},remove:function(J){var s=this,k=s._20o[J];k&&(kq(k.div),delete s._20o[J],s._21o.remove(J),s.iv())},clear:function(){var Y=this;Y._21o.toArray().forEach(Y.remove,Y),Y._20o={},Y._21o.clear(),Y.iv()},isExpanded:function(d){return this._10o===d},expand:function(V){var E=this;E._20o[V]&&E._10o!==V&&(E._10o=V,E.onExpanded(V),E.iv())},onExpanded:function(){},collapse:function(){var Q=this;Q._10o&&(Q.onCollapsed(Q._10o),delete Q._10o,Q.iv())},onCollapsed:function(){},initCanvas:function($,T,L){sf($,T,L);var I=An($);return ze(I,0,0,1),I.clearRect(0,0,T,L),I},drawTitle:function(X,$,N,u,l){var Z=this,x=nb(l.icon),B=Z.isExpanded($),d=Z._titleHeight,A=Z._titleBackground,p=Z._selectWidth,e=Z._separatorColor,S=nb(B?Z._expandIcon:Z._collapseIcon),c=p+4;Yl(X,0,0,N,u,A),B&&p&&Yl(X,0,0,p,u,Z._selectBackground),(B||Z._21o.get(Z._21o.size()-1)!==$)&&Yl(X,0,u-1,N,1,e?e:vn(A)),x&&(on(X,x,c+El(x)/2,d/2),c+=El(x)+2),li(X,$,Z.getLabelFont($),Z.getLabelColor($),c,0,0,d),S&&on(X,S,N-El(S)/2-4,d/2)},validateImpl:function(){var N=this,F=N._view,M=0,J=0,j=N.getWidth(),C=N.getHeight(),n=N._titleHeight,H=N._21o.size()*n,i=N._11o,d=N._9o;delete N._11o,delete N._9o,N._21o.each(function(U){var m,h,g=N._20o[U],q=g.content,E=N._10o===U;Or(N)?(Kj(g.div,M,0,n,C),m=N.initCanvas(g.canvas,n,C),Zd(m,0,C),jc(m,-S),N.drawTitle(m,U,C,n,g),m.restore(),E?(h=t(0,j-H),q&&(N._11o=q,N._9o=Yf(q),Kj(q,M+n,0,h,C)),M+=n+h):M+=n):(Kj(g.div,0,J,j,n),m=N.initCanvas(g.canvas,j,n),N.drawTitle(m,U,j,n,g),m.restore(),E?(h=t(0,C-H),q&&(N._11o=q,N._9o=Yf(q),Kj(q,0,J+n,j,h)),J+=n+h):J+=n)});var U=N._9o;i&&i!==N._11o&&i.endEditing&&i.endEditing(),U&&U!==d&&Xd(F,U),d&&d!==U&&kq(d)}}),yc.SplitView=function(c,h,K,X){var T=this,B=T._dividerDiv=$b(),e=T._60O=Ub(),Z=T._61O=Ub(),t=e.style,v=Z.style;T._view=js(1,T),Xd(T._view,B),t.msTouchAction=wr,t.pointerEvents=wr,t.cursor=Ne,v.msTouchAction=wr,v.pointerEvents=wr,v.cursor=Ne,c&&T.setLeftView(c),h&&T.setRightView(h),K&&T.setOrientation(K),X!=s&&T.setPosition(X),T.setStatus(Ag),new To(T)},qd("SplitView",H,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:l.splitViewDividerSize,_dividerBackground:l.splitViewDividerBackground,_dragOpacity:l.splitViewDragOpacity,_toggleIcon:l.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(x,K){var G=this,U=G._position;isNaN(x)||(K||(G._82O=0>x?-1:x>1?1:0),G._position=x,G.fp(Yb,U,x))},getLeftView:function(){return this._leftView},setLeftView:function(y){var i=this,b=i._leftView,A=i._view;if(i._leftView!==y){if(b&&b!==i._rightView){var F=Yf(b);F.parentNode===A&&kq(F)}if(i._leftView=y,y){var V=Yf(y);V.parentNode!==A&&A.insertBefore(V,i._dividerDiv)}i.fp("leftView",b,y)}},getRightView:function(){return this._rightView},setRightView:function(w){var h=this,s=h._rightView,q=h._view;if(h._rightView!==w){if(s&&s!==h._leftView){var g=Yf(s);g.parentNode===q&&kq(g)}if(h._rightView=w,w){var l=Yf(w);l.parentNode!==q&&q.insertBefore(l,h._dividerDiv)}h.fp("rightView",s,w)}},validateImpl:function(){var w=this,y=w._draggable,O=w._position,n=w.getWidth(),L=w.getHeight(),o=w._dividerSize,v=w._dividerBackground,Y=Ch?18:8,Q=w._dividerDiv,B=w._82O,k=w._60O,s=w._61O,E=w._toggleIcon,R=w._status,p=Q.style,r=null,C=Ch?20:4,g=E.comps[0];o>=Y||0===o?w._coverDiv&&(kq(w._coverDiv),delete w._coverDiv):w._coverDiv||(w._coverDiv=$b(),N&&(w._coverDiv.style.background=yd),Xd(Q,w._coverDiv)),w._togglable?k.parentNode||(Xd(Q,k),Xd(Q,s)):(kq(k),kq(s));var j=w._coverDiv,c=w._leftView,e=w._rightView;if(Or(w)){if(o>n&&(o=n),R===Ag)if(1===B)var z=$(O,n),I=t(0,n-o-z);else-1===B?(I=$(-O,n),z=t(0,n-o-I)):(z=d((n-o)*O),I=t(0,n-o-z));else"cl"===R?(z=0,I=t(0,n-o)):"cr"===R&&(I=0,z=t(0,n-o));c&&Kj(c,0,0,z,L),e&&Kj(e,z+o,0,I,L),Kj(Q,z,0,o,L),w._22o=z,j&&(Kj(j,o/2-Y/2,0,Y,L),j.style.cursor=y?co:""),Q.style.cursor=y?co:"";var _=Q.clientHeight/2,A=Q.clientWidth;sf(k,A,A),Kj(k,0,_-A-C,A,A),r=An(k),ze(r,0,0,1),g.rotation=-S,rm(r,E,0,0,A,A),r.restore(),sf(s,A,A),Kj(s,0,_+C,A,A),r=An(s),ze(r,0,0,1),g.rotation=S,rm(r,E,0,0,A,A),r.restore()}else{if(o>L&&(o=L),R===Ag)if(1===B)var Z=$(O,L),P=t(0,L-o-Z);else-1===B?(P=$(-O,L),Z=t(0,L-o-P)):(Z=d((L-o)*O),P=t(0,L-o-Z));else"cl"===R?(Z=0,P=t(0,L-o)):"cr"===R&&(P=0,Z=t(0,L-o));c&&Kj(c,0,0,n,Z),e&&Kj(e,0,Z+o,n,P),Kj(Q,0,Z,n,o),w._22o=Z,j&&(Kj(j,0,o/2-Y/2,n,Y),j.style.cursor=y?Wi:""),p.cursor=y?Wi:"";var K=Q.clientWidth/2,A=Q.clientHeight;sf(k,A,A),Kj(k,K-A-C,0,A,A),r=An(k),ze(r,0,0,1),g.rotation=0,rm(r,E,0,0,A,A),r.restore(),sf(s,A,A),Kj(s,K+C,0,A,A),r=An(s),ze(r,0,0,1),g.rotation=M,rm(r,E,0,0,A,A),r.restore()}p.background=v}});var To=function(b){this.sv=b,this.addListeners()};Op(To,H,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(E){var R=this,b=R.sv,I=b._dividerDiv,C=b._60O,p=b._61O,L=b._status,Z=E.target;if(Z===C)L===Ag?b.setStatus("cl"):"cr"===L&&b.setStatus(Ag);else if(Z===p)L===Ag?b.setStatus("cr"):"cl"===L&&b.setStatus(Ag);else if(xq(E)&&(Z===I||Z===b._coverDiv)&&(bn(E),b.isDraggable())){b.getLeftView(),b.getRightView();var i=R.maskDiv=$b();if(i.style.left=0,i.style.top=0,i.style.width=b.getWidth()+"px",i.style.height=b.getHeight()+"px",b.getView().appendChild(i),!b.isContinuousLayout()){var $=R.resizeDiv=$b();$.style.left=I.style.left,$.style.top=I.style.top,$.style.width=I.style.width,$.style.height=I.style.height,$.style.opacity=b.getDragOpacity(),$.style.background=b.getDividerBackground(),Xd(R.getView(),$)}R._lastAbsPosition=b._22o,R._86o=Or(b)?Il(E).x:Il(E).y,De(R,E)}},handleWindowTouchMove:function(q){xq(q)&&this.update(q,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(p){var o=this;o.update(p,!0),o.sv.setStatus(Ag),o.maskDiv&&kq(o.maskDiv),o.resizeDiv&&kq(o.resizeDiv),o.maskDiv=o.resizeDiv=s},handle_mousedown:function(D){Zb(D)&&this.handle_touchstart(D)},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},update:function(z,x){var y=this,S=y.sv,B=Or(S)?S.getWidth():S.getHeight(),$=S._dividerSize,L=y._lastAbsPosition-y._86o;Or(S)?(L+=Il(z).x,L>B-$&&(L=B-$),0>L&&(L=0),y.resizeDiv&&(y.resizeDiv.style.left=L+pp)):(L+=Il(z).y,L>B-$&&(L=B-$),0>L&&(L=0),y.resizeDiv&&(y.resizeDiv.style.top=L+pp)),x&&B!==$&&(1===S._82O?S.setPosition(L,1):-1===S._82O?S.setPosition(L-B+$,1):S.setPosition(L/(B-$),1))}}),yc.TabView=function(){var S=this,L=S._view=js(1,S),F=S._91O=$b(1),J=S._tabModel=new hd,Y=J.sm(),k=S.invalidate;S._7o=new Ce,S._canvas=Ub(F),Xd(L,F),Xd(L,S._92O=$b(1)),Y.setSelectionMode(Tc),Y.ms(S.handleSelectionChange,S),J.mm(k,S),J.md(k,S),J.mh(k,S),S._interactor=new Zm(S),S.iv()},qd("TabView",H,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Nb,wo,"tabBackground","selectWidth",xm,"moveBackground","insertColor"],_tabPosition:ns,_tabHeight:lf,_tabGap:l.tabViewTabGap,_labelColor:l.tabViewLabelColor,_labelFont:l.tabViewLabelFont,_tabBackground:l.tabViewTabBackground,_selectWidth:l.tabViewSelectWidth,_selectBackground:l.tabViewSelectBackground,_moveBackground:l.tabViewMoveBackground,_insertColor:l.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(b,G,q){var F,w=this._tabModel;return b instanceof be?(F=b,G&&F.setView(G)):(F=new be,F.setName(b),F.setView(G)),w.add(F),q&&w.sm().ss(F),F},getLabel:function(N){return N.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(r){this._23o=r,this.iv()},get:function($){var n=this,H=n._tabModel;if(il($))return H._roots.get($);if(Kl($)){var p;return H.each(function(I){$===n.getLabel(I)&&(p=I)}),p}return $ instanceof be?$:s},select:function(d){this._tabModel.sm().ss(this.get(d))},remove:function(c){var Y=this;if(c=Y.get(c)){var v=Y._tabModel,f=v._roots.indexOf(c);Y._tabModel.remove(c),Y.selectByIndex(--f)}},getCurrentTab:function(){return this._8o},hideTabView:function(b,k){k.parentNode===this._92O&&(gp(k)?(k.style.display=zh,k._tab_=b):kq(k),Si())},showTabView:function(X,Y){gp(Y)&&(Y.style.display="block",Y._tab_=X),Y.parentNode!==this._92O&&(Xd(this._92O,Y),Si())},_24o:function(){var L,w=this,q=w._8o,k=w._9o,c=w._tabModel.sm().ld();c&&(L=Yf(c.getView())),L!==k&&(k&&(q.getView()&&q.getView().endEditing&&q.getView().endEditing(),w.hideTabView(q,k)),L&&w.showTabView(c,L)),w._8o=c,w._9o=L,q!==c&&w.onTabChanged(q,c)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(t,Z){this.selectByIndex(--Z)},selectByIndex:function(p){var r=this,f=r._tabModel,U=f.size();if(U&&!f.sm().ld()){p==s&&(p=0),p>=U&&(p=U-1),0>p&&(p=0);for(var w=p;w>=0;w--){var l=r.get(w);if(!l.isDisabled())return r.select(l),l}for(w=p+1;U>w;w++)if(l=r.get(w),!l.isDisabled())return r.select(l),l}},getTabWidth:function(x){var Y=4,L=nb(x.getIcon());L&&(Y+=El(L,x)+4);var a=this.getLabel(x);return a&&(Y+=sq(this.getLabelFont(x),a).width+4),x.isClosable()&&(Y+=10),Y},drawTab:function(C,K,N,j,P,V,m){var L,w=this,W=w._tabPosition,R=N+4,T=w._selectWidth,O=nb(K.getIcon()),f=K.isDisabled(),g=w.getLabelColor(K),d=w.getLabelFont(K),H=w.getLabel(K),p=w._selectBackground,A=W===Ih+"-vertical",s=W===Go+"-vertical";(A||s)&&(R=j+4),f&&(C.globalAlpha=ok),Yl(C,N,j,P,V,m),K===w._8o&&T&&(W===ns?Yl(C,N,j+V-T,P,T,p):W===Ih?Yl(C,N+P-T,j,T,V,p):W===Go?Yl(C,N,j,T,V,p):A?Yl(C,N+P-T,j,T,V,p):s?Yl(C,N,j,T,V,p):Yl(C,N,j,P,T,p));var l=P/2;if(A&&(Zd(C,l,j+V/2),jc(C,M),Zd(C,-l,-j-V/2)),O){var t=tj(O,K),G=El(O,K);if(A||s){var h=N+P/2,i=R+t/2;Zd(C,h,i),jc(C,S),Zd(C,-h,-i),on(C,O,N+P/2,R+t/2,K,w),Zd(C,h,i),jc(C,-S),Zd(C,-h,-i),R+=t+4}else on(C,O,R+G/2,j+V/2,K,w),R+=G+4}return A||s?(Zd(C,P/2,R+P/2),jc(C,S),Zd(C,-P/2,-R-P/2),li(C,H,d,g,N,R,V,P),Zd(C,P/2,R+P/2),jc(C,-S),Zd(C,-P/2,-R-P/2)):li(C,H,d,g,R,j,P,V),A&&(Zd(C,l,j+V/2),jc(C,-M),Zd(C,-l,-j-V/2)),K.isClosable()&&(L=s?{x:N+P-12,y:j+V-12,width:12,height:12}:{x:N+P-12,y:j+2,width:12,height:12},this.drawCloseIcon(K,C,g,L)),f&&(C.globalAlpha=1),L},drawCloseIcon:function(h,Z,C,d){var Q=d.x,H=d.y;Z.strokeStyle=C,Z.lineWidth=1,Z.beginPath(),Z.moveTo(Q+2,H+8),Z.lineTo(Q+8,H+2),Z.moveTo(Q+8,H+8),Z.lineTo(Q+2,H+2),Z.stroke()},getTabAt:function(z){var E=this._interactor._8Q(z);return E?E.tab:null},validateImpl:function(){var l=this;l._24o();var d,y=l._canvas,w=l._tabPosition,o=l._91O,N=l._92O,f=l._tabModel,u=l.getWidth(),U=l.getHeight(),h=l._tabHeight,$=l._7o,M=l._tabGap,B=w===ns,S=w===Ih,i=w===Go,Q=w===Ih+"-vertical",b=w===Go+"-vertical",R=l._23o,n=0;if((S||i)&&f._roots.each(function(k){n=t(l.getTabWidth(k),n)}),B?(Kj(o,0,0,u,h),d={x:0,y:h,width:u,height:t(0,U-h)}):S?(Kj(o,0,0,n,U),d={x:n,y:0,width:t(0,u-n),height:U}):i?(Kj(o,u-n,0,n,U),d={x:0,y:0,width:t(0,u-n),height:U}):Q?(Kj(o,0,0,h,U),d={x:h,y:0,width:t(0,u-h),height:U}):b?(Kj(o,u-h,0,h,U),d={x:0,y:0,width:t(0,u-h),height:U}):(Kj(o,0,U-h,u,h),d={x:0,y:0,width:u,height:t(0,U-h)}),Kj(N,d),Q||b){l._9o&&(d.x=0,Kj(l._8o.getView(),d)),sf(y,h,U);var A=An(y),O=0;if(ze(A,0,l.ty(),1),A.clearRect(0,0,h,U),$.clear(),f._roots.each(function(y){var Q,D=l.getTabWidth(y);R&&R.tab===y||(Q=l.drawTab(A,y,0,O,h,D,l._tabBackground)),$.add({_75o:Q,tab:y,startY:O,endY:O+D,height:D}),O+=D+M}),l._23Q=t(0,O-M),R){var g=R.position;l.drawTab(A,R.tab,0,R.startY,h,R.height,l._moveBackground),Yl(A,0,g,h,1,l._insertColor)}if(A.restore(),l._selectionChanged){l._selectionChanged=!1;for(var C=l.ty(),K=0;K<$.size();K++){var E=$.get(K);if(E.tab===l._8o){if(E.endY+C<0){l.ty(-E.startY);break}if(E.startY+C>U){l.ty(U-E.endY);break}}}}l.ty(l.ty())}else if(S||i){l._9o&&(d.x=0,Kj(l._8o.getView(),d)),sf(y,n,U);var A=An(y),O=0;if(ze(A,0,l.ty(),1),A.clearRect(0,0,n,U),$.clear(),f._roots.each(function(e){var x;R&&R.tab===e||(x=l.drawTab(A,e,0,O,n,h,l._tabBackground)),$.add({_75o:x,tab:e,startY:O,endY:O+h,height:h}),O+=h+M}),l._23Q=t(0,O-M),R){var g=R.position;l.drawTab(A,R.tab,0,R.startY,n,R.height,l._moveBackground),Yl(A,0,g,n,1,l._insertColor)}if(A.restore(),l._selectionChanged){l._selectionChanged=!1;for(var C=l.ty(),K=0;K<$.size();K++){var E=$.get(K);if(E.tab===l._8o){if(E.endY+C<0){l.ty(-E.startY);break}if(E.startY+C>U){l.ty(U-E.endY);break}}}}l.ty(l.ty())}else{l._9o&&(d.y=0,Kj(l._8o.getView(),d)),sf(y,u,h);var A=An(y),q=0;if(ze(A,l.tx(),0,1),A.clearRect(0,0,u,h),$.clear(),f._roots.each(function(x){var W,O=l.getTabWidth(x);R&&R.tab===x||(W=l.drawTab(A,x,q,0,O,h,l._tabBackground)),$.add({_75o:W,tab:x,startX:q,endX:q+O,width:O}),q+=O+M}),l._64I=t(0,q-M),R){var g=R.position;l.drawTab(A,R.tab,R.startX,0,R.width,h,l._moveBackground),oq(A,l._insertColor,g,0,h)}if(A.restore(),l._selectionChanged){l._selectionChanged=!1;for(var T=l.tx(),K=0;K<$.size();K++){var E=$.get(K);if(E.tab===l._8o){if(E.endX+T<0){l.tx(-E.startX);break}if(E.startX+T>u){l.tx(u-E.endX);break}}}}l.tx(l.tx())}for(var j=[],_=N.children,K=0;K<_.length;K++){var L=_[K],r=L._tab_;r&&!f.contains(r)&&j.push(L)}j.forEach(function(O){N.removeChild(O)})}});var Zm=function(W){this.tv=W,this.addListeners()};Op(Zm,H,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(P){this.handleScroll(P,10*(P.wheelDelta/40))},handle_DOMMouseScroll:function(S){this.handleScroll(S,10*-S.detail)},handleScroll:function(Z,O){bn(Z);var S=this.tv,N=S._tabPosition;!S._40o()||N!==ns&&N!==cj||S.tx(this.tv.tx()+O),!S._41o()||N!==Ih&&N!==Go&&N!==Ih+"-vertical"&&N!==Go+"-vertical"||S.ty(this.tv.ty()+O)},_8Q:function(H){var G,u,w=this.tv,l=w._tabPosition,M=w._7o;if(l===ns||l===cj){var _=w.lp(H).x;for(G=0;G<M.size();G++)if(u=M.get(G),u.startX<=_&&_<=u.endX)return u}else if(l===Ih||l===Go||l===Ih+"-vertical"||l===Go+"-vertical"){var e=w.lp(H).y;for(G=0;G<M.size();G++)if(u=M.get(G),u.startY<=e&&e<=u.endY)return u}return s},isClickable:function(N){var M=this.tv,x=M._tabPosition,A=this._73o=this._8Q(N);return!M._40o()||x!==ns&&x!==cj?!M._41o()||x!==Ih&&x!==Go&&x!==Ih+"-vertical"&&x!==Go+"-vertical"?A&&(!A.tab.isDisabled()||M.isMovable()):!0:!0},handle_mousemove:function(F){var W=this;Rn?W._74o=W._8Q(F):W.getView().style.cursor=W.isClickable(F)?Ne:""},handle_mousedown:function(D){this.handle_mousemove(D),this.handle_touchstart(D)},handle_touchstart:function(S){var h=this,w=h.tv,f=w._tabPosition;bn(S),Zb(S)&&h.isClickable(S)&&(f===ns||f===cj?(h.x=Il(S).x,h.lp=w.lp(S),h.tx=w.tx()):(h.y=Il(S).y,h.lp=w.lp(S),h.ty=w.ty()),De(h,S))},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowTouchMove:function(R){var o,f=this,r=f.tv,E=r._tabPosition,v=f._73o;if(E===ns||E===cj){if(o=Il(R).x-f.x,!f._25o&&!f.moving&&P(o)>2&&(r._40o()&&!Ei(R)?f._25o=1:v&&r.isMovable()&&(f.moving=1)),f._25o)r.tx(f.tx+o);else if(f.moving){var z=f.lp.x+o,g=r._tabGap/2;r._7o.each(function(l){var X=l.endX,U=z-l.startX<X-z;z>=l.startX&&X>=z&&r._7Q({tab:v.tab,startX:v.startX+o,width:v.width,front:U,insertTab:l.tab,position:U?t(0,l.startX-g):$(r._64I,X+g)})})}}else if(o=Il(R).y-f.y,!f._25o&&!f.moving&&P(o)>2&&(r._41o()&&!Ei(R)?f._25o=1:v&&r.isMovable()&&(f.moving=1)),f._25o)r.ty(f.ty+o);else if(f.moving){var d=f.lp.y+o,g=r._tabGap/2;r._7o.each(function(B){var u=B.endY,Y=d-B.startY<u-d;d>=B.startY&&u>=d&&r._7Q({tab:v.tab,startY:v.startY+o,height:v.height,front:Y,insertTab:B.tab,position:Y?t(0,B.startY-g):$(r._23Q,u+g)})})}},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(){var G=this,U=G.tv,R=U._tabPosition,l=U.getTabModel(),J=l._roots,u=G._73o;if(G.moving){var i=U._23o;if(i&&i.insertTab!==i.tab){var P=i.tab,Y=J.remove(P),Q=J.indexOf(i.insertTab);Q>=0&&(i.front||Q++,Q<=J.size()&&(J.add(P,Q),l._38I(P,Y,Q)))}U._7Q(s),delete G.moving}else if(!G._25o&&u){P=u.tab;var W=G._74o;if(!W||W.tab===P)if(!P.isDisabled()&&Li(u._75o,G.lp)){var c=function(){var k=J.indexOf(P);l.remove(P),U.onTabClosed(P,k)};U.onTabClosing(P,c)&&c()}else P.isDisabled()||U._8o===P||l.sm().ss(P)}G._25o=G._73o=G._74o=R===ns||R===cj?G.x=G.lp=G.tx=s:G.y=G.lp=G.ty=s}}),yc.PropertyView=function(v){var B=this;B._view=js(1,B),B._canvas=Ub(B._view),Xd(B._view,B._79O=$b()),B._rows=new Ce,B._28o=new Ce,B._26o={},B._26Q={};var A=B._propertyModel=new hd,s=B.ivm;A.mm(s,B),A.md(s,B),A.mh(s,B),B.dm(v?v:new hd),new Rj(B)},qd("PropertyView",H,{ms_ac:[Nb,oe,wo,eb,Lp,"categorizable",Vl,ij,Tn,Vh,nh,Sb,Um,kg,"selectRowIndex",xm,"background",Ar,oi,om,mh,qn],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:vi,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Pc,_background:l.propertyViewBackground,_expandIcon:l.propertyViewExpandIcon,_collapseIcon:l.propertyViewCollapseIcon,_scrollBarColor:ps,_scrollBarSize:ms,_autoHideScrollBar:em,_selectBackground:l.propertyViewSelectBackground,_rowHeight:xi,_rowLineVisible:l.propertyViewRowLineVisible,_rowLineColor:l.propertyViewRowLineColor,_10I:.5,_columnLineVisible:l.propertyViewColumnLineVisible,_columnLineColor:l.propertyViewColumnLineColor,_labelColor:l.propertyViewLabelColor,_labelSelectColor:l.propertyViewLabelSelectColor,_labelFont:l.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(d){0>d&&(d=0),d>1&&(d=1);var A=this,L=A._10I;A._10I=d,A.fp("columnPosition",L,d)},getPropertyName:function(D){return D.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(O,M,b){return b===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(P,X){return X===this._selectRowIndex?this._labelSelectColor:P.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(L){var n=this.getHeight()-this._59I;return n>L&&(L=n),L>0?0:d(L)},isExpanded:function(U){if(!U)return!0;var C=this._26o[U];return C?C.isExpanded:!(this._26Q[U]===!1)},toggle:function(g){var n=this;n.isExpanded(g)?n.collapse(g):n.expand(g)},expandAll:function(){this.validate();for(var C in this._26o)this.expand(C)},expand:function(K){if(K&&K!==zh){var k=this,W=k._26o[K];W&&!W.isExpanded&&(W.isExpanded=!0,k.onExpanded(K),k.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var V in this._26o)this.collapse(V)},collapse:function(Y){if(Y&&Y!==zh){var S=this,O=S._26o[Y];O&&O.isExpanded&&(O.isExpanded=!1,S.onCollapsed(Y),S.ivm())}},onCollapsed:function(){},getCategoryName:function(k){if(!this.isCategorizable())return zh;var W=k.getCategoryName();return W?W:zh},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(z){var B=this,W=B._dataModel;W!==z&&(W&&(W.umd(B.handlePropertyChange,B),B._selectionModel||W.sm().ums(B.handleSelectionChange,B)),B._dataModel=z,z.md(B.handlePropertyChange,B),B._selectionModel?B._selectionModel._21I(z):z.sm().ms(B.handleSelectionChange,B),B.fp(oo,W,z))},isVisible:function(j){return this._visibleFunc?this._visibleFunc(j):!0},onPropertyChanged:function(A){var o=this,Y=A.property;vk[Y]?o.ivm():o.iv(),Y===_n&&o._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:nl},handlePropertyChange:function(F){this._27o===F.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var c=this;c._96I||(c.setSelectRowIndex(-1),c._96I=1,c.iv())},redraw:function(){this.iv()},validateModel:function(){var J=this,i=J._rows,d=J._28o,Q={},U=new Ce,t=J._27o;J.updateCurrentData(),t!==J._27o&&J.endEditing(),i.clear(),d.clear(),J.getRawProperties().each(function(T){if(J.isVisible(T)){U.add(T);var X=J.getCategoryName(T);Q[X]||(d.add(X,X===zh?0:r),Q[X]={isExpanded:J.isExpanded(X),properties:new Ce})}}),J._sortFunc&&U.sort(J._sortFunc);for(var e in J._26o)J._26Q[e]=J.isExpanded(e);J._26o=Q,d.each(function(g){g!==zh&&i.add(g);var P=Q[g];P.isExpanded&&U.each(function(Z){J.getCategoryName(Z)===g&&(P.properties.add(Z),i.add({property:Z,data:J._27o}))},J)})},validateImpl:function(){var e=this;e._76o(),e._96I&&(e.validateModel(),delete e._96I);var i=e._canvas,W=e.getWidth(),R=e.getHeight(),p=-e.ty(),G=e._rowHeight,k=e._indent,y=W-k,F=e._rows,j=F.size(),b=e._9I=k+y*e._10I,Z=e._59I=j*G;sf(i,W,R),e._29I={x:0,y:p,width:W,height:R},e._31I=c(p/G),e._14I=v((p+R)/G),e._31I<0&&(e._31I=0),e._14I>j&&(e._14I=j);var T,K=An(i),J=e._background;ze(K,0,-p,1),K.beginPath(),K.rect(0,p,W,R),K.clip(),K.clearRect(0,p,W,R),e._93db(K),J&&Yl(K,0,0,k,Z,J);for(var q=e._31I;q<e._14I;q++){var D=F.get(q),p=G*q;if(Kl(D))J&&Yl(K,k,p,y,G,J),T=nb(e.isExpanded(D)?e._expandIcon:e._collapseIcon),T&&Bk(K,T,yk,0,p,k,G),K.save(),K.beginPath(),K.rect(k,p,y,G),K.clip(),e.drawCategoryName(K,D,q,k,p,y,G),K.restore();else{var a=D.property,C=D.data,T=nb(a.getIcon()),L=e._selectRowIndex===q?e.getSelectBackground():s;if(T&&Bk(K,T,yk,0,p,k,G),L&&Yl(K,k,p,y,G,L),K.save(),K.beginPath(),K.rect(k,p,b-k,G),K.clip(),e.drawPropertyName(K,a,q,k,p,b-k,G),K.restore(),!e.isEditing(C,a)){var E=b+1,U=W-b-1;K.save(),K.beginPath(),K.rect(E,p,U,G),K.clip(),e._87o(e.drawPropertyValue(K,a,e.getValue(C,a),q,E,p,U,G,C),q,E,p,U,G),K.restore()}}e._rowLineVisible&&Yl(K,k,p+G-1,y,1,e._rowLineColor)}e._columnLineVisible&&(Yl(K,b,0,1,Z,e._columnLineColor),Yl(K,W-1,0,1,Z)),e._92db(K),e._93I(),K.restore(),e.ty(e.ty())},drawCategoryName:function(v,R,Z,X,$,J,r){li(v,R,this.getCategoryFont(R),this.getCategoryColor(R),X,$,J,r)},drawPropertyName:function(o,m,Y,T,v,h,_){return m.drawPropertyName?(m.drawPropertyName(o,m,Y,T,v,h,_,this),void 0):(li(o,this.getPropertyName(m),this.getPropertyFont(m,Y),this.getPropertyColor(m,Y),T,v,h,_),void 0)},drawPropertyValue:function(c,v,T,U,o,J,i,q,Q){return v.drawPropertyValue?v.drawPropertyValue(c,v,T,U,o,J,i,q,Q,this):(Qm(c,T,v,this.getLabelFont(v,T,U),this.getLabelColor(v,T,U),o,J,i,q,Q,this),void 0)},isPropertyEditable:function(J){return J.isEditable()&&this.isEditable()},setProperties:function(e){this._propertyModel.clear(),this.addProperties(e)},addProperties:function(R){if(R){var Y=this._propertyModel;R.forEach(function(T){if(!(T instanceof Je)){var R=um(T.className);T=sh(R?R:Je,T)}Y.add(T)})}},getRowIndexAt:function(h){var o=this,g=c(o.lp(h).y/o._rowHeight);return g>=0&&g<o._rows.size()?g:-1},getPropertyAt:function(n){var Y=this,t=Y.getRowIndexAt(n);return t>=0?Y._rows.get(t).property:s},getToolTip:function(d){var J=this,U=J.getPropertyAt(d),o=J._27o;return U&&o?U.getToolTip(o,J._9I<J.lp(d).x,J):s}});var Rj=function(M){this.pv=M,this.addListeners()};Op(Rj,H,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(C){this.getView().style.cursor=C},clear:function(){var N=this;N._62O=N.cp=N.ty=N.p=s,N.setCursor(uj)},handle_mousedown:function(j){this.handle_touchstart(j)},handle_touchstart:function(Y){var e=this,y=e.pv;bn(Y),y.setFocus(Y)&&(Zb(Y)?(e.cp=Il(Y),e.ty=y.ty(),e.p=y.getColumnPosition(),e.handle_touchmove(Y)):y.setSelectRowIndex(y.getRowIndexAt(Y)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(G){var B=this;if(B.cp&&!B._62O){var I=B.pv,R=I.lp(G),Q=R.x,b=R.y,U=I._indent,y=I.getRowIndexAt(G),d=I._9I;if(y>=0){var M=I._rowHeight,e=M*y,C=I._rows.get(y),_=C.property;if(Kl(C))nb(I.isExpanded(C)?I._expandIcon:I._collapseIcon)&&Q>=0&&U>=Q&&b>=e&&e+M>=b?I.toggle(C):ui(G)&&I.toggle(C);else if(Q>d&&I.isPropertyEditable(_,G)){var X={x:d+1,y:e,width:I.getWidth()-d-1,height:M},D={x:X.x+I.tx(),y:X.y+I.ty(),width:X.width,height:X.height},J=0,N=I._29I;X.y<N.y?J=X.y-N.y:X.y+M>N.y+N.height&&(J=X.y+M-N.y-N.height),J&&(I.ty(I.ty()-J),D.y-=J),I.beginEditing({data:C.data,property:_,value:I.getValue(C.data,_),event:G,rect:X,editorRect:D,view:I})}}I.setSelectRowIndex(y)}B.clear()},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(J){var Z=this,X=Z.pv,f=Z.ty,O=Z.cp,H=Il(J),V=Z._62O;if("p"===V)X.setTranslateY(f+H.y-O.y);else if("c"===V){var j=X.getWidth()-X._indent;if(j>16){var L=Z.p-(O.x-H.x)/j,A=16/j;A>L&&(L=A),L>1-A&&(L=1-A),X.setColumnPosition(L)}}else"s"===V&&X.setTranslateY(f+(O.y-H.y)*X._59I/X._29I.height)},handle_mousemove:function(d){this.handle_touchmove(d)},handle_touchmove:function(M){if(!Rn&&Zb(M)){var p=this,l=p.pv,D=P(l.lp(M).x-l._9I)<=(Ch?8:3);p.cp?p._62O||(D?(p._62O="c",De(p)):P(Il(M).y-p.cp.y)>=2&&(p._62O=p.isV(M)?"s":"p",De(p))):(D?p.setCursor(co):p.setCursor(uj),p.isV(M)&&l._43o())}},isV:function(H){var a=this.pv,v=a._29I;return a._41o()&&v.x+v.width-a.lp(H).x<Fo},handle_mousewheel:function(L){this.handleScroll(L,L.wheelDelta/40)},handle_DOMMouseScroll:function(O){2===O.axis&&this.handleScroll(O,-O.detail)},handleScroll:function(Q,B){var Z=this.pv;bn(Q),Z.endEditing(),Z.translate(0,B*Z.getRowHeight())},handle_keydown:function(V){var L=this.pv,w=L._rows.size(),B=L._selectRowIndex+(ri(V)?-1:1);(ri(V)||tr(V))&&(0>B&&(B=0),B>=w&&(B=w-1),L.setSelectRowIndex(B))}}),yc.ListView=function(R){this._5o(R),new Cb(this)},qd("ListView",H,{ms_ac:[Nb,oe,wo,Ar,Vl,oi,om,ij,Tn,Sb,Um,kg,Sg,xm],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Pc,_rowHeight:xi,_rowLineVisible:l.listViewRowLineVisible,_rowLineColor:l.listViewRowLineColor,_scrollBarColor:ps,_scrollBarSize:ms,_autoMakeVisible:$o,_autoHideScrollBar:em,_selectBackground:l.listViewSelectBackground,_labelColor:l.listViewLabelColor,_labelSelectColor:l.listViewLabelSelectColor,_labelFont:l.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(B){var z=this,G=z._checkMode;z._checkMode=B,z.fp(dn,G,B)},drawRow:function(D,G,d,j,b,w,X){var $=this,p=0,f=$._indent,J=$.getIconWidth(G);$.drawRowBackground(D,G,d,j,b,w,X),$._checkMode&&(on(D,nb($.getCheckIcon(G)),p+f/2,b+X/2,G,$),p+=f),$.drawIcon(D,G,p,b,J,X),$.drawLabel(D,G,p+J,b,X)}});var Cb=function(Y){this.list=Y,this._lastSelectDataTime=Ip(),this.addListeners()};Op(Cb,H,{ms_listener:1,getView:function(){return this.list._view
        },clear:function(L){var y=this,T=y.list;L&&"d"===y._62O&&!y.dragCancel&&T.handleDragAndDrop(L,"end"),T.draggingData&&(T.draggingData=null,T.redraw()),y.dragCancel=y._62O=y._isV=y._isH=y.cp=y.tx=y.ty=s},handle_mousedown:function(X){this.handle_touchstart(X)},handle_touchstart:function(j){var v=this,i=v.list;if(bn(j),i.setFocus(j)){var d=i.getDataAt(j);v.cp=Il(j),v.tx=i.tx(),v.ty=i.ty(),Zb(j)?d&&i.handleDragAndDrop&&!v.isV(j)&&!v.isH(j)&&(i.draggingData=d,i.redraw(),i.handleDragAndDrop(j,"prepare")):(d&&v._33o(j,d),v.clear(j))}},handleWindowMouseUp:function(A){this.clear(A)},handleWindowTouchEnd:function(n){this.clear(n)},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(a){var Y=this,e=Y.list;if(!Y._isV&&!Y._isH&&Y.cp&&!Y._62O){var H=e.getDataAt(a);H?(e.isCheckMode()?Y._34o(a,H):Y._33o(a,H),ui(a)?e.onDataDoubleClicked(H,a):e.onDataClicked(H,a)):e.handleBackgroundClick(a)}Y.clear(a)},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(L){var W=this,r=W.list,O=W._62O,F=W.tx,P=W.ty,J=W.cp,H=Il(L),o=r._29I;"p"===O?r.setTranslate(F+H.x-J.x,P+H.y-J.y):"v"===O?r.ty(P+(J.y-H.y)*r._59I/o.height):"h"===O?r.tx(F+(J.x-H.x)*r._91I/o.width):"d"===O&&(W.dragCancel||r.handleDragAndDrop(L,"between"))},handle_mousemove:function(j){this.handle_touchmove(j)},handle_touchmove:function($){if(!Rn&&Zb($)){var z=this,G=z.list;if(z._isV=z.isV($),z._isH=z.isH($),z.cp){if(!z._62O){if(Bg(Il($),z.cp)<2)return;z._isV?z._62O="v":z._isH?z._62O="h":G.draggingData&&!this.dragCancel?(z._62O="d",G.handleDragAndDrop($,"begin")):z._62O="p",z._62O&&"d"!==z._62O&&G.draggingData&&(G.draggingData=null,G.redraw()),De(z)}}else z._isV&&G._43o(),z._isH&&G._42o()}},isV:function(v){var y=this.list,n=y._29I;return y._41o()&&n.x+n.width-y.lp(v).x<Fo},isH:function(X){var B=this.list,T=B._29I;return B._40o()&&T.y+T.height-B.lp(X).y<Fo},handle_mousewheel:function(k){this.handleScroll(k,k.wheelDelta/40,k.wheelDelta!==k.wheelDeltaX)},handle_DOMMouseScroll:function(y){this.handleScroll(y,-y.detail,1)},handleScroll:function(t,d,v){var I=this.list;bn(t),I.endEditing&&I.endEditing(),v&&I._41o()?I.translate(0,d*I.getRowHeight()):I._40o()&&I.translate(10*d,0)},handle_keydown:function(S){if(!l.isInput(S.target)){var p,s=this.list,P=s.sm(),H=s._rows,f=H.size();if(Jc(S))s.selectAll();else if(Wl(S))s.handleDelete&&s.handleDelete(S);else if(vq(S))"d"!==this._62O||this.dragCancel||(s.handleDragAndDrop(S,"cancel"),this.dragCancel=!0);else if(Ln(S))s.isCheckMode()&&(p=s.getFocusData(),p&&s.checkData(p));else if(ri(S)||tr(S)){var Q=s.isCheckMode();if(p=Q?s.getFocusData():P.ld()){var j=s.getRowIndex(p);j>=0&&(ri(S)?0!==j&&(p=H.get(j-1),Q?s.setFocusData(p):P.ss(p)):j!==f-1&&(p=H.get(j+1),Q?s.setFocusData(p):P.ss(p)))}else f>0&&(p=H.get(0),Q?s.setFocusData(p):P.ss(p))}}},_34o:function(T,q){var g=this.list,V=g.lp(T).x;return V>=0&&V<=g._indent?(g.checkData(q),void 0):(g.setFocusData(q),void 0)},_33o:function(a,c){var j=this.list,C=j.sm(),u=C.ld();if(Ei(a))j.isSelected(c)?C.rs(c):C.as(c);else if(Fg(a))if(u)for(var W=j.getRowIndex(u),E=j.getRowIndex(c);W!==E;)W+=E>W?1:-1,C.as(j._rows.get(W));else C.ss(c);else if(Zb(a)){var s=Ip();if(C.contains(c)){var d=s-this._lastSelectDataTime;j.handleDataDoubleSelect&&d>500&&1500>d&&j.handleDataDoubleSelect(a,c)}C.ss(c),this._lastSelectDataTime=s}else C.contains(c)||C.ss(c)}}),yc.TreeView=function(r){var X=this;X._35o(),X._5o(r),new Xl(X)},qd("TreeView",H,{ms_ac:[Nb,oe,wo,"rootVisible",dn,"rootData",ij,Tn,Sb,Um,kg,Vl,Ar,oi,om,Vh,nh,Sg,xm,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:s,_indent:Pc,_rowHeight:xi,_rowLineVisible:l.treeViewRowLineVisible,_rowLineColor:l.treeViewRowLineColor,_scrollBarColor:ps,_scrollBarSize:ms,_autoHideScrollBar:em,_expandIcon:l.treeViewExpandIcon,_collapseIcon:l.treeViewCollapseIcon,_autoMakeVisible:$o,_selectBackground:l.treeViewSelectBackground,_labelColor:l.treeViewLabelColor,_labelSelectColor:l.treeViewLabelSelectColor,_labelFont:l.treeViewLabelFont,_doubleClickToToggle:l.treeViewDoubleClickToToggle,drawRow:function(Z,V,m,e,Y,n,K){var $=this;$.drawRowBackground(Z,V,m,e,Y,n,K),$._97I(Z,V,m,0,Y,n,K)},isOnToggleIcon:function(L){var n=this.getDataAt(L);if(n){var R=this.getIndent(),i=this.lp(L).x;if(nb(this.getToggleIcon(n))){var O=R*this.getLevel(n);if(i>=O&&O+R>=i)return!0}}return!1}});var Xl=function(v){jj(Xl,this,[v])};Op(Xl,Cb,{toggle:function(F,w,x,Q){var D=this.list,z=D.lp(F).x;if(nb(D.getToggleIcon(w))){var l=x*Q;if(z>=l&&l+x>=z)return D.toggle(w),!0}return D.isDoubleClickToToggle()&&ui(F)?(D.toggle(w),!0):!1},_34o:function(b,O){var p=this.list,K=p.lp(b).x,I=p._levelMap[O._id],H=p._indent,C=H*(I+1);return K>=C&&C+H>=K?(p.checkData(O),void 0):(this.toggle(b,O,H,I)||p.setFocusData(O),void 0)},_33o:function(q,$){var h=this,Z=h.list;h.toggle(q,$,Z._indent,Z.getLevel($))||Xl.superClass._33o.call(h,q,$)},handle_keydown:function(m){if(Dp(m)||Wc(m)){var o=this.list,U=o._rows,$=o.isCheckMode(),w=o.sm(),u=$?o.getFocusData():w.ld();u?u.hasChildren()&&(Dp(m)?o.collapse(u):o.expand(u)):U.size()>0&&(u=U.get(0),$?o.setFocusData(u):w.ss(u))}else Xl.superClass.handle_keydown.call(this,m)}});var kb=yc.TableView=function(C){this._98I(),this._5o(C),new gm(this)};qd("TableView",H,{ms_ac:[Nb,oe,wo,"sortMode",eb,Lp,Ar,oi,om,mh,qn,"sortColumn",ij,Tn,Sb,Um,kg,Sg,xm],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ho,_editable:!0,_batchEditable:!1,_rowHeight:xi,_rowLineVisible:l.tableViewRowLineVisible,_rowLineColor:l.tableViewRowLineColor,_columnLineVisible:l.tableViewColumnLineVisible,_columnLineColor:l.tableViewColumnLineColor,_scrollBarColor:ps,_scrollBarSize:ms,_autoHideScrollBar:em,_autoMakeVisible:$o,_selectBackground:l.tableViewSelectBackground,_labelColor:l.tableViewLabelColor,_labelSelectColor:l.tableViewLabelSelectColor,_labelFont:l.tableViewLabelFont,getCheckColumn:function(){var R=this;if(!R._31o){var h=R._31o=new am;h.setEditable(!0),h.setWidth(40),h.getValue=R.getCheckColumValue,h.drawCell=R.drawCheckColumnCell}return R._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(L){var s=this,f=s._39o,I=s.getCheckColumn();L!==s.isCheckMode()&&(L?f.add(I,0):f.remove(I),s.fp(dn,!L,L))},getCheckColumValue:function(f,J,G){return G.isSelected(f)},drawCheckColumnCell:function(v,r,X,k,F,H,T,h,G){on(v,G.getCheckIcon(r),F+T/2,H+h/2,r,G)}});var gm=function(G){jj(gm,this,[G])};Op(gm,Cb,{_34o:function(U,n){var K=this.list,t=K._31o;if(K.isCellEditable(n,t,U)){var _=K._3Q(t),E=K.lp(U).x;if(_&&E>=_.startX&&E<_.startX+t.getWidth())return K.checkData(n),void 0}K._37O(n,U),K.setFocusData(n)},_33o:function(K,Z){this.list._37O(Z,K),gm.superClass._33o.apply(this,arguments)}});var te=yc.TreeTableView=function(Y){var r=this,Q=r._4o=new am;r._35o(),r._98I(),r._5o(Y),Q.setDisplayName("Name"),Q.setEditable(!0),Q.setWidth(180),Q.drawCell=jg,Q.getValue=eg,r._39o.add(Q),new _q(r)},jg=function(e,r,v,b,D,k,d,C,Z){Z._97I(e,r,v,D,k,d,C)},eg=function(y,q,Q){return Q.getLabel(y)};qd("TreeTableView",H,{ms_ac:[Nb,oe,wo,"sortMode",eb,Lp,Vl,dn,"rootData","rootVisible",ij,Tn,"sortColumn",Vh,nh,Sb,Um,kg,Sg,om,Ar,oi,mh,qn,xm,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ho,_checkMode:s,_editable:!0,_batchEditable:!1,_indent:Pc,_rowHeight:xi,_rowLineVisible:l.treeTableViewRowLineVisible,_rowLineColor:l.treeTableViewRowLineColor,_columnLineVisible:l.treeTableViewColumnLineVisible,_columnLineColor:l.treeTableViewColumnLineColor,_expandIcon:l.treeTableViewExpandIcon,_collapseIcon:l.treeTableViewCollapseIcon,_scrollBarColor:ps,_scrollBarSize:ms,_autoHideScrollBar:em,_autoMakeVisible:$o,_selectBackground:l.treeTableViewSelectBackground,_labelColor:l.treeTableViewLabelColor,_labelSelectColor:l.treeTableViewLabelSelectColor,_labelFont:l.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var _q=function(L){jj(_q,this,[L])};Op(_q,Cb,{_34o:function(T,E){var A=this.list,r=A._4o,q=A._3Q(r),a=A.lp(T).x;if(q){var n=A._indent,U=q.startX+n*A.getLevel(E);if(nb(A.getToggleIcon(E))&&a>=U&&U+n>=a)return A.toggle(E),void 0;if(A.isCellEditable(E,r)&&(U+=n,a>=U&&U+n>=a))return A.checkData(E),void 0}A._37O(E,T),A.setFocusData(E)},_33o:function(f,y){var x=this.list,G=x.lp(f).x;if(nb(x.getToggleIcon(y))){var i=x._3Q(x._4o);if(i){var Y=x._indent,h=i.startX+Y*x.getLevel(y);if(G>=h&&h+Y>=G)return x.toggle(y),void 0}}x._37O(y,f),_q.superClass._33o.apply(this,arguments)}});var rk=yc.TableHeader=function(u){var b=this,$=b._view=js(1,b),p=b._39o=u.getColumnModel(),J=b.iv;b.tv=b._tableView=u,b._60I=new Ce,b._canvas=Ub($),$.style.background=l.tableHeaderBackground||"",$.style.height=uq+pp,p.mm(J,b),p.md(J,b),p.mh(J,b),u.mp(function(c){Te[c.property]&&b.iv()},b),new So(b),b.iv()};qd("TableHeader",H,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Nb,wo,Vl,"moveBackground","insertColor",mh,qn,"resizable","movable"],_checkIcon:Fi,_movable:!0,_resizable:!0,_labelColor:l.tableHeaderLabelColor,_labelFont:l.tableHeaderLabelFont,_columnLineColor:l.tableHeaderColumnLineColor,_columnLineVisible:l.tableHeaderColumnLineVisible,_sortDescIcon:l.tableHeaderSortDescIcon,_sortAscIcon:l.tableHeaderSortAscIcon,_moveBackground:l.tableHeaderMoveBackground,_insertColor:l.tableHeaderInsertColor,_indent:Pc,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(X){return X.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(k){return k.getColor()||this._labelColor},getLabelAlign:function(k){return k._align},onPropertyChanged:function(){this.iv()},_5Q:function(b){this._61I=b,this.iv()},getLogicalPoint:function(k){return Xq(k,this._canvas,this.tv.tx())},validateImpl:function(){var z=this,I=z._canvas,q=z.getWidth(),x=z.getHeight(),G=z.tv,V=z._60I,y=z._61I,r=-G.tx(),g=0;(q!==I.clientWidth||x!==I.clientHeight)&&sf(I,q,x),V.clear(),z._39o._roots.each(function(t){if(t.isVisible()){var z=g+t.getWidth();r+q>=g&&z>=r&&V.add({column:t,startX:g}),g=z}});var o=An(I);if(ze(o,-r,0,1),o.beginPath(),o.rect(r,0,q,x),o.clip(),o.clearRect(r,0,q,x),V.each(function(M){var g=M.column,u=M.startX,w=g.getWidth();w>0&&(o.save(),o.beginPath(),o.rect(u,0,w,x),o.clip(),y&&y.column===g||z.drawColumn(o,g,u,0,w,x),z._columnLineVisible&&Yl(o,u+w-1,0,1,x,z._columnLineColor),o.restore())}),y){var T=y.column,g=y.startX,P=y.position,w=T.getWidth();o.save(),o.beginPath(),o.rect(g,0,w,x),o.clip(),o.fillStyle=z._moveBackground,o.fill(),z.drawColumn(o,T,g,0,w,x),o.restore(),oq(o,z._insertColor,P,0,x)}o.restore()},_6Q:function(C){var Q=this.tv;return Q._31o===C&&Q.sm().getSelectionMode()===Ij},drawColumn:function(W,B,d,t,n,C){var h=this,l=h.tv,S=nb(B.getIcon()),P=h.getLabelAlign(B);if(h._6Q(B)){var s=nb(h._checkIcon);on(W,s,d+n/2,t+C/2,B,h)}else{var Z=h.getLabel(B),$=h.getLabelFont(B),M=h.getLabelColor(B),N=sq($,Z).width,a=S?h._indent:0;P===Ih?(S&&Bk(W,S,yk,d,t,a,C),li(W,Z,$,M,d+a,t,n,C,Ih)):P===Go?(S&&Bk(W,S,yk,d+n-N-a,t,a,C),li(W,Z,$,M,d,t,n,C,Go)):(S&&Bk(W,S,yk,d+(n-N-a)/2,t,a,C),li(W,Z,$,M,d+(n-N+a)/2,t,0,C,Ih))}if(B.isSortable()&&l.getSortColumn()===B&&(S=nb(B.getSortOrder()===lj?h._sortAscIcon:h._sortDescIcon))){var c=El(S,B)/2+2;on(W,S,P===Go?d+c:d+n-c,t+C/2,B,l)}}});var So=function(u){var w=this;w.th=u,w.tv=u._tableView,w.addListeners()};Op(So,H,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(J){this.getView().style.cursor=J},handle_mousemove:function(s){if(!Rn){var x=this;delete x._29o,x.setCursor(uj);for(var N=x.th,J=N._60I,Z=N.lp(s).x,t=J.size()-1;t>=0;t--){var w=J.get(t),y=w.column,h=w.startX+y.getWidth();if(N.isResizable()&&P(h-Z)<=(Ch?10:3))return x._29o=w,x.setCursor(co),void 0;Z>w.startX&&h>Z&&(x._29o=w),(y.isClickable()||y.isSortable()||N.isMovable()||x.tv.getCheckColumn&&y===x.tv.getCheckColumn())&&Z>w.startX&&h>Z&&x.setCursor(Ne)}}},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(t){var Z=this;bn(t),Z.tv.endEditing(),Z.handle_mousemove(t),Z._29o&&(Z.x=Il(t).x,Z.lx=Z.th.lp(t).x,Z.w=Z._29o.column.getWidth(),De(Z,t))},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowTouchMove:function(R){var H=this,y=H.th,Z=H.getView().style.cursor,D=H._29o,g=Il(R).x-H.x;if(H.resizing||H.moving||(Z===co?H.resizing=1:y.isMovable()&&Z===Ne&&P(g)>2&&(H.moving=1)),H.resizing)D.column.setWidth(H.w+g);else if(H.moving){var c=H.lx+g;y._60I.each(function(G){var Z=G.startX,Q=Z+G.column.getWidth();if(c>=Z&&Q>=c){var d={column:D.column,startX:D.startX+g,front:Q-c>c-Z,insertColumn:G.column};d.position=d.front?Z:Q,y._5Q(d)}})}},_16Q:function(V,r){var R=this,H=R.tv,L=R.th,$=L._checkIcon;if(L._6Q(V)){var Y=nb($),K=R.lx,P=V.getWidth(),u=El(Y,V);if(K>=r+P/2-u&&r+P/2+u>=K){L.setCheckIcon($===Ii?Fi:Ii);var h=H.sm(),b=H._rows;return $===Ii?h.rs(b):h.ss(b),H.onCheckColumnClicked(V),!0}}return!1},handleWindowMouseUp:function(u){this.handleWindowTouchEnd(u)},handleWindowTouchEnd:function(P){var R=this,c=R.tv,D=R.th,G=R._29o;if(R.moving){var k=D._61I;if(k&&k.insertColumn!==k.column){var J=k.column,E=c.getColumnModel()._roots,b=E.remove(J),B=E.indexOf(k.insertColumn);B>=0&&(k.front||B++,B<=E.size()&&(E.add(J,B),c.getColumnModel()._38I(J,b,B)))}D._5Q(s),delete R.moving}else if(!R.resizing&&G){J=G.column;var d=D.lp(P).x,r=G.startX,X=!0;if(D.onColumnClicked){var x=D.onColumnClicked(J,P,r);x===!1&&(X=!1)}if(X&&d>=r&&d<=r+J.getWidth()&&!R._16Q(J,r)){if(J.isSortable()){var Y=c.getSortMode(),w=J.getSortOrder();Y===ho?c.getSortColumn()===J?(w===mk&&c.setSortColumn(s),J.setSortOrder(w===lj?mk:lj)):c.setSortColumn(J):"bistate"===Y&&(c.getSortColumn()===J?J.setSortOrder(w===lj?mk:lj):c.setSortColumn(J))}c.onColumnClicked(J,P,r)}}R._29o=R.resizing=R.x=R.lx=R.w=s}}),yc.TablePane=function(Y){this.init(new kb(Y))},qd("TablePane",H,{ms_v:1,_44o:1}),yc.TreeTablePane=function(L){this.init(new te(L))},qd("TreeTablePane",H,{ms_v:1,_44o:1}),yc.Toolbar=function(N){var A=this,B=A._view=js(1,A),y=B.style;y.background=l.toolbarBackground||"",y.height=lf+pp,A._canvas=Ub(B),A._30o=new Ce,A._90I=new Ce,A.setItems(N||[]),B.handleGroupSelectedChanged=function(i){if(i.isSelected()){var t=i.getGroupId();null!=t&&A._items.forEach(function(d){var u=d.element;u&&u!==i&&u.setSelected&&u.getGroupId&&u.getGroupId()===t&&u.setSelected(!1)})}},new tk(A)},qd("Toolbar",H,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[qk,Nb,wo,oe,xm,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:l.toolbarLabelColor,_labelSelectColor:l.toolbarLabelSelectColor,_labelFont:l.toolbarLabelFont,_selectBackground:l.toolbarSelectBackground,_itemGap:l.toolbarItemGap,_separatorColor:l.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(J){var d=this.getItemInfoAt(J);return d?d.item.toolTip:s},getLabelColor:function(s){return s&&s.selected&&s.type!==Ii&&s.type!==Zg?this._labelSelectColor:this._labelColor},onPropertyChanged:function(q){this.iv(),q.property===qk&&this._items.forEach(function(_){us(_)})},redraw:function(){this.iv()},addItem:function(j,c){var f=this._items;c==s?f.push(j):f.splice(c,0,j),this.fp(qk,s,f)},removeItem:function(b){if(b)for(var I=this._items,V=0;V<I.length;V++)b===I[V]&&(I.splice(V,1),this.fp(qk,s,I))},removeItemById:function(w){if(w!=s)for(var i=this._items,Y=0;Y<i.length;Y++)if(w===i[Y].id){var p=i.splice(Y,1)[0];return this.fp(qk,s,i),p}},getItemById:function(g){if(g!=s)for(var d=this._items,F=0;F<d.length;F++){var H=d[F];if(g===H.id)return H}},setItemVisible:function(f,G){var Q=this.getItemById(f);Q&&(Q.visible=G)},getItemInfos:function(){return this._30o},getItemInfoAt:function(Z){var X=this,W=0,V=X._30o,m=X.lp(Z),f=m.x,J=m.y;if(J>=0&&J<=X.getHeight())for(;W<V.size();W++){var F=V.get(W);if(F.startX<=f&&f<=F.endX)return F}return s},drawItem:function(b,e,C,M,A){if(e.visible===!1)return 0;if(Ym(e.visible)&&!e.visible())return 0;var u=this,h=e.disabled;h&&(b.globalAlpha=ok);var O=u.drawItemImpl(b,e,C,M,A),s=u._itemGap;return h&&(b.globalAlpha=1),this._currentItem!==e||"separator"===e||e.separator===!0||e.unfocusable||Gq(b,u._separatorColor,C-s/2,0,O+s,M),O},drawItemImpl:function(G,E,D,Z,m){var $=this,x=$._view,y=$._itemGap,e=Z/2,V=E.type,F=E.element,_=E.label;Kl(F)&&(_=F,F=s);var z,w=$.getLabelFont(E),j=$.getLabelColor(E),U=E.selected,r=nb(E.icon),S=El(r,E),L=0,u=S+(_?sq(w,_).width:0);if("separator"===E||E.separator===!0)return oq(G,$._separatorColor,D,Z/4,e),1;if(F){r&&on(G,r,D+S/2,e,E,$),li(G,_,w,j,D+S,0,0,Z);var h=Yf(F);m||$._90I.add(h),h.parentNode!==x&&Xd(x,h),F.iv&&F.iv(),F.validate&&F.validate();var K=h.getBoundingClientRect(),t=K.width,C=h.style;return Ql(h),C.left=$.tx()+D+u+pp,C.top=(Z-K.height)/2+pp,u+t}return V===Zg?z=nb(U?aq:Yn):V===Ii&&(z=nb(U?Ii:Fi)),z?(L=El(z,E),on(G,z,D+L/2,e,E,$),D+=L,u+=L):U&&Yl(G,D-y/2,0,u+y,Z,$.getSelectBackground(E)),r&&on(G,r,D+S/2,e,E,$),li(G,_,w,j,D+S,0,0,Z),u},validateImpl:function(){var C=this,m=C._canvas,V=C.getWidth(),E=C.getHeight(),r=C._30o,H=C._items;sf(m,V,E);var f=An(m),Y=C._itemGap,h=Y/2;ze(f,C.tx(),0,1),f.clearRect(0,0,V,E);var N=C._90I;C._90I=new Ce,r.clear(),H.forEach(function(w){var k=C.drawItem(f,w,h,E);r.add({item:w,startX:h,endX:h+k,width:k}),k&&(h+=k+Y)}),N.each(function(p){C._90I.contains(p)||kq(p)});var K=C._64I;C._64I=t(0,h),f.restore(),C._stickToRight?(C._65O=0,f=An(m),h=V-C._64I+Y,ze(f,0,0,1),f.clearRect(0,0,V,E),r.clear(),H.forEach(function(Q){var A=C.drawItem(f,Q,h,E,!0);r.add({item:Q,startX:h,endX:h+A,width:A}),A&&(h+=A+Y)}),f.restore()):C.tx(C.tx()),K!==C._64I&&C.onSumWidthChanged(K,C._64I)},onSumWidthChanged:function(){},handleClick:function(m,R){var B=this,w=m.type,$=m.action,t=m.groupId,r=m.selected;m.disabled||(t!=s?r||(m.selected=!0,this._items.forEach(function(v){v.groupId===t&&m!==v&&(v.selected=!1)}),$&&m.action(m,B,R)):w===Ii||"toggle"===w?(m.selected=!r,$&&m.action(m,B,R)):$&&m.action(m,B,R)),Si(),B.iv()}});var tk=function(A){this.tb=A,this.addListeners()};Op(tk,H,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(N){this.handleScroll(N,10*(N.wheelDelta/40))},handle_DOMMouseScroll:function(I){this.handleScroll(I,10*-I.detail)},handleScroll:function(P,s){bn(P);var o=this.tb;o.isScrollable()&&!o._stickToRight&&(o.tx(o.tx()+s),ei())},handle_mousemove:function(t){var H=this;Rn||H.setItem(t)},handle_mouseout:function(a){var v=this;a.target===v.getView()?v.tb.setCurrentItem(s):v.handle_mousemove(a)},handle_mousedown:function(G){this.handle_mousemove(G),this.handle_touchstart(G)},handle_touchstart:function(w){var q=this,V=q.tb,f=w.target;Zb(w)&&(f===q.getView()||f===V._canvas)&&(bn(w),V.setFocus(w)&&(this.setItem(w,!0),(V.isScrollable()||q.info&&!q.info.item.disabled)&&(q.x=Il(w).x,q.tx=V.tx(),De(q,w))))},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(W){var p=this,z=p.tb;if(!z._stickToRight){var N=Il(W).x-p.x;!p._25o&&P(N)>2&&z.isScrollable()&&(p._25o=1),p._25o&&z.tx(p.tx+N)}},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(y){var W=this,a=W.tb,u=W.info,z=W.tb.getItemInfoAt(y);if(!W._25o&&u){var E=u.item;z&&z.item===E&&a.handleClick(E,y)}W._25o=W.x=W.tx=s,W.setItem()},setItem:function(g,U){var f=this,y=f.tb,C=f.info=g?y.getItemInfoAt(g):s,M=C?C.item:s;y.setCurrentItem(M),U&&M&&Ym(M.onDown)&&M.onDown(g)}}),yc.BorderPane=function(){this._view=js(1,this),this.iv()},qd("BorderPane",H,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(I,v){this._12o("leftView",I),v!=s&&this.setLeftWidth(v)},getRightView:function(){return this._rightView},setRightView:function(K,b){this._12o("rightView",K),b!=s&&this.setRightWidth(b)},getTopView:function(){return this._topView},setTopView:function($,b){this._12o("topView",$),b!=s&&this.setTopHeight(b)},getBottomView:function(){return this._bottomView},setBottomView:function(Q,Z){this._12o("bottomView",Q),Z!=s&&this.setBottomHeight(Z)},getCenterView:function(){return this._centerView},setCenterView:function(G){this._12o("centerView",G)},_12o:function(q,n){var Y=this,R="_"+q,Z=Y._view,l=Y[R];l!==n&&(l&&(l.getView?kq(l.getView()):kq(l)),Y[R]=n,n&&(n.getView?Xd(Z,n.getView(),1):Xd(Z,n,1)),Y.fp(q,l,n))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var B=this,S=B._topView,L=B._bottomView,I=B._leftView,Z=B._rightView,J=B._centerView,z=B.getWidth(),M=B.getHeight(),e=0,w=0,j=z,X=M,U=0,P=0,g=0,y=0;S&&(U=B._topHeight==s?ec(S):B._topHeight,w=U),L&&(P=B._bottomHeight==s?ec(L):B._bottomHeight,X=M-P),I&&(g=B._leftWidth==s?kh(I):B._leftWidth,e=g),Z&&(y=B._rightWidth==s?kh(Z):B._rightWidth,j=z-y);var v=t(0,j-e),F=t(0,X-w);S&&Kj(S,0,0,z,U),L&&Kj(L,0,X,z,P),I&&Kj(I,0,w,g,F),Z&&Kj(Z,j,w,y,F),J&&Kj(J,e,w,v,F)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);